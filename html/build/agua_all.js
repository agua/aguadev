/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

if(!dojo._hasResource["plugins.core.Common.Array"]){dojo._hasResource["plugins.core.Common.Array"]=true;dojo.provide("plugins.core.Common.Array");dojo.declare("plugins.core.Common.Array",[],{_getIndex:function(_1,_2){for(var i=0;i<_1.length;i++){if(_1[i]==_2){return i;}}return -1;},_getObjectByKeyValue:function(_3,_4,_5){if(_3==null){return;}for(var i=0;i<_3.length;i++){if(_3[i][_4]==_5){return _3[i];}}return;},_addObjectToArray:function(_6,_7,_8){if(_6==null){_6=new Array;}var _9=this.notDefined(_7,_8);if(_9.length>0){console.log("  Common.Array._addObjectToArray    notDefined: "+dojo.toJson(_9));return false;}_6.push(_7);return true;},_removeObjectFromArray:function(_a,_b,_c){var _d=this._getIndexInArray(_a,_b,_c);if(_d==null){return false;}_a.splice(_d,1);return true;},_removeArrayFromArray:function(_e,_f,_10){var _11=true;for(var j=0;j<_f.length;j++){var _12=this.notDefined(_f[j],_10);if(_12.length>0){console.log("  Common.Array.removeArrayFromArray    object has notDefined keys: "+dojo.toJson(_12));_11=false;continue;}var _13=this._removeObjectFromArray(_e,_f[j],_10);if(_13==false){_11=_13;}}return _11;},_getIndexInArray:function(_14,_15,_16){if(_14==null){return null;}for(var i=0;i<_14.length;i++){var _17=_14[i];var _18=true;for(var j=0;j<_16.length;j++){if(_17[_16[j]]!=_15[_16[j]]){_18=false;break;}}if(_18==true){return i;}}return null;},_objectInArray:function(_19,_1a,_1b){if(_19==null){return false;}if(_1a==null){return false;}var _1c=this._getIndexInArray(_19,_1a,_1b);if(_1c==null){return false;}return true;},_removeObjectsFromArray:function(_1d,_1e,_1f){if(_1d==null){return;}var _20=new Array;for(var i=0;i<_1d.length;i++){var _21=_1d[i];var _22=true;for(var j=0;j<_1f.length;j++){if(_21[_1f[j]]!=_1e[_1f[j]]){_22=false;break;}}if(_22==true){_20.push(_1d.splice(i,1));i--;}}return _20;},_addArrayToArray:function(_23,_24,_25){if(_23==null){return;}var _26=true;for(var i=0;i<_24.length;i++){if(!this._addObjectToArray(_23,_24[i],_25)){_26=false;}}return _26;},_objectsMatchByKey:function(_27,_28,_29){console.log("    Common._objectsMatchByKey object1:");console.dir({object1:_27});console.log("    Common._objectsMatchByKey object2:");console.dir({object2:_28});if(!_27||!_28){return;}if(_27==null||_27==null||_29==null){return false;}for(var i=0;i<_29.length;i++){if(_27[_29[i]]!=_28[_29[i]]){return false;}}return true;},hashArrayKeyToArray:function(_2a,key){var _2b=new Array;dojo.forEach(_2a,function(_2c){if(_2c[key]){_2b.push(_2c[key]);}});return _2b;},hashkeysToArray:function(_2d){var _2e=new Array;for(var key in _2d){if(key!=null&&key!=""){_2e.push(key);}}return _2e;},filterHasharray:function(_2f,key){var _30=new Array;dojo.forEach(_2f,function(_31){if(_31[key]!=null){_30.push(_31);}});return _30;},filterByKeyValues:function(_32,_33,_34){if(_32==null){return;}if(_33==null){return;}if(_34==null){return;}for(var i=0;i<_32.length;i++){var _35=true;for(var j=0;j<_33.length;j++){if(_32[i][_33[j]]!=_34[j]){_35=false;break;}}if(_35==false){var _36=_32[i];_32.splice(i,1);i--;}}return _32;},_addArrayToArray:function(_37,_38,_39){if(_37==null){_37=new Array;}var _3a=this.notDefined(_38,_39);if(_3a.length>0){console.log("  Common.Array._addArrayToArray    notDefined: "+dojo.toJson(_3a));return false;}console.log("  Common.Array._addArrayToArray    Doing twoDArray.push(array)");_37.push(_38);console.log("  Common.Array._addArrayToArray    AFTER twoDArray.push(array). twoDArray: "+dojo.toJson(_37));return true;},notDefined:function(_3b,_3c){if(_3b==null){return;}var _3d=new Array;for(var i=0;i<_3c.length;i++){if(_3b[_3c[i]]==null){_3d.push(_3c[i]);}}return _3d;},getEntry:function(_3e,_3f,_40){if(_3e==null){return;}if(_3f==null){return;}if(_40==null){return;}for(var i=0;i<_3e.length;i++){var _41=true;for(var j=0;j<_3f.length;j++){if(_3e[i][_3f[j]]!=_40[j]){_41=false;break;}}if(_41==true){return _3e[i];}}console.log("  Common.Array.getEntry    Returning null");return null;},uniqueValues:function(_42){if(_42.length==1){return _42;}_42=_42.sort();for(var i=1;i<_42.length;i++){if(_42[i-1]==_42[i]){_42.splice(i,1);i--;}}return _42;}});}if(!dojo._hasResource["plugins.core.Common.ComboBox"]){dojo._hasResource["plugins.core.Common.ComboBox"]=true;dojo.provide("plugins.core.Common.ComboBox");dojo.declare("plugins.core.Common.ComboBox",[],{setUsernameCombo:function(){var _43=Agua.getSharedUsernames();if(_43==null||_43.length==0){return;}var _44={identifier:"name",items:[]};for(var i in _43){_44.items[i]={name:_43[i]};}var _45=new dojo.data.ItemFileReadStore({data:_44});this.usernameCombo.store=_45;this.usernameCombo.startup();this.usernameCombo.set("value",_43[0]);},setSharedProjectCombo:function(_46,_47,_48){var _49=Agua.getSharedProjectsByUsername(_46);if(_49==null){return;}var _4a=this.hashArrayKeyToArray(_49,"name");_4a=this.uniqueValues(_4a);if(_4a==null||_4a.length==0){return;}var _4b={identifier:"name",items:[]};for(var i in _4a){_4b.items[i]={name:_4a[i]};}var _4c=new dojo.data.ItemFileReadStore({data:_4b});this.projectCombo.store=_4c;this.projectCombo.startup();this.projectCombo.set("value",_4a[0]);},setSharedWorkflowCombo:function(_4d,_4e,_4f){console.log("  Common.ComboBox.setSharedWorkflowCombo    plugins.report.Workflow.setSharedWorkflowCombo(username, project, workflow)");console.log("  Common.ComboBox.setSharedWorkflowCombo    projectName: "+_4e);if(_4e==null){_4e=this.projectCombo.get("value");}console.log("  Common.ComboBox.setSharedWorkflowCombo    AFTER projectName: "+_4e);var _50=Agua.getSharedWorkflowsByProject(_4d,_4e);if(_50==null){console.log("  Common.ComboBox.setSharedWorkflowCombo    workflows is null. Returning");return;}console.log("  Common.ComboBox.setSharedWorkflowCombo    workflows: ");console.dir({workflows:_50});var _51=this.hashArrayKeyToArray(_50,"name");_51=this.uniqueValues(_51);console.log("  Common.ComboBox.setSharedWorkflowCombo    workflowNames: "+dojo.toJson(_51));if(_51==null||_51.length==0){console.log("  Common.ComboBox.setSharedWorkflowCombo    workflowNames not defined. Returning.");return;}var _52={identifier:"name",items:[]};for(var i in _51){_52.items[i]={name:_51[i]};}var _53=new dojo.data.ItemFileReadStore({data:_52});this.workflowCombo.store=_53;this.workflowCombo.startup();this.workflowCombo.set("value",_51[0]);},setProjectCombo:function(_54,_55){var _56=Agua.getProjectNames();if(!_56){return;}if(_54==null||!_54){_54=_56[0];}var _57={identifier:"name",items:[]};for(var i in _56){_57.items[i]={name:_56[i]};}var _58=new dojo.data.ItemFileReadStore({data:_57});var _59=this.projectCombo;if(_59==null){return;}_59.store=_58;_59.set("value",_54);},setWorkflowCombo:function(_5a,_5b){if(_5a==null||!_5a){return;}var _5c=Agua.getWorkflowsByProject(_5a);console.log("  Common.ComboBox.setWorkflowCombo    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX DOING SORT workflows");_5c=this.sortHasharrayByKeys(_5c,["number"]);console.log("  Common.ComboBox.setWorkflowCombo    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX AFTER SORT workflows:");console.dir({XXXXXXXXXXXXXXXXXworkflows:_5c});var _5d=this.hashArrayKeyToArray(_5c,"name");if(!_5d){console.log("  Common.ComboBox.setWorkflowCombo    workflowNames not defined. Returning.");return;}var _5e={identifier:"name",items:[]};for(var i in _5d){_5e.items[i]={name:_5d[i]};}console.log("  Common.ComboBox.setWorkflowCombo    data: "+dojo.toJson(_5e));var _5f=new dojo.data.ItemFileReadStore({data:_5e});var _60=this.workflowCombo;if(_60==null){console.log("  Common.ComboBox.setworkflowCombo    workflowCombo is null. Returning.");return;}_60.store=_5f;if(_5b==null||!_5b){_5b=_5d[0];}_60.startup();_60.set("value",_5b);},setReportCombo:function(_61,_62,_63){if(_61==null||!_61){console.log("  Common.ComboBox.setReportCombo    project not defined. Returning.");return;}if(_62==null||!_62){console.log("  Common.ComboBox.setReportCombo    workflow not defined. Returning.");return;}var _64=Agua.getReportsByWorkflow(_61,_62);if(_64==null){_64=[];}console.log("  Common.ComboBox.setReportCombo    project "+_61+" reports: "+dojo.toJson(_64));var _65=this.hashArrayKeyToArray(_64,"name");console.log("  Common.ComboBox.setReportCombo    reportNames: "+dojo.toJson(_65));var _66={identifier:"name",items:[]};for(var i in _64){_66.items[i]={name:_65[i]};}console.log("  Common.ComboBox.setReportCombo    data: "+dojo.toJson(_66));var _67=new dojo.data.ItemFileReadStore({data:_66});var _68=this.reportCombo;if(_68==null){console.log("  Common.ComboBox.setreportCombo    reportCombo is null. Returning.");return;}console.log("  Common.ComboBox.setReportCombo    reportCombo: "+_68);_68.store=_67;var _69=this;_68.startup();_68.set("value",_63);},setViewCombo:function(_6a,_6b){console.log("  Common.ComboBox.setViewCombo    projectName: "+_6a);console.log("  Common.ComboBox.setViewCombo    viewName: "+_6b);if(!this.viewCombo){return;}if(!_6a){return;}var _6c=Agua.getViewNames(_6a);console.log("  Common.ComboBox.setViewCombo    BEFORE SORT views: ");console.dir({views:_6c});_6c.sort(this.sortNaturally);console.log("View.setViewCombo    AFTER SORT views: ");console.dir({views:_6c});if(!_6c||_6c.length==0){_6c=[];}if(_6b==null||!_6b){_6b=_6c[0];}var _6d={identifier:"name",items:[]};for(var i in _6c){_6d.items[i]={name:_6c[i]};}var _6e=new dojo.data.ItemFileReadStore({data:_6d});this.viewCombo.store=_6e;this.viewCombo.startup();this.viewCombo.set("value",_6b);},getSelectedValue:function(_6f){var _70=_6f.selectedIndex;var _71=_6f.options[_70].text;return _71;}});}if(!dojo._hasResource["plugins.core.Common.Date"]){dojo._hasResource["plugins.core.Common.Date"]=true;dojo.provide("plugins.core.Common.Date");dojo.declare("plugins.core.Common.Date",[],{currentDate:function(){var _72=new Date;var _73=_72.toString();return _73;},currentMysqlDate:function(){var _74=new Date;_74=this.dateToMysql(_74);return _74;},dateToMysql:function(_75){return _75.getFullYear()+"-"+(_75.getMonth()<9?"0":"")+(_75.getMonth()+1)+"-"+(_75.getDate()<10?"0":"")+_75.getDate()+" "+(_75.getHours()<10?"0":"")+_75.getHours()+":"+(_75.getMinutes()<10?"0":"")+_75.getMinutes()+":"+(_75.getSeconds()<10?"0":"")+_75.getSeconds();},mysqlToDate:function(_76){var _77=/^([0-9]{2,4})-([0-1][0-9])-([0-3][0-9]) (?:([0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/;var _78=_76.replace(_77,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(_78[0],_78[1]-1,_78[2],_78[3],_78[4],_78[5]);}});}if(!dojo._hasResource["plugins.core.Common.Sort"]){dojo._hasResource["plugins.core.Common.Sort"]=true;dojo.provide("plugins.core.Common.Sort");dojo.declare("plugins.core.Common.Sort",[],{sortHasharrayByOrder:function(_79,_7a){var _7b=new Array;for(var i=0;i<_7a.length;i++){var _7c=_7a[i];for(var j=0;j<_79.length;j++){var _7d=_79[j];var _7e;for(var _7e in _7d){if(_7e==_7c){_7b.push(_7d);break;}}}}return _7b;},sortNoCase:function(_7f){return _7f.sort(function(a,b){return a.toUpperCase()==b.toUpperCase()?(a<b?-1:a>b):(a.toUpperCase()<b.toUpperCase()?-1:a.toUpperCase()>b.toUpperCase());});},sortHasharrayByKeys:function(_80,_81){if(_80==null){return;}if(_81==null){return;}if(!typeof _80=="ARRAY"||_80==null){return;}if(!typeof _81=="ARRAY"||_81==null){return;}return _80.sort(function(a,b){var _82=1;for(var i=0;i<_81.length;i++){var key=_81[i];if(a[key]==null||b[key]==null){continue;}if(a[key].toUpperCase&&b[key].toUpperCase){var _83=a[key].toUpperCase();var _84=b[key].toUpperCase();_82=_83==_84?(a[key]<b[key]?-1:(a[key]>b[key]?1:0)):(_83<_84?-1:(_83>_84?1:0));if(_82!=0){break;}}else{_82=a[key]<b[key]?-1:(a[key]>b[key]?1:0);if(_82!=0){break;}}}return _82;});},sortHasharray:function(_85,key){if(_85==null){return;}if(key==null){return;}if(!typeof _85=="ARRAY"){return;}return _85.sort(function(a,b){if(a[key]==null){return;}if(b[key]==null){return;}return a[key].toUpperCase()==b[key].toUpperCase()?(a[key]<b[key]?-1:a[key]>b[key]):(a[key].toUpperCase()<b[key].toUpperCase()?-1:a[key].toUpperCase()>b[key].toUpperCase());});},sortNumericHasharray:function(_86,key){if(_86==null){console.log("  Common.Sort.sortNumericHasharray    hashArray is null. Returning");return;}if(key==null){console.log("  Common.Sort.sortNumericHasharray    key is null. Returning.");return;}for(var i=0;i<_86.length;i++){if(parseInt(_86[i])=="NaN"){_86.splice(i,1);i--;}}return _86.sort(function(a,b){return parseInt(a[key])==parseInt(b[key])?(parseInt(a[key])<parseInt(b[key])?-1:parseInt(a[key])>parseInt(b[key])):(parseInt(a[key])<parseInt(b[key])?-1:parseInt(a[key])>parseInt(b[key]));});},sortNaturally:function(a,b){var _87=a.match(/^(\d*\D+)/);var _88=b.match(/^(\d*\D+)/);if(_87&&_88){if(_87<_88){return -1;}if(_87>_88){return 1;}}if(_87&&!_88){return -1;}if(!_87&&_88){return 1;}var _89=a.match(/(\d+)[^\/^\d]*$/);var _8a=b.match(/(\d+)[^\/^\d]*$/);if(parseInt(_89)&&parseInt(_8a)){if(parseInt(_89)<parseInt(_8a)){return -1;}if(parseInt(_89)>parseInt(_8a)){return 1;}return 0;}if(parseInt(_89)&&!parseInt(_8a)){return -1;}if(!parseInt(_89)&&parseInt(_8a)){return 1;}return 0;},sortObjectsNaturally:function(a,b,key){if(a[key]&&!b[key]){return -1;}if(!a[key]&&b[key]){return 1;}if(!a[key]&&!b[key]){return 0;}var _8b=a[key].match(/^(\d*\D+)/);if(_8b){_8b=_8b[1];}var _8c=b[key].match(/^(\d*\D+)/);if(_8c){_8c=_8c[1];}if(_8b&&_8c){if(_8b<_8c){return -1;}if(_8b>_8c){return 1;}}if(_8b&&!_8c){return -1;}if(!_8b&&_8c){return 1;}var _8d=a[key].match(/(\d+)[^\/^\d]*$/);if(_8d){_8d=parseInt(_8d[1]);}var _8e=b[key].match(/(\d+)[^\/^\d]*$/);if(_8e){_8e=parseInt(_8e[1]);}if(_8d&&_8e){if(_8d<_8e){return -1;}if(_8d>_8e){return 1;}return 0;}if(_8d&&!_8e){return -1;}if(!_8d&&_8e){return 1;}return 0;},sortTwoDArray:function(_8f,_90){console.log("  Common.Sort.sortTwoDArray    plugins.core.Common.sortTwoDArray(twoDArray, key)");if(_8f==null){return;}if(_90==null){return;}console.log("  Common.Sort.sortTwoDArray    twoDArray: "+dojo.toJson(_8f));console.log("  Common.Sort.sortTwoDArray    index: "+_90);return _8f.sort(function(a,b){console.log("  Common.Sort.sortTwoDArray    a["+_90+"]: "+a[_90]);console.log("  Common.Sort.sortTwoDArray    b["+_90+"]: "+b[_90]);if(a[_90]==null){console.log("No value for index '"+_90+"' in twoDArray item: "+dojo.toJson(a));return;}if(b[_90]==null){console.log("No value for index '"+_90+"' in twoDArray item: "+dojo.toJson(b));return;}return a[_90].toUpperCase()==b[_90].toUpperCase()?(a[_90]<b[_90]?-1:a[_90]>b[_90]):(a[_90].toUpperCase()<b[_90].toUpperCase()?-1:a[_90].toUpperCase()>b[_90].toUpperCase());});}});}if(!dojo._hasResource["plugins.core.Common.Text"]){dojo._hasResource["plugins.core.Common.Text"]=true;dojo.provide("plugins.core.Common.Text");dojo.declare("plugins.core.Common.Text",[],{repeatChar:function(_91,_92){var _93="";for(var i=0;i<_92;i++){_93+=_91;}return _93;},xor:function(_94,_95){if((_94&&!_95)||(!_94&&_95)){return true;}return false;},systemVariables:function(_96,_97){if(_97==null){_97=this;}if(_96==null||_96==true||_96==false){return _96;}if(_96.replace==null){return _96;}_96=_96.replace(/%username%/g,Agua.cookie("username"));_96=_96.replace(/%project%/g,_97.project);_96=_96.replace(/%workflow%/g,_97.workflow);return _96;},insertTextBreaks:function(_98,_99){if(this.textBreakWidth!=null){_99=this.textBreakWidth;}if(_99==null){return;}var _9a="\n";_98=this.removeTextBreaks(_98);var _9b="";var _9c=0;while(_9c<_98.length){var _9d=_98.substring(_9c,_9c+_99);_9c+=_99;_9b+=_9d;_9b+=_9a;}return _9b;},removeTextBreaks:function(_9e){_9e=_9e.replace(/\n/g,"");return _9e;},jsonSafe:function(_9f,_a0){if(_9f==null||!_9f){return "";}if(_9f==true||_9f==false){return _9f;}_9f=String(_9f).replace(/\s+$/g,"");_9f=String(_9f).replace(/^\s+/g,"");_9f=String(_9f).replace(/"/g,"'");var _a1=[["&quot;","'"],["&#35;","#"],["&#36;","$"],["&#37;","%"],["&amp;","&"],["&#40;","("],["&#41;",")"],["&frasl;","/"],["&#91;","["],["&#92;","\\"],["&#93;","]"],["&#96;","`"],["&#123;","{"],["&#124;","|"],["&#125;","}"]];for(var i=0;i<_a1.length;i++){if(_a0=="toJson"){var _a2=new RegExp(_a1[i][1],"g");return _9f.replace(_a2,_a1[i][0]);}else{if(_a0=="fromJson"){var _a2=new RegExp(_a1[i][0],"g");return _9f.replace(_a2,_a1[i][1]);}}}return _9f;},autoHeight:function(_a3){var _a4=parseInt(_a3.rows);console.log("  Common.Text.autoHeight    textarea.rows: "+_a3.rows);while(_a3.rows*_a3.cols<_a3.value.length){_a3.rows=++_a4;}},firstLetterUpperCase:function(_a5){if(_a5==null||_a5==""){return _a5;}if(_a5.substring==null){return null;}return _a5.substring(0,1).toUpperCase()+_a5.substring(1);},cleanEnds:function(_a6){if(_a6==null){return "";}_a6=_a6.replace(/^[\s\n]+/,"");_a6=_a6.replace(/[\s\n]+$/,"");return _a6;},cleanWord:function(_a7){if(_a7==null){return "";}return _a7.replace(/[\s\n]+/,"");},clearValue:function(_a8,_a9){if(_a8==null){return;}if(_a8.get&&_a8.get("value")==_a9){_a8.set("value","");}else{if(_a8.value&&_a8.value.match(_a9)){_a8.value="";}}},cleanNumber:function(_aa){if(_aa==null){return "";}_aa=_aa.toString().replace(/[\s\n]+/,"");return _aa.toString().replace(/[\s\n]+/,"");},convertString:function(_ab,_ac){if(_ab==null){return "";}if(_ab==null){return "";}if(_ab.replace==null){return _ab;}var _ad=_ab;_ab=this.convertAngleBrackets(_ab,_ac);_ab=this.convertAmpersand(_ab,_ac);_ab=this.convertQuote(_ab,_ac);return _ab;},convertBackslash:function(_ae,_af){if(_ae==null){return "";}if(_ae.replace==null){return _ae;}try{var _b0=function(_b1,num){if(!num){return "";}var _b2=_b1;while(--num){_b2+=_b1;}return _b2;};var _b3=function(_b4){return _b0("\\",(_b4.length/2));};var _b5=function(_b6){return _b0("\\",(_b6.length*2));};if(_af=="compress"){_ae=_ae.replace(/\\+/g,_b3);}if(_af=="expand"){_ae=_ae.replace(/\\+/g,_b5);}}catch(error){return "";}return _ae;},convertAmpersand:function(_b7,_b8){if(_b7==null){return "";}if(_b7.replace==null){return _b7;}if(_b8=="textToHtml"){_b7=_b7.replace(/&/g,"&amp;");}else{_b7=_b7.replace(/&amp;/g,"&");}return _b7;},convertQuote:function(_b9,_ba){if(_b9==null){return "";}if(_b9.replace==null){return _b9;}if(_ba=="textToHtml"){_b9=_b9.replace(/"/g,"&quot;");}else{_b9=_b9.replace(/&quot;/g,"\"");}return _b9;},convertAngleBrackets:function(_bb,_bc){if(_bb==null){return "";}if(_bb.replace==null){return _bb;}var _bd=[["&lt;","<"],["&gt;",">"]];var _be=0;var to=1;if(_bc=="textToHtml"){_be=1;to=0;}for(var i=0;i<_bd.length;i++){var _bf=new RegExp(_bd[i][_be],"g");_bb=_bb.replace(_bf,_bd[i][to]);}return _bb;},printObjectKeys:function(_c0,key,_c1){if(_c1==null){_c1="key";}for(var i=0;i<_c0.length;i++){console.log(_c1+" "+i+": "+_c0[i][key]);}},});}if(!dojo._hasResource["dojo.fx.Toggler"]){dojo._hasResource["dojo.fx.Toggler"]=true;dojo.provide("dojo.fx.Toggler");dojo.declare("dojo.fx.Toggler",null,{node:null,showFunc:dojo.fadeIn,hideFunc:dojo.fadeOut,showDuration:200,hideDuration:200,constructor:function(_c2){var _c3=this;dojo.mixin(_c3,_c2);_c3.node=_c2.node;_c3._showArgs=dojo.mixin({},_c2);_c3._showArgs.node=_c3.node;_c3._showArgs.duration=_c3.showDuration;_c3.showAnim=_c3.showFunc(_c3._showArgs);_c3._hideArgs=dojo.mixin({},_c2);_c3._hideArgs.node=_c3.node;_c3._hideArgs.duration=_c3.hideDuration;_c3.hideAnim=_c3.hideFunc(_c3._hideArgs);dojo.connect(_c3.showAnim,"beforeBegin",dojo.hitch(_c3.hideAnim,"stop",true));dojo.connect(_c3.hideAnim,"beforeBegin",dojo.hitch(_c3.showAnim,"stop",true));},show:function(_c4){return this.showAnim.play(_c4||0);},hide:function(_c5){return this.hideAnim.play(_c5||0);}});}if(!dojo._hasResource["dojo.fx"]){dojo._hasResource["dojo.fx"]=true;dojo.provide("dojo.fx");(function(){var d=dojo,_c6={_fire:function(evt,_c7){if(this[evt]){this[evt].apply(this,_c7||[]);}return this;}};var _c8=function(_c9){this._index=-1;this._animations=_c9||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;d.forEach(this._animations,function(a){this.duration+=a.duration;if(a.delay){this.duration+=a.delay;}},this);};d.extend(_c8,{_onAnimate:function(){this._fire("onAnimate",arguments);},_onEnd:function(){d.disconnect(this._onAnimateCtx);d.disconnect(this._onEndCtx);this._onAnimateCtx=this._onEndCtx=null;if(this._index+1==this._animations.length){this._fire("onEnd");}else{this._current=this._animations[++this._index];this._onAnimateCtx=d.connect(this._current,"onAnimate",this,"_onAnimate");this._onEndCtx=d.connect(this._current,"onEnd",this,"_onEnd");this._current.play(0,true);}},play:function(_ca,_cb){if(!this._current){this._current=this._animations[this._index=0];}if(!_cb&&this._current.status()=="playing"){return this;}var _cc=d.connect(this._current,"beforeBegin",this,function(){this._fire("beforeBegin");}),_cd=d.connect(this._current,"onBegin",this,function(arg){this._fire("onBegin",arguments);}),_ce=d.connect(this._current,"onPlay",this,function(arg){this._fire("onPlay",arguments);d.disconnect(_cc);d.disconnect(_cd);d.disconnect(_ce);});if(this._onAnimateCtx){d.disconnect(this._onAnimateCtx);}this._onAnimateCtx=d.connect(this._current,"onAnimate",this,"_onAnimate");if(this._onEndCtx){d.disconnect(this._onEndCtx);}this._onEndCtx=d.connect(this._current,"onEnd",this,"_onEnd");this._current.play.apply(this._current,arguments);return this;},pause:function(){if(this._current){var e=d.connect(this._current,"onPause",this,function(arg){this._fire("onPause",arguments);d.disconnect(e);});this._current.pause();}return this;},gotoPercent:function(_cf,_d0){this.pause();var _d1=this.duration*_cf;this._current=null;d.some(this._animations,function(a){if(a.duration<=_d1){this._current=a;return true;}_d1-=a.duration;return false;});if(this._current){this._current.gotoPercent(_d1/this._current.duration,_d0);}return this;},stop:function(_d2){if(this._current){if(_d2){for(;this._index+1<this._animations.length;++this._index){this._animations[this._index].stop(true);}this._current=this._animations[this._index];}var e=d.connect(this._current,"onStop",this,function(arg){this._fire("onStop",arguments);d.disconnect(e);});this._current.stop();}return this;},status:function(){return this._current?this._current.status():"stopped";},destroy:function(){if(this._onAnimateCtx){d.disconnect(this._onAnimateCtx);}if(this._onEndCtx){d.disconnect(this._onEndCtx);}}});d.extend(_c8,_c6);dojo.fx.chain=function(_d3){return new _c8(_d3);};var _d4=function(_d5){this._animations=_d5||[];this._connects=[];this._finished=0;this.duration=0;d.forEach(_d5,function(a){var _d6=a.duration;if(a.delay){_d6+=a.delay;}if(this.duration<_d6){this.duration=_d6;}this._connects.push(d.connect(a,"onEnd",this,"_onEnd"));},this);this._pseudoAnimation=new d.Animation({curve:[0,1],duration:this.duration});var _d7=this;d.forEach(["beforeBegin","onBegin","onPlay","onAnimate","onPause","onStop","onEnd"],function(evt){_d7._connects.push(d.connect(_d7._pseudoAnimation,evt,function(){_d7._fire(evt,arguments);}));});};d.extend(_d4,{_doAction:function(_d8,_d9){d.forEach(this._animations,function(a){a[_d8].apply(a,_d9);});return this;},_onEnd:function(){if(++this._finished>this._animations.length){this._fire("onEnd");}},_call:function(_da,_db){var t=this._pseudoAnimation;t[_da].apply(t,_db);},play:function(_dc,_dd){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this;},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this;},gotoPercent:function(_de,_df){var ms=this.duration*_de;d.forEach(this._animations,function(a){a.gotoPercent(a.duration<ms?1:(ms/a.duration),_df);});this._call("gotoPercent",arguments);return this;},stop:function(_e0){this._doAction("stop",arguments);this._call("stop",arguments);return this;},status:function(){return this._pseudoAnimation.status();},destroy:function(){d.forEach(this._connects,dojo.disconnect);}});d.extend(_d4,_c6);dojo.fx.combine=function(_e1){return new _d4(_e1);};dojo.fx.wipeIn=function(_e2){var _e3=_e2.node=d.byId(_e2.node),s=_e3.style,o;var _e4=d.animateProperty(d.mixin({properties:{height:{start:function(){o=s.overflow;s.overflow="hidden";if(s.visibility=="hidden"||s.display=="none"){s.height="1px";s.display="";s.visibility="";return 1;}else{var _e5=d.style(_e3,"height");return Math.max(_e5,1);}},end:function(){return _e3.scrollHeight;}}}},_e2));d.connect(_e4,"onEnd",function(){s.height="auto";s.overflow=o;});return _e4;};dojo.fx.wipeOut=function(_e6){var _e7=_e6.node=d.byId(_e6.node),s=_e7.style,o;var _e8=d.animateProperty(d.mixin({properties:{height:{end:1}}},_e6));d.connect(_e8,"beforeBegin",function(){o=s.overflow;s.overflow="hidden";s.display="";});d.connect(_e8,"onEnd",function(){s.overflow=o;s.height="auto";s.display="none";});return _e8;};dojo.fx.slideTo=function(_e9){var _ea=_e9.node=d.byId(_e9.node),top=null,_eb=null;var _ec=(function(n){return function(){var cs=d.getComputedStyle(n);var pos=cs.position;top=(pos=="absolute"?n.offsetTop:parseInt(cs.top)||0);_eb=(pos=="absolute"?n.offsetLeft:parseInt(cs.left)||0);if(pos!="absolute"&&pos!="relative"){var ret=d.position(n,true);top=ret.y;_eb=ret.x;n.style.position="absolute";n.style.top=top+"px";n.style.left=_eb+"px";}};})(_ea);_ec();var _ed=d.animateProperty(d.mixin({properties:{top:_e9.top||0,left:_e9.left||0}},_e9));d.connect(_ed,"beforeBegin",_ed,_ec);return _ed;};})();}if(!dojo._hasResource["dojo.window"]){dojo._hasResource["dojo.window"]=true;dojo.provide("dojo.window");dojo.getObject("window",true,dojo);dojo.window.getBox=function(){var _ee=(dojo.doc.compatMode=="BackCompat")?dojo.body():dojo.doc.documentElement;var _ef=dojo._docScroll();return {w:_ee.clientWidth,h:_ee.clientHeight,l:_ef.x,t:_ef.y};};dojo.window.get=function(doc){if(dojo.isIE&&window!==document.parentWindow){doc.parentWindow.execScript("document._parentWindow = window;","Javascript");var win=doc._parentWindow;doc._parentWindow=null;return win;}return doc.parentWindow||doc.defaultView;};dojo.window.scrollIntoView=function(_f0,pos){try{_f0=dojo.byId(_f0);var doc=_f0.ownerDocument||dojo.doc,_f1=doc.body||dojo.body(),_f2=doc.documentElement||_f1.parentNode,_f3=dojo.isIE,_f4=dojo.isWebKit;if((!(dojo.isMoz||_f3||_f4||dojo.isOpera)||_f0==_f1||_f0==_f2)&&(typeof _f0.scrollIntoView!="undefined")){_f0.scrollIntoView(false);return;}var _f5=doc.compatMode=="BackCompat",_f6=(_f3>=9&&_f0.ownerDocument.parentWindow.frameElement)?((_f2.clientHeight>0&&_f2.clientWidth>0&&(_f1.clientHeight==0||_f1.clientWidth==0||_f1.clientHeight>_f2.clientHeight||_f1.clientWidth>_f2.clientWidth))?_f2:_f1):(_f5?_f1:_f2),_f7=_f4?_f1:_f6,_f8=_f6.clientWidth,_f9=_f6.clientHeight,rtl=!dojo._isBodyLtr(),_fa=pos||dojo.position(_f0),el=_f0.parentNode,_fb=function(el){return ((_f3<=6||(_f3&&_f5))?false:(dojo.style(el,"position").toLowerCase()=="fixed"));};if(_fb(_f0)){return;}while(el){if(el==_f1){el=_f7;}var _fc=dojo.position(el),_fd=_fb(el);if(el==_f7){_fc.w=_f8;_fc.h=_f9;if(_f7==_f2&&_f3&&rtl){_fc.x+=_f7.offsetWidth-_fc.w;}if(_fc.x<0||!_f3){_fc.x=0;}if(_fc.y<0||!_f3){_fc.y=0;}}else{var pb=dojo._getPadBorderExtents(el);_fc.w-=pb.w;_fc.h-=pb.h;_fc.x+=pb.l;_fc.y+=pb.t;var _fe=el.clientWidth,_ff=_fc.w-_fe;if(_fe>0&&_ff>0){_fc.w=_fe;_fc.x+=(rtl&&(_f3||el.clientLeft>pb.l))?_ff:0;}_fe=el.clientHeight;_ff=_fc.h-_fe;if(_fe>0&&_ff>0){_fc.h=_fe;}}if(_fd){if(_fc.y<0){_fc.h+=_fc.y;_fc.y=0;}if(_fc.x<0){_fc.w+=_fc.x;_fc.x=0;}if(_fc.y+_fc.h>_f9){_fc.h=_f9-_fc.y;}if(_fc.x+_fc.w>_f8){_fc.w=_f8-_fc.x;}}var l=_fa.x-_fc.x,t=_fa.y-Math.max(_fc.y,0),r=l+_fa.w-_fc.w,bot=t+_fa.h-_fc.h;if(r*l>0){var s=Math[l<0?"max":"min"](l,r);if(rtl&&((_f3==8&&!_f5)||_f3>=9)){s=-s;}_fa.x+=el.scrollLeft;el.scrollLeft+=s;_fa.x-=el.scrollLeft;}if(bot*t>0){_fa.y+=el.scrollTop;el.scrollTop+=Math[t<0?"max":"min"](t,bot);_fa.y-=el.scrollTop;}el=(el!=_f7)&&!_fd&&el.parentNode;}}catch(error){console.error("scrollIntoView: "+error);_f0.scrollIntoView(false);}};}if(!dojo._hasResource["dijit._base.manager"]){dojo._hasResource["dijit._base.manager"]=true;dojo.provide("dijit._base.manager");dojo.declare("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0;},add:function(_100){if(this._hash[_100.id]){throw new Error("Tried to register widget with id=="+_100.id+" but that id is already registered");}this._hash[_100.id]=_100;this.length++;},remove:function(id){if(this._hash[id]){delete this._hash[id];this.length--;}},forEach:function(func,_101){_101=_101||dojo.global;var i=0,id;for(id in this._hash){func.call(_101,this._hash[id],i++,this._hash);}return this;},filter:function(_102,_103){_103=_103||dojo.global;var res=new dijit.WidgetSet(),i=0,id;for(id in this._hash){var w=this._hash[id];if(_102.call(_103,w,i++,this._hash)){res.add(w);}}return res;},byId:function(id){return this._hash[id];},byClass:function(cls){var res=new dijit.WidgetSet(),id,_104;for(id in this._hash){_104=this._hash[id];if(_104.declaredClass==cls){res.add(_104);}}return res;},toArray:function(){var ar=[];for(var id in this._hash){ar.push(this._hash[id]);}return ar;},map:function(func,_105){return dojo.map(this.toArray(),func,_105);},every:function(func,_106){_106=_106||dojo.global;var x=0,i;for(i in this._hash){if(!func.call(_106,this._hash[i],x++,this._hash)){return false;}}return true;},some:function(func,_107){_107=_107||dojo.global;var x=0,i;for(i in this._hash){if(func.call(_107,this._hash[i],x++,this._hash)){return true;}}return false;}});(function(){dijit.registry=new dijit.WidgetSet();var hash=dijit.registry._hash,attr=dojo.attr,_108=dojo.hasAttr,_109=dojo.style;dijit.byId=function(id){return typeof id=="string"?hash[id]:id;};var _10a={};dijit.getUniqueId=function(_10b){var id;do{id=_10b+"_"+(_10b in _10a?++_10a[_10b]:_10a[_10b]=0);}while(hash[id]);return dijit._scopeName=="dijit"?id:dijit._scopeName+"_"+id;};dijit.findWidgets=function(root){var _10c=[];function _10d(root){for(var node=root.firstChild;node;node=node.nextSibling){if(node.nodeType==1){var _10e=node.getAttribute("widgetId");if(_10e){var _10f=hash[_10e];if(_10f){_10c.push(_10f);}}else{_10d(node);}}}};_10d(root);return _10c;};dijit._destroyAll=function(){dijit._curFocus=null;dijit._prevFocus=null;dijit._activeStack=[];dojo.forEach(dijit.findWidgets(dojo.body()),function(_110){if(!_110._destroyed){if(_110.destroyRecursive){_110.destroyRecursive();}else{if(_110.destroy){_110.destroy();}}}});};if(dojo.isIE){dojo.addOnWindowUnload(function(){dijit._destroyAll();});}dijit.byNode=function(node){return hash[node.getAttribute("widgetId")];};dijit.getEnclosingWidget=function(node){while(node){var id=node.getAttribute&&node.getAttribute("widgetId");if(id){return hash[id];}node=node.parentNode;}return null;};var _111=(dijit._isElementShown=function(elem){var s=_109(elem);return (s.visibility!="hidden")&&(s.visibility!="collapsed")&&(s.display!="none")&&(attr(elem,"type")!="hidden");});dijit.hasDefaultTabStop=function(elem){switch(elem.nodeName.toLowerCase()){case "a":return _108(elem,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return true;case "iframe":var body;try{var _112=elem.contentDocument;if("designMode" in _112&&_112.designMode=="on"){return true;}body=_112.body;}catch(e1){try{body=elem.contentWindow.document.body;}catch(e2){return false;}}return body.contentEditable=="true"||(body.firstChild&&body.firstChild.contentEditable=="true");default:return elem.contentEditable=="true";}};var _113=(dijit.isTabNavigable=function(elem){if(attr(elem,"disabled")){return false;}else{if(_108(elem,"tabIndex")){return attr(elem,"tabIndex")>=0;}else{return dijit.hasDefaultTabStop(elem);}}});dijit._getTabNavigable=function(root){var _114,last,_115,_116,_117,_118,_119={};function _11a(node){return node&&node.tagName.toLowerCase()=="input"&&node.type&&node.type.toLowerCase()=="radio"&&node.name&&node.name.toLowerCase();};var _11b=function(_11c){dojo.query("> *",_11c).forEach(function(_11d){if((dojo.isIE&&_11d.scopeName!=="HTML")||!_111(_11d)){return;}if(_113(_11d)){var _11e=attr(_11d,"tabIndex");if(!_108(_11d,"tabIndex")||_11e==0){if(!_114){_114=_11d;}last=_11d;}else{if(_11e>0){if(!_115||_11e<_116){_116=_11e;_115=_11d;}if(!_117||_11e>=_118){_118=_11e;_117=_11d;}}}var rn=_11a(_11d);if(dojo.attr(_11d,"checked")&&rn){_119[rn]=_11d;}}if(_11d.nodeName.toUpperCase()!="SELECT"){_11b(_11d);}});};if(_111(root)){_11b(root);}function rs(node){return _119[_11a(node)]||node;};return {first:rs(_114),last:rs(last),lowest:rs(_115),highest:rs(_117)};};dijit.getFirstInTabbingOrder=function(root){var _11f=dijit._getTabNavigable(dojo.byId(root));return _11f.lowest?_11f.lowest:_11f.first;};dijit.getLastInTabbingOrder=function(root){var _120=dijit._getTabNavigable(dojo.byId(root));return _120.last?_120.last:_120.highest;};dijit.defaultDuration=dojo.config["defaultDuration"]||200;})();}if(!dojo._hasResource["dojo.Stateful"]){dojo._hasResource["dojo.Stateful"]=true;dojo.provide("dojo.Stateful");dojo.declare("dojo.Stateful",null,{postscript:function(_121){if(_121){dojo.mixin(this,_121);}},get:function(name){return this[name];},set:function(name,_122){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _123=this[name];this[name]=_122;if(this._watchCallbacks){this._watchCallbacks(name,_123,_122);}return this;},watch:function(name,_124){var _125=this._watchCallbacks;if(!_125){var self=this;_125=this._watchCallbacks=function(name,_126,_127,_128){var _129=function(_12a){if(_12a){_12a=_12a.slice();for(var i=0,l=_12a.length;i<l;i++){try{_12a[i].call(self,name,_126,_127);}catch(e){console.error(e);}}}};_129(_125["_"+name]);if(!_128){_129(_125["*"]);}};}if(!_124&&typeof name==="function"){_124=name;name="*";}else{name="_"+name;}var _12b=_125[name];if(typeof _12b!=="object"){_12b=_125[name]=[];}_12b.push(_124);return {unwatch:function(){_12b.splice(dojo.indexOf(_12b,_124),1);}};}});}if(!dojo._hasResource["dijit._WidgetBase"]){dojo._hasResource["dijit._WidgetBase"]=true;dojo.provide("dijit._WidgetBase");(function(){dojo.declare("dijit._WidgetBase",dojo.Stateful,{id:"",lang:"",dir:"","class":"",style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,attributeMap:{id:"",dir:"",lang:"","class":"",style:"",title:""},_blankGif:(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif")).toString(),postscript:function(_12c,_12d){this.create(_12c,_12d);},create:function(_12e,_12f){this.srcNodeRef=dojo.byId(_12f);this._connects=[];this._subscribes=[];if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){this.id=this.srcNodeRef.id;}if(_12e){this.params=_12e;dojo._mixin(this,_12e);}this.postMixInProperties();if(!this.id){this.id=dijit.getUniqueId(this.declaredClass.replace(/\./g,"_"));}dijit.registry.add(this);this.buildRendering();if(this.domNode){this._applyAttributes();var _130=this.srcNodeRef;if(_130&&_130.parentNode&&this.domNode!==_130){_130.parentNode.replaceChild(this.domNode,_130);}}if(this.domNode){this.domNode.setAttribute("widgetId",this.id);}this.postCreate();if(this.srcNodeRef&&!this.srcNodeRef.parentNode){delete this.srcNodeRef;}this._created=true;},_applyAttributes:function(){var _131=function(attr,_132){if((_132.params&&attr in _132.params)||_132[attr]){_132.set(attr,_132[attr]);}};for(var attr in this.attributeMap){_131(attr,this);}dojo.forEach(this._getSetterAttributes(),function(a){if(!(a in this.attributeMap)){_131(a,this);}},this);},_getSetterAttributes:function(){var ctor=this.constructor;if(!ctor._setterAttrs){var r=(ctor._setterAttrs=[]),_133,_134=ctor.prototype;for(var _135 in _134){if(dojo.isFunction(_134[_135])&&(_133=_135.match(/^_set([a-zA-Z]*)Attr$/))&&_133[1]){r.push(_133[1].charAt(0).toLowerCase()+_133[1].substr(1));}}}return ctor._setterAttrs;},postMixInProperties:function(){},buildRendering:function(){if(!this.domNode){this.domNode=this.srcNodeRef||dojo.create("div");}if(this.baseClass){var _136=this.baseClass.split(" ");if(!this.isLeftToRight()){_136=_136.concat(dojo.map(_136,function(name){return name+"Rtl";}));}dojo.addClass(this.domNode,_136);}},postCreate:function(){},startup:function(){this._started=true;},destroyRecursive:function(_137){this._beingDestroyed=true;this.destroyDescendants(_137);this.destroy(_137);},destroy:function(_138){this._beingDestroyed=true;this.uninitialize();var d=dojo,dfe=d.forEach,dun=d.unsubscribe;dfe(this._connects,function(_139){dfe(_139,d.disconnect);});dfe(this._subscribes,function(_13a){dun(_13a);});dfe(this._supportingWidgets||[],function(w){if(w.destroyRecursive){w.destroyRecursive();}else{if(w.destroy){w.destroy();}}});this.destroyRendering(_138);dijit.registry.remove(this.id);this._destroyed=true;},destroyRendering:function(_13b){if(this.bgIframe){this.bgIframe.destroy(_13b);delete this.bgIframe;}if(this.domNode){if(_13b){dojo.removeAttr(this.domNode,"widgetId");}else{dojo.destroy(this.domNode);}delete this.domNode;}if(this.srcNodeRef){if(!_13b){dojo.destroy(this.srcNodeRef);}delete this.srcNodeRef;}},destroyDescendants:function(_13c){dojo.forEach(this.getChildren(),function(_13d){if(_13d.destroyRecursive){_13d.destroyRecursive(_13c);}});},uninitialize:function(){return false;},_setClassAttr:function(_13e){var _13f=this[this.attributeMap["class"]||"domNode"];dojo.replaceClass(_13f,_13e,this["class"]);this._set("class",_13e);},_setStyleAttr:function(_140){var _141=this[this.attributeMap.style||"domNode"];if(dojo.isObject(_140)){dojo.style(_141,_140);}else{if(_141.style.cssText){_141.style.cssText+="; "+_140;}else{_141.style.cssText=_140;}}this._set("style",_140);},_attrToDom:function(attr,_142){var _143=this.attributeMap[attr];dojo.forEach(dojo.isArray(_143)?_143:[_143],function(_144){var _145=this[_144.node||_144||"domNode"];var type=_144.type||"attribute";switch(type){case "attribute":if(dojo.isFunction(_142)){_142=dojo.hitch(this,_142);}var _146=_144.attribute?_144.attribute:(/^on[A-Z][a-zA-Z]*$/.test(attr)?attr.toLowerCase():attr);dojo.attr(_145,_146,_142);break;case "innerText":_145.innerHTML="";_145.appendChild(dojo.doc.createTextNode(_142));break;case "innerHTML":_145.innerHTML=_142;break;case "class":dojo.replaceClass(_145,_142,this[attr]);break;}},this);},get:function(name){var _147=this._getAttrNames(name);return this[_147.g]?this[_147.g]():this[name];},set:function(name,_148){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _149=this._getAttrNames(name);if(this[_149.s]){var _14a=this[_149.s].apply(this,Array.prototype.slice.call(arguments,1));}else{if(name in this.attributeMap){this._attrToDom(name,_148);}this._set(name,_148);}return _14a||this;},_attrPairNames:{},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.charAt(0).toUpperCase()+name.substr(1);return (apn[name]={n:name+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});},_set:function(name,_14b){var _14c=this[name];this[name]=_14b;if(this._watchCallbacks&&this._created&&_14b!==_14c){this._watchCallbacks(name,_14c,_14b);}},toString:function(){return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";},getDescendants:function(){return this.containerNode?dojo.query("[widgetId]",this.containerNode).map(dijit.byNode):[];},getChildren:function(){return this.containerNode?dijit.findWidgets(this.containerNode):[];},connect:function(obj,_14d,_14e){var _14f=[dojo._connect(obj,_14d,this,_14e)];this._connects.push(_14f);return _14f;},disconnect:function(_150){for(var i=0;i<this._connects.length;i++){if(this._connects[i]==_150){dojo.forEach(_150,dojo.disconnect);this._connects.splice(i,1);return;}}},subscribe:function(_151,_152){var _153=dojo.subscribe(_151,this,_152);this._subscribes.push(_153);return _153;},unsubscribe:function(_154){for(var i=0;i<this._subscribes.length;i++){if(this._subscribes[i]==_154){dojo.unsubscribe(_154);this._subscribes.splice(i,1);return;}}},isLeftToRight:function(){return this.dir?(this.dir=="ltr"):dojo._isBodyLtr();},placeAt:function(_155,_156){if(_155.declaredClass&&_155.addChild){_155.addChild(this,_156);}else{dojo.place(this.domNode,_155,_156);}return this;}});})();}if(!dojo._hasResource["dijit._base.focus"]){dojo._hasResource["dijit._base.focus"]=true;dojo.provide("dijit._base.focus");dojo.mixin(dijit,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return dijit.getBookmark().isCollapsed;},getBookmark:function(){var bm,rg,tg,sel=dojo.doc.selection,cf=dijit._curFocus;if(dojo.global.getSelection){sel=dojo.global.getSelection();if(sel){if(sel.isCollapsed){tg=cf?cf.tagName:"";if(tg){tg=tg.toLowerCase();if(tg=="textarea"||(tg=="input"&&(!cf.type||cf.type.toLowerCase()=="text"))){sel={start:cf.selectionStart,end:cf.selectionEnd,node:cf,pRange:true};return {isCollapsed:(sel.end<=sel.start),mark:sel};}}bm={isCollapsed:true};if(sel.rangeCount){bm.mark=sel.getRangeAt(0).cloneRange();}}else{rg=sel.getRangeAt(0);bm={isCollapsed:false,mark:rg.cloneRange()};}}}else{if(sel){tg=cf?cf.tagName:"";tg=tg.toLowerCase();if(cf&&tg&&(tg=="button"||tg=="textarea"||tg=="input")){if(sel.type&&sel.type.toLowerCase()=="none"){return {isCollapsed:true,mark:null};}else{rg=sel.createRange();return {isCollapsed:rg.text&&rg.text.length?false:true,mark:{range:rg,pRange:true}};}}bm={};try{rg=sel.createRange();bm.isCollapsed=!(sel.type=="Text"?rg.htmlText.length:rg.length);}catch(e){bm.isCollapsed=true;return bm;}if(sel.type.toUpperCase()=="CONTROL"){if(rg.length){bm.mark=[];var i=0,len=rg.length;while(i<len){bm.mark.push(rg.item(i++));}}else{bm.isCollapsed=true;bm.mark=null;}}else{bm.mark=rg.getBookmark();}}else{console.warn("No idea how to store the current selection for this browser!");}}return bm;},moveToBookmark:function(_157){var _158=dojo.doc,mark=_157.mark;if(mark){if(dojo.global.getSelection){var sel=dojo.global.getSelection();if(sel&&sel.removeAllRanges){if(mark.pRange){var r=mark;var n=r.node;n.selectionStart=r.start;n.selectionEnd=r.end;}else{sel.removeAllRanges();sel.addRange(mark);}}else{console.warn("No idea how to restore selection for this browser!");}}else{if(_158.selection&&mark){var rg;if(mark.pRange){rg=mark.range;}else{if(dojo.isArray(mark)){rg=_158.body.createControlRange();dojo.forEach(mark,function(n){rg.addElement(n);});}else{rg=_158.body.createTextRange();rg.moveToBookmark(mark);}}rg.select();}}}},getFocus:function(menu,_159){var node=!dijit._curFocus||(menu&&dojo.isDescendant(dijit._curFocus,menu.domNode))?dijit._prevFocus:dijit._curFocus;return {node:node,bookmark:(node==dijit._curFocus)&&dojo.withGlobal(_159||dojo.global,dijit.getBookmark),openedForWindow:_159};},focus:function(_15a){if(!_15a){return;}var node="node" in _15a?_15a.node:_15a,_15b=_15a.bookmark,_15c=_15a.openedForWindow,_15d=_15b?_15b.isCollapsed:false;if(node){var _15e=(node.tagName.toLowerCase()=="iframe")?node.contentWindow:node;if(_15e&&_15e.focus){try{_15e.focus();}catch(e){}}dijit._onFocusNode(node);}if(_15b&&dojo.withGlobal(_15c||dojo.global,dijit.isCollapsed)&&!_15d){if(_15c){_15c.focus();}try{dojo.withGlobal(_15c||dojo.global,dijit.moveToBookmark,null,[_15b]);}catch(e2){}}},_activeStack:[],registerIframe:function(_15f){return dijit.registerWin(_15f.contentWindow,_15f);},unregisterIframe:function(_160){dijit.unregisterWin(_160);},registerWin:function(_161,_162){var _163=function(evt){dijit._justMouseDowned=true;setTimeout(function(){dijit._justMouseDowned=false;},0);if(dojo.isIE&&evt&&evt.srcElement&&evt.srcElement.parentNode==null){return;}dijit._onTouchNode(_162||evt.target||evt.srcElement,"mouse");};var doc=dojo.isIE?_161.document.documentElement:_161.document;if(doc){if(dojo.isIE){_161.document.body.attachEvent("onmousedown",_163);var _164=function(evt){if(evt.srcElement.tagName.toLowerCase()!="#document"&&dijit.isTabNavigable(evt.srcElement)){dijit._onFocusNode(_162||evt.srcElement);}else{dijit._onTouchNode(_162||evt.srcElement);}};doc.attachEvent("onactivate",_164);var _165=function(evt){dijit._onBlurNode(_162||evt.srcElement);};doc.attachEvent("ondeactivate",_165);return function(){_161.document.detachEvent("onmousedown",_163);doc.detachEvent("onactivate",_164);doc.detachEvent("ondeactivate",_165);doc=null;};}else{doc.body.addEventListener("mousedown",_163,true);var _166=function(evt){dijit._onFocusNode(_162||evt.target);};doc.addEventListener("focus",_166,true);var _167=function(evt){dijit._onBlurNode(_162||evt.target);};doc.addEventListener("blur",_167,true);return function(){doc.body.removeEventListener("mousedown",_163,true);doc.removeEventListener("focus",_166,true);doc.removeEventListener("blur",_167,true);doc=null;};}}},unregisterWin:function(_168){_168&&_168();},_onBlurNode:function(node){dijit._prevFocus=dijit._curFocus;dijit._curFocus=null;if(dijit._justMouseDowned){return;}if(dijit._clearActiveWidgetsTimer){clearTimeout(dijit._clearActiveWidgetsTimer);}dijit._clearActiveWidgetsTimer=setTimeout(function(){delete dijit._clearActiveWidgetsTimer;dijit._setStack([]);dijit._prevFocus=null;},100);},_onTouchNode:function(node,by){if(dijit._clearActiveWidgetsTimer){clearTimeout(dijit._clearActiveWidgetsTimer);delete dijit._clearActiveWidgetsTimer;}var _169=[];try{while(node){var _16a=dojo.attr(node,"dijitPopupParent");if(_16a){node=dijit.byId(_16a).domNode;}else{if(node.tagName&&node.tagName.toLowerCase()=="body"){if(node===dojo.body()){break;}node=dojo.window.get(node.ownerDocument).frameElement;}else{var id=node.getAttribute&&node.getAttribute("widgetId"),_16b=id&&dijit.byId(id);if(_16b&&!(by=="mouse"&&_16b.get("disabled"))){_169.unshift(id);}node=node.parentNode;}}}}catch(e){}dijit._setStack(_169,by);},_onFocusNode:function(node){if(!node){return;}if(node.nodeType==9){return;}dijit._onTouchNode(node);if(node==dijit._curFocus){return;}if(dijit._curFocus){dijit._prevFocus=dijit._curFocus;}dijit._curFocus=node;dojo.publish("focusNode",[node]);},_setStack:function(_16c,by){var _16d=dijit._activeStack;dijit._activeStack=_16c;for(var _16e=0;_16e<Math.min(_16d.length,_16c.length);_16e++){if(_16d[_16e]!=_16c[_16e]){break;}}var _16f;for(var i=_16d.length-1;i>=_16e;i--){_16f=dijit.byId(_16d[i]);if(_16f){_16f._focused=false;_16f.set("focused",false);_16f._hasBeenBlurred=true;if(_16f._onBlur){_16f._onBlur(by);}dojo.publish("widgetBlur",[_16f,by]);}}for(i=_16e;i<_16c.length;i++){_16f=dijit.byId(_16c[i]);if(_16f){_16f._focused=true;_16f.set("focused",true);if(_16f._onFocus){_16f._onFocus(by);}dojo.publish("widgetFocus",[_16f,by]);}}}});dojo.addOnLoad(function(){var _170=dijit.registerWin(window);if(dojo.isIE){dojo.addOnWindowUnload(function(){dijit.unregisterWin(_170);_170=null;});}});}if(!dojo._hasResource["dojo.AdapterRegistry"]){dojo._hasResource["dojo.AdapterRegistry"]=true;dojo.provide("dojo.AdapterRegistry");dojo.AdapterRegistry=function(_171){this.pairs=[];this.returnWrappers=_171||false;};dojo.extend(dojo.AdapterRegistry,{register:function(name,_172,wrap,_173,_174){this.pairs[((_174)?"unshift":"push")]([name,_172,wrap,_173]);},match:function(){for(var i=0;i<this.pairs.length;i++){var pair=this.pairs[i];if(pair[1].apply(this,arguments)){if((pair[3])||(this.returnWrappers)){return pair[2];}else{return pair[2].apply(this,arguments);}}}throw new Error("No match found");},unregister:function(name){for(var i=0;i<this.pairs.length;i++){var pair=this.pairs[i];if(pair[0]==name){this.pairs.splice(i,1);return true;}}return false;}});}if(!dojo._hasResource["dijit._base.place"]){dojo._hasResource["dijit._base.place"]=true;dojo.provide("dijit._base.place");dijit.getViewport=function(){return dojo.window.getBox();};dijit.placeOnScreen=function(node,pos,_175,_176){var _177=dojo.map(_175,function(_178){var c={corner:_178,pos:{x:pos.x,y:pos.y}};if(_176){c.pos.x+=_178.charAt(1)=="L"?_176.x:-_176.x;c.pos.y+=_178.charAt(0)=="T"?_176.y:-_176.y;}return c;});return dijit._place(node,_177);};dijit._place=function(node,_179,_17a,_17b){var view=dojo.window.getBox();if(!node.parentNode||String(node.parentNode.tagName).toLowerCase()!="body"){dojo.body().appendChild(node);}var best=null;dojo.some(_179,function(_17c){var _17d=_17c.corner;var pos=_17c.pos;var _17e=0;var _17f={w:_17d.charAt(1)=="L"?(view.l+view.w)-pos.x:pos.x-view.l,h:_17d.charAt(1)=="T"?(view.t+view.h)-pos.y:pos.y-view.t};if(_17a){var res=_17a(node,_17c.aroundCorner,_17d,_17f,_17b);_17e=typeof res=="undefined"?0:res;}var _180=node.style;var _181=_180.display;var _182=_180.visibility;_180.visibility="hidden";_180.display="";var mb=dojo.marginBox(node);_180.display=_181;_180.visibility=_182;var _183=Math.max(view.l,_17d.charAt(1)=="L"?pos.x:(pos.x-mb.w)),_184=Math.max(view.t,_17d.charAt(0)=="T"?pos.y:(pos.y-mb.h)),endX=Math.min(view.l+view.w,_17d.charAt(1)=="L"?(_183+mb.w):pos.x),endY=Math.min(view.t+view.h,_17d.charAt(0)=="T"?(_184+mb.h):pos.y),_185=endX-_183,_186=endY-_184;_17e+=(mb.w-_185)+(mb.h-_186);if(best==null||_17e<best.overflow){best={corner:_17d,aroundCorner:_17c.aroundCorner,x:_183,y:_184,w:_185,h:_186,overflow:_17e,spaceAvailable:_17f};}return !_17e;});if(best.overflow&&_17a){_17a(node,best.aroundCorner,best.corner,best.spaceAvailable,_17b);}var l=dojo._isBodyLtr(),s=node.style;s.top=best.y+"px";s[l?"left":"right"]=(l?best.x:view.w-best.x-best.w)+"px";return best;};dijit.placeOnScreenAroundNode=function(node,_187,_188,_189){_187=dojo.byId(_187);var _18a=dojo.position(_187,true);return dijit._placeOnScreenAroundRect(node,_18a.x,_18a.y,_18a.w,_18a.h,_188,_189);};dijit.placeOnScreenAroundRectangle=function(node,_18b,_18c,_18d){return dijit._placeOnScreenAroundRect(node,_18b.x,_18b.y,_18b.width,_18b.height,_18c,_18d);};dijit._placeOnScreenAroundRect=function(node,x,y,_18e,_18f,_190,_191){var _192=[];for(var _193 in _190){_192.push({aroundCorner:_193,corner:_190[_193],pos:{x:x+(_193.charAt(1)=="L"?0:_18e),y:y+(_193.charAt(0)=="T"?0:_18f)}});}return dijit._place(node,_192,_191,{w:_18e,h:_18f});};dijit.placementRegistry=new dojo.AdapterRegistry();dijit.placementRegistry.register("node",function(n,x){return typeof x=="object"&&typeof x.offsetWidth!="undefined"&&typeof x.offsetHeight!="undefined";},dijit.placeOnScreenAroundNode);dijit.placementRegistry.register("rect",function(n,x){return typeof x=="object"&&"x" in x&&"y" in x&&"width" in x&&"height" in x;},dijit.placeOnScreenAroundRectangle);dijit.placeOnScreenAroundElement=function(node,_194,_195,_196){return dijit.placementRegistry.match.apply(dijit.placementRegistry,arguments);};dijit.getPopupAroundAlignment=function(_197,_198){var _199={};dojo.forEach(_197,function(pos){switch(pos){case "after":_199[_198?"BR":"BL"]=_198?"BL":"BR";break;case "before":_199[_198?"BL":"BR"]=_198?"BR":"BL";break;case "below-alt":_198=!_198;case "below":_199[_198?"BL":"BR"]=_198?"TL":"TR";_199[_198?"BR":"BL"]=_198?"TR":"TL";break;case "above-alt":_198=!_198;case "above":default:_199[_198?"TL":"TR"]=_198?"BL":"BR";_199[_198?"TR":"TL"]=_198?"BR":"BL";break;}});return _199;};}if(!dojo._hasResource["dijit._base.window"]){dojo._hasResource["dijit._base.window"]=true;dojo.provide("dijit._base.window");dijit.getDocumentWindow=function(doc){return dojo.window.get(doc);};}if(!dojo._hasResource["dijit._base.popup"]){dojo._hasResource["dijit._base.popup"]=true;dojo.provide("dijit._base.popup");dijit.popup={_stack:[],_beginZIndex:1000,_idGen:1,_createWrapper:function(_19a){var _19b=_19a.declaredClass?_19a._popupWrapper:(_19a.parentNode&&dojo.hasClass(_19a.parentNode,"dijitPopup")),node=_19a.domNode||_19a;if(!_19b){_19b=dojo.create("div",{"class":"dijitPopup",style:{display:"none"},role:"presentation"},dojo.body());_19b.appendChild(node);var s=node.style;s.display="";s.visibility="";s.position="";s.top="0px";if(_19a.declaredClass){_19a._popupWrapper=_19b;dojo.connect(_19a,"destroy",function(){dojo.destroy(_19b);delete _19a._popupWrapper;});}}return _19b;},moveOffScreen:function(_19c){var _19d=this._createWrapper(_19c);dojo.style(_19d,{visibility:"hidden",top:"-9999px",display:""});},hide:function(_19e){var _19f=this._createWrapper(_19e);dojo.style(_19f,"display","none");},getTopPopup:function(){var _1a0=this._stack;for(var pi=_1a0.length-1;pi>0&&_1a0[pi].parent===_1a0[pi-1].widget;pi--){}return _1a0[pi];},open:function(args){var _1a1=this._stack,_1a2=args.popup,_1a3=args.orient||((args.parent?args.parent.isLeftToRight():dojo._isBodyLtr())?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"}),_1a4=args.around,id=(args.around&&args.around.id)?(args.around.id+"_dropdown"):("popup_"+this._idGen++);while(_1a1.length&&(!args.parent||!dojo.isDescendant(args.parent.domNode,_1a1[_1a1.length-1].widget.domNode))){dijit.popup.close(_1a1[_1a1.length-1].widget);}var _1a5=this._createWrapper(_1a2);dojo.attr(_1a5,{id:id,style:{zIndex:this._beginZIndex+_1a1.length},"class":"dijitPopup "+(_1a2.baseClass||_1a2["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:args.parent?args.parent.id:""});if(dojo.isIE||dojo.isMoz){if(!_1a2.bgIframe){_1a2.bgIframe=new dijit.BackgroundIframe(_1a5);}}var best=_1a4?dijit.placeOnScreenAroundElement(_1a5,_1a4,_1a3,_1a2.orient?dojo.hitch(_1a2,"orient"):null):dijit.placeOnScreen(_1a5,args,_1a3=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],args.padding);_1a5.style.display="";_1a5.style.visibility="visible";_1a2.domNode.style.visibility="visible";var _1a6=[];_1a6.push(dojo.connect(_1a5,"onkeypress",this,function(evt){if(evt.charOrCode==dojo.keys.ESCAPE&&args.onCancel){dojo.stopEvent(evt);args.onCancel();}else{if(evt.charOrCode===dojo.keys.TAB){dojo.stopEvent(evt);var _1a7=this.getTopPopup();if(_1a7&&_1a7.onCancel){_1a7.onCancel();}}}}));if(_1a2.onCancel){_1a6.push(dojo.connect(_1a2,"onCancel",args.onCancel));}_1a6.push(dojo.connect(_1a2,_1a2.onExecute?"onExecute":"onChange",this,function(){var _1a8=this.getTopPopup();if(_1a8&&_1a8.onExecute){_1a8.onExecute();}}));_1a1.push({widget:_1a2,parent:args.parent,onExecute:args.onExecute,onCancel:args.onCancel,onClose:args.onClose,handlers:_1a6});if(_1a2.onOpen){_1a2.onOpen(best);}return best;},close:function(_1a9){var _1aa=this._stack;while((_1a9&&dojo.some(_1aa,function(elem){return elem.widget==_1a9;}))||(!_1a9&&_1aa.length)){var top=_1aa.pop(),_1ab=top.widget,_1ac=top.onClose;if(_1ab.onClose){_1ab.onClose();}dojo.forEach(top.handlers,dojo.disconnect);if(_1ab&&_1ab.domNode){this.hide(_1ab);}if(_1ac){_1ac();}}}};dijit._frames=new function(){var _1ad=[];this.pop=function(){var _1ae;if(_1ad.length){_1ae=_1ad.pop();_1ae.style.display="";}else{if(dojo.isIE<9){var burl=dojo.config["dojoBlankHtmlUrl"]||(dojo.moduleUrl("dojo","resources/blank.html")+"")||"javascript:\"\"";var html="<iframe src='"+burl+"'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";_1ae=dojo.doc.createElement(html);}else{_1ae=dojo.create("iframe");_1ae.src="javascript:\"\"";_1ae.className="dijitBackgroundIframe";dojo.style(_1ae,"opacity",0.1);}_1ae.tabIndex=-1;dijit.setWaiRole(_1ae,"presentation");}return _1ae;};this.push=function(_1af){_1af.style.display="none";_1ad.push(_1af);};}();dijit.BackgroundIframe=function(node){if(!node.id){throw new Error("no id");}if(dojo.isIE||dojo.isMoz){var _1b0=(this.iframe=dijit._frames.pop());node.appendChild(_1b0);if(dojo.isIE<7||dojo.isQuirks){this.resize(node);this._conn=dojo.connect(node,"onresize",this,function(){this.resize(node);});}else{dojo.style(_1b0,{width:"100%",height:"100%"});}}};dojo.extend(dijit.BackgroundIframe,{resize:function(node){if(this.iframe){dojo.style(this.iframe,{width:node.offsetWidth+"px",height:node.offsetHeight+"px"});}},destroy:function(){if(this._conn){dojo.disconnect(this._conn);this._conn=null;}if(this.iframe){dijit._frames.push(this.iframe);delete this.iframe;}}});}if(!dojo._hasResource["dijit._base.scroll"]){dojo._hasResource["dijit._base.scroll"]=true;dojo.provide("dijit._base.scroll");dijit.scrollIntoView=function(node,pos){dojo.window.scrollIntoView(node,pos);};}if(!dojo._hasResource["dojo.uacss"]){dojo._hasResource["dojo.uacss"]=true;dojo.provide("dojo.uacss");(function(){var d=dojo,html=d.doc.documentElement,ie=d.isIE,_1b1=d.isOpera,maj=Math.floor,ff=d.isFF,_1b2=d.boxModel.replace(/-/,""),_1b3={dj_ie:ie,dj_ie6:maj(ie)==6,dj_ie7:maj(ie)==7,dj_ie8:maj(ie)==8,dj_ie9:maj(ie)==9,dj_quirks:d.isQuirks,dj_iequirks:ie&&d.isQuirks,dj_opera:_1b1,dj_khtml:d.isKhtml,dj_webkit:d.isWebKit,dj_safari:d.isSafari,dj_chrome:d.isChrome,dj_gecko:d.isMozilla,dj_ff3:maj(ff)==3};_1b3["dj_"+_1b2]=true;var _1b4="";for(var clz in _1b3){if(_1b3[clz]){_1b4+=clz+" ";}}html.className=d.trim(html.className+" "+_1b4);dojo._loaders.unshift(function(){if(!dojo._isBodyLtr()){var _1b5="dj_rtl dijitRtl "+_1b4.replace(/ /g,"-rtl ");html.className=d.trim(html.className+" "+_1b5);}});})();}if(!dojo._hasResource["dijit._base.sniff"]){dojo._hasResource["dijit._base.sniff"]=true;dojo.provide("dijit._base.sniff");}if(!dojo._hasResource["dijit._base.typematic"]){dojo._hasResource["dijit._base.typematic"]=true;dojo.provide("dijit._base.typematic");dijit.typematic={_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(this._currentTimeout<0?this._initialDelay:(this._subsequentDelay>1?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay)),this._minDelay);this._timer=setTimeout(dojo.hitch(this,"_fireEventAndReload"),this._currentTimeout);},trigger:function(evt,_1b6,node,_1b7,obj,_1b8,_1b9,_1ba){if(obj!=this._obj){this.stop();this._initialDelay=_1b9||500;this._subsequentDelay=_1b8||0.9;this._minDelay=_1ba||10;this._obj=obj;this._evt=evt;this._node=node;this._currentTimeout=-1;this._count=-1;this._callback=dojo.hitch(_1b6,_1b7);this._fireEventAndReload();this._evt=dojo.mixin({faux:true},evt);}},stop:function(){if(this._timer){clearTimeout(this._timer);this._timer=null;}if(this._obj){this._callback(-1,this._node,this._evt);this._obj=null;}},addKeyListener:function(node,_1bb,_1bc,_1bd,_1be,_1bf,_1c0){if(_1bb.keyCode){_1bb.charOrCode=_1bb.keyCode;dojo.deprecated("keyCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");}else{if(_1bb.charCode){_1bb.charOrCode=String.fromCharCode(_1bb.charCode);dojo.deprecated("charCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");}}return [dojo.connect(node,"onkeypress",this,function(evt){if(evt.charOrCode==_1bb.charOrCode&&(_1bb.ctrlKey===undefined||_1bb.ctrlKey==evt.ctrlKey)&&(_1bb.altKey===undefined||_1bb.altKey==evt.altKey)&&(_1bb.metaKey===undefined||_1bb.metaKey==(evt.metaKey||false))&&(_1bb.shiftKey===undefined||_1bb.shiftKey==evt.shiftKey)){dojo.stopEvent(evt);dijit.typematic.trigger(evt,_1bc,node,_1bd,_1bb,_1be,_1bf,_1c0);}else{if(dijit.typematic._obj==_1bb){dijit.typematic.stop();}}}),dojo.connect(node,"onkeyup",this,function(evt){if(dijit.typematic._obj==_1bb){dijit.typematic.stop();}})];},addMouseListener:function(node,_1c1,_1c2,_1c3,_1c4,_1c5){var dc=dojo.connect;return [dc(node,"mousedown",this,function(evt){dojo.stopEvent(evt);dijit.typematic.trigger(evt,_1c1,node,_1c2,node,_1c3,_1c4,_1c5);}),dc(node,"mouseup",this,function(evt){dojo.stopEvent(evt);dijit.typematic.stop();}),dc(node,"mouseout",this,function(evt){dojo.stopEvent(evt);dijit.typematic.stop();}),dc(node,"mousemove",this,function(evt){evt.preventDefault();}),dc(node,"dblclick",this,function(evt){dojo.stopEvent(evt);if(dojo.isIE){dijit.typematic.trigger(evt,_1c1,node,_1c2,node,_1c3,_1c4,_1c5);setTimeout(dojo.hitch(this,dijit.typematic.stop),50);}})];},addListener:function(_1c6,_1c7,_1c8,_1c9,_1ca,_1cb,_1cc,_1cd){return this.addKeyListener(_1c7,_1c8,_1c9,_1ca,_1cb,_1cc,_1cd).concat(this.addMouseListener(_1c6,_1c9,_1ca,_1cb,_1cc,_1cd));}};}if(!dojo._hasResource["dijit._base.wai"]){dojo._hasResource["dijit._base.wai"]=true;dojo.provide("dijit._base.wai");dijit.wai={onload:function(){var div=dojo.create("div",{id:"a11yTestNode",style:{cssText:"border: 1px solid;"+"border-color:red green;"+"position: absolute;"+"height: 5px;"+"top: -999px;"+"background-image: url(\""+(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif"))+"\");"}},dojo.body());var cs=dojo.getComputedStyle(div);if(cs){var _1ce=cs.backgroundImage;var _1cf=(cs.borderTopColor==cs.borderRightColor)||(_1ce!=null&&(_1ce=="none"||_1ce=="url(invalid-url:)"));dojo[_1cf?"addClass":"removeClass"](dojo.body(),"dijit_a11y");if(dojo.isIE){div.outerHTML="";}else{dojo.body().removeChild(div);}}}};if(dojo.isIE||dojo.isMoz){dojo._loaders.unshift(dijit.wai.onload);}dojo.mixin(dijit,{hasWaiRole:function(elem,role){var _1d0=this.getWaiRole(elem);return role?(_1d0.indexOf(role)>-1):(_1d0.length>0);},getWaiRole:function(elem){return dojo.trim((dojo.attr(elem,"role")||"").replace("wairole:",""));},setWaiRole:function(elem,role){dojo.attr(elem,"role",role);},removeWaiRole:function(elem,role){var _1d1=dojo.attr(elem,"role");if(!_1d1){return;}if(role){var t=dojo.trim((" "+_1d1+" ").replace(" "+role+" "," "));dojo.attr(elem,"role",t);}else{elem.removeAttribute("role");}},hasWaiState:function(elem,_1d2){return elem.hasAttribute?elem.hasAttribute("aria-"+_1d2):!!elem.getAttribute("aria-"+_1d2);},getWaiState:function(elem,_1d3){return elem.getAttribute("aria-"+_1d3)||"";},setWaiState:function(elem,_1d4,_1d5){elem.setAttribute("aria-"+_1d4,_1d5);},removeWaiState:function(elem,_1d6){elem.removeAttribute("aria-"+_1d6);}});}if(!dojo._hasResource["dijit._base"]){dojo._hasResource["dijit._base"]=true;dojo.provide("dijit._base");}if(!dojo._hasResource["dijit._Widget"]){dojo._hasResource["dijit._Widget"]=true;dojo.provide("dijit._Widget");dojo.connect(dojo,"_connect",function(_1d7,_1d8){if(_1d7&&dojo.isFunction(_1d7._onConnect)){_1d7._onConnect(_1d8);}});dijit._connectOnUseEventHandler=function(_1d9){};dijit._lastKeyDownNode=null;if(dojo.isIE){(function(){var _1da=function(evt){dijit._lastKeyDownNode=evt.srcElement;};dojo.doc.attachEvent("onkeydown",_1da);dojo.addOnWindowUnload(function(){dojo.doc.detachEvent("onkeydown",_1da);});})();}else{dojo.doc.addEventListener("keydown",function(evt){dijit._lastKeyDownNode=evt.target;},true);}(function(){dojo.declare("dijit._Widget",dijit._WidgetBase,{_deferredConnects:{onClick:"",onDblClick:"",onKeyDown:"",onKeyPress:"",onKeyUp:"",onMouseMove:"",onMouseDown:"",onMouseOut:"",onMouseOver:"",onMouseLeave:"",onMouseEnter:"",onMouseUp:""},onClick:dijit._connectOnUseEventHandler,onDblClick:dijit._connectOnUseEventHandler,onKeyDown:dijit._connectOnUseEventHandler,onKeyPress:dijit._connectOnUseEventHandler,onKeyUp:dijit._connectOnUseEventHandler,onMouseDown:dijit._connectOnUseEventHandler,onMouseMove:dijit._connectOnUseEventHandler,onMouseOut:dijit._connectOnUseEventHandler,onMouseOver:dijit._connectOnUseEventHandler,onMouseLeave:dijit._connectOnUseEventHandler,onMouseEnter:dijit._connectOnUseEventHandler,onMouseUp:dijit._connectOnUseEventHandler,create:function(_1db,_1dc){this._deferredConnects=dojo.clone(this._deferredConnects);for(var attr in this.attributeMap){delete this._deferredConnects[attr];}for(attr in this._deferredConnects){if(this[attr]!==dijit._connectOnUseEventHandler){delete this._deferredConnects[attr];}}this.inherited(arguments);if(this.domNode){for(attr in this.params){this._onConnect(attr);}}},_onConnect:function(_1dd){if(_1dd in this._deferredConnects){var _1de=this[this._deferredConnects[_1dd]||"domNode"];this.connect(_1de,_1dd.toLowerCase(),_1dd);delete this._deferredConnects[_1dd];}},focused:false,isFocusable:function(){return this.focus&&(dojo.style(this.domNode,"display")!="none");},onFocus:function(){},onBlur:function(){},_onFocus:function(e){this.onFocus();},_onBlur:function(){this.onBlur();},setAttribute:function(attr,_1df){dojo.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(attr,_1df);},attr:function(name,_1e0){if(dojo.config.isDebug){var _1e1=arguments.callee._ach||(arguments.callee._ach={}),_1e2=(arguments.callee.caller||"unknown caller").toString();if(!_1e1[_1e2]){dojo.deprecated(this.declaredClass+"::attr() is deprecated. Use get() or set() instead, called from "+_1e2,"","2.0");_1e1[_1e2]=true;}}var args=arguments.length;if(args>=2||typeof name==="object"){return this.set.apply(this,arguments);}else{return this.get(name);}},nodesWithKeyClick:["input","button"],connect:function(obj,_1e3,_1e4){var d=dojo,dc=d._connect,_1e5=this.inherited(arguments,[obj,_1e3=="ondijitclick"?"onclick":_1e3,_1e4]);if(_1e3=="ondijitclick"){if(d.indexOf(this.nodesWithKeyClick,obj.nodeName.toLowerCase())==-1){var m=d.hitch(this,_1e4);_1e5.push(dc(obj,"onkeydown",this,function(e){if((e.keyCode==d.keys.ENTER||e.keyCode==d.keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey){dijit._lastKeyDownNode=e.target;if(!("openDropDown" in this&&obj==this._buttonNode)){e.preventDefault();}}}),dc(obj,"onkeyup",this,function(e){if((e.keyCode==d.keys.ENTER||e.keyCode==d.keys.SPACE)&&e.target==dijit._lastKeyDownNode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey){dijit._lastKeyDownNode=null;return m(e);}}));}}return _1e5;},_onShow:function(){this.onShow();},onShow:function(){},onHide:function(){},onClose:function(){return true;}});})();}if(!dojo._hasResource["dojo.string"]){dojo._hasResource["dojo.string"]=true;dojo.provide("dojo.string");dojo.getObject("string",true,dojo);dojo.string.rep=function(str,num){if(num<=0||!str){return "";}var buf=[];for(;;){if(num&1){buf.push(str);}if(!(num>>=1)){break;}str+=str;}return buf.join("");};dojo.string.pad=function(text,size,ch,end){if(!ch){ch="0";}var out=String(text),pad=dojo.string.rep(ch,Math.ceil((size-out.length)/ch.length));return end?out+pad:pad+out;};dojo.string.substitute=function(_1e6,map,_1e7,_1e8){_1e8=_1e8||dojo.global;_1e7=_1e7?dojo.hitch(_1e8,_1e7):function(v){return v;};return _1e6.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(_1e9,key,_1ea){var _1eb=dojo.getObject(key,false,map);if(_1ea){_1eb=dojo.getObject(_1ea,false,_1e8).call(_1e8,_1eb,key);}return _1e7(_1eb,key).toString();});};dojo.string.trim=String.prototype.trim?dojo.trim:function(str){str=str.replace(/^\s+/,"");for(var i=str.length-1;i>=0;i--){if(/\S/.test(str.charAt(i))){str=str.substring(0,i+1);break;}}return str;};}if(!dojo._hasResource["dojo.date.stamp"]){dojo._hasResource["dojo.date.stamp"]=true;dojo.provide("dojo.date.stamp");dojo.getObject("date.stamp",true,dojo);dojo.date.stamp.fromISOString=function(_1ec,_1ed){if(!dojo.date.stamp._isoRegExp){dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _1ee=dojo.date.stamp._isoRegExp.exec(_1ec),_1ef=null;if(_1ee){_1ee.shift();if(_1ee[1]){_1ee[1]--;}if(_1ee[6]){_1ee[6]*=1000;}if(_1ed){_1ed=new Date(_1ed);dojo.forEach(dojo.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(prop){return _1ed["get"+prop]();}),function(_1f0,_1f1){_1ee[_1f1]=_1ee[_1f1]||_1f0;});}_1ef=new Date(_1ee[0]||1970,_1ee[1]||0,_1ee[2]||1,_1ee[3]||0,_1ee[4]||0,_1ee[5]||0,_1ee[6]||0);if(_1ee[0]<100){_1ef.setFullYear(_1ee[0]||1970);}var _1f2=0,_1f3=_1ee[7]&&_1ee[7].charAt(0);if(_1f3!="Z"){_1f2=((_1ee[8]||0)*60)+(Number(_1ee[9])||0);if(_1f3!="-"){_1f2*=-1;}}if(_1f3){_1f2-=_1ef.getTimezoneOffset();}if(_1f2){_1ef.setTime(_1ef.getTime()+_1f2*60000);}}return _1ef;};dojo.date.stamp.toISOString=function(_1f4,_1f5){var _1f6=function(n){return (n<10)?"0"+n:n;};_1f5=_1f5||{};var _1f7=[],_1f8=_1f5.zulu?"getUTC":"get",date="";if(_1f5.selector!="time"){var year=_1f4[_1f8+"FullYear"]();date=["0000".substr((year+"").length)+year,_1f6(_1f4[_1f8+"Month"]()+1),_1f6(_1f4[_1f8+"Date"]())].join("-");}_1f7.push(date);if(_1f5.selector!="date"){var time=[_1f6(_1f4[_1f8+"Hours"]()),_1f6(_1f4[_1f8+"Minutes"]()),_1f6(_1f4[_1f8+"Seconds"]())].join(":");var _1f9=_1f4[_1f8+"Milliseconds"]();if(_1f5.milliseconds){time+="."+(_1f9<100?"0":"")+_1f6(_1f9);}if(_1f5.zulu){time+="Z";}else{if(_1f5.selector!="time"){var _1fa=_1f4.getTimezoneOffset();var _1fb=Math.abs(_1fa);time+=(_1fa>0?"-":"+")+_1f6(Math.floor(_1fb/60))+":"+_1f6(_1fb%60);}}_1f7.push(time);}return _1f7.join("T");};}if(!dojo._hasResource["dojo.parser"]){dojo._hasResource["dojo.parser"]=true;dojo.provide("dojo.parser");new Date("X");dojo.parser=new function(){var d=dojo;function _1fc(_1fd){if(d.isString(_1fd)){return "string";}if(typeof _1fd=="number"){return "number";}if(typeof _1fd=="boolean"){return "boolean";}if(d.isFunction(_1fd)){return "function";}if(d.isArray(_1fd)){return "array";}if(_1fd instanceof Date){return "date";}if(_1fd instanceof d._Url){return "url";}return "object";};function _1fe(_1ff,type){switch(type){case "string":return _1ff;case "number":return _1ff.length?Number(_1ff):NaN;case "boolean":return typeof _1ff=="boolean"?_1ff:!(_1ff.toLowerCase()=="false");case "function":if(d.isFunction(_1ff)){_1ff=_1ff.toString();_1ff=d.trim(_1ff.substring(_1ff.indexOf("{")+1,_1ff.length-1));}try{if(_1ff===""||_1ff.search(/[^\w\.]+/i)!=-1){return new Function(_1ff);}else{return d.getObject(_1ff,false)||new Function(_1ff);}}catch(e){return new Function();}case "array":return _1ff?_1ff.split(/\s*,\s*/):[];case "date":switch(_1ff){case "":return new Date("");case "now":return new Date();default:return d.date.stamp.fromISOString(_1ff);}case "url":return d.baseUrl+_1ff;default:return d.fromJson(_1ff);}};var _200={},_201={};d.connect(d,"extend",function(){_201={};});function _202(cls,_203){for(var name in cls){if(name.charAt(0)=="_"){continue;}if(name in _200){continue;}_203[name]=_1fc(cls[name]);}return _203;};function _204(_205,_206){var c=_201[_205];if(!c){var cls=d.getObject(_205),_207=null;if(!cls){return null;}if(!_206){_207=_202(cls.prototype,{});}c={cls:cls,params:_207};}else{if(!_206&&!c.params){c.params=_202(c.cls.prototype,{});}}return c;};this._functionFromScript=function(_208,_209){var _20a="";var _20b="";var _20c=(_208.getAttribute(_209+"args")||_208.getAttribute("args"));if(_20c){d.forEach(_20c.split(/\s*,\s*/),function(part,idx){_20a+="var "+part+" = arguments["+idx+"]; ";});}var _20d=_208.getAttribute("with");if(_20d&&_20d.length){d.forEach(_20d.split(/\s*,\s*/),function(part){_20a+="with("+part+"){";_20b+="}";});}return new Function(_20a+_208.innerHTML+_20b);};this.instantiate=function(_20e,_20f,args){var _210=[],_20f=_20f||{};args=args||{};var _211=(args.scope||d._scopeName)+"Type",_212="data-"+(args.scope||d._scopeName)+"-";d.forEach(_20e,function(obj){if(!obj){return;}var node,type,_213,_214,_215,_216;if(obj.node){node=obj.node;type=obj.type;_216=obj.fastpath;_213=obj.clsInfo||(type&&_204(type,_216));_214=_213&&_213.cls;_215=obj.scripts;}else{node=obj;type=_211 in _20f?_20f[_211]:node.getAttribute(_211);_213=type&&_204(type);_214=_213&&_213.cls;_215=(_214&&(_214._noScript||_214.prototype._noScript)?[]:d.query("> script[type^='dojo/']",node));}if(!_213){throw new Error("Could not load class '"+type);}var _217={};if(args.defaults){d._mixin(_217,args.defaults);}if(obj.inherited){d._mixin(_217,obj.inherited);}if(_216){var _218=node.getAttribute(_212+"props");if(_218&&_218.length){try{_218=d.fromJson.call(args.propsThis,"{"+_218+"}");d._mixin(_217,_218);}catch(e){throw new Error(e.toString()+" in data-dojo-props='"+_218+"'");}}var _219=node.getAttribute(_212+"attach-point");if(_219){_217.dojoAttachPoint=_219;}var _21a=node.getAttribute(_212+"attach-event");if(_21a){_217.dojoAttachEvent=_21a;}dojo.mixin(_217,_20f);}else{var _21b=node.attributes;for(var name in _213.params){var item=name in _20f?{value:_20f[name],specified:true}:_21b.getNamedItem(name);if(!item||(!item.specified&&(!dojo.isIE||name.toLowerCase()!="value"))){continue;}var _21c=item.value;switch(name){case "class":_21c="className" in _20f?_20f.className:node.className;break;case "style":_21c="style" in _20f?_20f.style:(node.style&&node.style.cssText);}var _21d=_213.params[name];if(typeof _21c=="string"){_217[name]=_1fe(_21c,_21d);}else{_217[name]=_21c;}}}var _21e=[],_21f=[];d.forEach(_215,function(_220){node.removeChild(_220);var _221=(_220.getAttribute(_212+"event")||_220.getAttribute("event")),type=_220.getAttribute("type"),nf=d.parser._functionFromScript(_220,_212);if(_221){if(type=="dojo/connect"){_21e.push({event:_221,func:nf});}else{_217[_221]=nf;}}else{_21f.push(nf);}});var _222=_214.markupFactory||_214.prototype&&_214.prototype.markupFactory;var _223=_222?_222(_217,node,_214):new _214(_217,node);_210.push(_223);var _224=(node.getAttribute(_212+"id")||node.getAttribute("jsId"));if(_224){d.setObject(_224,_223);}d.forEach(_21e,function(_225){d.connect(_223,_225.event,null,_225.func);});d.forEach(_21f,function(func){func.call(_223);});});if(!_20f._started){d.forEach(_210,function(_226){if(!args.noStart&&_226&&dojo.isFunction(_226.startup)&&!_226._started&&(!_226.getParent||!_226.getParent())){_226.startup();}});}return _210;};this.parse=function(_227,args){var root;if(!args&&_227&&_227.rootNode){args=_227;root=args.rootNode;}else{root=_227;}root=root?dojo.byId(root):dojo.body();args=args||{};var _228=(args.scope||d._scopeName)+"Type",_229="data-"+(args.scope||d._scopeName)+"-";function scan(_22a,list){var _22b=dojo.clone(_22a.inherited);dojo.forEach(["dir","lang"],function(name){var val=_22a.node.getAttribute(name);if(val){_22b[name]=val;}});var _22c=_22a.clsInfo&&!_22a.clsInfo.cls.prototype._noScript?_22a.scripts:null;var _22d=(!_22a.clsInfo||!_22a.clsInfo.cls.prototype.stopParser)||(args&&args.template);for(var _22e=_22a.node.firstChild;_22e;_22e=_22e.nextSibling){if(_22e.nodeType==1){var type,_22f=_22d&&_22e.getAttribute(_229+"type");if(_22f){type=_22f;}else{type=_22d&&_22e.getAttribute(_228);}var _230=_22f==type;if(type){var _231={"type":type,fastpath:_230,clsInfo:_204(type,_230),node:_22e,scripts:[],inherited:_22b};list.push(_231);scan(_231,list);}else{if(_22c&&_22e.nodeName.toLowerCase()=="script"){type=_22e.getAttribute("type");if(type&&/^dojo\/\w/i.test(type)){_22c.push(_22e);}}else{if(_22d){scan({node:_22e,inherited:_22b},list);}}}}}};var _232={};if(args&&args.inherited){for(var key in args.inherited){if(args.inherited[key]){_232[key]=args.inherited[key];}}}var list=[];scan({node:root,inherited:_232},list);var _233=args&&args.template?{template:true}:null;return this.instantiate(list,_233,args);};}();(function(){var _234=function(){if(dojo.config.parseOnLoad){dojo.parser.parse();}};if(dojo.getObject("dijit.wai.onload")===dojo._loaders[0]){dojo._loaders.splice(1,0,_234);}else{dojo._loaders.unshift(_234);}})();}if(!dojo._hasResource["dojo.cache"]){dojo._hasResource["dojo.cache"]=true;dojo.provide("dojo.cache");var cache={};dojo.cache=function(_235,url,_236){if(typeof _235=="string"){var _237=dojo.moduleUrl(_235,url);}else{_237=_235;_236=url;}var key=_237.toString();var val=_236;if(_236!=undefined&&!dojo.isString(_236)){val=("value" in _236?_236.value:undefined);}var _238=_236&&_236.sanitize?true:false;if(typeof val=="string"){val=cache[key]=_238?dojo.cache._sanitize(val):val;}else{if(val===null){delete cache[key];}else{if(!(key in cache)){val=dojo._getText(key);cache[key]=_238?dojo.cache._sanitize(val):val;}val=cache[key];}}return val;};dojo.cache._sanitize=function(val){if(val){val=val.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var _239=val.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(_239){val=_239[1];}}else{val="";}return val;};}if(!dojo._hasResource["dijit._Templated"]){dojo._hasResource["dijit._Templated"]=true;dojo.provide("dijit._Templated");dojo.declare("dijit._Templated",null,{templateString:null,templatePath:null,widgetsInTemplate:false,_skipNodeCache:false,_earlyTemplatedStartup:false,constructor:function(){this._attachPoints=[];this._attachEvents=[];},_stringRepl:function(tmpl){var _23a=this.declaredClass,_23b=this;return dojo.string.substitute(tmpl,this,function(_23c,key){if(key.charAt(0)=="!"){_23c=dojo.getObject(key.substr(1),false,_23b);}if(typeof _23c=="undefined"){throw new Error(_23a+" template:"+key);}if(_23c==null){return "";}return key.charAt(0)=="!"?_23c:_23c.toString().replace(/"/g,"&quot;");},this);},buildRendering:function(){var _23d=dijit._Templated.getCachedTemplate(this.templatePath,this.templateString,this._skipNodeCache);var node;if(dojo.isString(_23d)){node=dojo._toDom(this._stringRepl(_23d));if(node.nodeType!=1){throw new Error("Invalid template: "+_23d);}}else{node=_23d.cloneNode(true);}this.domNode=node;this.inherited(arguments);this._attachTemplateNodes(node);if(this.widgetsInTemplate){var cw=(this._startupWidgets=dojo.parser.parse(node,{noStart:!this._earlyTemplatedStartup,template:true,inherited:{dir:this.dir,lang:this.lang},propsThis:this,scope:"dojo"}));this._supportingWidgets=dijit.findWidgets(node);this._attachTemplateNodes(cw,function(n,p){return n[p];});}this._fillContent(this.srcNodeRef);},_fillContent:function(_23e){var dest=this.containerNode;if(_23e&&dest){while(_23e.hasChildNodes()){dest.appendChild(_23e.firstChild);}}},_attachTemplateNodes:function(_23f,_240){_240=_240||function(n,p){return n.getAttribute(p);};var _241=dojo.isArray(_23f)?_23f:(_23f.all||_23f.getElementsByTagName("*"));var x=dojo.isArray(_23f)?0:-1;for(;x<_241.length;x++){var _242=(x==-1)?_23f:_241[x];if(this.widgetsInTemplate&&(_240(_242,"dojoType")||_240(_242,"data-dojo-type"))){continue;}var _243=_240(_242,"dojoAttachPoint")||_240(_242,"data-dojo-attach-point");if(_243){var _244,_245=_243.split(/\s*,\s*/);while((_244=_245.shift())){if(dojo.isArray(this[_244])){this[_244].push(_242);}else{this[_244]=_242;}this._attachPoints.push(_244);}}var _246=_240(_242,"dojoAttachEvent")||_240(_242,"data-dojo-attach-event");if(_246){var _247,_248=_246.split(/\s*,\s*/);var trim=dojo.trim;while((_247=_248.shift())){if(_247){var _249=null;if(_247.indexOf(":")!=-1){var _24a=_247.split(":");_247=trim(_24a[0]);_249=trim(_24a[1]);}else{_247=trim(_247);}if(!_249){_249=_247;}this._attachEvents.push(this.connect(_242,_247,_249));}}}var role=_240(_242,"waiRole");if(role){dijit.setWaiRole(_242,role);}var _24b=_240(_242,"waiState");if(_24b){dojo.forEach(_24b.split(/\s*,\s*/),function(_24c){if(_24c.indexOf("-")!=-1){var pair=_24c.split("-");dijit.setWaiState(_242,pair[0],pair[1]);}});}}},startup:function(){dojo.forEach(this._startupWidgets,function(w){if(w&&!w._started&&w.startup){w.startup();}});this.inherited(arguments);},destroyRendering:function(){dojo.forEach(this._attachPoints,function(_24d){delete this[_24d];},this);this._attachPoints=[];dojo.forEach(this._attachEvents,this.disconnect,this);this._attachEvents=[];this.inherited(arguments);}});dijit._Templated._templateCache={};dijit._Templated.getCachedTemplate=function(_24e,_24f,_250){var _251=dijit._Templated._templateCache;var key=_24f||_24e;var _252=_251[key];if(_252){try{if(!_252.ownerDocument||_252.ownerDocument==dojo.doc){return _252;}}catch(e){}dojo.destroy(_252);}if(!_24f){_24f=dojo.cache(_24e,{sanitize:true});}_24f=dojo.string.trim(_24f);if(_250||_24f.match(/\$\{([^\}]+)\}/g)){return (_251[key]=_24f);}else{var node=dojo._toDom(_24f);if(node.nodeType!=1){throw new Error("Invalid template: "+_24f);}return (_251[key]=node);}};if(dojo.isIE){dojo.addOnWindowUnload(function(){var _253=dijit._Templated._templateCache;for(var key in _253){var _254=_253[key];if(typeof _254=="object"){dojo.destroy(_254);}delete _253[key];}});}dojo.extend(dijit._Widget,{dojoAttachEvent:"",dojoAttachPoint:"",waiRole:"",waiState:""});}if(!dojo._hasResource["dojox.widget.Toaster"]){dojo._hasResource["dojox.widget.Toaster"]=true;dojo.provide("dojox.widget.Toaster");dojo.declare("dojox.widget.Toaster",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitToasterClip\" dojoAttachPoint=\"clipNode\"><div class=\"dijitToasterContainer\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onclick:onSelect\"><div class=\"dijitToasterContent\" dojoAttachPoint=\"contentNode\"></div></div></div>",messageTopic:"",messageTypes:{MESSAGE:"message",WARNING:"warning",ERROR:"error",FATAL:"fatal"},defaultType:"message",positionDirection:"br-up",positionDirectionTypes:["br-up","br-left","bl-up","bl-right","tr-down","tr-left","tl-down","tl-right"],duration:2000,slideDuration:500,separator:"<hr></hr>",postCreate:function(){this.inherited(arguments);this.hide();dojo.body().appendChild(this.domNode);if(this.messageTopic){dojo.subscribe(this.messageTopic,this,"_handleMessage");}},_handleMessage:function(_255){if(dojo.isString(_255)){this.setContent(_255);}else{this.setContent(_255.message,_255.type,_255.duration);}},_capitalize:function(w){return w.substring(0,1).toUpperCase()+w.substring(1);},setContent:function(_256,_257,_258){_258=_258||this.duration;if(this.slideAnim){if(this.slideAnim.status()!="playing"){this.slideAnim.stop();}if(this.slideAnim.status()=="playing"||(this.fadeAnim&&this.fadeAnim.status()=="playing")){setTimeout(dojo.hitch(this,function(){this.setContent(_256,_257,_258);}),50);return;}}for(var type in this.messageTypes){dojo.removeClass(this.containerNode,"dijitToaster"+this._capitalize(this.messageTypes[type]));}dojo.style(this.containerNode,"opacity",1);this._setContent(_256);dojo.addClass(this.containerNode,"dijitToaster"+this._capitalize(_257||this.defaultType));this.show();var _259=dojo.marginBox(this.containerNode);this._cancelHideTimer();if(this.isVisible){this._placeClip();if(!this._stickyMessage){this._setHideTimer(_258);}}else{var _25a=this.containerNode.style;var pd=this.positionDirection;if(pd.indexOf("-up")>=0){_25a.left=0+"px";_25a.top=_259.h+10+"px";}else{if(pd.indexOf("-left")>=0){_25a.left=_259.w+10+"px";_25a.top=0+"px";}else{if(pd.indexOf("-right")>=0){_25a.left=0-_259.w-10+"px";_25a.top=0+"px";}else{if(pd.indexOf("-down")>=0){_25a.left=0+"px";_25a.top=0-_259.h-10+"px";}else{throw new Error(this.id+".positionDirection is invalid: "+pd);}}}}this.slideAnim=dojo.fx.slideTo({node:this.containerNode,top:0,left:0,duration:this.slideDuration});this.connect(this.slideAnim,"onEnd",function(_25b,anim){this.fadeAnim=dojo.fadeOut({node:this.containerNode,duration:1000});this.connect(this.fadeAnim,"onEnd",function(evt){this.isVisible=false;this.hide();});this._setHideTimer(_258);this.connect(this,"onSelect",function(evt){this._cancelHideTimer();this._stickyMessage=false;this.fadeAnim.play();});this.isVisible=true;});this.slideAnim.play();}},_setContent:function(_25c){if(dojo.isFunction(_25c)){_25c(this);return;}if(_25c&&this.isVisible){_25c=this.contentNode.innerHTML+this.separator+_25c;}this.contentNode.innerHTML=_25c;},_cancelHideTimer:function(){if(this._hideTimer){clearTimeout(this._hideTimer);this._hideTimer=null;}},_setHideTimer:function(_25d){this._cancelHideTimer();if(_25d>0){this._cancelHideTimer();this._hideTimer=setTimeout(dojo.hitch(this,function(evt){if(this.bgIframe&&this.bgIframe.iframe){this.bgIframe.iframe.style.display="none";}this._hideTimer=null;this._stickyMessage=false;this.fadeAnim.play();}),_25d);}else{this._stickyMessage=true;}},_placeClip:function(){var view=dojo.window.getBox();var _25e=dojo.marginBox(this.containerNode);var _25f=this.clipNode.style;_25f.height=_25e.h+"px";_25f.width=_25e.w+"px";var pd=this.positionDirection;if(pd.match(/^t/)){_25f.top=view.t+"px";}else{if(pd.match(/^b/)){_25f.top=(view.h-_25e.h-2+view.t)+"px";}}if(pd.match(/^[tb]r-/)){_25f.left=(view.w-_25e.w-1-view.l)+"px";}else{if(pd.match(/^[tb]l-/)){_25f.left=0+"px";}}_25f.clip="rect(0px, "+_25e.w+"px, "+_25e.h+"px, 0px)";if(dojo.isIE){if(!this.bgIframe){this.clipNode.id=dijit.getUniqueId("dojox_widget_Toaster_clipNode");this.bgIframe=new dijit.BackgroundIframe(this.clipNode);}var _260=this.bgIframe.iframe;if(_260){_260.style.display="block";}}},onSelect:function(e){},show:function(){dojo.style(this.domNode,"display","block");this._placeClip();if(!this._scrollConnected){this._scrollConnected=dojo.connect(window,"onscroll",this,this._placeClip);}},hide:function(){dojo.style(this.domNode,"display","none");if(this._scrollConnected){dojo.disconnect(this._scrollConnected);this._scrollConnected=false;}dojo.style(this.containerNode,"opacity",1);}});}if(!dojo._hasResource["plugins.dojox.widget.Toaster"]){dojo._hasResource["plugins.dojox.widget.Toaster"]=true;dojo.provide("plugins.dojox.widget.Toaster");dojo.declare("plugins.dojox.widget.Toaster",[dojox.widget.Toaster],{setContent:function(_261,_262,_263){_263=_263||this.duration;if(this.slideAnim){if(this.slideAnim.status()!="playing"){this.slideAnim.stop();}if(this.slideAnim.status()=="playing"||(this.fadeAnim&&this.fadeAnim.status()=="playing")){setTimeout(dojo.hitch(this,function(){this.setContent(_261,_262,_263);}),50);return;}}for(var type in this.messageTypes){dojo.removeClass(this.containerNode,"dijitToaster"+this._capitalize(this.messageTypes[type]));}dojo.style(this.containerNode,"opacity",1);this._setContent(_261,_262);dojo.addClass(this.containerNode,"dijitToaster"+this._capitalize(_262||this.defaultType));this.show();var _264=dojo.marginBox(this.containerNode);this._cancelHideTimer();if(this.isVisible){this._placeClip();if(!this._stickyMessage){this._setHideTimer(_263);}}else{var _265=this.containerNode.style;var pd=this.positionDirection;if(pd.indexOf("-up")>=0){_265.left=0+"px";_265.top=_264.h+10+"px";}else{if(pd.indexOf("-left")>=0){_265.left=_264.w+10+"px";_265.top=0+"px";}else{if(pd.indexOf("-right")>=0){_265.left=0-_264.w-10+"px";_265.top=0+"px";}else{if(pd.indexOf("-down")>=0){_265.left=0+"px";_265.top=0-_264.h-10+"px";}else{throw new Error(this.id+".positionDirection is invalid: "+pd);}}}}this.slideAnim=dojo.fx.slideTo({node:this.containerNode,top:0,left:0,duration:this.slideDuration});this.connect(this.slideAnim,"onEnd",function(_266,anim){this.fadeAnim=dojo.fadeOut({node:this.containerNode,duration:1000});this.connect(this.fadeAnim,"onEnd",function(evt){this.isVisible=false;this.hide();});this._setHideTimer(_263);this.connect(this,"onSelect",function(evt){this._cancelHideTimer();this._stickyMessage=false;this.fadeAnim.play();});this.isVisible=true;});this.slideAnim.play();}},_setContent:function(_267,_268){console.log("plugins.core.Common.Toaster._setContent    message: "+_267);console.log("plugins.core.Common.Toaster._setContent    messageType: "+_268);if(dojo.isFunction(_267)){_267(this);return;}if(_267&&this.isVisible){_267=this.contentNode.innerHTML+this.separator+"<span class='"+_268+"'>"+_267+"</span>";}else{_267="<span class='"+_268+"'>"+_267+"</span>";}console.log("plugins.core.Common.Toaster._setContent    FINAL message: "+_267);this.contentNode.innerHTML=_267;}});}if(!dojo._hasResource["plugins.core.Common.Toast"]){dojo._hasResource["plugins.core.Common.Toast"]=true;dojo.provide("plugins.core.Common.Toast");dojo.declare("plugins.core.Common.Toast",[],{setToaster:function(){console.log("Common.Toast.setToaster    this.toaster: "+this.toaster);console.dir({this_toaster:this.toaster});var _269=[dojo.moduleUrl("plugins","core/css/toaster.css")];this.loadCSS(_269);if(!this.toaster){this.toaster=new plugins.dojox.widget.Toaster({className:"toaster",positionDirection:"bl-right",duration:"500",messageTopic:"toastTopic"});}this.containerNode.style.width="100%";},toastMessage:function(args){console.log("Common.Toast.toastMessage    args:");console.dir({args:args});console.log("Common.Toast.toastMessage    this.toaster: "+this.toaster);console.dir({this_toaster:this.toaster});if(!args){return;}if(!this.toaster||!this.toaster.containerNode){this.setToaster();}if(args.doToast==false){return;}var _26a=args.message;if(_26a==null||_26a==""){console.log("Common.Toast.toastMessage    message is empty or not defined. Returning");return;}console.log("Common.Toast.toastMessage    args: ");console.dir({args:args});var type=args.type;var _26b=args.duration;if(_26b==null){_26b=4000;}if(type!=null&&(type!="warning"&&type!="error"&&type!="fatal")){console.log("Common.Toast.toastMessage    type not supported (must be warning|error|fatal): "+type);return;}var _26c="toastTopic";try{dojo.publish(_26c,[{message:_26a,type:type,duration:_26b}]);}catch(error){console.log("Common.Toast.toastMessage    error: "+dojo.toJson(error));}},toast:function(_26d){console.log("Common.Toast.toast    response: ");console.dir({response:_26d});if(_26d.error){var args={message:_26d.error,type:"error"};if(_26d.duration!=null){args.duration=_26d.duration;}this.toastMessage(args);}else{var args={message:_26d.status,type:"warning"};if(_26d.duration!=null){args.duration=_26d.duration;}this.toastMessage(args);}},toastError:function(_26e){this.toastMessage({message:_26e,type:"error"});},toastInfo:function(info){this.toastMessage({message:info,type:"warning"});},error:function(_26f){this.toastMessage({message:_26f,type:"error"});},warning:function(_270){this.toastMessage({message:_270,type:"warning"});}});}if(!dojo._hasResource["plugins.core.Common.Util"]){dojo._hasResource["plugins.core.Common.Util"]=true;dojo.provide("plugins.core.Common.Util");dojo.declare("plugins.core.Common.Util",[],{doPut:function(_271){console.log("    Common.Util.doPut    inputs: ");console.dir({inputs:_271});var _272=function(){};if(_271.callback!=null){_272=_271.callback;}var _273=true;if(_271.doToast!=null){_273=_271.doToast;}var url=_271.url;url+="?";url+=Math.floor(Math.random()*100000);var _274=_271.query;var _275=_271.timeout?_271.timeout:null;var _276=_271.handleAs?_271.handleAs:"json";var sync=_271.sync?_271.sync:false;dojo.xhrPut({url:url,contentType:"text",preventCache:true,sync:sync,handleAs:_276,putData:dojo.toJson(_274),timeout:_275,load:function(_277,_278){console.log("    Common.Util.doPut    response: ");console.dir({response:_277});if(_277.error){if(_273){console.log("    Common.Util.doPut    DOING Agua.toastMessage ERROR");Agua.toastMessage({message:_277.error,type:"error",duration:10000});}}else{if(_277.status){if(_273){console.log("    Common.Util.doPut    DOING Agua.toastMessage STATUS");Agua.toastMessage({message:_277.status,type:"warning",duration:10000});if(Agua.loader!=null){Agua.loader._hide();}}}console.log("    Common.Util.doPut    DOING callback(response, inputs)");_272(_277,_271);}},error:function(_279,_27a){console.log("    Common.Util.doPut    Error with put. Response: "+_279);return _279;}});},getClassName:function(_27b){var _27c=new String(_27b);var name;if(_27c.match(/^\[Widget\s+(\S+),/)){name=_27c.match(/^\[Widget\s+(\S+),/)[1];}return name;},showMessage:function(_27d,_27e){console.log("    Common.Util.showMessage    Polling message: "+_27d);},downloadFile:function(_27f,_280){var _281="?mode=downloadFile";if(_280!=null){_281+="&username="+_280;_281+="&requestor="+Agua.cookie("username");}else{_281+="&username="+Agua.cookie("username");}_281+="&sessionId="+Agua.cookie("sessionId");_281+="&filepath="+_27f;var url=Agua.cgiUrl+"download.cgi";var args={method:"GET",url:url+_281,handleAs:"json",timeout:10000,load:this.handleDownload};console.log("ParameterRow.downloadFile     args: ",args);console.log("ParameterRow.downloadFile     Doing dojo.io.iframe.send(args))");var _282=dojo.io.iframe.send(args);},loadCSS:function(_283){if(_283==null){_283=this.cssFiles;}for(var i in _283){this.loadCSSFile(_283[i]);}},loadCSSFile:function(_284){if(Agua.loadedCssFiles==null||!Agua.loadedCssFiles){Agua.loadedCssFiles=new Object;}if(!Agua.loadedCssFiles[_284]){console.log("    Common.Util.loadCSSFile    Loading cssFile: "+_284);var _285=document.createElement("link");_285.type="text/css";_285.rel="stylesheet";_285.href=_284;document.getElementsByTagName("head")[0].appendChild(_285);Agua.loadedCssFiles[_284]=1;}else{}return Agua.loadedCssFiles;},randomiseUrl:function(url){url+="?dojo.preventCache=1266358799763";url+=Math.floor(Math.random()*1000000000000);return url;},killPopup:function(_286){var _287="widget_"+_286.id+"_dropdown";var _288=dojo.byId(_287);if(_288!=null){var _289=dijit.byNode(_288.childNodes[0]);dijit.popup.close(_289);}},});}if(!dojo._hasResource["plugins.core.Common"]){dojo._hasResource["plugins.core.Common"]=true;dojo.provide("plugins.core.Common");dojo.declare("plugins.core.Common",[plugins.core.Common.Array,plugins.core.Common.ComboBox,plugins.core.Common.Date,plugins.core.Common.Sort,plugins.core.Common.Text,plugins.core.Common.Toast,plugins.core.Common.Util],{loadedCssFiles:null,});}if(!dojo._hasResource["dojo.dnd.common"]){dojo._hasResource["dojo.dnd.common"]=true;dojo.provide("dojo.dnd.common");dojo.getObject("dnd",true,dojo);dojo.dnd.getCopyKeyState=dojo.isCopyKey;dojo.dnd._uniqueId=0;dojo.dnd.getUniqueId=function(){var id;do{id=dojo._scopeName+"Unique"+(++dojo.dnd._uniqueId);}while(dojo.byId(id));return id;};dojo.dnd._empty={};dojo.dnd.isFormElement=function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;};}if(!dojo._hasResource["dojo.dnd.Container"]){dojo._hasResource["dojo.dnd.Container"]=true;dojo.provide("dojo.dnd.Container");dojo.declare("dojo.dnd.Container",null,{skipForm:false,constructor:function(node,_28a){this.node=dojo.byId(node);if(!_28a){_28a={};}this.creator=_28a.creator||null;this.skipForm=_28a.skipForm;this.parent=_28a.dropParent&&dojo.byId(_28a.dropParent);this.map={};this.current=null;this.containerState="";dojo.addClass(this.node,"dojoDndContainer");if(!(_28a&&_28a._skipStartup)){this.startup();}this.events=[dojo.connect(this.node,"onmouseover",this,"onMouseOver"),dojo.connect(this.node,"onmouseout",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",this,"onSelectStart"),dojo.connect(this.node,"onselectstart",this,"onSelectStart")];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||dojo.global;var m=this.map,e=dojo.dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return dojo.query("> .dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dojo.dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_28b,_28c){if(!this.parent.firstChild){_28c=null;}else{if(_28b){if(!_28c){_28c=this.parent.firstChild;}}else{if(_28c){_28c=_28c.nextSibling;}}}if(_28c){for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.insertBefore(t.node,_28c);}}else{for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_28d,node){_28d._skipStartup=true;return new dojo.dnd.Container(node,_28d);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dojo.dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_28e){var _28f="dojoDnd"+type;var _290=type.toLowerCase()+"State";dojo.replaceClass(this.node,_28f+_28e,_28f+this[_290]);this[_290]=_28e;},_addItemClass:function(node,type){dojo.addClass(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){dojo.removeClass(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _291=node.parentNode;_291;node=_291,_291=node.parentNode){if(_291==this.parent&&dojo.hasClass(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!dojo.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dojo.dnd.getUniqueId();}dojo.addClass(t.node,"dojoDndItem");return t;}});dojo.dnd._createNode=function(tag){if(!tag){return dojo.dnd._createSpan;}return function(text){return dojo.create(tag,{innerHTML:text});};};dojo.dnd._createTrTd=function(text){var tr=dojo.create("tr");dojo.create("td",{innerHTML:text},tr);return tr;};dojo.dnd._createSpan=function(text){return dojo.create("span",{innerHTML:text});};dojo.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dojo.dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dojo.dnd._createTrTd:dojo.dnd._createNode(dojo.dnd._defaultCreatorNodes[tag]);return function(item,hint){var _292=item&&dojo.isObject(item),data,type,n;if(_292&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_292&&item.data)?item.data:item;type=(_292&&item.type)?item.type:["text"];n=(hint=="avatar"?dojo.dnd._createSpan:c)(String(data));}if(!n.id){n.id=dojo.dnd.getUniqueId();}return {node:n,data:data,type:type};};};}if(!dojo._hasResource["dojo.dnd.Selector"]){dojo._hasResource["dojo.dnd.Selector"]=true;dojo.provide("dojo.dnd.Selector");dojo.declare("dojo.dnd.Selector",dojo.dnd.Container,{constructor:function(node,_293){if(!_293){_293={};}this.singular=_293.singular;this.autoSync=_293.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(dojo.connect(this.node,"onmousedown",this,"onMouseDown"),dojo.connect(this.node,"onmouseup",this,"onMouseUp"));},singular:false,getSelectedNodes:function(){var t=new dojo.NodeList();var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dojo.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dojo.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dojo.byId(i);this.delItem(i);dojo.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||dojo.global;var s=this.selection,e=dojo.dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){dojo.dnd.Selector.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}dojo.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_294,data,_295,_296){var _297=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_297.call(this,item,hint);if(_294){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};dojo.dnd.Selector.superclass.insertNodes.call(this,data,_295,_296);this._normalizedCreator=_297;return this;},destroy:function(){dojo.dnd.Selector.superclass.destroy.call(this);this.selection=this.anchor=null;},markupFactory:function(_298,node){_298._skipStartup=true;return new dojo.dnd.Selector(node,_298);},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dojo.isCopyKey(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(e.button===dojo.mouseButtons.LEFT){dojo.stopEvent(e);}return;}if(!this.singular&&e.shiftKey){if(!dojo.isCopyKey(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0;for(;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dojo.isCopyKey(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dojo.isCopyKey(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}dojo.stopEvent(e);},onMouseUp:function(e){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(e){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=dojo.connect(this.node,"onmousemove",this,"onMouseMove");},onOutEvent:function(){dojo.disconnect(this.onmousemoveEvent);delete this.onmousemoveEvent;},_removeSelection:function(){console.log("dojo.dnd.Selector._removeSelection    this.selection:");console.dir({this_selection:this.selection});var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dojo.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});}if(!dojo._hasResource["dojo.dnd.autoscroll"]){dojo._hasResource["dojo.dnd.autoscroll"]=true;dojo.provide("dojo.dnd.autoscroll");dojo.getObject("dnd",true,dojo);dojo.dnd.getViewport=dojo.window.getBox;dojo.dnd.V_TRIGGER_AUTOSCROLL=32;dojo.dnd.H_TRIGGER_AUTOSCROLL=32;dojo.dnd.V_AUTOSCROLL_VALUE=16;dojo.dnd.H_AUTOSCROLL_VALUE=16;dojo.dnd.autoScroll=function(e){var v=dojo.window.getBox(),dx=0,dy=0;if(e.clientX<dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=-dojo.dnd.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=dojo.dnd.H_AUTOSCROLL_VALUE;}}if(e.clientY<dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=-dojo.dnd.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=dojo.dnd.V_AUTOSCROLL_VALUE;}}window.scrollBy(dx,dy);};dojo.dnd._validNodes={"div":1,"p":1,"td":1};dojo.dnd._validOverflow={"auto":1,"scroll":1};dojo.dnd.autoScrollNodes=function(e){for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in dojo.dnd._validNodes)){var s=dojo.getComputedStyle(n);if(s.overflow.toLowerCase() in dojo.dnd._validOverflow){var b=dojo._getContentBox(n,s),t=dojo.position(n,true);var w=Math.min(dojo.dnd.H_TRIGGER_AUTOSCROLL,b.w/2),h=Math.min(dojo.dnd.V_TRIGGER_AUTOSCROLL,b.h/2),rx=e.pageX-t.x,ry=e.pageY-t.y,dx=0,dy=0;if(dojo.isWebKit||dojo.isOpera){rx+=dojo.body().scrollLeft;ry+=dojo.body().scrollTop;}if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}}if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}}var _299=n.scrollLeft,_29a=n.scrollTop;n.scrollLeft=n.scrollLeft+dx;n.scrollTop=n.scrollTop+dy;if(_299!=n.scrollLeft||_29a!=n.scrollTop){return;}}}try{n=n.parentNode;}catch(x){n=null;}}dojo.dnd.autoScroll(e);};}if(!dojo._hasResource["dojo.dnd.Avatar"]){dojo._hasResource["dojo.dnd.Avatar"]=true;dojo.provide("dojo.dnd.Avatar");dojo.declare("dojo.dnd.Avatar",null,{constructor:function(_29b){this.manager=_29b;this.construct();},construct:function(){this.isA11y=dojo.hasClass(dojo.body(),"dijit_a11y");var a=dojo.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_29c=this.manager.source,node,b=dojo.create("tbody",null,a),tr=dojo.create("tr",null,b),td=dojo.create("td",null,tr),icon=this.isA11y?dojo.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td):null,span=dojo.create("span",{innerHTML:_29c.generateText?this._generateText():""},td),k=Math.min(5,this.manager.nodes.length),i=0;dojo.attr(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_29c.creator){node=_29c._normalizedCreator(_29c.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _29d=dojo.create("table"),_29e=dojo.create("tbody",null,_29d);_29e.appendChild(node);node=_29d;}}node.id="";tr=dojo.create("tr",null,b);td=dojo.create("td",null,tr);td.appendChild(node);dojo.attr(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){dojo.destroy(this.node);this.node=false;},update:function(){dojo[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");if(this.isA11y){var icon=dojo.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}dojo.query(("tr.dojoDndAvatarHeader td span"+(this.isA11y?" span":"")),this.node).forEach(function(node){node.innerHTML=this._generateText();},this);},_generateText:function(){return this.manager.nodes.length.toString();}});}if(!dojo._hasResource["dojo.dnd.Manager"]){dojo._hasResource["dojo.dnd.Manager"]=true;dojo.provide("dojo.dnd.Manager");dojo.declare("dojo.dnd.Manager",null,{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:16,OFFSET_Y:16,overSource:function(_29f){if(this.avatar){this.target=(_29f&&_29f.targetState!="Disabled")?_29f:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}dojo.publish("/dnd/source/over",[_29f]);},outSource:function(_2a0){if(this.avatar){if(this.target==_2a0){this.target=null;this.canDropFlag=false;this.avatar.update();dojo.publish("/dnd/source/over",[null]);}}else{dojo.publish("/dnd/source/over",[null]);}},startDrag:function(_2a1,_2a2,copy){this.source=_2a1;this.nodes=_2a2;this.copy=Boolean(copy);this.avatar=this.makeAvatar();dojo.body().appendChild(this.avatar.node);dojo.publish("/dnd/start",[_2a1,_2a2,this.copy]);this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp"),dojo.connect(dojo.doc,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent)];var c="dojoDnd"+(copy?"Copy":"Move");dojo.addClass(dojo.body(),c);},canDrop:function(flag){var _2a3=Boolean(this.target&&flag);if(this.canDropFlag!=_2a3){this.canDropFlag=_2a3;this.avatar.update();}},stopDrag:function(){dojo.removeClass(dojo.body(),["dojoDndCopy","dojoDndMove"]);dojo.forEach(this.events,dojo.disconnect);this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new dojo.dnd.Avatar(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){dojo.dnd.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dojo.isCopyKey(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dojo.isCopyKey(e))),_2a4=[this.source,this.nodes,copy,this.target,e];dojo.publish("/dnd/drop/before",_2a4);dojo.publish("/dnd/drop",_2a4);}else{dojo.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case dojo.keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case dojo.keys.ESCAPE:dojo.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==dojo.keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();dojo.replaceClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dojo.dnd._manager=null;dojo.dnd.manager=function(){if(!dojo.dnd._manager){dojo.dnd._manager=new dojo.dnd.Manager();}return dojo.dnd._manager;};}if(!dojo._hasResource["dojo.dnd.Source"]){dojo._hasResource["dojo.dnd.Source"]=true;dojo.provide("dojo.dnd.Source");dojo.declare("dojo.dnd.Source",dojo.dnd.Selector,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_2a5){dojo.mixin(this,dojo.mixin({},_2a5));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){dojo.addClass(this.node,"dojoDndSource");}this.targetState="";if(this.accept){dojo.addClass(this.node,"dojoDndTarget");}if(this.horizontal){dojo.addClass(this.node,"dojoDndHorizontal");}this.topics=[dojo.subscribe("/dnd/source/over",this,"onDndSourceOver"),dojo.subscribe("/dnd/start",this,"onDndStart"),dojo.subscribe("/dnd/drop",this,"onDndDrop"),dojo.subscribe("/dnd/cancel",this,"onDndCancel")];},checkAcceptance:function(_2a6,_2a7){if(this==_2a6){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_2a7.length;++i){var type=_2a6.getItem(_2a7[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_2a8,self){if(_2a8){return true;}if(arguments.length<2){self=this==dojo.dnd.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){dojo.dnd.Source.superclass.destroy.call(this);dojo.forEach(this.topics,dojo.unsubscribe);this.targetAnchor=null;},markupFactory:function(_2a9,node){_2a9._skipStartup=true;return new dojo.dnd.Source(node,_2a9);},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}dojo.dnd.Source.superclass.onMouseMove.call(this,e);var m=dojo.dnd.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _2aa=this.getSelectedNodes();if(_2aa.length){m.startDrag(this,_2aa,this.copyState(dojo.isCopyKey(e),true));}}}if(this.isDragging){var _2ab=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=dojo.position(this.current,true);}if(this.horizontal){_2ab=(e.pageX-this.targetBox.x)<(this.targetBox.w/2);}else{_2ab=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_2ab!=this.before){this._markTargetAnchor(_2ab);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dojo.dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;dojo.dnd.Source.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;dojo.dnd.Source.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_2ac){if(this!=_2ac){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=dojo.dnd.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_2ad,_2ae,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_2ad?(copy?"Copied":"Moved"):"");}var _2af=this.accept&&this.checkAcceptance(_2ad,_2ae);this._changeState("Target",_2af?"":"Disabled");if(this==_2ad){dojo.dnd.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_2b0,_2b1,copy,_2b2){if(this==_2b2){this.onDrop(_2b0,_2b1,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_2b3,_2b4,copy){if(this!=_2b3){this.onDropExternal(_2b3,_2b4,copy);}else{this.onDropInternal(_2b4,copy);}},onDropExternal:function(_2b5,_2b6,copy){console.log("dojo.dnd.Source.onDropExternal    HERE HERE HERE");var _2b7=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _2b7.call(this,_2b5.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node,hint){var t=_2b5.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node,hint){var t=_2b5.getItem(node.id);_2b5.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_2b5.selectNone();}this.insertNodes(true,_2b6,this.before,this.current);if(!copy&&this.creator){_2b5.deleteSelectedNodes();}this._normalizedCreator=_2b7;},onDropInternal:function(_2b8,copy){var _2b9=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _2b9.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_2b8,this.before,this.current);this._normalizedCreator=_2b9;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){dojo.dnd.Source.superclass.onOverEvent.call(this);dojo.dnd.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){dojo.dnd.Source.superclass.onOutEvent.call(this);dojo.dnd.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_2ba){if(this.current==this.targetAnchor&&this.before==_2ba){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_2ba;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(!dojo.mouseButtons.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(dojo.hasClass(node,"dojoDndHandle")){return true;}if(dojo.hasClass(node,"dojoDndItem")||dojo.hasClass(node,"dojoDndIgnore")){break;}}return false;}});dojo.declare("dojo.dnd.Target",dojo.dnd.Source,{constructor:function(node,_2bb){this.isSource=false;dojo.removeClass(this.node,"dojoDndSource");},markupFactory:function(_2bc,node){_2bc._skipStartup=true;return new dojo.dnd.Target(node,_2bc);}});dojo.declare("dojo.dnd.AutoSource",dojo.dnd.Source,{constructor:function(node,_2bd){this.autoSync=true;},markupFactory:function(_2be,node){_2be._skipStartup=true;return new dojo.dnd.AutoSource(node,_2be);}});}if(!dojo._hasResource["dojo.dnd.Mover"]){dojo._hasResource["dojo.dnd.Mover"]=true;dojo.provide("dojo.dnd.Mover");dojo.declare("dojo.dnd.Mover",null,{constructor:function(node,e,host){this.node=dojo.byId(node);var pos=e.touches?e.touches[0]:e;this.marginBox={l:pos.pageX,t:pos.pageY};this.mouseButton=e.button;var h=(this.host=host),d=node.ownerDocument;this.events=[dojo.connect(d,"onmousemove",this,"onFirstMove"),dojo.connect(d,"ontouchmove",this,"onFirstMove"),dojo.connect(d,"onmousemove",this,"onMouseMove"),dojo.connect(d,"ontouchmove",this,"onMouseMove"),dojo.connect(d,"onmouseup",this,"onMouseUp"),dojo.connect(d,"ontouchend",this,"onMouseUp"),dojo.connect(d,"ondragstart",dojo.stopEvent),dojo.connect(d.body,"onselectstart",dojo.stopEvent)];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){dojo.dnd.autoScroll(e);var m=this.marginBox,pos=e.touches?e.touches[0]:e;this.host.onMove(this,{l:m.l+pos.pageX,t:m.t+pos.pageY},e);dojo.stopEvent(e);},onMouseUp:function(e){if(dojo.isWebKit&&dojo.isMac&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){this.destroy();}dojo.stopEvent(e);},onFirstMove:function(e){var s=this.node.style,l,t,h=this.host;switch(s.position){case "relative":case "absolute":l=Math.round(parseFloat(s.left))||0;t=Math.round(parseFloat(s.top))||0;break;default:s.position="absolute";var m=dojo.marginBox(this.node);var b=dojo.doc.body;var bs=dojo.getComputedStyle(b);var bm=dojo._getMarginBox(b,bs);var bc=dojo._getContentBox(b,bs);l=m.l-(bc.l-bm.l);t=m.t-(bc.t-bm.t);break;}this.marginBox.l=l-this.marginBox.l;this.marginBox.t=t-this.marginBox.t;if(h&&h.onFirstMove){h.onFirstMove(this,e);}dojo.disconnect(this.events.shift());dojo.disconnect(this.events.shift());},destroy:function(){dojo.forEach(this.events,dojo.disconnect);var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.node=this.host=null;}});}if(!dojo._hasResource["dojo.dnd.Moveable"]){dojo._hasResource["dojo.dnd.Moveable"]=true;dojo.provide("dojo.dnd.Moveable");dojo.declare("dojo.dnd.Moveable",null,{handle:"",delay:0,skip:false,constructor:function(node,_2bf){this.node=dojo.byId(node);if(!_2bf){_2bf={};}this.handle=_2bf.handle?dojo.byId(_2bf.handle):null;if(!this.handle){this.handle=this.node;}this.delay=_2bf.delay>0?_2bf.delay:0;this.skip=_2bf.skip;this.mover=_2bf.mover?_2bf.mover:dojo.dnd.Mover;this.events=[dojo.connect(this.handle,"onmousedown",this,"onMouseDown"),dojo.connect(this.handle,"ontouchstart",this,"onMouseDown"),dojo.connect(this.handle,"ondragstart",this,"onSelectStart"),dojo.connect(this.handle,"onselectstart",this,"onSelectStart")];},markupFactory:function(_2c0,node){return new dojo.dnd.Moveable(node,_2c0);},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.events=this.node=this.handle=null;},onMouseDown:function(e){if(this.skip&&dojo.dnd.isFormElement(e)){return;}if(this.delay){this.events.push(dojo.connect(this.handle,"onmousemove",this,"onMouseMove"),dojo.connect(this.handle,"ontouchmove",this,"onMouseMove"),dojo.connect(this.handle,"onmouseup",this,"onMouseUp"),dojo.connect(this.handle,"ontouchend",this,"onMouseUp"));var pos=e.touches?e.touches[0]:e;this._lastX=pos.pageX;this._lastY=pos.pageY;}else{this.onDragDetected(e);}dojo.stopEvent(e);},onMouseMove:function(e){var pos=e.touches?e.touches[0]:e;if(Math.abs(pos.pageX-this._lastX)>this.delay||Math.abs(pos.pageY-this._lastY)>this.delay){this.onMouseUp(e);this.onDragDetected(e);}dojo.stopEvent(e);},onMouseUp:function(e){for(var i=0;i<2;++i){dojo.disconnect(this.events.pop());}dojo.stopEvent(e);},onSelectStart:function(e){if(!this.skip||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onDragDetected:function(e){new this.mover(this.node,e,this);},onMoveStart:function(_2c1){dojo.publish("/dnd/move/start",[_2c1]);dojo.addClass(dojo.body(),"dojoMove");dojo.addClass(this.node,"dojoMoveItem");},onMoveStop:function(_2c2){dojo.publish("/dnd/move/stop",[_2c2]);dojo.removeClass(dojo.body(),"dojoMove");dojo.removeClass(this.node,"dojoMoveItem");},onFirstMove:function(_2c3,e){},onMove:function(_2c4,_2c5,e){this.onMoving(_2c4,_2c5);var s=_2c4.node.style;s.left=_2c5.l+"px";s.top=_2c5.t+"px";this.onMoved(_2c4,_2c5);},onMoving:function(_2c6,_2c7){},onMoved:function(_2c8,_2c9){}});}if(!dojo._hasResource["dojo.dnd.move"]){dojo._hasResource["dojo.dnd.move"]=true;dojo.provide("dojo.dnd.move");dojo.declare("dojo.dnd.move.constrainedMoveable",dojo.dnd.Moveable,{constraints:function(){},within:false,markupFactory:function(_2ca,node){return new dojo.dnd.move.constrainedMoveable(node,_2ca);},constructor:function(node,_2cb){if(!_2cb){_2cb={};}this.constraints=_2cb.constraints;this.within=_2cb.within;},onFirstMove:function(_2cc){var c=this.constraintBox=this.constraints.call(this,_2cc);c.r=c.l+c.w;c.b=c.t+c.h;if(this.within){var mb=dojo._getMarginSize(_2cc.node);c.r-=mb.w;c.b-=mb.h;}},onMove:function(_2cd,_2ce){var c=this.constraintBox,s=_2cd.node.style;this.onMoving(_2cd,_2ce);_2ce.l=_2ce.l<c.l?c.l:c.r<_2ce.l?c.r:_2ce.l;_2ce.t=_2ce.t<c.t?c.t:c.b<_2ce.t?c.b:_2ce.t;s.left=_2ce.l+"px";s.top=_2ce.t+"px";this.onMoved(_2cd,_2ce);}});dojo.declare("dojo.dnd.move.boxConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{box:{},markupFactory:function(_2cf,node){return new dojo.dnd.move.boxConstrainedMoveable(node,_2cf);},constructor:function(node,_2d0){var box=_2d0&&_2d0.box;this.constraints=function(){return box;};}});dojo.declare("dojo.dnd.move.parentConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{area:"content",markupFactory:function(_2d1,node){return new dojo.dnd.move.parentConstrainedMoveable(node,_2d1);},constructor:function(node,_2d2){var area=_2d2&&_2d2.area;this.constraints=function(){var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);if(area=="margin"){return mb;}var t=dojo._getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="border"){return mb;}t=dojo._getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="padding"){return mb;}t=dojo._getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};}});dojo.dnd.constrainedMover=dojo.dnd.move.constrainedMover;dojo.dnd.boxConstrainedMover=dojo.dnd.move.boxConstrainedMover;dojo.dnd.parentConstrainedMover=dojo.dnd.move.parentConstrainedMover;}if(!dojo._hasResource["dojo.data.util.filter"]){dojo._hasResource["dojo.data.util.filter"]=true;dojo.provide("dojo.data.util.filter");dojo.getObject("data.util.filter",true,dojo);dojo.data.util.filter.patternToRegExp=function(_2d3,_2d4){var rxp="^";var c=null;for(var i=0;i<_2d3.length;i++){c=_2d3.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_2d3.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_2d4){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};}if(!dojo._hasResource["dojo.data.util.sorter"]){dojo._hasResource["dojo.data.util.sorter"]=true;dojo.provide("dojo.data.util.sorter");dojo.getObject("data.util.sorter",true,dojo);dojo.data.util.sorter.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};dojo.data.util.sorter.createSortFunction=function(_2d5,_2d6){var _2d7=[];function _2d8(attr,dir,comp,s){return function(_2d9,_2da){var a=s.getValue(_2d9,attr);var b=s.getValue(_2da,attr);return dir*comp(a,b);};};var _2db;var map=_2d6.comparatorMap;var bc=dojo.data.util.sorter.basicComparator;for(var i=0;i<_2d5.length;i++){_2db=_2d5[i];var attr=_2db.attribute;if(attr){var dir=(_2db.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_2d7.push(_2d8(attr,dir,comp,_2d6));}}return function(rowA,rowB){var i=0;while(i<_2d7.length){var ret=_2d7[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};}if(!dojo._hasResource["dojo.data.util.simpleFetch"]){dojo._hasResource["dojo.data.util.simpleFetch"]=true;dojo.provide("dojo.data.util.simpleFetch");dojo.getObject("data.util.simpleFetch",true,dojo);dojo.data.util.simpleFetch.fetch=function(_2dc){_2dc=_2dc||{};if(!_2dc.store){_2dc.store=this;}var self=this;var _2dd=function(_2de,_2df){if(_2df.onError){var _2e0=_2df.scope||dojo.global;_2df.onError.call(_2e0,_2de,_2df);}};var _2e1=function(_2e2,_2e3){var _2e4=_2e3.abort||null;var _2e5=false;var _2e6=_2e3.start?_2e3.start:0;var _2e7=(_2e3.count&&(_2e3.count!==Infinity))?(_2e6+_2e3.count):_2e2.length;_2e3.abort=function(){_2e5=true;if(_2e4){_2e4.call(_2e3);}};var _2e8=_2e3.scope||dojo.global;if(!_2e3.store){_2e3.store=self;}if(_2e3.onBegin){_2e3.onBegin.call(_2e8,_2e2.length,_2e3);}if(_2e3.sort){_2e2.sort(dojo.data.util.sorter.createSortFunction(_2e3.sort,self));}if(_2e3.onItem){for(var i=_2e6;(i<_2e2.length)&&(i<_2e7);++i){var item=_2e2[i];if(!_2e5){_2e3.onItem.call(_2e8,item,_2e3);}}}if(_2e3.onComplete&&!_2e5){var _2e9=null;if(!_2e3.onItem){_2e9=_2e2.slice(_2e6,_2e7);}_2e3.onComplete.call(_2e8,_2e9,_2e3);}};this._fetchItems(_2dc,_2e1,_2dd);return _2dc;};}if(!dojo._hasResource["dojo.data.ItemFileReadStore"]){dojo._hasResource["dojo.data.ItemFileReadStore"]=true;dojo.provide("dojo.data.ItemFileReadStore");dojo.declare("dojo.data.ItemFileReadStore",null,{constructor:function(_2ea){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_2ea.url;this._ccUrl=_2ea.url;this.url=_2ea.url;this._jsonData=_2ea.data;this.data=null;this._datatypeMap=_2ea.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_2eb){return dojo.date.stamp.fromISOString(_2eb);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_2ea.urlPreventCache!==undefined){this.urlPreventCache=_2ea.urlPreventCache?true:false;}if(_2ea.hierarchical!==undefined){this.hierarchical=_2ea.hierarchical?true:false;}if(_2ea.clearOnClose){this.clearOnClose=true;}if("failOk" in _2ea){this.failOk=_2ea.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.");}},_assertIsAttribute:function(_2ec){if(typeof _2ec!=="string"){throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.");}},getValue:function(item,_2ed,_2ee){var _2ef=this.getValues(item,_2ed);return (_2ef.length>0)?_2ef[0]:_2ee;},getValues:function(item,_2f0){this._assertIsItem(item);this._assertIsAttribute(_2f0);return (item[_2f0]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _2f1=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_2f1.push(key);}}return _2f1;},hasAttribute:function(item,_2f2){this._assertIsItem(item);this._assertIsAttribute(_2f2);return (_2f2 in item);},containsValue:function(item,_2f3,_2f4){var _2f5=undefined;if(typeof _2f4==="string"){_2f5=dojo.data.util.filter.patternToRegExp(_2f4,false);}return this._containsValue(item,_2f3,_2f4,_2f5);},_containsValue:function(item,_2f6,_2f7,_2f8){return dojo.some(this.getValues(item,_2f6),function(_2f9){if(_2f9!==null&&!dojo.isObject(_2f9)&&_2f8){if(_2f9.toString().match(_2f8)){return true;}}else{if(_2f7===_2f9){return true;}}});},isItem:function(_2fa){if(_2fa&&_2fa[this._storeRefPropName]===this){if(this._arrayOfAllItems[_2fa[this._itemNumPropName]]===_2fa){return true;}}return false;},isItemLoaded:function(_2fb){return this.isItem(_2fb);},loadItem:function(_2fc){this._assertIsItem(_2fc.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},_fetchItems:function(_2fd,_2fe,_2ff){var self=this,_300=function(_301,_302){var _303=[],i,key;if(_301.query){var _304,_305=_301.queryOptions?_301.queryOptions.ignoreCase:false;var _306={};for(key in _301.query){_304=_301.query[key];if(typeof _304==="string"){_306[key]=dojo.data.util.filter.patternToRegExp(_304,_305);}else{if(_304 instanceof RegExp){_306[key]=_304;}}}for(i=0;i<_302.length;++i){var _307=true;var _308=_302[i];if(_308===null){_307=false;}else{for(key in _301.query){_304=_301.query[key];if(!self._containsValue(_308,key,_304,_306[key])){_307=false;}}}if(_307){_303.push(_308);}}_2fe(_303,_301);}else{for(i=0;i<_302.length;++i){var item=_302[i];if(item!==null){_303.push(item);}}_2fe(_303,_301);}};if(this._loadFinished){_300(_2fd,this._getItemsArray(_2fd.queryOptions));}else{if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_2fd,filter:_300});}else{this._loadInProgress=true;var _309={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _30a=dojo.xhrGet(_309);_30a.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;_300(_2fd,self._getItemsArray(_2fd.queryOptions));self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_2ff(e,_2fd);}});_30a.addErrback(function(_30b){self._loadInProgress=false;_2ff(_30b,_2fd);});var _30c=null;if(_2fd.abort){_30c=_2fd.abort;}_2fd.abort=function(){var df=_30a;if(df&&df.fired===-1){df.cancel();df=null;}if(_30c){_30c.call(_2fd);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;_300(_2fd,this._getItemsArray(_2fd.queryOptions));}catch(e){_2ff(e,_2fd);}}else{_2ff(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),_2fd);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _30d=this._queuedFetches[i],_30e=_30d.args,_30f=_30d.filter;if(_30f){_30f(_30e,this._getItemsArray(_30e.queryOptions));}else{this.fetchItemByIdentity(_30e);}}this._queuedFetches=[];}},_getItemsArray:function(_310){if(_310&&_310.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_311){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug("dojo.data.ItemFileReadStore: WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_312){var _313=false,self=this;function _314(_315){var _316=((_315!==null)&&(typeof _315==="object")&&(!dojo.isArray(_315)||_313)&&(!dojo.isFunction(_315))&&(_315.constructor==Object||dojo.isArray(_315))&&(typeof _315._reference==="undefined")&&(typeof _315._type==="undefined")&&(typeof _315._value==="undefined")&&self.hierarchical);return _316;};function _317(_318){self._arrayOfAllItems.push(_318);for(var _319 in _318){var _31a=_318[_319];if(_31a){if(dojo.isArray(_31a)){var _31b=_31a;for(var k=0;k<_31b.length;++k){var _31c=_31b[k];if(_314(_31c)){_317(_31c);}}}else{if(_314(_31a)){_317(_31a);}}}}};this._labelAttr=_312.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_312.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(dojo.isArray(item)){_313=true;}_317(item);item[this._rootItemPropName]=true;}var _31d={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _31e=item[key];if(_31e!==null){if(!dojo.isArray(_31e)){item[key]=[_31e];}}else{item[key]=[null];}}_31d[key]=key;}}while(_31d[this._storeRefPropName]){this._storeRefPropName+="_";}while(_31d[this._itemNumPropName]){this._itemNumPropName+="_";}while(_31d[this._reverseRefMap]){this._reverseRefMap+="_";}var _31f;var _320=_312.identifier;if(_320){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_320;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_31f=item[_320];var _321=_31f[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_321)){this._itemsByIdentity[_321]=item;}else{if(this._jsonFileUrl){throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_320+"].  Value collided: ["+_321+"]");}else{if(this._jsonData){throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_320+"].  Value collided: ["+_321+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_31f=item[key];for(var j=0;j<_31f.length;++j){_31e=_31f[j];if(_31e!==null&&typeof _31e=="object"){if(("_type" in _31e)&&("_value" in _31e)){var type=_31e._type;var _322=this._datatypeMap[type];if(!_322){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(dojo.isFunction(_322)){_31f[j]=new _322(_31e._value);}else{if(dojo.isFunction(_322.deserialize)){_31f[j]=_322.deserialize(_31e._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_31e._reference){var _323=_31e._reference;if(!dojo.isObject(_323)){_31f[j]=this._getItemByIdentity(_323);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _324=this._arrayOfAllItems[k],_325=true;for(var _326 in _323){if(_324[_326]!=_323[_326]){_325=false;}}if(_325){_31f[j]=_324;}}}if(this.referenceIntegrity){var _327=_31f[j];if(this.isItem(_327)){this._addReferenceToMap(_327,item,key);}}}else{if(this.isItem(_31e)){if(this.referenceIntegrity){this._addReferenceToMap(_31e,item,key);}}}}}}}},_addReferenceToMap:function(_328,_329,_32a){},getIdentity:function(item){var _32b=this._features["dojo.data.api.Identity"];if(_32b===Number){return item[this._itemNumPropName];}else{var _32c=item[_32b];if(_32c){return _32c[0];}}return null;},fetchItemByIdentity:function(_32d){var item,_32e;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_32d});}else{this._loadInProgress=true;var _32f={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _330=dojo.xhrGet(_32f);_330.addCallback(function(data){var _331=_32d.scope?_32d.scope:dojo.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_32d.identity);if(_32d.onItem){_32d.onItem.call(_331,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_32d.onError){_32d.onError.call(_331,error);}}});_330.addErrback(function(_332){self._loadInProgress=false;if(_32d.onError){var _333=_32d.scope?_32d.scope:dojo.global;_32d.onError.call(_333,_332);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_32d.identity);if(_32d.onItem){_32e=_32d.scope?_32d.scope:dojo.global;_32d.onItem.call(_32e,item);}}}}else{item=this._getItemByIdentity(_32d.identity);if(_32d.onItem){_32e=_32d.scope?_32d.scope:dojo.global;_32d.onItem.call(_32e,item);}}},_getItemByIdentity:function(_334){var item=null;if(this._itemsByIdentity&&Object.hasOwnProperty.call(this._itemsByIdentity,_334)){item=this._itemsByIdentity[_334];}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_334)){item=this._arrayOfAllItems[_334];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _335=this._features["dojo.data.api.Identity"];if(_335===Number){return null;}else{return [_335];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _336={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _337=dojo.xhrGet(_336);_337.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error("dojo.data.ItemFileReadStore:  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_337.addErrback(function(_338){throw _338;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});dojo.extend(dojo.data.ItemFileReadStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["dojo.regexp"]){dojo._hasResource["dojo.regexp"]=true;dojo.provide("dojo.regexp");dojo.getObject("regexp",true,dojo);dojo.regexp.escapeString=function(str,_339){return str.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(ch){if(_339&&_339.indexOf(ch)!=-1){return ch;}return "\\"+ch;});};dojo.regexp.buildGroupRE=function(arr,re,_33a){if(!(arr instanceof Array)){return re(arr);}var b=[];for(var i=0;i<arr.length;i++){b.push(re(arr[i]));}return dojo.regexp.group(b.join("|"),_33a);};dojo.regexp.group=function(_33b,_33c){return "("+(_33c?"?:":"")+_33b+")";};}if(!dojo._hasResource["dijit._CssStateMixin"]){dojo._hasResource["dijit._CssStateMixin"]=true;dojo.provide("dijit._CssStateMixin");dojo.declare("dijit._CssStateMixin",[],{cssStateNodes:{},hovering:false,active:false,_applyAttributes:function(){this.inherited(arguments);dojo.forEach(["onmouseenter","onmouseleave","onmousedown"],function(e){this.connect(this.domNode,e,"_cssMouseEvent");},this);dojo.forEach(["disabled","readOnly","checked","selected","focused","state","hovering","active"],function(attr){this.watch(attr,dojo.hitch(this,"_setStateClass"));},this);for(var ap in this.cssStateNodes){this._trackMouseState(this[ap],this.cssStateNodes[ap]);}this._setStateClass();},_cssMouseEvent:function(_33d){if(!this.disabled){switch(_33d.type){case "mouseenter":case "mouseover":this._set("hovering",true);this._set("active",this._mouseDown);break;case "mouseleave":case "mouseout":this._set("hovering",false);this._set("active",false);break;case "mousedown":this._set("active",true);this._mouseDown=true;var _33e=this.connect(dojo.body(),"onmouseup",function(){this._mouseDown=false;this._set("active",false);this.disconnect(_33e);});break;}}},_setStateClass:function(){var _33f=this.baseClass.split(" ");function _340(_341){_33f=_33f.concat(dojo.map(_33f,function(c){return c+_341;}),"dijit"+_341);};if(!this.isLeftToRight()){_340("Rtl");}if(this.checked){_340("Checked");}if(this.state){_340(this.state);}if(this.selected){_340("Selected");}if(this.disabled){_340("Disabled");}else{if(this.readOnly){_340("ReadOnly");}else{if(this.active){_340("Active");}else{if(this.hovering){_340("Hover");}}}}if(this._focused){_340("Focused");}var tn=this.stateNode||this.domNode,_342={};dojo.forEach(tn.className.split(" "),function(c){_342[c]=true;});if("_stateClasses" in this){dojo.forEach(this._stateClasses,function(c){delete _342[c];});}dojo.forEach(_33f,function(c){_342[c]=true;});var _343=[];for(var c in _342){_343.push(c);}tn.className=_343.join(" ");this._stateClasses=_33f;},_trackMouseState:function(node,_344){var _345=false,_346=false,_347=false;var self=this,cn=dojo.hitch(this,"connect",node);function _348(){var _349=("disabled" in self&&self.disabled)||("readonly" in self&&self.readonly);dojo.toggleClass(node,_344+"Hover",_345&&!_346&&!_349);dojo.toggleClass(node,_344+"Active",_346&&!_349);dojo.toggleClass(node,_344+"Focused",_347&&!_349);};cn("onmouseenter",function(){_345=true;_348();});cn("onmouseleave",function(){_345=false;_346=false;_348();});cn("onmousedown",function(){_346=true;_348();});cn("onmouseup",function(){_346=false;_348();});cn("onfocus",function(){_347=true;_348();});cn("onblur",function(){_347=false;_348();});this.watch("disabled",_348);this.watch("readOnly",_348);}});}if(!dojo._hasResource["dijit.form._FormWidget"]){dojo._hasResource["dijit.form._FormWidget"]=true;dojo.provide("dijit.form._FormWidget");dojo.declare("dijit.form._FormWidget",[dijit._Widget,dijit._Templated,dijit._CssStateMixin],{name:"",alt:"",value:"",type:"text",tabIndex:"0",disabled:false,intermediateChanges:false,scrollOnFocus:true,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{value:"focusNode",id:"focusNode",tabIndex:"focusNode",alt:"focusNode",title:"focusNode"}),postMixInProperties:function(){this.nameAttrSetting=this.name?("name=\""+this.name.replace(/'/g,"&quot;")+"\""):"";this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousedown","_onMouseDown");},_setDisabledAttr:function(_34a){this._set("disabled",_34a);dojo.attr(this.focusNode,"disabled",_34a);if(this.valueNode){dojo.attr(this.valueNode,"disabled",_34a);}dijit.setWaiState(this.focusNode,"disabled",_34a);if(_34a){this._set("hovering",false);this._set("active",false);var _34b="tabIndex" in this.attributeMap?this.attributeMap.tabIndex:"focusNode";dojo.forEach(dojo.isArray(_34b)?_34b:[_34b],function(_34c){var node=this[_34c];if(dojo.isWebKit||dijit.hasDefaultTabStop(node)){node.setAttribute("tabIndex","-1");}else{node.removeAttribute("tabIndex");}},this);}else{if(this.tabIndex!=""){this.focusNode.setAttribute("tabIndex",this.tabIndex);}}},setDisabled:function(_34d){dojo.deprecated("setDisabled("+_34d+") is deprecated. Use set('disabled',"+_34d+") instead.","","2.0");this.set("disabled",_34d);},_onFocus:function(e){if(this.scrollOnFocus){dojo.window.scrollIntoView(this.domNode);}this.inherited(arguments);},isFocusable:function(){return !this.disabled&&this.focusNode&&(dojo.style(this.domNode,"display")!="none");},focus:function(){if(!this.disabled){dijit.focus(this.focusNode);}},compare:function(val1,val2){if(typeof val1=="number"&&typeof val2=="number"){return (isNaN(val1)&&isNaN(val2))?0:val1-val2;}else{if(val1>val2){return 1;}else{if(val1<val2){return -1;}else{return 0;}}}},onChange:function(_34e){},_onChangeActive:false,_handleOnChange:function(_34f,_350){if(this._lastValueReported==undefined&&(_350===null||!this._onChangeActive)){this._resetValue=this._lastValueReported=_34f;}this._pendingOnChange=this._pendingOnChange||(typeof _34f!=typeof this._lastValueReported)||(this.compare(_34f,this._lastValueReported)!=0);if((this.intermediateChanges||_350||_350===undefined)&&this._pendingOnChange){this._lastValueReported=_34f;this._pendingOnChange=false;if(this._onChangeActive){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);}this._onChangeHandle=setTimeout(dojo.hitch(this,function(){this._onChangeHandle=null;this.onChange(_34f);}),0);}}},create:function(){this.inherited(arguments);this._onChangeActive=true;},destroy:function(){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);this.onChange(this._lastValueReported);}this.inherited(arguments);},setValue:function(_351){dojo.deprecated("dijit.form._FormWidget:setValue("+_351+") is deprecated.  Use set('value',"+_351+") instead.","","2.0");this.set("value",_351);},getValue:function(){dojo.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value");},_onMouseDown:function(e){if(!e.ctrlKey&&dojo.mouseButtons.isLeft(e)&&this.isFocusable()){var _352=this.connect(dojo.body(),"onmouseup",function(){if(this.isFocusable()){this.focus();}this.disconnect(_352);});}}});dojo.declare("dijit.form._FormValueWidget",dijit.form._FormWidget,{readOnly:false,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{value:"",readOnly:"focusNode"}),_setReadOnlyAttr:function(_353){dojo.attr(this.focusNode,"readOnly",_353);dijit.setWaiState(this.focusNode,"readonly",_353);this._set("readOnly",_353);},postCreate:function(){this.inherited(arguments);if(dojo.isIE<9||(dojo.isIE&&dojo.isQuirks)){this.connect(this.focusNode||this.domNode,"onkeydown",this._onKeyDown);}if(this._resetValue===undefined){this._lastValueReported=this._resetValue=this.value;}},_setValueAttr:function(_354,_355){this._handleOnChange(_354,_355);},_handleOnChange:function(_356,_357){this._set("value",_356);this.inherited(arguments);},undo:function(){this._setValueAttr(this._lastValueReported,false);},reset:function(){this._hasBeenBlurred=false;this._setValueAttr(this._resetValue,true);},_onKeyDown:function(e){if(e.keyCode==dojo.keys.ESCAPE&&!(e.ctrlKey||e.altKey||e.metaKey)){var te;if(dojo.isIE){e.preventDefault();te=document.createEventObject();te.keyCode=dojo.keys.ESCAPE;te.shiftKey=e.shiftKey;e.srcElement.fireEvent("onkeypress",te);}}},_layoutHackIE7:function(){if(dojo.isIE==7){var _358=this.domNode;var _359=_358.parentNode;var _35a=_358.firstChild||_358;var _35b=_35a.style.filter;var _35c=this;while(_359&&_359.clientHeight==0){(function ping(){var _35d=_35c.connect(_359,"onscroll",function(e){_35c.disconnect(_35d);_35a.style.filter=(new Date()).getMilliseconds();setTimeout(function(){_35a.style.filter=_35b;},0);});})();_359=_359.parentNode;}}}});}if(!dojo._hasResource["dojo.i18n"]){dojo._hasResource["dojo.i18n"]=true;dojo.provide("dojo.i18n");dojo.getObject("i18n",true,dojo);dojo.i18n.getLocalization=dojo.i18n.getLocalization||function(_35e,_35f,_360){_360=dojo.i18n.normalizeLocale(_360);var _361=_360.split("-");var _362=[_35e,"nls",_35f].join(".");var _363=dojo._loadedModules[_362];if(_363){var _364;for(var i=_361.length;i>0;i--){var loc=_361.slice(0,i).join("_");if(_363[loc]){_364=_363[loc];break;}}if(!_364){_364=_363.ROOT;}if(_364){var _365=function(){};_365.prototype=_364;return new _365();}}throw new Error("Bundle not found: "+_35f+" in "+_35e+" , locale="+_360);};dojo.i18n.normalizeLocale=function(_366){var _367=_366?_366.toLowerCase():dojo.locale;if(_367=="root"){_367="ROOT";}return _367;};dojo.i18n._requireLocalization=function(_368,_369,_36a,_36b){var _36c=dojo.i18n.normalizeLocale(_36a);var _36d=[_368,"nls",_369].join(".");var _36e="";if(_36b){var _36f=_36b.split(",");for(var i=0;i<_36f.length;i++){if(_36c["indexOf"](_36f[i])==0){if(_36f[i].length>_36e.length){_36e=_36f[i];}}}if(!_36e){_36e="ROOT";}}var _370=_36b?_36e:_36c;var _371=dojo._loadedModules[_36d];var _372=null;if(_371){if(dojo.config.localizationComplete&&_371._built){return;}var _373=_370.replace(/-/g,"_");var _374=_36d+"."+_373;_372=dojo._loadedModules[_374];}if(!_372){_371=dojo["provide"](_36d);var syms=dojo._getModuleSymbols(_368);var _375=syms.concat("nls").join("/");var _376;dojo.i18n._searchLocalePath(_370,_36b,function(loc){var _377=loc.replace(/-/g,"_");var _378=_36d+"."+_377;var _379=false;if(!dojo._loadedModules[_378]){dojo["provide"](_378);var _37a=[_375];if(loc!="ROOT"){_37a.push(loc);}_37a.push(_369);var _37b=_37a.join("/")+".js";_379=dojo._loadPath(_37b,null,function(hash){hash=hash.root||hash;var _37c=function(){};_37c.prototype=_376;_371[_377]=new _37c();for(var j in hash){_371[_377][j]=hash[j];}});}else{_379=true;}if(_379&&_371[_377]){_376=_371[_377];}else{_371[_377]=_376;}if(_36b){return true;}});}if(_36b&&_36c!=_36e){_371[_36c.replace(/-/g,"_")]=_371[_36e.replace(/-/g,"_")];}};(function(){var _37d=dojo.config.extraLocale;if(_37d){if(!_37d instanceof Array){_37d=[_37d];}var req=dojo.i18n._requireLocalization;dojo.i18n._requireLocalization=function(m,b,_37e,_37f){req(m,b,_37e,_37f);if(_37e){return;}for(var i=0;i<_37d.length;i++){req(m,b,_37d[i],_37f);}};}})();dojo.i18n._searchLocalePath=function(_380,down,_381){_380=dojo.i18n.normalizeLocale(_380);var _382=_380.split("-");var _383=[];for(var i=_382.length;i>0;i--){_383.push(_382.slice(0,i).join("-"));}_383.push(false);if(down){_383.reverse();}for(var j=_383.length-1;j>=0;j--){var loc=_383[j]||"ROOT";var stop=_381(loc);if(stop){break;}}};dojo.i18n._preloadLocalizations=function(_384,_385){function _386(_387){_387=dojo.i18n.normalizeLocale(_387);dojo.i18n._searchLocalePath(_387,true,function(loc){for(var i=0;i<_385.length;i++){if(_385[i]==loc){dojo["require"](_384+"_"+loc);return true;}}return false;});};_386();var _388=dojo.config.extraLocale||[];for(var i=0;i<_388.length;i++){_386(_388[i]);}};}if(!dojo._hasResource["dijit.form.TextBox"]){dojo._hasResource["dijit.form.TextBox"]=true;dojo.provide("dijit.form.TextBox");dojo.declare("dijit.form.TextBox",dijit.form._FormValueWidget,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,placeHolder:"",templateString:dojo.cache("dijit.form","templates/TextBox.html","<div class=\"dijit dijitReset dijitInline dijitLeft\" id=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class=\"dijitReset dijitInputInner\" dojoAttachPoint='textbox,focusNode' autocomplete=\"off\"\n\t\t\t${!nameAttrSetting} type='${type}'\n\t/></div\n></div>\n"),_singleNodeTemplate:"<input class=\"dijit dijitReset dijitLeft dijitInputField\" dojoAttachPoint=\"textbox,focusNode\" autocomplete=\"off\" type=\"${type}\" ${!nameAttrSetting} />",_buttonInputDisabled:dojo.isIE?"disabled":"",baseClass:"dijitTextBox",attributeMap:dojo.delegate(dijit.form._FormValueWidget.prototype.attributeMap,{maxLength:"focusNode"}),postMixInProperties:function(){var type=this.type.toLowerCase();if(this.templateString&&this.templateString.toLowerCase()=="input"||((type=="hidden"||type=="file")&&this.templateString==dijit.form.TextBox.prototype.templateString)){this.templateString=this._singleNodeTemplate;}this.inherited(arguments);},_setPlaceHolderAttr:function(v){this._set("placeHolder",v);if(!this._phspan){this._attachPoints.push("_phspan");this._phspan=dojo.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after");}this._phspan.innerHTML="";this._phspan.appendChild(document.createTextNode(v));this._updatePlaceHolder();},_updatePlaceHolder:function(){if(this._phspan){this._phspan.style.display=(this.placeHolder&&!this._focused&&!this.textbox.value)?"":"none";}},_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints);},_setValueAttr:function(_389,_38a,_38b){var _38c;if(_389!==undefined){_38c=this.filter(_389);if(typeof _38b!="string"){if(_38c!==null&&((typeof _38c!="number")||!isNaN(_38c))){_38b=this.filter(this.format(_38c,this.constraints));}else{_38b="";}}}if(_38b!=null&&_38b!=undefined&&((typeof _38b)!="number"||!isNaN(_38b))&&this.textbox.value!=_38b){this.textbox.value=_38b;this._set("displayedValue",this.get("displayedValue"));}this._updatePlaceHolder();this.inherited(arguments,[_38c,_38a]);},displayedValue:"",getDisplayedValue:function(){dojo.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use set('displayedValue') instead.","","2.0");return this.get("displayedValue");},_getDisplayedValueAttr:function(){return this.filter(this.textbox.value);},setDisplayedValue:function(_38d){dojo.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",_38d);},_setDisplayedValueAttr:function(_38e){if(_38e===null||_38e===undefined){_38e="";}else{if(typeof _38e!="string"){_38e=String(_38e);}}this.textbox.value=_38e;this._setValueAttr(this.get("value"),undefined);this._set("displayedValue",this.get("displayedValue"));},format:function(_38f,_390){return ((_38f==null||_38f==undefined)?"":(_38f.toString?_38f.toString():_38f));},parse:function(_391,_392){return _391;},_refreshState:function(){},_onInput:function(e){if(e&&e.type&&/key/i.test(e.type)&&e.keyCode){switch(e.keyCode){case dojo.keys.SHIFT:case dojo.keys.ALT:case dojo.keys.CTRL:case dojo.keys.TAB:return;}}if(this.intermediateChanges){var _393=this;setTimeout(function(){_393._handleOnChange(_393.get("value"),false);},0);}this._refreshState();this._set("displayedValue",this.get("displayedValue"));},postCreate:function(){if(dojo.isIE){setTimeout(dojo.hitch(this,function(){var s=dojo.getComputedStyle(this.domNode);if(s){var ff=s.fontFamily;if(ff){var _394=this.domNode.getElementsByTagName("INPUT");if(_394){for(var i=0;i<_394.length;i++){_394[i].style.fontFamily=ff;}}}}}),0);}this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);if(dojo.isMoz||dojo.isOpera){this.connect(this.textbox,"oninput","_onInput");}else{this.connect(this.textbox,"onkeydown","_onInput");this.connect(this.textbox,"onkeyup","_onInput");this.connect(this.textbox,"onpaste","_onInput");this.connect(this.textbox,"oncut","_onInput");}},_blankValue:"",filter:function(val){if(val===null){return this._blankValue;}if(typeof val!="string"){return val;}if(this.trim){val=dojo.trim(val);}if(this.uppercase){val=val.toUpperCase();}if(this.lowercase){val=val.toLowerCase();}if(this.propercase){val=val.replace(/[^\s]+/g,function(word){return word.substring(0,1).toUpperCase()+word.substring(1);});}return val;},_setBlurValue:function(){this._setValueAttr(this.get("value"),true);},_onBlur:function(e){if(this.disabled){return;}this._setBlurValue();this.inherited(arguments);if(this._selectOnClickHandle){this.disconnect(this._selectOnClickHandle);}if(this.selectOnClick&&dojo.isMoz){this.textbox.selectionStart=this.textbox.selectionEnd=undefined;}this._updatePlaceHolder();},_onFocus:function(by){if(this.disabled||this.readOnly){return;}if(this.selectOnClick&&by=="mouse"){this._selectOnClickHandle=this.connect(this.domNode,"onmouseup",function(){this.disconnect(this._selectOnClickHandle);var _395;if(dojo.isIE){var _396=dojo.doc.selection.createRange();var _397=_396.parentElement();_395=_397==this.textbox&&_396.text.length==0;}else{_395=this.textbox.selectionStart==this.textbox.selectionEnd;}if(_395){dijit.selectInputText(this.textbox);}});}this._updatePlaceHolder();this.inherited(arguments);this._refreshState();},reset:function(){this.textbox.value="";this.inherited(arguments);}});dijit.selectInputText=function(_398,_399,stop){var _39a=dojo.global;var _39b=dojo.doc;_398=dojo.byId(_398);if(isNaN(_399)){_399=0;}if(isNaN(stop)){stop=_398.value?_398.value.length:0;}dijit.focus(_398);if(_39b["selection"]&&dojo.body()["createTextRange"]){if(_398.createTextRange){var r=_398.createTextRange();r.collapse(true);r.moveStart("character",-99999);r.moveStart("character",_399);r.moveEnd("character",stop-_399);r.select();}}else{if(_39a["getSelection"]){if(_398.setSelectionRange){_398.setSelectionRange(_399,stop);}}}};}if(!dojo._hasResource["dijit.Tooltip"]){dojo._hasResource["dijit.Tooltip"]=true;dojo.provide("dijit.Tooltip");dojo.declare("dijit._MasterTooltip",[dijit._Widget,dijit._Templated],{duration:dijit.defaultDuration,templateString:dojo.cache("dijit","templates/Tooltip.html","<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\"\n\t><div class=\"dijitTooltipContainer dijitTooltipContents\" dojoAttachPoint=\"containerNode\" role='alert'></div\n\t><div class=\"dijitTooltipConnector\" dojoAttachPoint=\"connectorNode\"></div\n></div>\n"),postCreate:function(){dojo.body().appendChild(this.domNode);this.bgIframe=new dijit.BackgroundIframe(this.domNode);this.fadeIn=dojo.fadeIn({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onShow")});this.fadeOut=dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onHide")});},show:function(_39c,_39d,_39e,rtl){if(this.aroundNode&&this.aroundNode===_39d){return;}this.domNode.width="auto";if(this.fadeOut.status()=="playing"){this._onDeck=arguments;return;}this.containerNode.innerHTML=_39c;var pos=dijit.placeOnScreenAroundElement(this.domNode,_39d,dijit.getPopupAroundAlignment((_39e&&_39e.length)?_39e:dijit.Tooltip.defaultPosition,!rtl),dojo.hitch(this,"orient"));dojo.style(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=true;this.aroundNode=_39d;},orient:function(node,_39f,_3a0,_3a1,_3a2){this.connectorNode.style.top="";var _3a3=_3a1.w-this.connectorNode.offsetWidth;node.className="dijitTooltip "+{"BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_39f+"-"+_3a0];this.domNode.style.width="auto";var size=dojo.contentBox(this.domNode);var _3a4=Math.min((Math.max(_3a3,1)),size.w);var _3a5=_3a4<size.w;this.domNode.style.width=_3a4+"px";if(_3a5){this.containerNode.style.overflow="auto";var _3a6=this.containerNode.scrollWidth;this.containerNode.style.overflow="visible";if(_3a6>_3a4){_3a6=_3a6+dojo.style(this.domNode,"paddingLeft")+dojo.style(this.domNode,"paddingRight");this.domNode.style.width=_3a6+"px";}}if(_3a0.charAt(0)=="B"&&_39f.charAt(0)=="B"){var mb=dojo.marginBox(node);var _3a7=this.connectorNode.offsetHeight;if(mb.h>_3a1.h){var _3a8=_3a1.h-(_3a2.h/2)-(_3a7/2);this.connectorNode.style.top=_3a8+"px";this.connectorNode.style.bottom="";}else{this.connectorNode.style.bottom=Math.min(Math.max(_3a2.h/2-_3a7/2,0),mb.h-_3a7)+"px";this.connectorNode.style.top="";}}else{this.connectorNode.style.top="";this.connectorNode.style.bottom="";}return Math.max(0,size.w-_3a3);},_onShow:function(){if(dojo.isIE){this.domNode.style.filter="";}},hide:function(_3a9){if(this._onDeck&&this._onDeck[1]==_3a9){this._onDeck=null;}else{if(this.aroundNode===_3a9){this.fadeIn.stop();this.isShowingNow=false;this.aroundNode=null;this.fadeOut.play();}else{}}},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";if(this._onDeck){this.show.apply(this,this._onDeck);this._onDeck=null;}}});dijit.showTooltip=function(_3aa,_3ab,_3ac,rtl){if(!dijit._masterTT){dijit._masterTT=new dijit._MasterTooltip();}return dijit._masterTT.show(_3aa,_3ab,_3ac,rtl);};dijit.hideTooltip=function(_3ad){if(!dijit._masterTT){dijit._masterTT=new dijit._MasterTooltip();}return dijit._masterTT.hide(_3ad);};dojo.declare("dijit.Tooltip",dijit._Widget,{label:"",showDelay:400,connectId:[],position:[],_setConnectIdAttr:function(_3ae){dojo.forEach(this._connections||[],function(_3af){dojo.forEach(_3af,dojo.hitch(this,"disconnect"));},this);var ary=dojo.isArrayLike(_3ae)?_3ae:(_3ae?[_3ae]:[]);this._connections=dojo.map(ary,function(id){var node=dojo.byId(id);return node?[this.connect(node,"onmouseenter","_onTargetMouseEnter"),this.connect(node,"onmouseleave","_onTargetMouseLeave"),this.connect(node,"onfocus","_onTargetFocus"),this.connect(node,"onblur","_onTargetBlur")]:[];},this);this._set("connectId",_3ae);this._connectIds=ary;},addTarget:function(node){var id=node.id||node;if(dojo.indexOf(this._connectIds,id)==-1){this.set("connectId",this._connectIds.concat(id));}},removeTarget:function(node){var id=node.id||node,idx=dojo.indexOf(this._connectIds,id);if(idx>=0){this._connectIds.splice(idx,1);this.set("connectId",this._connectIds);}},buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitTooltipData");},startup:function(){this.inherited(arguments);var ids=this.connectId;dojo.forEach(dojo.isArrayLike(ids)?ids:[ids],this.addTarget,this);},_onTargetMouseEnter:function(e){this._onHover(e);},_onTargetMouseLeave:function(e){this._onUnHover(e);},_onTargetFocus:function(e){this._focus=true;this._onHover(e);},_onTargetBlur:function(e){this._focus=false;this._onUnHover(e);},_onHover:function(e){if(!this._showTimer){var _3b0=e.target;this._showTimer=setTimeout(dojo.hitch(this,function(){this.open(_3b0);}),this.showDelay);}},_onUnHover:function(e){if(this._focus){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.close();},open:function(_3b1){if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}dijit.showTooltip(this.label||this.domNode.innerHTML,_3b1,this.position,!this.isLeftToRight());this._connectNode=_3b1;this.onShow(_3b1,this.position);},close:function(){if(this._connectNode){dijit.hideTooltip(this._connectNode);delete this._connectNode;this.onHide();}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},onShow:function(_3b2,_3b3){},onHide:function(){},uninitialize:function(){this.close();this.inherited(arguments);}});dijit.Tooltip.defaultPosition=["after","before"];}if(!dojo._hasResource["dijit.form.ValidationTextBox"]){dojo._hasResource["dijit.form.ValidationTextBox"]=true;dojo.provide("dijit.form.ValidationTextBox");dojo.declare("dijit.form.ValidationTextBox",dijit.form.TextBox,{templateString:dojo.cache("dijit.form","templates/ValidationTextBox.html","<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class=\"dijitReset dijitInputInner\" dojoAttachPoint='textbox,focusNode' autocomplete=\"off\"\n\t\t\t${!nameAttrSetting} type='${type}'\n\t/></div\n></div>\n"),baseClass:"dijitTextBox dijitValidationTextBox",required:false,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},regExp:".*",regExpGen:function(_3b4){return this.regExp;},state:"",tooltipPosition:[],_setValueAttr:function(){this.inherited(arguments);this.validate(this._focused);},validator:function(_3b5,_3b6){return (new RegExp("^(?:"+this.regExpGen(_3b6)+")"+(this.required?"":"?")+"$")).test(_3b5)&&(!this.required||!this._isEmpty(_3b5))&&(this._isEmpty(_3b5)||this.parse(_3b5,_3b6)!==undefined);},_isValidSubset:function(){return this.textbox.value.search(this._partialre)==0;},isValid:function(_3b7){var _3b8=this.validator(this.textbox.value,this.constraints);return _3b8;},_isEmpty:function(_3b9){var _3ba=(this.trim?/^\s*$/:/^$/).test(_3b9);return (this.trim?/^\s*$/:/^$/).test(_3b9);},getErrorMessage:function(_3bb){return (this.required&&this._isEmpty(this.textbox.value))?this.missingMessage:this.invalidMessage;},getPromptMessage:function(_3bc){return this.promptMessage;},_maskValidSubsetError:true,validate:function(_3bd){var _3be="";var _3bf=this.disabled||this.isValid(_3bd);if(_3bf){this._maskValidSubsetError=true;}var _3c0=this._isEmpty(this.textbox.value);var _3c1=!_3bf&&_3bd&&this._isValidSubset();this._set("state",_3bf?"":(((((!this._hasBeenBlurred||_3bd)&&_3c0)||_3c1)&&this._maskValidSubsetError)?"Incomplete":"Error"));dijit.setWaiState(this.focusNode,"invalid",_3bf?"false":"true");if(this.state=="Error"){this._maskValidSubsetError=_3bd&&_3c1;_3be=this.getErrorMessage(_3bd);}else{if(this.state=="Incomplete"){_3be=this.getPromptMessage(_3bd);this._maskValidSubsetError=!this._hasBeenBlurred||_3bd;}else{if(_3c0){_3be=this.getPromptMessage(_3bd);}}}this.set("message",_3be);return _3bf;},displayMessage:function(_3c2){dijit.hideTooltip(this.domNode);if(_3c2&&this._focused){dijit.showTooltip(_3c2,this.domNode,this.tooltipPosition,!this.isLeftToRight());}},_refreshState:function(){this.validate(this._focused);this.inherited(arguments);},constructor:function(){this.constraints={};},_setConstraintsAttr:function(_3c3){if(!_3c3.locale&&this.lang){_3c3.locale=this.lang;}this._set("constraints",_3c3);this._computePartialRE();},_computePartialRE:function(){var p=this.regExpGen(this.constraints);this.regExp=p;var _3c4="";if(p!=".*"){this.regExp.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(re){switch(re.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":_3c4+=re;break;case ")":_3c4+="|$)";break;default:_3c4+="(?:"+re+"|$)";break;}});}try{"".search(_3c4);}catch(e){_3c4=this.regExp;console.warn("RegExp error in "+this.declaredClass+": "+this.regExp);}this._partialre="^(?:"+_3c4+")$";},postMixInProperties:function(){this.inherited(arguments);this.messages=dojo.i18n.getLocalization("dijit.form","validate",this.lang);if(this.invalidMessage=="$_unset_$"){this.invalidMessage=this.messages.invalidMessage;}if(!this.invalidMessage){this.invalidMessage=this.promptMessage;}if(this.missingMessage=="$_unset_$"){this.missingMessage=this.messages.missingMessage;}if(!this.missingMessage){this.missingMessage=this.invalidMessage;}this._setConstraintsAttr(this.constraints);},_setDisabledAttr:function(_3c5){this.inherited(arguments);this._refreshState();},_setRequiredAttr:function(_3c6){this._set("required",_3c6);dijit.setWaiState(this.focusNode,"required",_3c6);this._refreshState();},_setMessageAttr:function(_3c7){this._set("message",_3c7);this.displayMessage(_3c7);},reset:function(){this._maskValidSubsetError=true;this.inherited(arguments);},_onBlur:function(){this.displayMessage("");this.inherited(arguments);}});dojo.declare("dijit.form.MappedTextBox",dijit.form.ValidationTextBox,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},serialize:function(val,_3c8){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.get("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=dojo.place("<input type='hidden'"+(this.name?" name='"+this.name.replace(/'/g,"&quot;")+"'":"")+"/>",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});dojo.declare("dijit.form.RangeBoundTextBox",dijit.form.MappedTextBox,{rangeMessage:"",rangeCheck:function(_3c9,_3ca){return ("min" in _3ca?(this.compare(_3c9,_3ca.min)>=0):true)&&("max" in _3ca?(this.compare(_3c9,_3ca.max)<=0):true);},isInRange:function(_3cb){return this.rangeCheck(this.get("value"),this.constraints);},_isDefinitelyOutOfRange:function(){var val=this.get("value");var _3cc=false;var _3cd=false;if("min" in this.constraints){var min=this.constraints.min;min=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min);_3cc=(typeof min=="number")&&min<0;}if("max" in this.constraints){var max=this.constraints.max;max=this.compare(val,((typeof max!="number")||max>0)?max:0);_3cd=(typeof max=="number")&&max>0;}return _3cc||_3cd;},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();},isValid:function(_3ce){return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_3ce));},getErrorMessage:function(_3cf){var v=this.get("value");if(v!==null&&v!==""&&v!==undefined&&(typeof v!="number"||!isNaN(v))&&!this.isInRange(_3cf)){return this.rangeMessage;}return this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this.rangeMessage){this.messages=dojo.i18n.getLocalization("dijit.form","validate",this.lang);this.rangeMessage=this.messages.rangeMessage;}},_setConstraintsAttr:function(_3d0){this.inherited(arguments);if(this.focusNode){if(this.constraints.min!==undefined){dijit.setWaiState(this.focusNode,"valuemin",this.constraints.min);}else{dijit.removeWaiState(this.focusNode,"valuemin");}if(this.constraints.max!==undefined){dijit.setWaiState(this.focusNode,"valuemax",this.constraints.max);}else{dijit.removeWaiState(this.focusNode,"valuemax");}}},_setValueAttr:function(_3d1,_3d2){dijit.setWaiState(this.focusNode,"valuenow",_3d1);this.inherited(arguments);}});}if(!dojo._hasResource["dijit._HasDropDown"]){dojo._hasResource["dijit._HasDropDown"]=true;dojo.provide("dijit._HasDropDown");dojo.declare("dijit._HasDropDown",null,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:true,forceWidth:false,maxHeight:0,dropDownPosition:["below","above"],_stopClickEvents:true,_onDropDownMouseDown:function(e){if(this.disabled||this.readOnly){return;}dojo.stopEvent(e);this._docHandler=this.connect(dojo.doc,"onmouseup","_onDropDownMouseUp");this.toggleDropDown();},_onDropDownMouseUp:function(e){if(e&&this._docHandler){this.disconnect(this._docHandler);}var _3d3=this.dropDown,_3d4=false;if(e&&this._opened){var c=dojo.position(this._buttonNode,true);if(!(e.pageX>=c.x&&e.pageX<=c.x+c.w)||!(e.pageY>=c.y&&e.pageY<=c.y+c.h)){var t=e.target;while(t&&!_3d4){if(dojo.hasClass(t,"dijitPopup")){_3d4=true;}else{t=t.parentNode;}}if(_3d4){t=e.target;if(_3d3.onItemClick){var _3d5;while(t&&!(_3d5=dijit.byNode(t))){t=t.parentNode;}if(_3d5&&_3d5.onClick&&_3d5.getParent){_3d5.getParent().onItemClick(_3d5,e);}}return;}}}if(this._opened&&_3d3.focus&&_3d3.autoFocus!==false){window.setTimeout(dojo.hitch(_3d3,"focus"),1);}},_onDropDownClick:function(e){if(this._stopClickEvents){dojo.stopEvent(e);}},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var _3d6={"after":this.isLeftToRight()?"Right":"Left","before":this.isLeftToRight()?"Left":"Right","above":"Up","below":"Down","left":"Left","right":"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";dojo.addClass(this._arrowWrapperNode||this._buttonNode,"dijit"+_3d6+"ArrowButton");},postCreate:function(){this.inherited(arguments);this.connect(this._buttonNode,"onmousedown","_onDropDownMouseDown");this.connect(this._buttonNode,"onclick","_onDropDownClick");this.connect(this.focusNode,"onkeypress","_onKey");this.connect(this.focusNode,"onkeyup","_onKeyUp");},destroy:function(){if(this.dropDown){if(!this.dropDown._destroyed){this.dropDown.destroyRecursive();}delete this.dropDown;}this.inherited(arguments);},_onKey:function(e){if(this.disabled||this.readOnly){return;}var d=this.dropDown,_3d7=e.target;if(d&&this._opened&&d.handleKey){if(d.handleKey(e)===false){dojo.stopEvent(e);return;}}if(d&&this._opened&&e.charOrCode==dojo.keys.ESCAPE){this.closeDropDown();dojo.stopEvent(e);}else{if(!this._opened&&(e.charOrCode==dojo.keys.DOWN_ARROW||((e.charOrCode==dojo.keys.ENTER||e.charOrCode==" ")&&((_3d7.tagName||"").toLowerCase()!=="input"||(_3d7.type&&_3d7.type.toLowerCase()!=="text"))))){this._toggleOnKeyUp=true;dojo.stopEvent(e);}}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var d=this.dropDown;if(d&&d.focus){setTimeout(dojo.hitch(d,"focus"),1);}}},_onBlur:function(){var _3d8=dijit._curFocus&&this.dropDown&&dojo.isDescendant(dijit._curFocus,this.dropDown.domNode);this.closeDropDown(_3d8);this.inherited(arguments);},isLoaded:function(){return true;},loadDropDown:function(_3d9){_3d9();},toggleDropDown:function(){if(this.disabled||this.readOnly){return;}if(!this._opened){if(!this.isLoaded()){this.loadDropDown(dojo.hitch(this,"openDropDown"));return;}else{this.openDropDown();}}else{this.closeDropDown();}},openDropDown:function(){var _3da=this.dropDown,_3db=_3da.domNode,_3dc=this._aroundNode||this.domNode,self=this;if(!this._preparedNode){this._preparedNode=true;if(_3db.style.width){this._explicitDDWidth=true;}if(_3db.style.height){this._explicitDDHeight=true;}}if(this.maxHeight||this.forceWidth||this.autoWidth){var _3dd={display:"",visibility:"hidden"};if(!this._explicitDDWidth){_3dd.width="";}if(!this._explicitDDHeight){_3dd.height="";}dojo.style(_3db,_3dd);var _3de=this.maxHeight;if(_3de==-1){var _3df=dojo.window.getBox(),_3e0=dojo.position(_3dc,false);_3de=Math.floor(Math.max(_3e0.y,_3df.h-(_3e0.y+_3e0.h)));}if(_3da.startup&&!_3da._started){_3da.startup();}dijit.popup.moveOffScreen(_3da);var mb=dojo._getMarginSize(_3db);var _3e1=(_3de&&mb.h>_3de);dojo.style(_3db,{overflowX:"hidden",overflowY:_3e1?"auto":"hidden"});if(_3e1){mb.h=_3de;if("w" in mb){mb.w+=16;}}else{delete mb.h;}if(this.forceWidth){mb.w=_3dc.offsetWidth;}else{if(this.autoWidth){mb.w=Math.max(mb.w,_3dc.offsetWidth);}else{delete mb.w;}}if(dojo.isFunction(_3da.resize)){_3da.resize(mb);}else{dojo.marginBox(_3db,mb);}}var _3e2=dijit.popup.open({parent:this,popup:_3da,around:_3dc,orient:dijit.getPopupAroundAlignment((this.dropDownPosition&&this.dropDownPosition.length)?this.dropDownPosition:["below"],this.isLeftToRight()),onExecute:function(){self.closeDropDown(true);},onCancel:function(){self.closeDropDown(true);},onClose:function(){dojo.attr(self._popupStateNode,"popupActive",false);dojo.removeClass(self._popupStateNode,"dijitHasDropDownOpen");self._opened=false;}});dojo.attr(this._popupStateNode,"popupActive","true");dojo.addClass(self._popupStateNode,"dijitHasDropDownOpen");this._opened=true;return _3e2;},closeDropDown:function(_3e3){if(this._opened){if(_3e3){this.focus();}dijit.popup.close(this.dropDown);this._opened=false;}}});}if(!dojo._hasResource["dijit.form.ComboBox"]){dojo._hasResource["dijit.form.ComboBox"]=true;dojo.provide("dijit.form.ComboBox");dojo.declare("dijit.form.ComboBoxMixin",dijit._HasDropDown,{item:null,pageSize:Infinity,store:null,fetchProperties:{},query:{},autoComplete:true,highlightMatch:"first",searchDelay:100,searchAttr:"name",labelAttr:"",labelType:"text",queryExpr:"${0}*",ignoreCase:true,hasDownArrow:true,templateString:dojo.cache("dijit.form","templates/DropDownBox.html","<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdojoAttachPoint=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdojoAttachPoint=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"),baseClass:"dijitTextBox dijitComboBox",dropDownClass:"dijit.form._ComboBoxMenu",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_3e4){var pos=0;if(typeof (_3e4.selectionStart)=="number"){pos=_3e4.selectionStart;}else{if(dojo.isIE){var tr=dojo.doc.selection.createRange().duplicate();var ntr=_3e4.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_3e5,_3e6){_3e6=parseInt(_3e6);dijit.selectInputText(_3e5,_3e6,_3e6);},_setDisabledAttr:function(_3e7){this.inherited(arguments);dijit.setWaiState(this.domNode,"disabled",_3e7);},_abortQuery:function(){if(this.searchTimer){clearTimeout(this.searchTimer);this.searchTimer=null;}if(this._fetchHandle){if(this._fetchHandle.abort){this._fetchHandle.abort();}this._fetchHandle=null;}},_onInput:function(evt){if(!this.searchTimer&&(evt.type=="paste"||evt.type=="input")&&this._lastInput!=this.textbox.value){this.searchTimer=setTimeout(dojo.hitch(this,function(){this._onKey({charOrCode:229});}),100);}this.inherited(arguments);},_onKey:function(evt){var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==dojo.keys.SHIFT){return;}var _3e8=false;var pw=this.dropDown;var dk=dojo.keys;var _3e9=null;this._prev_key_backspace=false;this._abortQuery();this.inherited(arguments);if(this._opened){_3e9=pw.getHighlightedOption();}switch(key){case dk.PAGE_DOWN:case dk.DOWN_ARROW:case dk.PAGE_UP:case dk.UP_ARROW:if(this._opened){this._announceOption(_3e9);}dojo.stopEvent(evt);break;case dk.ENTER:if(_3e9){if(_3e9==pw.nextButton){this._nextSearch(1);dojo.stopEvent(evt);break;}else{if(_3e9==pw.previousButton){this._nextSearch(-1);dojo.stopEvent(evt);break;}}}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}if(this._opened||this._fetchHandle){evt.preventDefault();}case dk.TAB:var _3ea=this.get("displayedValue");if(pw&&(_3ea==pw._messages["previousMessage"]||_3ea==pw._messages["nextMessage"])){break;}if(_3e9){this._selectOption();}if(this._opened){this._lastQuery=null;this.closeDropDown();}break;case " ":if(_3e9){dojo.stopEvent(evt);this._selectOption();this.closeDropDown();}else{_3e8=true;}break;case dk.DELETE:case dk.BACKSPACE:this._prev_key_backspace=true;_3e8=true;break;default:_3e8=typeof key=="string"||key==229;}if(_3e8){this.item=undefined;this.searchTimer=setTimeout(dojo.hitch(this,"_startSearchFromInput"),1);}},_autoCompleteText:function(text){var fn=this.focusNode;dijit.selectInputText(fn,fn.value.length);var _3eb=this.ignoreCase?"toLowerCase":"substr";if(text[_3eb](0).indexOf(this.focusNode.value[_3eb](0))==0){var cpos=this._getCaretPos(fn);if((cpos+1)>fn.value.length){fn.value=text;dijit.selectInputText(fn,cpos);}}else{fn.value=text;dijit.selectInputText(fn);}},_openResultList:function(_3ec,_3ed){this._fetchHandle=null;if(this.disabled||this.readOnly||(_3ed.query[this.searchAttr]!=this._lastQuery)){return;}var _3ee=this.dropDown._highlighted_option&&dojo.hasClass(this.dropDown._highlighted_option,"dijitMenuItemSelected");this.dropDown.clearResultList();if(!_3ec.length&&!this._maxOptions){this.closeDropDown();return;}_3ed._maxOptions=this._maxOptions;var _3ef=this.dropDown.createOptions(_3ec,_3ed,dojo.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if(_3ed.direction){if(1==_3ed.direction){this.dropDown.highlightFirstOption();}else{if(-1==_3ed.direction){this.dropDown.highlightLastOption();}}if(_3ee){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_3ed.query[this.searchAttr])){this._announceOption(_3ef[1]);}}},_showResultList:function(){this.closeDropDown(true);this.displayMessage("");this.openDropDown();dijit.setWaiState(this.domNode,"expanded","true");},loadDropDown:function(_3f0){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);dijit.setWaiState(this.domNode,"expanded","false");dijit.removeWaiState(this.focusNode,"activedescendant");}},_setBlurValue:function(){var _3f1=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_3f1==pw._messages["previousMessage"]||_3f1==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_3f1);}else{if(this.value!=this._lastValueReported){dijit.form._FormValueWidget.prototype._setValueAttr.call(this,this.value,true);}this._refreshState();}}},_onBlur:function(){this.closeDropDown();this.inherited(arguments);},_setItemAttr:function(item,_3f2,_3f3){if(!_3f3){_3f3=this.store.getValue(item,this.searchAttr);}var _3f4=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_3f3;this._set("item",item);dijit.form.ComboBox.superclass._setValueAttr.call(this,_3f4,_3f2,_3f3);},_announceOption:function(node){if(!node){return;}var _3f5;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_3f5=node.innerHTML;this.item=undefined;this.value="";}else{_3f5=this.store.getValue(node.item,this.searchAttr).toString();this.set("item",node.item,false,_3f5);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);dijit.setWaiState(this.focusNode,"activedescendant",dojo.attr(node,"id"));this._autoCompleteText(_3f5);},_selectOption:function(evt){if(evt){this._announceOption(evt.target);}this.closeDropDown();this._setCaretPos(this.focusNode,this.focusNode.value.length);dijit.form._FormValueWidget.prototype._setValueAttr.call(this,this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_getQueryString:function(text){return dojo.string.substitute(this.queryExpr,[text]);},_startSearch:function(key){if(!this.dropDown){var _3f6=this.id+"_popup",_3f7=dojo.getObject(this.dropDownClass,false);this.dropDown=new _3f7({onChange:dojo.hitch(this,this._selectOption),id:_3f6,dir:this.dir});dijit.removeWaiState(this.focusNode,"activedescendant");dijit.setWaiState(this.textbox,"owns",_3f6);}var _3f8=dojo.clone(this.query);this._lastInput=key;this._lastQuery=_3f8[this.searchAttr]=this._getQueryString(key);this.searchTimer=setTimeout(dojo.hitch(this,function(_3f9,_3fa){this.searchTimer=null;var _3fb={queryOptions:{ignoreCase:this.ignoreCase,deep:true},query:_3f9,onBegin:dojo.hitch(this,"_setMaxOptions"),onComplete:dojo.hitch(this,"_openResultList"),onError:function(_3fc){_3fa._fetchHandle=null;console.error("dijit.form.ComboBox: "+_3fc);_3fa.closeDropDown();},start:0,count:this.pageSize};dojo.mixin(_3fb,_3fa.fetchProperties);this._fetchHandle=_3fa.store.fetch(_3fb);var _3fd=function(_3fe,_3ff){_3fe.start+=_3fe.count*_3ff;_3fe.direction=_3ff;this._fetchHandle=this.store.fetch(_3fe);this.focus();};this._nextSearch=this.dropDown.onPage=dojo.hitch(this,_3fd,this._fetchHandle);},_3f8,this),this.searchDelay);},_setMaxOptions:function(size,_400){this._maxOptions=size;},_getValueField:function(){return this.searchAttr;},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var _401=this.srcNodeRef;this.store=new dijit.form._ComboBoxDataStore(_401);if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _402=this._getValueField();this.value=this.store.getValue(item,_402);}}}this.inherited(arguments);},postCreate:function(){var _403=dojo.query("label[for=\""+this.id+"\"]");if(_403.length){_403[0].id=(this.id+"_label");dijit.setWaiState(this.domNode,"labelledby",_403[0].id);}this.inherited(arguments);},_setHasDownArrowAttr:function(val){this.hasDownArrow=val;this._buttonNode.style.display=val?"":"none";},_getMenuLabelFromItem:function(item){var _404=this.labelFunc(item,this.store),_405=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_404=this.doHighlight(_404,this._escapeHtml(this._lastInput));_405="html";}return {html:_405=="html",label:_404};},doHighlight:function(_406,find){var _407=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");find=dojo.regexp.escapeString(find);return this._escapeHtml(_406).replace(new RegExp((i==0?"^":"")+"("+find+")"+(i==(this.queryExpr.length-4)?"$":""),_407),"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,_408){return _408.getValue(item,this.labelAttr||this.searchAttr).toString();}});dojo.declare("dijit.form._ComboBoxMenu",[dijit._Widget,dijit._Templated,dijit._CssStateMixin],{templateString:"<ul class='dijitReset dijitMenu' dojoAttachEvent='onmousedown:_onMouseDown,onmouseup:_onMouseUp,onmouseover:_onMouseOver,onmouseout:_onMouseOut' style='overflow: \"auto\"; overflow-x: \"hidden\";'>"+"<li class='dijitMenuItem dijitMenuPreviousButton' dojoAttachPoint='previousButton' role='option'></li>"+"<li class='dijitMenuItem dijitMenuNextButton' dojoAttachPoint='nextButton' role='option'></li>"+"</ul>",_messages:null,baseClass:"dijitComboBoxMenu",postMixInProperties:function(){this.inherited(arguments);this._messages=dojo.i18n.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_409){this.value=_409;this.onChange(_409);},onChange:function(_40a){},onPage:function(_40b){},onClose:function(){this._blurOptionNode();},_createOption:function(item,_40c){var _40d=dojo.create("li",{"class":"dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl"),role:"option"});var _40e=_40c(item);if(_40e.html){_40d.innerHTML=_40e.label;}else{_40d.appendChild(dojo.doc.createTextNode(_40e.label));}if(_40d.innerHTML==""){_40d.innerHTML="&nbsp;";}_40d.item=item;return _40d;},createOptions:function(_40f,_410,_411){this.previousButton.style.display=(_410.start==0)?"none":"";dojo.attr(this.previousButton,"id",this.id+"_prev");dojo.forEach(_40f,function(item,i){var _412=this._createOption(item,_411);dojo.attr(_412,"id",this.id+i);this.domNode.insertBefore(_412,this.nextButton);},this);var _413=false;if(_410._maxOptions&&_410._maxOptions!=-1){if((_410.start+_410.count)<_410._maxOptions){_413=true;}else{if((_410.start+_410.count)>_410._maxOptions&&_410.count==_40f.length){_413=true;}}}else{if(_410.count==_40f.length){_413=true;}}this.nextButton.style.display=_413?"":"none";dojo.attr(this.nextButton,"id",this.id+"_next");return this.domNode.childNodes;},clearResultList:function(){while(this.domNode.childNodes.length>2){this.domNode.removeChild(this.domNode.childNodes[this.domNode.childNodes.length-2]);}this._blurOptionNode();},_onMouseDown:function(evt){dojo.stopEvent(evt);},_onMouseUp:function(evt){if(evt.target===this.domNode||!this._highlighted_option){return;}else{if(evt.target==this.previousButton){this._blurOptionNode();this.onPage(-1);}else{if(evt.target==this.nextButton){this._blurOptionNode();this.onPage(1);}else{var tgt=evt.target;while(!tgt.item){tgt=tgt.parentNode;}this._setValueAttr({target:tgt},true);}}}},_onMouseOver:function(evt){if(evt.target===this.domNode){return;}var tgt=evt.target;if(!(tgt==this.previousButton||tgt==this.nextButton)){while(!tgt.item){tgt=tgt.parentNode;}}this._focusOptionNode(tgt);},_onMouseOut:function(evt){if(evt.target===this.domNode){return;}this._blurOptionNode();},_focusOptionNode:function(node){if(this._highlighted_option!=node){this._blurOptionNode();this._highlighted_option=node;dojo.addClass(this._highlighted_option,"dijitMenuItemSelected");}},_blurOptionNode:function(){if(this._highlighted_option){dojo.removeClass(this._highlighted_option,"dijitMenuItemSelected");this._highlighted_option=null;}},_highlightNextOption:function(){if(!this.getHighlightedOption()){var fc=this.domNode.firstChild;this._focusOptionNode(fc.style.display=="none"?fc.nextSibling:fc);}else{var ns=this._highlighted_option.nextSibling;if(ns&&ns.style.display!="none"){this._focusOptionNode(ns);}else{this.highlightFirstOption();}}dojo.window.scrollIntoView(this._highlighted_option);},highlightFirstOption:function(){var _414=this.domNode.firstChild;var _415=_414.nextSibling;this._focusOptionNode(_415.style.display=="none"?_414:_415);dojo.window.scrollIntoView(this._highlighted_option);},highlightLastOption:function(){this._focusOptionNode(this.domNode.lastChild.previousSibling);dojo.window.scrollIntoView(this._highlighted_option);},_highlightPrevOption:function(){if(!this.getHighlightedOption()){var lc=this.domNode.lastChild;this._focusOptionNode(lc.style.display=="none"?lc.previousSibling:lc);}else{var ps=this._highlighted_option.previousSibling;if(ps&&ps.style.display!="none"){this._focusOptionNode(ps);}else{this.highlightLastOption();}}dojo.window.scrollIntoView(this._highlighted_option);},_page:function(up){var _416=0;var _417=this.domNode.scrollTop;var _418=dojo.style(this.domNode,"height");if(!this.getHighlightedOption()){this._highlightNextOption();}while(_416<_418){if(up){if(!this.getHighlightedOption().previousSibling||this._highlighted_option.previousSibling.style.display=="none"){break;}this._highlightPrevOption();}else{if(!this.getHighlightedOption().nextSibling||this._highlighted_option.nextSibling.style.display=="none"){break;}this._highlightNextOption();}var _419=this.domNode.scrollTop;_416+=(_419-_417)*(up?-1:1);_417=_419;}},pageUp:function(){this._page(true);},pageDown:function(){this._page(false);},getHighlightedOption:function(){var ho=this._highlighted_option;return (ho&&ho.parentNode)?ho:null;},handleKey:function(evt){switch(evt.charOrCode){case dojo.keys.DOWN_ARROW:this._highlightNextOption();return false;case dojo.keys.PAGE_DOWN:this.pageDown();return false;case dojo.keys.UP_ARROW:this._highlightPrevOption();return false;case dojo.keys.PAGE_UP:this.pageUp();return false;default:return true;}}});dojo.declare("dijit.form.ComboBox",[dijit.form.ValidationTextBox,dijit.form.ComboBoxMixin],{_setValueAttr:function(_41a,_41b,_41c){this._set("item",null);if(!_41a){_41a="";}dijit.form.ValidationTextBox.prototype._setValueAttr.call(this,_41a,_41b,_41c);}});dojo.declare("dijit.form._ComboBoxDataStore",null,{constructor:function(root){this.root=root;if(root.tagName!="SELECT"&&root.firstChild){root=dojo.query("select",root);if(root.length>0){root=root[0];}else{this.root.innerHTML="<SELECT>"+this.root.innerHTML+"</SELECT>";root=this.root.firstChild;}this.root=root;}dojo.query("> option",root).forEach(function(node){node.innerHTML=dojo.trim(node.innerHTML);});},getValue:function(item,_41d,_41e){return (_41d=="value")?item.value:(item.innerText||item.textContent||"");},isItemLoaded:function(_41f){return true;},getFeatures:function(){return {"dojo.data.api.Read":true,"dojo.data.api.Identity":true};},_fetchItems:function(args,_420,_421){if(!args.query){args.query={};}if(!args.query.name){args.query.name="";}if(!args.queryOptions){args.queryOptions={};}var _422=dojo.data.util.filter.patternToRegExp(args.query.name,args.queryOptions.ignoreCase),_423=dojo.query("> option",this.root).filter(function(_424){return (_424.innerText||_424.textContent||"").match(_422);});if(args.sort){_423.sort(dojo.data.util.sorter.createSortFunction(args.sort,this));}_420(_423,args);},close:function(_425){return;},getLabel:function(item){return item.innerHTML;},getIdentity:function(item){return dojo.attr(item,"value");},fetchItemByIdentity:function(args){var item=dojo.query("> option[value='"+args.identity+"']",this.root)[0];args.onItem(item);},fetchSelectedItem:function(){var root=this.root,si=root.selectedIndex;return typeof si=="number"?dojo.query("> option:nth-child("+(si!=-1?si+1:1)+")",root)[0]:null;}});dojo.extend(dijit.form._ComboBoxDataStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["dijit._Contained"]){dojo._hasResource["dijit._Contained"]=true;dojo.provide("dijit._Contained");dojo.declare("dijit._Contained",null,{getParent:function(){var _426=dijit.getEnclosingWidget(this.domNode.parentNode);return _426&&_426.isContainer?_426:null;},_getSibling:function(_427){var node=this.domNode;do{node=node[_427+"Sibling"];}while(node&&node.nodeType!=1);return node&&dijit.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});}if(!dojo._hasResource["dijit._Container"]){dojo._hasResource["dijit._Container"]=true;dojo.provide("dijit._Container");dojo.declare("dijit._Container",null,{isContainer:true,buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},addChild:function(_428,_429){var _42a=this.containerNode;if(_429&&typeof _429=="number"){var _42b=this.getChildren();if(_42b&&_42b.length>=_429){_42a=_42b[_429-1].domNode;_429="after";}}dojo.place(_428.domNode,_42a,_429);if(this._started&&!_428._started){_428.startup();}},removeChild:function(_42c){if(typeof _42c=="number"){_42c=this.getChildren()[_42c];}if(_42c){var node=_42c.domNode;if(node&&node.parentNode){node.parentNode.removeChild(node);}}},hasChildren:function(){return this.getChildren().length>0;},destroyDescendants:function(_42d){dojo.forEach(this.getChildren(),function(_42e){_42e.destroyRecursive(_42d);});},_getSiblingOfChild:function(_42f,dir){var node=_42f.domNode,_430=(dir>0?"nextSibling":"previousSibling");do{node=node[_430];}while(node&&(node.nodeType!=1||!dijit.byNode(node)));return node&&dijit.byNode(node);},getIndexOfChild:function(_431){return dojo.indexOf(this.getChildren(),_431);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(_432){_432.startup();});this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout._LayoutWidget"]){dojo._hasResource["dijit.layout._LayoutWidget"]=true;dojo.provide("dijit.layout._LayoutWidget");dojo.declare("dijit.layout._LayoutWidget",[dijit._Widget,dijit._Container,dijit._Contained],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitContainer");},startup:function(){if(this._started){return;}this.inherited(arguments);var _433=this.getParent&&this.getParent();if(!(_433&&_433.isLayoutContainer)){this.resize();this.connect(dojo.isIE?this.domNode:dojo.global,"onresize",function(){this.resize();});}},resize:function(_434,_435){var node=this.domNode;if(_434){dojo.marginBox(node,_434);if(_434.t){node.style.top=_434.t+"px";}if(_434.l){node.style.left=_434.l+"px";}}var mb=_435||{};dojo.mixin(mb,_434||{});if(!("h" in mb)||!("w" in mb)){mb=dojo.mixin(dojo.marginBox(node),mb);}var cs=dojo.getComputedStyle(node);var me=dojo._getMarginExtents(node,cs);var be=dojo._getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=dojo._getPadExtents(node,cs);this._contentBox={l:dojo._toPixelValue(node,cs.paddingLeft),t:dojo._toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_436){var cls=this.baseClass+"-child "+(_436.baseClass?this.baseClass+"-"+_436.baseClass:"");dojo.addClass(_436.domNode,cls);},addChild:function(_437,_438){this.inherited(arguments);if(this._started){this._setupChild(_437);}},removeChild:function(_439){var cls=this.baseClass+"-child"+(_439.baseClass?" "+this.baseClass+"-"+_439.baseClass:"");dojo.removeClass(_439.domNode,cls);this.inherited(arguments);}});dijit.layout.marginBox2contentBox=function(node,mb){var cs=dojo.getComputedStyle(node);var me=dojo._getMarginExtents(node,cs);var pb=dojo._getPadBorderExtents(node,cs);return {l:dojo._toPixelValue(node,cs.paddingLeft),t:dojo._toPixelValue(node,cs.paddingTop),w:mb.w-(me.w+pb.w),h:mb.h-(me.h+pb.h)};};(function(){var _43a=function(word){if(word==null){return "";}return word.substring(0,1).toUpperCase()+word.substring(1);};var size=function(_43b,dim){var _43c=_43b.resize?_43b.resize(dim):dojo.marginBox(_43b.domNode,dim);if(_43c){dojo.mixin(_43b,_43c);}else{dojo.mixin(_43b,dojo.marginBox(_43b.domNode));dojo.mixin(_43b,dim);}};dijit.layout.layoutChildren=function(_43d,dim,_43e,_43f,_440){dim=dojo.mixin({},dim);dojo.addClass(_43d,"dijitLayoutContainer");_43e=dojo.filter(_43e,function(item){return item.region!="center"&&item.layoutAlign!="client";}).concat(dojo.filter(_43e,function(item){return item.region=="center"||item.layoutAlign=="client";}));dojo.forEach(_43e,function(_441){var elm=_441.domNode,pos=(_441.region||_441.layoutAlign);var _442=elm.style;_442.left=dim.l+"px";_442.top=dim.t+"px";_442.position="absolute";dojo.addClass(elm,"dijitAlign"+_43a(pos));var _443={};if(_43f&&_43f==_441.id){_443[_441.region=="top"||_441.region=="bottom"?"h":"w"]=_440;}if(pos=="top"||pos=="bottom"){_443.w=dim.w;size(_441,_443);dim.h-=_441.h;if(pos=="top"){dim.t+=_441.h;}else{_442.top=dim.t+dim.h+"px";}}else{if(pos=="left"||pos=="right"){_443.h=dim.h;size(_441,_443);dim.w-=_441.w;if(pos=="left"){dim.l+=_441.w;}else{_442.left=dim.l+dim.w+"px";}}else{if(pos=="client"||pos=="center"){size(_441,dim);}}}});};})();}if(!dojo._hasResource["dijit.layout._ContentPaneResizeMixin"]){dojo._hasResource["dijit.layout._ContentPaneResizeMixin"]=true;dojo.provide("dijit.layout._ContentPaneResizeMixin");dojo.declare("dijit.layout._ContentPaneResizeMixin",null,{doLayout:true,isContainer:true,isLayoutContainer:true,_startChildren:function(){dojo.forEach(this.getChildren(),function(_444){_444.startup();_444._started=true;});},startup:function(){if(this._started){return;}var _445=dijit._Contained.prototype.getParent.call(this);this._childOfLayoutWidget=_445&&_445.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._startChildren();if(this._isShown()){this._onShow();}if(!this._childOfLayoutWidget){this.connect(dojo.isIE?this.domNode:dojo.global,"onresize",function(){this._needLayout=!this._childOfLayoutWidget;this.resize();});}},_checkIfSingleChild:function(){var _446=dojo.query("> *",this.containerNode).filter(function(node){return node.tagName!=="SCRIPT";}),_447=_446.filter(function(node){return dojo.hasAttr(node,"data-dojo-type")||dojo.hasAttr(node,"dojoType")||dojo.hasAttr(node,"widgetId");}),_448=dojo.filter(_447.map(dijit.byNode),function(_449){return _449&&_449.domNode&&_449.resize;});if(_446.length==_447.length&&_448.length==1){this._singleChild=_448[0];}else{delete this._singleChild;}dojo.toggleClass(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild);},resize:function(_44a,_44b){if(!this._wasShown&&this.open!==false){this._onShow();}this._resizeCalled=true;this._scheduleLayout(_44a,_44b);},_scheduleLayout:function(_44c,_44d){if(this._isShown()){this._layout(_44c,_44d);}else{this._needLayout=true;this._changeSize=_44c;this._resultSize=_44d;}},_layout:function(_44e,_44f){if(_44e){dojo.marginBox(this.domNode,_44e);}var cn=this.containerNode;if(cn===this.domNode){var mb=_44f||{};dojo.mixin(mb,_44e||{});if(!("h" in mb)||!("w" in mb)){mb=dojo.mixin(dojo.marginBox(cn),mb);}this._contentBox=dijit.layout.marginBox2contentBox(cn,mb);}else{this._contentBox=dojo.contentBox(cn);}this._layoutChildren();delete this._needLayout;},_layoutChildren:function(){if(this.doLayout){this._checkIfSingleChild();}if(this._singleChild&&this._singleChild.resize){var cb=this._contentBox||dojo.contentBox(this.containerNode);this._singleChild.resize({w:cb.w,h:cb.h});}else{dojo.forEach(this.getChildren(),function(_450){if(_450.resize){_450.resize();}});}},_isShown:function(){if(this._childOfLayoutWidget){if(this._resizeCalled&&"open" in this){return this.open;}return this._resizeCalled;}else{if("open" in this){return this.open;}else{var node=this.domNode,_451=this.domNode.parentNode;return (node.style.display!="none")&&(node.style.visibility!="hidden")&&!dojo.hasClass(node,"dijitHidden")&&_451&&_451.style&&(_451.style.display!="none");}}},_onShow:function(){if(this._needLayout){this._layout(this._changeSize,this._resultSize);}this.inherited(arguments);this._wasShown=true;}});}if(!dojo._hasResource["dojo.html"]){dojo._hasResource["dojo.html"]=true;dojo.provide("dojo.html");dojo.getObject("html",true,dojo);(function(){var _452=0,d=dojo;dojo.html._secureForInnerHtml=function(cont){return cont.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"");};dojo.html._emptyNode=dojo.empty;dojo.html._setNodeContent=function(node,cont){d.empty(node);if(cont){if(typeof cont=="string"){cont=d._toDom(cont,node.ownerDocument);}if(!cont.nodeType&&d.isArrayLike(cont)){for(var _453=cont.length,i=0;i<cont.length;i=_453==cont.length?i+1:0){d.place(cont[i],node,"last");}}else{d.place(cont,node,"last");}}return node;};dojo.declare("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:false,extractContent:false,parseContent:false,parserScope:dojo._scopeName,startup:true,constructor:function(_454,node){dojo.mixin(this,_454||{});node=this.node=dojo.byId(this.node||node);if(!this.id){this.id=["Setter",(node)?node.id||node.tagName:"",_452++].join("_");}},set:function(cont,_455){if(undefined!==cont){this.content=cont;}if(_455){this._mixin(_455);}this.onBegin();this.setContent();this.onEnd();return this.node;},setContent:function(){var node=this.node;if(!node){throw new Error(this.declaredClass+": setContent given no node");}try{node=dojo.html._setNodeContent(node,this.content);}catch(e){var _456=this.onContentError(e);try{node.innerHTML=_456;}catch(e){console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+e.message,e);}}this.node=node;},empty:function(){if(this.parseResults&&this.parseResults.length){dojo.forEach(this.parseResults,function(w){if(w.destroy){w.destroy();}});delete this.parseResults;}dojo.html._emptyNode(this.node);},onBegin:function(){var cont=this.content;if(dojo.isString(cont)){if(this.cleanContent){cont=dojo.html._secureForInnerHtml(cont);}if(this.extractContent){var _457=cont.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(_457){cont=_457[1];}}}this.empty();this.content=cont;return this.node;},onEnd:function(){if(this.parseContent){this._parse();}return this.node;},tearDown:function(){delete this.parseResults;delete this.node;delete this.content;},onContentError:function(err){return "Error occured setting content: "+err;},_mixin:function(_458){var _459={},key;for(key in _458){if(key in _459){continue;}this[key]=_458[key];}},_parse:function(){var _45a=this.node;try{var _45b={};dojo.forEach(["dir","lang","textDir"],function(name){if(this[name]){_45b[name]=this[name];}},this);this.parseResults=dojo.parser.parse({rootNode:_45a,noStart:!this.startup,inherited:_45b,scope:this.parserScope});}catch(e){this._onError("Content",e,"Error parsing in _ContentSetter#"+this.id);}},_onError:function(type,err,_45c){var _45d=this["on"+type+"Error"].call(this,err);if(_45c){console.error(_45c,err);}else{if(_45d){dojo.html._setNodeContent(this.node,_45d,true);}}}});dojo.html.set=function(node,cont,_45e){if(undefined==cont){console.warn("dojo.html.set: no cont argument provided, using empty string");cont="";}if(!_45e){return dojo.html._setNodeContent(node,cont,true);}else{var op=new dojo.html._ContentSetter(dojo.mixin(_45e,{content:cont,node:node}));return op.set();}};})();}if(!dojo._hasResource["dijit.layout.ContentPane"]){dojo._hasResource["dijit.layout.ContentPane"]=true;dojo.provide("dijit.layout.ContentPane");dojo.declare("dijit.layout.ContentPane",[dijit._Widget,dijit.layout._ContentPaneResizeMixin],{href:"",extractContent:false,parseOnLoad:true,parserScope:dojo._scopeName,preventCache:false,preload:false,refreshOnShow:false,loadingMessage:"<span class='dijitContentPaneLoading'>${loadingState}</span>",errorMessage:"<span class='dijitContentPaneError'>${errorState}</span>",isLoaded:false,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:[]}),stopParser:true,template:false,create:function(_45f,_460){if((!_45f||!_45f.template)&&_460&&!("href" in _45f)&&!("content" in _45f)){var df=dojo.doc.createDocumentFragment();_460=dojo.byId(_460);while(_460.firstChild){df.appendChild(_460.firstChild);}_45f=dojo.delegate(_45f,{content:df});}this.inherited(arguments,[_45f,_460]);},postMixInProperties:function(){this.inherited(arguments);var _461=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=dojo.string.substitute(this.loadingMessage,_461);this.errorMessage=dojo.string.substitute(this.errorMessage,_461);},buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}this.domNode.title="";if(!dojo.attr(this.domNode,"role")){dijit.setWaiRole(this.domNode,"group");}},_startChildren:function(){this.inherited(arguments);if(this._contentSetter){dojo.forEach(this._contentSetter.parseResults,function(obj){if(!obj._started&&!obj._destroyed&&dojo.isFunction(obj.startup)){obj.startup();obj._started=true;}},this);}},setHref:function(href){dojo.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0");return this.set("href",href);},_setHrefAttr:function(href){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this.onLoadDeferred.addCallback(dojo.hitch(this,"onLoad"));this._set("href",href);if(this.preload||(this._created&&this._isShown())){this._load();}else{this._hrefChanged=true;}return this.onLoadDeferred;},setContent:function(data){dojo.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",data);},_setContentAttr:function(data){this._set("href","");this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));if(this._created){this.onLoadDeferred.addCallback(dojo.hitch(this,"onLoad"));}this._setContent(data||"");this._isDownloaded=false;return this.onLoadDeferred;},_getContentAttr:function(){return this.containerNode.innerHTML;},cancel:function(){if(this._xhrDfd&&(this._xhrDfd.fired==-1)){this._xhrDfd.cancel();}delete this._xhrDfd;this.onLoadDeferred=null;},uninitialize:function(){if(this._beingDestroyed){this.cancel();}this.inherited(arguments);},destroyRecursive:function(_462){if(this._beingDestroyed){return;}this.inherited(arguments);},_onShow:function(){this.inherited(arguments);if(this.href){if(!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow)){return this.refresh();}}},refresh:function(){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this.onLoadDeferred.addCallback(dojo.hitch(this,"onLoad"));this._load();return this.onLoadDeferred;},_load:function(){this._setContent(this.onDownloadStart(),true);var self=this;var _463={preventCache:(this.preventCache||this.refreshOnShow),url:this.href,handleAs:"text"};if(dojo.isObject(this.ioArgs)){dojo.mixin(_463,this.ioArgs);}var hand=(this._xhrDfd=(this.ioMethod||dojo.xhrGet)(_463));hand.addCallback(function(html){try{self._isDownloaded=true;self._setContent(html,false);self.onDownloadEnd();}catch(err){self._onError("Content",err);}delete self._xhrDfd;return html;});hand.addErrback(function(err){if(!hand.canceled){self._onError("Download",err);}delete self._xhrDfd;return err;});delete this._hrefChanged;},_onLoadHandler:function(data){this._set("isLoaded",true);try{this.onLoadDeferred.callback(data);}catch(e){console.error("Error "+this.widgetId+" running custom onLoad code: "+e.message);}},_onUnloadHandler:function(){this._set("isLoaded",false);try{this.onUnload();}catch(e){console.error("Error "+this.widgetId+" running custom onUnload code: "+e.message);}},destroyDescendants:function(){if(this.isLoaded){this._onUnloadHandler();}var _464=this._contentSetter;dojo.forEach(this.getChildren(),function(_465){if(_465.destroyRecursive){_465.destroyRecursive();}});if(_464){dojo.forEach(_464.parseResults,function(_466){if(_466.destroyRecursive&&_466.domNode&&_466.domNode.parentNode==dojo.body()){_466.destroyRecursive();}});delete _464.parseResults;}dojo.html._emptyNode(this.containerNode);delete this._singleChild;},_setContent:function(cont,_467){this.destroyDescendants();var _468=this._contentSetter;if(!(_468&&_468 instanceof dojo.html._ContentSetter)){_468=this._contentSetter=new dojo.html._ContentSetter({node:this.containerNode,_onError:dojo.hitch(this,this._onError),onContentError:dojo.hitch(this,function(e){var _469=this.onContentError(e);try{this.containerNode.innerHTML=_469;}catch(e){console.error("Fatal "+this.id+" could not change content due to "+e.message,e);}})});}var _46a=dojo.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:this.parseOnLoad,parserScope:this.parserScope,startup:false,dir:this.dir,lang:this.lang},this._contentSetterParams||{});_468.set((dojo.isObject(cont)&&cont.domNode)?cont.domNode:cont,_46a);delete this._contentSetterParams;if(this.doLayout){this._checkIfSingleChild();}if(!_467){if(this._started){this._startChildren();this._scheduleLayout();}this._onLoadHandler(cont);}},_onError:function(type,err,_46b){this.onLoadDeferred.errback(err);var _46c=this["on"+type+"Error"].call(this,err);if(_46b){console.error(_46b,err);}else{if(_46c){this._setContent(_46c,true);}}},onLoad:function(data){console.log("dijit.layout.ContentPane.onLoad    caller: "+this.onLoad.caller.nom);},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage;},onContentError:function(_46d){},onDownloadError:function(_46e){return this.errorMessage;},onDownloadEnd:function(){}});}if(!dojo._hasResource["dijit.form.Button"]){dojo._hasResource["dijit.form.Button"]=true;dojo.provide("dijit.form.Button");dojo.declare("dijit.form.Button",dijit.form._FormWidget,{label:"",showLabel:true,iconClass:"",type:"button",baseClass:"dijitButton",templateString:dojo.cache("dijit.form","templates/Button.html","<span class=\"dijit dijitReset dijitInline\"\n\t><span class=\"dijitReset dijitInline dijitButtonNode\"\n\t\tdojoAttachEvent=\"ondijitclick:_onButtonClick\"\n\t\t><span class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\tdojoAttachPoint=\"titleNode,focusNode\"\n\t\t\trole=\"button\" aria-labelledby=\"${id}_label\"\n\t\t\t><span class=\"dijitReset dijitInline dijitIcon\" dojoAttachPoint=\"iconNode\"></span\n\t\t\t><span class=\"dijitReset dijitToggleButtonIconChar\">&#x25CF;</span\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\tid=\"${id}_label\"\n\t\t\t\tdojoAttachPoint=\"containerNode\"\n\t\t\t></span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" class=\"dijitOffScreen\" tabIndex=\"-1\"\n\t\tdojoAttachPoint=\"valueNode\"\n/></span>\n"),attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{value:"valueNode"}),_onClick:function(e){if(this.disabled){return false;}this._clicked();return this.onClick(e);},_onButtonClick:function(e){if(this._onClick(e)===false){e.preventDefault();}else{if(this.type=="submit"&&!(this.valueNode||this.focusNode).form){for(var node=this.domNode;node.parentNode;node=node.parentNode){var _46f=dijit.byNode(node);if(_46f&&typeof _46f._onSubmit=="function"){_46f._onSubmit(e);break;}}}else{if(this.valueNode){this.valueNode.click();e.preventDefault();}}}},buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.focusNode,false);},_fillContent:function(_470){if(_470&&(!this.params||!("label" in this.params))){this.set("label",_470.innerHTML);}},_setShowLabelAttr:function(val){if(this.containerNode){dojo.toggleClass(this.containerNode,"dijitDisplayNone",!val);}this._set("showLabel",val);},onClick:function(e){return true;},_clicked:function(e){},setLabel:function(_471){dojo.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_471);},_setLabelAttr:function(_472){this._set("label",_472);this.containerNode.innerHTML=_472;if(this.showLabel==false&&!this.params.title){this.titleNode.title=dojo.trim(this.containerNode.innerText||this.containerNode.textContent||"");}},_setIconClassAttr:function(val){var _473=this.iconClass||"dijitNoIcon",_474=val||"dijitNoIcon";dojo.replaceClass(this.iconNode,_474,_473);this._set("iconClass",val);}});dojo.declare("dijit.form.DropDownButton",[dijit.form.Button,dijit._Container,dijit._HasDropDown],{baseClass:"dijitDropDownButton",templateString:dojo.cache("dijit.form","templates/DropDownButton.html","<span class=\"dijit dijitReset dijitInline\"\n\t><span class='dijitReset dijitInline dijitButtonNode'\n\t\tdojoAttachEvent=\"ondijitclick:_onButtonClick\" dojoAttachPoint=\"_buttonNode\"\n\t\t><span class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\tdojoAttachPoint=\"focusNode,titleNode,_arrowWrapperNode\"\n\t\t\trole=\"button\" aria-haspopup=\"true\" aria-labelledby=\"${id}_label\"\n\t\t\t><span class=\"dijitReset dijitInline dijitIcon\"\n\t\t\t\tdojoAttachPoint=\"iconNode\"\n\t\t\t></span\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\tdojoAttachPoint=\"containerNode,_popupStateNode\"\n\t\t\t\tid=\"${id}_label\"\n\t\t\t></span\n\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonInner\"></span\n\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonChar\">&#9660;</span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" class=\"dijitOffScreen\" tabIndex=\"-1\"\n\t\tdojoAttachPoint=\"valueNode\"\n/></span>\n"),_fillContent:function(){if(this.srcNodeRef){var _475=dojo.query("*",this.srcNodeRef);dijit.form.DropDownButton.superclass._fillContent.call(this,_475[0]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}if(!this.dropDown&&this.dropDownContainer){var _476=dojo.query("[widgetId]",this.dropDownContainer)[0];this.dropDown=dijit.byNode(_476);delete this.dropDownContainer;}if(this.dropDown){dijit.popup.hide(this.dropDown);}this.inherited(arguments);},isLoaded:function(){var _477=this.dropDown;return (!!_477&&(!_477.href||_477.isLoaded));},loadDropDown:function(){var _478=this.dropDown;if(!_478){return;}if(!this.isLoaded()){var _479=dojo.connect(_478,"onLoad",this,function(){dojo.disconnect(_479);this.openDropDown();});_478.refresh();}else{this.openDropDown();}},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown;}});dojo.declare("dijit.form.ComboButton",dijit.form.DropDownButton,{templateString:dojo.cache("dijit.form","templates/ComboButton.html","<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tcellspacing='0' cellpadding='0' role=\"presentation\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonNode\" dojoAttachPoint=\"buttonNode\" dojoAttachEvent=\"ondijitclick:_onButtonClick,onkeypress:_onButtonKeyPress\"\n\t\t><div id=\"${id}_button\" class=\"dijitReset dijitButtonContents\"\n\t\t\tdojoAttachPoint=\"titleNode\"\n\t\t\trole=\"button\" aria-labelledby=\"${id}_label\"\n\t\t\t><div class=\"dijitReset dijitInline dijitIcon\" dojoAttachPoint=\"iconNode\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitInline dijitButtonText\" id=\"${id}_label\" dojoAttachPoint=\"containerNode\" role=\"presentation\"></div\n\t\t></div\n\t\t></td\n\t\t><td id=\"${id}_arrow\" class='dijitReset dijitRight dijitButtonNode dijitArrowButton'\n\t\t\tdojoAttachPoint=\"_popupStateNode,focusNode,_buttonNode\"\n\t\t\tdojoAttachEvent=\"onkeypress:_onArrowKeyPress\"\n\t\t\ttitle=\"${optionsTitle}\"\n\t\t\trole=\"button\" aria-haspopup=\"true\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\n\t\t></td\n\t\t><td style=\"display:none !important;\"\n\t\t\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" dojoAttachPoint=\"valueNode\"\n\t\t/></td></tr></tbody\n></table>\n"),attributeMap:dojo.mixin(dojo.clone(dijit.form.Button.prototype.attributeMap),{id:"",tabIndex:["focusNode","titleNode"],title:"titleNode"}),optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{"buttonNode":"dijitButtonNode","titleNode":"dijitButtonContents","_popupStateNode":"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyPress:function(evt){if(evt.charOrCode==dojo.keys[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]){dijit.focus(this._popupStateNode);dojo.stopEvent(evt);}},_onArrowKeyPress:function(evt){if(evt.charOrCode==dojo.keys[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]){dijit.focus(this.titleNode);dojo.stopEvent(evt);}},focus:function(_47a){if(!this.disabled){dijit.focus(_47a=="start"?this.titleNode:this._popupStateNode);}}});dojo.declare("dijit.form.ToggleButton",dijit.form.Button,{baseClass:"dijitToggleButton",checked:false,attributeMap:dojo.mixin(dojo.clone(dijit.form.Button.prototype.attributeMap),{checked:"focusNode"}),_clicked:function(evt){this.set("checked",!this.checked);},_setCheckedAttr:function(_47b,_47c){this._set("checked",_47b);dojo.attr(this.focusNode||this.domNode,"checked",_47b);dijit.setWaiState(this.focusNode||this.domNode,"pressed",_47b);this._handleOnChange(_47b,_47c);},setChecked:function(_47d){dojo.deprecated("setChecked("+_47d+") is deprecated. Use set('checked',"+_47d+") instead.","","2.0");this.set("checked",_47d);},reset:function(){this._hasBeenBlurred=false;this.set("checked",this.params.checked||false);}});}if(!dojo._hasResource["plugins.admin.Admin"]){dojo._hasResource["plugins.admin.Admin"]=true;dojo.provide("plugins.admin.Admin");dojo.declare("plugins.admin.Admin",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- ADMIN TAB -->\n\t<div\n        dojoAttachPoint=\"mainTab\"\n        class=\"admin\"\n\t\ticonClass=\"adminIcon\"\n        style=\"min-width: 1140px !important; width: 100% !important; height:100% !important; max-height: auto !important; padding: 0px; background: #FFF;\"\n        dojoType=\"dijit.layout.BorderContainer\"\n\t\tclosable=\"true\"\t\t\n        title=\"Admin\"\n        >\n        \n        <!-- LEFT PANE -->\n        <div\n            dojoAttachPoint=\"leftPane\"\n            class=\"leftPane\"\n\t\t\tlayoutAlign=\"left\" \n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; width: 390px; height: 100% !important; max-height: auto !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- LEFT TAB CONTAINER-->\n            <div dojoAttachPoint=\"leftTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF LEFT TAB CONTAINER-->\n\t\t\t\n        </div>\n        <!-- END OF LEFT PANE -->\n\n        <!-- MIDDLE PANE -->\n        <div\n            dojoAttachPoint=\"middlePane\"\n\t\t\tlayoutAlign=\"middle\" \n\t\t\tclass=\"middlePane\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 390px !important; height: 100% !important; max-height: auto !important; width: 390px; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- MIDDLE TAB CONTAINER-->\n            <div\n                dojoAttachPoint=\"middleTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n\n        </div>\n        <!-- END OF MIDDLE PANE -->\n\n\n        <!-- RIGHT PANE -->\n        <div\n            dojoAttachPoint=\"rightPane\" \n            class=\"rightPane\"\n\t\t\tlayoutAlign=\"right\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 780px !important; height: 100% !important; max-height: auto !important; width: 390px !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- RIGHT TAB CONTAINER-->\n            <div dojoAttachPoint=\"rightTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible; width: 390px !important; \"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF RIGHT TAB CONTAINER-->\n\n        </div>\n        <!-- END OF RIGHT PANE -->\n\n\t</div>\n\t<!-- END OF ADMIN TAB -->\n\n</div>\n",widgetsInTemplate:true,paneWidgets:null,core:new Object,cssFiles:[dojo.moduleUrl("plugins","admin/css/admin.css")],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){Agua.addWidget("admin",this);Agua.tabs.addChild(this.mainTab);Agua.tabs.selectChild(this.mainTab);this.paneWidgets=new Object;this.headings=Agua.getAdminHeadings();console.log("Admin.startup    this.headings:");console.dir({this_headings:this.headings});this.loadPanes();},reload:function(_47e){if(_47e=="all"){for(var _47f in this.headings){for(var i in this.headings[_47f]){this.reloadWidget(this.headings[_47f][i]);}}}else{if(_47e=="leftPane"||_47e=="middlePane"||_47e=="rightPane"){for(var i in this.headings[_47e]){this.reloadWidget(this.headings[_47e][i]);}}else{try{this.reloadWidget(_47e);}catch(e){}}}},reloadWidget:function(_480){delete this.paneWidgets[_480];var _481=this;this.paneWidgets[_480]=new plugins.admin[_480]({parentWidget:_481,tabContainer:_481.leftTabContainer});},loadPanes:function(){var _482=["left","middle","right"];for(var i=0;i<_482.length;i++){this.loadPane(_482[i]);}},loadPane:function(side){var pane=side+"Pane";var _483=side+"TabContainer";if(this.headings==null||this.headings[pane]==null){return;}for(var i=0;i<this.headings[pane].length;i++){var _484=this.headings[pane][i];console.log("Admin.loadPane    dojo.require tabPaneName: "+_484);var _485="plugins.admin."+_484;console.log("Admin.loadPane    BEFORE dojo.require moduleName: "+_485);dojo["require"](_485);console.log("Admin.loadPane    AFTER dojo.require moduleName: "+_485);var _486=this;var _487=new plugins["admin"][_484]({parentWidget:_486,tabContainer:_486[_483]});if(this.paneWidgets[_485]==null){this.paneWidgets[_485]=new Array;}this.paneWidgets[_485].push(_487);}},destroyRecursive:function(){console.log("Admin.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["dojo.data.ItemFileWriteStore"]){dojo._hasResource["dojo.data.ItemFileWriteStore"]=true;dojo.provide("dojo.data.ItemFileWriteStore");dojo.declare("dojo.data.ItemFileWriteStore",dojo.data.ItemFileReadStore,{constructor:function(_488){this._features["dojo.data.api.Write"]=true;this._features["dojo.data.api.Notification"]=true;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};if(!this._datatypeMap["Date"].serialize){this._datatypeMap["Date"].serialize=function(obj){return dojo.date.stamp.toISOString(obj,{zulu:true});};}if(_488&&(_488.referenceIntegrity===false)){this.referenceIntegrity=false;}this._saveInProgress=false;},referenceIntegrity:true,_assert:function(_489){if(!_489){throw new Error("assertion failed in ItemFileWriteStore");}},_getIdentifierAttribute:function(){var _48a=this.getFeatures()["dojo.data.api.Identity"];return _48a;},newItem:function(_48b,_48c){this._assert(!this._saveInProgress);if(!this._loadFinished){this._forceLoad();}if(typeof _48b!="object"&&typeof _48b!="undefined"){throw new Error("newItem() was passed something other than an object");}var _48d=null;var _48e=this._getIdentifierAttribute();if(_48e===Number){_48d=this._arrayOfAllItems.length;}else{_48d=_48b[_48e];if(typeof _48d==="undefined"){throw new Error("newItem() was not passed an identity for the new item");}if(dojo.isArray(_48d)){throw new Error("newItem() was not passed an single-valued identity");}}if(this._itemsByIdentity){this._assert(typeof this._itemsByIdentity[_48d]==="undefined");}this._assert(typeof this._pending._newItems[_48d]==="undefined");this._assert(typeof this._pending._deletedItems[_48d]==="undefined");var _48f={};_48f[this._storeRefPropName]=this;_48f[this._itemNumPropName]=this._arrayOfAllItems.length;if(this._itemsByIdentity){this._itemsByIdentity[_48d]=_48f;_48f[_48e]=[_48d];}this._arrayOfAllItems.push(_48f);var _490=null;if(_48c&&_48c.parent&&_48c.attribute){_490={item:_48c.parent,attribute:_48c.attribute,oldValue:undefined};var _491=this.getValues(_48c.parent,_48c.attribute);if(_491&&_491.length>0){var _492=_491.slice(0,_491.length);if(_491.length===1){_490.oldValue=_491[0];}else{_490.oldValue=_491.slice(0,_491.length);}_492.push(_48f);this._setValueOrValues(_48c.parent,_48c.attribute,_492,false);_490.newValue=this.getValues(_48c.parent,_48c.attribute);}else{this._setValueOrValues(_48c.parent,_48c.attribute,_48f,false);_490.newValue=_48f;}}else{_48f[this._rootItemPropName]=true;this._arrayOfTopLevelItems.push(_48f);}this._pending._newItems[_48d]=_48f;for(var key in _48b){if(key===this._storeRefPropName||key===this._itemNumPropName){throw new Error("encountered bug in ItemFileWriteStore.newItem");}var _493=_48b[key];if(!dojo.isArray(_493)){_493=[_493];}_48f[key]=_493;if(this.referenceIntegrity){for(var i=0;i<_493.length;i++){var val=_493[i];if(this.isItem(val)){this._addReferenceToMap(val,_48f,key);}}}}this.onNew(_48f,_490);return _48f;},_removeArrayElement:function(_494,_495){var _496=dojo.indexOf(_494,_495);if(_496!=-1){_494.splice(_496,1);return true;}return false;},deleteItem:function(item){this._assert(!this._saveInProgress);this._assertIsItem(item);var _497=item[this._itemNumPropName];var _498=this.getIdentity(item);if(this.referenceIntegrity){var _499=this.getAttributes(item);if(item[this._reverseRefMap]){item["backup_"+this._reverseRefMap]=dojo.clone(item[this._reverseRefMap]);}dojo.forEach(_499,function(_49a){dojo.forEach(this.getValues(item,_49a),function(_49b){if(this.isItem(_49b)){if(!item["backupRefs_"+this._reverseRefMap]){item["backupRefs_"+this._reverseRefMap]=[];}item["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(_49b),attr:_49a});this._removeReferenceFromMap(_49b,item,_49a);}},this);},this);var _49c=item[this._reverseRefMap];if(_49c){for(var _49d in _49c){var _49e=null;if(this._itemsByIdentity){_49e=this._itemsByIdentity[_49d];}else{_49e=this._arrayOfAllItems[_49d];}if(_49e){for(var _49f in _49c[_49d]){var _4a0=this.getValues(_49e,_49f)||[];var _4a1=dojo.filter(_4a0,function(_4a2){return !(this.isItem(_4a2)&&this.getIdentity(_4a2)==_498);},this);this._removeReferenceFromMap(item,_49e,_49f);if(_4a1.length<_4a0.length){this._setValueOrValues(_49e,_49f,_4a1,true);}}}}}}this._arrayOfAllItems[_497]=null;item[this._storeRefPropName]=null;if(this._itemsByIdentity){delete this._itemsByIdentity[_498];}this._pending._deletedItems[_498]=item;if(item[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,item);}this.onDelete(item);return true;},setValue:function(item,_4a3,_4a4){return this._setValueOrValues(item,_4a3,_4a4,true);},setValues:function(item,_4a5,_4a6){return this._setValueOrValues(item,_4a5,_4a6,true);},unsetAttribute:function(item,_4a7){return this._setValueOrValues(item,_4a7,[],true);},_setValueOrValues:function(item,_4a8,_4a9,_4aa){this._assert(!this._saveInProgress);this._assertIsItem(item);this._assert(dojo.isString(_4a8));this._assert(typeof _4a9!=="undefined");var _4ab=this._getIdentifierAttribute();if(_4a8==_4ab){throw new Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");}var _4ac=this._getValueOrValues(item,_4a8);var _4ad=this.getIdentity(item);if(!this._pending._modifiedItems[_4ad]){var _4ae={};for(var key in item){if((key===this._storeRefPropName)||(key===this._itemNumPropName)||(key===this._rootItemPropName)){_4ae[key]=item[key];}else{if(key===this._reverseRefMap){_4ae[key]=dojo.clone(item[key]);}else{_4ae[key]=item[key].slice(0,item[key].length);}}}this._pending._modifiedItems[_4ad]=_4ae;}var _4af=false;if(dojo.isArray(_4a9)&&_4a9.length===0){_4af=delete item[_4a8];_4a9=undefined;if(this.referenceIntegrity&&_4ac){var _4b0=_4ac;if(!dojo.isArray(_4b0)){_4b0=[_4b0];}for(var i=0;i<_4b0.length;i++){var _4b1=_4b0[i];if(this.isItem(_4b1)){this._removeReferenceFromMap(_4b1,item,_4a8);}}}}else{var _4b2;if(dojo.isArray(_4a9)){var _4b3=_4a9;_4b2=_4a9.slice(0,_4a9.length);}else{_4b2=[_4a9];}if(this.referenceIntegrity){if(_4ac){var _4b0=_4ac;if(!dojo.isArray(_4b0)){_4b0=[_4b0];}var map={};dojo.forEach(_4b0,function(_4b4){if(this.isItem(_4b4)){var id=this.getIdentity(_4b4);map[id.toString()]=true;}},this);dojo.forEach(_4b2,function(_4b5){if(this.isItem(_4b5)){var id=this.getIdentity(_4b5);if(map[id.toString()]){delete map[id.toString()];}else{this._addReferenceToMap(_4b5,item,_4a8);}}},this);for(var rId in map){var _4b6;if(this._itemsByIdentity){_4b6=this._itemsByIdentity[rId];}else{_4b6=this._arrayOfAllItems[rId];}this._removeReferenceFromMap(_4b6,item,_4a8);}}else{for(var i=0;i<_4b2.length;i++){var _4b1=_4b2[i];if(this.isItem(_4b1)){this._addReferenceToMap(_4b1,item,_4a8);}}}}item[_4a8]=_4b2;_4af=true;}if(_4aa){this.onSet(item,_4a8,_4ac,_4a9);}return _4af;},_addReferenceToMap:function(_4b7,_4b8,_4b9){var _4ba=this.getIdentity(_4b8);var _4bb=_4b7[this._reverseRefMap];if(!_4bb){_4bb=_4b7[this._reverseRefMap]={};}var _4bc=_4bb[_4ba];if(!_4bc){_4bc=_4bb[_4ba]={};}_4bc[_4b9]=true;},_removeReferenceFromMap:function(_4bd,_4be,_4bf){var _4c0=this.getIdentity(_4be);var _4c1=_4bd[this._reverseRefMap];var _4c2;if(_4c1){for(_4c2 in _4c1){if(_4c2==_4c0){delete _4c1[_4c2][_4bf];if(this._isEmpty(_4c1[_4c2])){delete _4c1[_4c2];}}}if(this._isEmpty(_4c1)){delete _4bd[this._reverseRefMap];}}},_dumpReferenceMap:function(){var i;for(i=0;i<this._arrayOfAllItems.length;i++){var item=this._arrayOfAllItems[i];if(item&&item[this._reverseRefMap]){console.log("Item: ["+this.getIdentity(item)+"] is referenced by: "+dojo.toJson(item[this._reverseRefMap]));}}},_getValueOrValues:function(item,_4c3){var _4c4=undefined;if(this.hasAttribute(item,_4c3)){var _4c5=this.getValues(item,_4c3);if(_4c5.length==1){_4c4=_4c5[0];}else{_4c4=_4c5;}}return _4c4;},_flatten:function(_4c6){if(this.isItem(_4c6)){var item=_4c6;var _4c7=this.getIdentity(item);var _4c8={_reference:_4c7};return _4c8;}else{if(typeof _4c6==="object"){for(var type in this._datatypeMap){var _4c9=this._datatypeMap[type];if(dojo.isObject(_4c9)&&!dojo.isFunction(_4c9)){if(_4c6 instanceof _4c9.type){if(!_4c9.serialize){throw new Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+type+"]");}return {_type:type,_value:_4c9.serialize(_4c6)};}}else{if(_4c6 instanceof _4c9){return {_type:type,_value:_4c6.toString()};}}}}return _4c6;}},_getNewFileContentString:function(){var _4ca={};var _4cb=this._getIdentifierAttribute();if(_4cb!==Number){_4ca.identifier=_4cb;}if(this._labelAttr){_4ca.label=this._labelAttr;}_4ca.items=[];for(var i=0;i<this._arrayOfAllItems.length;++i){var item=this._arrayOfAllItems[i];if(item!==null){var _4cc={};for(var key in item){if(key!==this._storeRefPropName&&key!==this._itemNumPropName&&key!==this._reverseRefMap&&key!==this._rootItemPropName){var _4cd=key;var _4ce=this.getValues(item,_4cd);if(_4ce.length==1){_4cc[_4cd]=this._flatten(_4ce[0]);}else{var _4cf=[];for(var j=0;j<_4ce.length;++j){_4cf.push(this._flatten(_4ce[j]));_4cc[_4cd]=_4cf;}}}}_4ca.items.push(_4cc);}}var _4d0=true;return dojo.toJson(_4ca,_4d0);},_isEmpty:function(_4d1){var _4d2=true;if(dojo.isObject(_4d1)){var i;for(i in _4d1){_4d2=false;break;}}else{if(dojo.isArray(_4d1)){if(_4d1.length>0){_4d2=false;}}}return _4d2;},save:function(_4d3){this._assert(!this._saveInProgress);this._saveInProgress=true;var self=this;var _4d4=function(){self._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};self._saveInProgress=false;if(_4d3&&_4d3.onComplete){var _4d5=_4d3.scope||dojo.global;_4d3.onComplete.call(_4d5);}};var _4d6=function(err){self._saveInProgress=false;if(_4d3&&_4d3.onError){var _4d7=_4d3.scope||dojo.global;_4d3.onError.call(_4d7,err);}};if(this._saveEverything){var _4d8=this._getNewFileContentString();this._saveEverything(_4d4,_4d6,_4d8);}if(this._saveCustom){this._saveCustom(_4d4,_4d6);}if(!this._saveEverything&&!this._saveCustom){_4d4();}},revert:function(){this._assert(!this._saveInProgress);var _4d9;for(_4d9 in this._pending._modifiedItems){var _4da=this._pending._modifiedItems[_4d9];var _4db=null;if(this._itemsByIdentity){_4db=this._itemsByIdentity[_4d9];}else{_4db=this._arrayOfAllItems[_4d9];}_4da[this._storeRefPropName]=this;for(key in _4db){delete _4db[key];}dojo.mixin(_4db,_4da);}var _4dc;for(_4d9 in this._pending._deletedItems){_4dc=this._pending._deletedItems[_4d9];_4dc[this._storeRefPropName]=this;var _4dd=_4dc[this._itemNumPropName];if(_4dc["backup_"+this._reverseRefMap]){_4dc[this._reverseRefMap]=_4dc["backup_"+this._reverseRefMap];delete _4dc["backup_"+this._reverseRefMap];}this._arrayOfAllItems[_4dd]=_4dc;if(this._itemsByIdentity){this._itemsByIdentity[_4d9]=_4dc;}if(_4dc[this._rootItemPropName]){this._arrayOfTopLevelItems.push(_4dc);}}for(_4d9 in this._pending._deletedItems){_4dc=this._pending._deletedItems[_4d9];if(_4dc["backupRefs_"+this._reverseRefMap]){dojo.forEach(_4dc["backupRefs_"+this._reverseRefMap],function(_4de){var _4df;if(this._itemsByIdentity){_4df=this._itemsByIdentity[_4de.id];}else{_4df=this._arrayOfAllItems[_4de.id];}this._addReferenceToMap(_4df,_4dc,_4de.attr);},this);delete _4dc["backupRefs_"+this._reverseRefMap];}}for(_4d9 in this._pending._newItems){var _4e0=this._pending._newItems[_4d9];_4e0[this._storeRefPropName]=null;this._arrayOfAllItems[_4e0[this._itemNumPropName]]=null;if(_4e0[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,_4e0);}if(this._itemsByIdentity){delete this._itemsByIdentity[_4d9];}}this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return true;},isDirty:function(item){if(item){var _4e1=this.getIdentity(item);return new Boolean(this._pending._newItems[_4e1]||this._pending._modifiedItems[_4e1]||this._pending._deletedItems[_4e1]).valueOf();}else{if(!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)){return true;}return false;}},onSet:function(item,_4e2,_4e3,_4e4){},onNew:function(_4e5,_4e6){},onDelete:function(_4e7){},close:function(_4e8){if(this.clearOnClose){if(!this.isDirty()){this.inherited(arguments);}else{throw new Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");}}}});}if(!dojo._hasResource["plugins.admin.AmiRow"]){dojo._hasResource["plugins.admin.AmiRow"]=true;dojo.provide("plugins.admin.AmiRow");dojo.declare("plugins.admin.AmiRow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table class=\"amiRow\" width=\"100%\">\n        <tr width=\"95%\">\n            \n            <td\n\t\t\t\tdojoAttachEvent=\"onclick:toggle\"\n\t\t\t\talign=\"center\"\n\t\t\t\tclass=\"amiid\"\n\t\t\t\tdojoAttachPoint=\"amiid\"\n\t\t\t>${amiid}\n\t\t\t</td>\n\t\t\t<td\n                dojoAttachPoint=\"cluster\"\n                class=\"aminame\"\n                title=\"AMI Name\"\n            >\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"aminame\"\n\t\t\t\t\tclass=\"aminame\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"${aminame}\"\n\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\tregExp=\"^\\S{1,20}$\"\n\t\t\t\t\tmaxlength=\"20\" \n\t\t\t\t\tpromptMessage=\"AMI name: up to 20 characters (no spaces)\" \n\t\t\t\t\tinvalidMessage=\"AMI name: up to 20 characters (no spaces)\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t>\n\t\t\t</td>\n            <td class=\"amitype\">\n                <select\n                    dojoAttachPoint=\"amitype\"\n\t\t\t\t\tclass=\"amitype\"\n\t\t\t\t\ttitle=\"AMI type: EBS-backed (stop/startable, retains its state) or emphemeral S3 type\">\n\t\t\t\t\t<option value=\"${amitype}\">${amitype}</option> \n\t\t\t\t\t<option value=\"S3\">S3</option>\n\t\t\t\t\t<option value=\"EBS\">EBS</option> \n                </select>\n            </td>\n\n\t\t</tr>\n\t\t<tr width=\"95%\">\n\t\t\t<td\n                align=\"center\"\n                colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                dojoAttachEvent=\"onclick:editCluster\"\n                class=\"description\"\n                width=\"100%\"\n                title=\"A brief description of the cluster group\"\n            >${description}</td>\n\t\t</tr>\n    </table>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.lockedValue=args.locked;this.args=args;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _4e9={target:{selectedIndex:0,options:[{text:"us-east-1"}]}};this.setOnkeyListeners(["aminame"]);setTimeout(function(_4ea){_4ea.setComboListeners();},2000,this);},setOnkeyListeners:function(_4eb){var _4ec=this;for(var i in _4eb){dojo.connect(_4ec[_4eb[i]],"onKeyPress",function(evt){var key=evt.charOrCode;evt.stopPropagation();if(key==13){_4ec.saveInputs();}});}},setComboListeners:function(){var _4ed=this;dojo.connect(this.amitype,"onchange",function(_4ee){if(_4ee.stopPropagation==null){return;}var _4ef=_4ed.parentWidget.getFormInputs(_4ed);_4ed.parentWidget.saveInputs(_4ef,{reload:false});_4ee.stopPropagation();});},saveInputs:function(){var _4f0=this.parentWidget.getFormInputs(this);this.parentWidget.saveInputs(_4f0,{reload:false});},editCluster:function(_4f1){this.parentWidget.editRow(this,_4f1.target);_4f1.stopPropagation();},toggle:function(){console.log("AmiRow.toggle    plugins.workflow.AmiRow.toggle()");console.log("AmiRow.toggle    this.description: "+this.description);var _4f2=["description"];for(var i in _4f2){console.log("AmiRow.toggle    toggling: "+_4f2[i]);if(this[_4f2[i]].style.display=="table-cell"){this[_4f2[i]].style.display="none";}else{this[_4f2[i]].style.display="table-cell";}}}});}if(!dojo._hasResource["dojo.number"]){dojo._hasResource["dojo.number"]=true;dojo.provide("dojo.number");dojo.getObject("number",true,dojo);dojo.number.format=function(_4f3,_4f4){_4f4=dojo.mixin({},_4f4||{});var _4f5=dojo.i18n.normalizeLocale(_4f4.locale),_4f6=dojo.i18n.getLocalization("dojo.cldr","number",_4f5);_4f4.customs=_4f6;var _4f7=_4f4.pattern||_4f6[(_4f4.type||"decimal")+"Format"];if(isNaN(_4f3)||Math.abs(_4f3)==Infinity){return null;}return dojo.number._applyPattern(_4f3,_4f7,_4f4);};dojo.number._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;dojo.number._applyPattern=function(_4f8,_4f9,_4fa){_4fa=_4fa||{};var _4fb=_4fa.customs.group,_4fc=_4fa.customs.decimal,_4fd=_4f9.split(";"),_4fe=_4fd[0];_4f9=_4fd[(_4f8<0)?1:0]||("-"+_4fe);if(_4f9.indexOf("%")!=-1){_4f8*=100;}else{if(_4f9.indexOf("")!=-1){_4f8*=1000;}else{if(_4f9.indexOf("")!=-1){_4fb=_4fa.customs.currencyGroup||_4fb;_4fc=_4fa.customs.currencyDecimal||_4fc;_4f9=_4f9.replace(/\u00a4{1,3}/,function(_4ff){var prop=["symbol","currency","displayName"][_4ff.length-1];return _4fa[prop]||_4fa.currency||"";});}else{if(_4f9.indexOf("E")!=-1){throw new Error("exponential notation not supported");}}}}var _500=dojo.number._numberPatternRE;var _501=_4fe.match(_500);if(!_501){throw new Error("unable to find a number expression in pattern: "+_4f9);}if(_4fa.fractional===false){_4fa.places=0;}return _4f9.replace(_500,dojo.number._formatAbsolute(_4f8,_501[0],{decimal:_4fc,group:_4fb,places:_4fa.places,round:_4fa.round}));};dojo.number.round=function(_502,_503,_504){var _505=10/(_504||10);return (_505*+_502).toFixed(_503)/_505;};if((0.9).toFixed()==0){(function(){var _506=dojo.number.round;dojo.number.round=function(v,p,m){var d=Math.pow(10,-p||0),a=Math.abs(v);if(!v||a>=d||a*Math.pow(10,p+1)<5){d=0;}return _506(v,p,m)+(v>0?d:-d);};})();}dojo.number._formatAbsolute=function(_507,_508,_509){_509=_509||{};if(_509.places===true){_509.places=0;}if(_509.places===Infinity){_509.places=6;}var _50a=_508.split("."),_50b=typeof _509.places=="string"&&_509.places.indexOf(","),_50c=_509.places;if(_50b){_50c=_509.places.substring(_50b+1);}else{if(!(_50c>=0)){_50c=(_50a[1]||[]).length;}}if(!(_509.round<0)){_507=dojo.number.round(_507,_50c,_509.round);}var _50d=String(Math.abs(_507)).split("."),_50e=_50d[1]||"";if(_50a[1]||_509.places){if(_50b){_509.places=_509.places.substring(0,_50b);}var pad=_509.places!==undefined?_509.places:(_50a[1]&&_50a[1].lastIndexOf("0")+1);if(pad>_50e.length){_50d[1]=dojo.string.pad(_50e,pad,"0",true);}if(_50c<_50e.length){_50d[1]=_50e.substr(0,_50c);}}else{if(_50d[1]){_50d.pop();}}var _50f=_50a[0].replace(",","");pad=_50f.indexOf("0");if(pad!=-1){pad=_50f.length-pad;if(pad>_50d[0].length){_50d[0]=dojo.string.pad(_50d[0],pad);}if(_50f.indexOf("#")==-1){_50d[0]=_50d[0].substr(_50d[0].length-pad);}}var _510=_50a[0].lastIndexOf(","),_511,_512;if(_510!=-1){_511=_50a[0].length-_510-1;var _513=_50a[0].substr(0,_510);_510=_513.lastIndexOf(",");if(_510!=-1){_512=_513.length-_510-1;}}var _514=[];for(var _515=_50d[0];_515;){var off=_515.length-_511;_514.push((off>0)?_515.substr(off):_515);_515=(off>0)?_515.slice(0,off):"";if(_512){_511=_512;delete _512;}}_50d[0]=_514.reverse().join(_509.group||",");return _50d.join(_509.decimal||".");};dojo.number.regexp=function(_516){return dojo.number._parseInfo(_516).regexp;};dojo.number._parseInfo=function(_517){_517=_517||{};var _518=dojo.i18n.normalizeLocale(_517.locale),_519=dojo.i18n.getLocalization("dojo.cldr","number",_518),_51a=_517.pattern||_519[(_517.type||"decimal")+"Format"],_51b=_519.group,_51c=_519.decimal,_51d=1;if(_51a.indexOf("%")!=-1){_51d/=100;}else{if(_51a.indexOf("")!=-1){_51d/=1000;}else{var _51e=_51a.indexOf("")!=-1;if(_51e){_51b=_519.currencyGroup||_51b;_51c=_519.currencyDecimal||_51c;}}}var _51f=_51a.split(";");if(_51f.length==1){_51f.push("-"+_51f[0]);}var re=dojo.regexp.buildGroupRE(_51f,function(_520){_520="(?:"+dojo.regexp.escapeString(_520,".")+")";return _520.replace(dojo.number._numberPatternRE,function(_521){var _522={signed:false,separator:_517.strict?_51b:[_51b,""],fractional:_517.fractional,decimal:_51c,exponent:false},_523=_521.split("."),_524=_517.places;if(_523.length==1&&_51d!=1){_523[1]="###";}if(_523.length==1||_524===0){_522.fractional=false;}else{if(_524===undefined){_524=_517.pattern?_523[1].lastIndexOf("0")+1:Infinity;}if(_524&&_517.fractional==undefined){_522.fractional=true;}if(!_517.places&&(_524<_523[1].length)){_524+=","+_523[1].length;}_522.places=_524;}var _525=_523[0].split(",");if(_525.length>1){_522.groupSize=_525.pop().length;if(_525.length>1){_522.groupSize2=_525.pop().length;}}return "("+dojo.number._realNumberRegexp(_522)+")";});},true);if(_51e){re=re.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(_526,_527,_528,_529){var prop=["symbol","currency","displayName"][_528.length-1],_52a=dojo.regexp.escapeString(_517[prop]||_517.currency||"");_527=_527?"[\\s\\xa0]":"";_529=_529?"[\\s\\xa0]":"";if(!_517.strict){if(_527){_527+="*";}if(_529){_529+="*";}return "(?:"+_527+_52a+_529+")?";}return _527+_52a+_529;});}return {regexp:re.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:_51b,decimal:_51c,factor:_51d};};dojo.number.parse=function(_52b,_52c){var info=dojo.number._parseInfo(_52c),_52d=(new RegExp("^"+info.regexp+"$")).exec(_52b);if(!_52d){return NaN;}var _52e=_52d[1];if(!_52d[1]){if(!_52d[2]){return NaN;}_52e=_52d[2];info.factor*=-1;}_52e=_52e.replace(new RegExp("["+info.group+"\\s\\xa0"+"]","g"),"").replace(info.decimal,".");return _52e*info.factor;};dojo.number._realNumberRegexp=function(_52f){_52f=_52f||{};if(!("places" in _52f)){_52f.places=Infinity;}if(typeof _52f.decimal!="string"){_52f.decimal=".";}if(!("fractional" in _52f)||/^0/.test(_52f.places)){_52f.fractional=[true,false];}if(!("exponent" in _52f)){_52f.exponent=[true,false];}if(!("eSigned" in _52f)){_52f.eSigned=[true,false];}var _530=dojo.number._integerRegexp(_52f),_531=dojo.regexp.buildGroupRE(_52f.fractional,function(q){var re="";if(q&&(_52f.places!==0)){re="\\"+_52f.decimal;if(_52f.places==Infinity){re="(?:"+re+"\\d+)?";}else{re+="\\d{"+_52f.places+"}";}}return re;},true);var _532=dojo.regexp.buildGroupRE(_52f.exponent,function(q){if(q){return "([eE]"+dojo.number._integerRegexp({signed:_52f.eSigned})+")";}return "";});var _533=_530+_531;if(_531){_533="(?:(?:"+_533+")|(?:"+_531+"))";}return _533+_532;};dojo.number._integerRegexp=function(_534){_534=_534||{};if(!("signed" in _534)){_534.signed=[true,false];}if(!("separator" in _534)){_534.separator="";}else{if(!("groupSize" in _534)){_534.groupSize=3;}}var _535=dojo.regexp.buildGroupRE(_534.signed,function(q){return q?"[-+]":"";},true);var _536=dojo.regexp.buildGroupRE(_534.separator,function(sep){if(!sep){return "(?:\\d+)";}sep=dojo.regexp.escapeString(sep);if(sep==" "){sep="\\s";}else{if(sep==""){sep="\\s\\xa0";}}var grp=_534.groupSize,grp2=_534.groupSize2;if(grp2){var _537="(?:0|[1-9]\\d{0,"+(grp2-1)+"}(?:["+sep+"]\\d{"+grp2+"})*["+sep+"]\\d{"+grp+"})";return ((grp-grp2)>0)?"(?:"+_537+"|(?:0|[1-9]\\d{0,"+(grp-1)+"}))":_537;}return "(?:0|[1-9]\\d{0,"+(grp-1)+"}(?:["+sep+"]\\d{"+grp+"})*)";},true);return _535+_536;};}if(!dojo._hasResource["dijit.form.NumberTextBox"]){dojo._hasResource["dijit.form.NumberTextBox"]=true;dojo.provide("dijit.form.NumberTextBox");dojo.declare("dijit.form.NumberTextBoxMixin",null,{regExpGen:dojo.number.regexp,value:NaN,editOptions:{pattern:"#.######"},_formatter:dojo.number.format,_setConstraintsAttr:function(_538){var _539=typeof _538.places=="number"?_538.places:0;if(_539){_539++;}if(typeof _538.max!="number"){_538.max=9*Math.pow(10,15-_539);}if(typeof _538.min!="number"){_538.min=-9*Math.pow(10,15-_539);}this.inherited(arguments,[_538]);if(this.focusNode&&this.focusNode.value&&!isNaN(this.value)){this.set("value",this.value);}},_onFocus:function(){if(this.disabled){return;}var val=this.get("value");if(typeof val=="number"&&!isNaN(val)){var _53a=this.format(val,this.constraints);if(_53a!==undefined){this.textbox.value=_53a;}}this.inherited(arguments);},format:function(_53b,_53c){var _53d=String(_53b);if(typeof _53b!="number"){return _53d;}if(isNaN(_53b)){return "";}if(!("rangeCheck" in this&&this.rangeCheck(_53b,_53c))&&_53c.exponent!==false&&/\de[-+]?\d/i.test(_53d)){return _53d;}if(this.editOptions&&this._focused){_53c=dojo.mixin({},_53c,this.editOptions);}return this._formatter(_53b,_53c);},_parser:dojo.number.parse,parse:function(_53e,_53f){var v=this._parser(_53e,dojo.mixin({},_53f,(this.editOptions&&this._focused)?this.editOptions:{}));if(this.editOptions&&this._focused&&isNaN(v)){v=this._parser(_53e,_53f);}return v;},_getDisplayedValueAttr:function(){var v=this.inherited(arguments);return isNaN(v)?this.textbox.value:v;},filter:function(_540){return (_540===null||_540===""||_540===undefined)?NaN:this.inherited(arguments);},serialize:function(_541,_542){return (typeof _541!="number"||isNaN(_541))?"":this.inherited(arguments);},_setBlurValue:function(){var val=dojo.hitch(dojo.mixin({},this,{_focused:true}),"get")("value");this._setValueAttr(val,true);},_setValueAttr:function(_543,_544,_545){if(_543!==undefined&&_545===undefined){_545=String(_543);if(typeof _543=="number"){if(isNaN(_543)){_545="";}else{if(("rangeCheck" in this&&this.rangeCheck(_543,this.constraints))||this.constraints.exponent===false||!/\de[-+]?\d/i.test(_545)){_545=undefined;}}}else{if(!_543){_545="";_543=NaN;}else{_543=undefined;}}}this.inherited(arguments,[_543,_544,_545]);},_getValueAttr:function(){var v=this.inherited(arguments);if(isNaN(v)&&this.textbox.value!==""){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+dojo.number._realNumberRegexp(dojo.mixin({},this.constraints))+"$").test(this.textbox.value))){var n=Number(this.textbox.value);return isNaN(n)?undefined:n;}else{return undefined;}}else{return v;}},isValid:function(_546){if(!this._focused||this._isEmpty(this.textbox.value)){return this.inherited(arguments);}else{var v=this.get("value");if(!isNaN(v)&&this.rangeCheck(v,this.constraints)){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)){return true;}else{return this.inherited(arguments);}}else{return false;}}}});dojo.declare("dijit.form.NumberTextBox",[dijit.form.RangeBoundTextBox,dijit.form.NumberTextBoxMixin],{baseClass:"dijitTextBox dijitNumberTextBox"});}if(!dojo._hasResource["dijit.form.SimpleTextarea"]){dojo._hasResource["dijit.form.SimpleTextarea"]=true;dojo.provide("dijit.form.SimpleTextarea");dojo.declare("dijit.form.SimpleTextarea",dijit.form.TextBox,{baseClass:"dijitTextBox dijitTextArea",attributeMap:dojo.delegate(dijit.form._FormValueWidget.prototype.attributeMap,{rows:"textbox",cols:"textbox"}),rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} dojoAttachPoint='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);if(dojo.isIE&&this.cols){dojo.addClass(this.textbox,"dijitTextAreaCols");}},filter:function(_547){if(_547){_547=_547.replace(/\r/g,"");}return this.inherited(arguments);},_previousValue:"",_onInput:function(e){if(this.maxLength){var _548=parseInt(this.maxLength);var _549=this.textbox.value.replace(/\r/g,"");var _54a=_549.length-_548;if(_54a>0){if(e){dojo.stopEvent(e);}var _54b=this.textbox;if(_54b.selectionStart){var pos=_54b.selectionStart;var cr=0;if(dojo.isOpera){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=_549.substring(0,pos-_54a-cr)+_549.substring(pos-cr);_54b.setSelectionRange(pos-_54a,pos-_54a);}else{if(dojo.doc.selection){_54b.focus();var _54c=dojo.doc.selection.createRange();_54c.moveStart("character",-_54a);_54c.text="";_54c.select();}}}this._previousValue=this.textbox.value;}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.form.Textarea"]){dojo._hasResource["dijit.form.Textarea"]=true;dojo.provide("dijit.form.Textarea");dojo.declare("dijit.form.Textarea",dijit.form.SimpleTextarea,{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",_previousNewlines:0,_strictMode:(dojo.doc.compatMode!="BackCompat"),_getHeight:function(_54d){var newH=_54d.scrollHeight;if(dojo.isIE){newH+=_54d.offsetHeight-_54d.clientHeight-((dojo.isIE<8&&this._strictMode)?dojo._getPadBorderExtents(_54d).h:0);}else{if(dojo.isMoz){newH+=_54d.offsetHeight-_54d.clientHeight;}else{if(dojo.isWebKit){newH+=dojo._getBorderExtents(_54d).h;}else{newH+=dojo._getPadBorderExtents(_54d).h;}}}return newH;},_estimateHeight:function(_54e){_54e.style.maxHeight="";_54e.style.height="auto";_54e.rows=(_54e.value.match(/\n/g)||[]).length+1;},_needsHelpShrinking:dojo.isMoz||dojo.isWebKit,_onInput:function(){this.inherited(arguments);if(this._busyResizing){return;}this._busyResizing=true;var _54f=this.textbox;if(_54f.scrollHeight&&_54f.offsetHeight&&_54f.clientHeight){var newH=this._getHeight(_54f)+"px";if(_54f.style.height!=newH){_54f.style.maxHeight=_54f.style.height=newH;}if(this._needsHelpShrinking){if(this._setTimeoutHandle){clearTimeout(this._setTimeoutHandle);}this._setTimeoutHandle=setTimeout(dojo.hitch(this,"_shrink"),0);}}else{this._estimateHeight(_54f);}this._busyResizing=false;},_busyResizing:false,_shrink:function(){this._setTimeoutHandle=null;if(this._needsHelpShrinking&&!this._busyResizing){this._busyResizing=true;var _550=this.textbox;var _551=false;if(_550.value==""){_550.value=" ";_551=true;}var _552=_550.scrollHeight;if(!_552){this._estimateHeight(_550);}else{var _553=_550.style.paddingBottom;var _554=dojo._getPadExtents(_550);_554=_554.h-_554.t;_550.style.paddingBottom=_554+1+"px";var newH=this._getHeight(_550)-1+"px";if(_550.style.maxHeight!=newH){_550.style.paddingBottom=_554+_552+"px";_550.scrollTop=0;_550.style.maxHeight=this._getHeight(_550)-_552+"px";}_550.style.paddingBottom=_553;}if(_551){_550.value="";}this._busyResizing=false;}},resize:function(){this._onInput();},_setValueAttr:function(){this.inherited(arguments);this.resize();},buildRendering:function(){this.inherited(arguments);dojo.style(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"});},postCreate:function(){this.inherited(arguments);this.connect(this.textbox,"onscroll","_onInput");this.connect(this.textbox,"onresize","_onInput");this.connect(this.textbox,"onfocus","_onInput");this._setTimeoutHandle=setTimeout(dojo.hitch(this,"resize"),0);},uninitialize:function(){if(this._setTimeoutHandle){clearTimeout(this._setTimeoutHandle);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.dnd.Avatar"]){dojo._hasResource["plugins.dnd.Avatar"]=true;dojo.provide("plugins.dnd.Avatar");dojo.declare("plugins.dnd.Avatar",[dojo.dnd.Avatar],{construct:function(){var _555="";if(this.manager.nodes[0].data!=null&&this.manager.nodes[0].data.avatarType!=null){_555=this.manager.nodes[0].data.avatarType;}this.isA11y=dojo.hasClass(dojo.body(),"dijit_a11y");var a=dojo.create("table",{"class":"dojoDndAvatar "+_555,style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_556=this.manager.source,node,b=dojo.create("tbody",null,a),k=Math.min(5,this.manager.nodes.length),i=0;for(;i<k;++i){if(_556.creator){node=_556._normalizedCreator(_556.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _557=dojo.create("table"),_558=dojo.create("tbody",null,_557);_558.appendChild(node);node=_557;}}node.id="";tr=dojo.create("tr",null,b);td=dojo.create("td",null,tr);td.appendChild(node);dojo.attr(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;}});}if(!dojo._hasResource["plugins.dnd.Manager"]){dojo._hasResource["plugins.dnd.Manager"]=true;dojo.provide("plugins.dnd.Manager");dojo.declare("plugins.dnd.Manager",null,{cssFiles:[dojo.moduleUrl("plugins","dnd/css/dnd.css")],constructor:function(){Agua.loadCSSFile(this.cssFiles[0]);this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:16,OFFSET_Y:16,overSource:function(_559){if(this.avatar){this.target=(_559&&_559.targetState!="Disabled")?_559:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}dojo.publish("/dnd/source/over",[_559]);},outSource:function(_55a){if(this.avatar){if(this.target==_55a){this.target=null;this.canDropFlag=false;this.avatar.update();dojo.publish("/dnd/source/over",[null]);}}else{dojo.publish("/dnd/source/over",[null]);}},startDrag:function(_55b,_55c,copy){this.source=_55b;this.nodes=_55c;this.copy=Boolean(copy);this.avatar=this.makeAvatar();dojo.body().appendChild(this.avatar.node);dojo.publish("/dnd/start",[_55b,_55c,this.copy]);this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp"),dojo.connect(dojo.doc,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent)];var c="dojoDnd"+(copy?"Copy":"Move");dojo.addClass(dojo.body(),c);},canDrop:function(flag){var _55d=Boolean(this.target&&flag);if(this.canDropFlag!=_55d){this.canDropFlag=_55d;this.avatar.update();}},stopDrag:function(){dojo.removeClass(dojo.body(),["dojoDndCopy","dojoDndMove"]);dojo.forEach(this.events,dojo.disconnect);this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new plugins.dnd.Avatar(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){dojo.dnd.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dojo.isCopyKey(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dojo.isCopyKey(e))),_55e=[this.source,this.nodes,copy,this.target,e];dojo.publish("/dnd/drop/before",_55e);dojo.publish("/dnd/drop",_55e);}else{dojo.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case dojo.keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case dojo.keys.ESCAPE:dojo.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==dojo.keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();dojo.replaceClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dojo.dnd._manager=null;dojo.dnd.manager=function(){if(!dojo.dnd._manager){dojo.dnd._manager=new plugins.dnd.Manager();}return dojo.dnd._manager;};}if(!dojo._hasResource["plugins.dnd.Source"]){dojo._hasResource["plugins.dnd.Source"]=true;dojo.provide("plugins.dnd.Source");dojo.declare("plugins.dnd.Source",[dojo.dnd.Selector,plugins.dnd.Manager],{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,creator:function(item,hint){var data=item.data;var node=dojo.doc.createElement("div");node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.data=new Object;for(name in thisObject.formInputs){node.data[name]=item[name];}var _55f="<table>";var _560=true;for(var i=0;i<thisObject.avatarItems.length;i++){var name=thisObject.avatarItems[i];if(_560==true){_55f+="<tr><td><strong style='color: darkred'>";_55f+=data[name]+"</strong></td></tr>";}else{_55f+="<tr><td>";_55f+=data[name]+"</td></tr>";}}_55f+="</table>";node.innerHTML=_55f;return {node:node,data:item,type:["draggableItem"]};},startup:function(){if(!this.parent){this.parent=this.node;console.log("plugins.dnd.Source.startup    plugins.dnd.Source.startup()");console.log("plugins.dnd.Source.startup    console.dir(this.parent):");console.dir({parent:this.parent});if(this.parent.tagName!=null){if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}}this.defaultCreator=dojo.dnd._defaultCreator(this.parent);this.sync();}});}if(!dojo._hasResource["plugins.form.ValidationTextarea"]){dojo._hasResource["plugins.form.ValidationTextarea"]=true;dojo.provide("plugins.form.ValidationTextarea");dojo.declare("plugins.form.ValidationTextarea",[dijit.form.ValidationTextBox,dijit.form.SimpleTextarea],{invalidMessage:"This field is required",regExp:"(.|\\s)*",preamble:function(args){this.invalidMessage=args.invalidMessage;},constructor:function(args){this.invalidMessage=args.invalidMessage;this.promptMessage=args.promptMessage;},postCreate:function(){var _561=this.invalidMessage;var _562=this.promptMessage;this.inherited(arguments);this.invalidMessage=_561;this.promptMessage=_562;},validate:function(){this.inherited(arguments);if(arguments.length==0){this.validate(false);}},onFocus:function(){if(!this.isValid()){this.displayMessage(this.getErrorMessage());}},onBlur:function(){this.validate(false);}});}if(!dojo._hasResource["plugins.form.DndSource"]){dojo._hasResource["plugins.form.DndSource"]=true;dojo.provide("plugins.form.DndSource");dojo.declare("plugins.form.DndSource",[],{rowClass:null,avatarItems:[],formInputs:{},childWidgets:[],constructor:function(args){},postCreate:function(){this.startup();},startup:function(){this.initialiseDragSource();this.setDragSourceCreator();},initialiseDragSource:function(node){if(node==null){node=this.dragSourceNode;}this.dragSource=new dojo.dnd.Source(node,{copyOnly:true,selfAccept:false,accept:["none"]});},setDragSourceCreator:function(){var _563=this;this.dragSource.creator=dojo.hitch(this.dragSource,function(item,hint){var data=item.data;var node=dojo.doc.createElement("div");node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.data=new Object;for(name in _563.formInputs){node.data[name]=item[name];}var _564="<table>";for(var i=0;i<_563.avatarItems.length;i++){var name=_563.avatarItems[i];if(i==0){_564+="<tr><td class='dojoDndAvatarHeader'><strong style='color: darkred'>";_564+=data[name]+"</strong></td></tr>";}else{_564+="<tr><td>";_564+=data[name]+"</td></tr>";}}_564+="</table>";node.innerHTML=_564;return {node:node,data:item,type:["draggableItem"]};});},getItemArray:function(){},clearDragSource:function(){var _565=this.dragSource.getAllNodes();if(_565!=null){for(var i=0;i<_565.length;i++){var node=_565[i];var item=this.dragSource.getItem(node.id);this.dragSource.delItem(item);dojo.destroy(node);}}if(this.childWidgets.length!=0){for(var i=0;i<this.childWidgets.length;i++){dojo.destroy(this.childWidgets[i]);}}this.childWidgets=[];},setDragSource:function(){if(this.dragSource==null){this.initialiseDragSource();this.setDragSourceCreator();}this.clearDragSource();nodes=this.dragSource.getAllNodes();for(var id in this.dragSource.map){}var _566=this.getItemArray();this.loadDragItems(_566);},loadDragItems:function(_567,_568){this.dragSourceOnchange=false;if(_567==null||_567.length==0){return;}var _569=new Array;for(var j=0;j<_567.length;j++){var data=_567[j];_569.push({data:data,type:["draggableItem"]});}this.dragSource.insertNodes(false,_569);var _56a=this.dragSource.getAllNodes();for(var k=0;k<_56a.length;k++){var node=_56a[k];node.data=_569[k].data;if(this.avatarType!==null){node.data.avatarType=this.avatarType;}var _56b=new Object;for(name in this.formInputs){_56b[name]=_569[k].data[name];}_56b.parentWidget=this;var _56c=this.rowClass;var _56d=dojo.getObject(_56c);var _56e=new _56d(_56b);this.childWidgets.push(_56e);node.innerHTML="";node.appendChild(_56e.domNode);if(this.contextMenu!=null){this.contextMenu.bind(node);}}}});}if(!dojo._hasResource["plugins.form.EditRow"]){dojo._hasResource["plugins.form.EditRow"]=true;dojo.provide("plugins.form.EditRow");dojo.declare("plugins.form.EditRow",[plugins.core.Common],{editingRow:false,rowWidget:null,node:null,constructor:function(args){this.setTextarea();this.setEventHandlers();},postCreate:function(){this.startup();},startup:function(){},setTextarea:function(){this.textarea=document.createElement("textarea");dojo.addClass(this.textarea,"editRow");dojo.attr(this.textarea,"style","visibility: hidden");},setEventHandlers:function(){dojo.connect(this.textarea,"onblur",dojo.hitch(this,"handleOnBlur"));dojo.connect(this.textarea,"onkeypress",dojo.hitch(this,"handleOnKeyPress"));},editRow:function(_56f,node){if(this.editingRow==true){return;}this.originalText=node.innerHTML;if(this.originalText==null||!this.originalText){this.originalText="";}if(this.originalText.match(/^<i/)||this.originalText.match(/^<br/)||this.originalText.match(/^<fieldset/)||this.originalText.match(/^<textarea/)){return;}this.rowWidget=_56f;this.node=node;this.editingRow=true;this.disableDrag();node.innerHTML="";this.originalText=this.convertString(this.originalText,"htmlToText");this.textarea.value=this.originalText;node.appendChild(this.textarea);dojo.attr(this.textarea,"style","visibility: visible");this.textarea.focus();},handleOnKeyPress:function(_570){var key=_570.charOrCode;if(key==null){return;}_570.stopPropagation();if(key==dojo.keys.ESCAPE){this.handleEscape();}if(key!=13){return;}try{this.freshValue=this.convertAngleBrackets(this.textarea.value,"htmlToText");this.node.removeChild(this.textarea);this.node.focus();this.node.innerHTML=this.freshValue;this.editingRow=false;var key=this.node.getAttribute("class").match(/^(\S+)/)[1];var _571=this.convertString(this.freshValue,"htmlToText");_571=this.convertBackslash(_571,"expand");if((this.isValidInput(key,_571)==false&&this.requiredInputs[key]!=null)){dojo.addClass(this.node,"invalid");this.node.innerHTML=this.freshValue;this.enableDrag();this.textarea.blur();}else{if(this.originalText==this.freshValue){this.node.innerHTML=this.freshValue;this.enableDrag();this.textarea.blur();}else{dojo.removeClass(this.node,"invalid");this.enableDrag();var _572=this.getFormInputs(this.rowWidget);if(_572==null){this.textarea.blur();return;}this.saveInputs(_572,{reload:false,originator:this});this.textarea.blur();}}}catch(error){this.editingRow=false;}this.enableDrag();},handleEscape:function(){this.editingRow=false;this.enableDrag();this.textarea.blur();this.node.removeChild(this.textarea);this.node.innerHTML=this.originalText;},handleOnBlur:function(_573){if(this.editingRow==false){return;}var _574;if(this.textarea!=null){_574=this.textarea.parentNode;}try{if(_574!=null&&this.textarea!=null){this.textarea.blur();_574.removeChild(this.textarea);}_574.innerHTML=this.originalText;}catch(error){}this.editingRow=false;this.enableDrag();},disableDrag:function(){if(this.dragSourceWidget==null){return;}this.dragSourceWidget.isSource=false;},enableDrag:function(){if(this.dragSourceWidget==null){return;}this.dragSourceWidget.isSource=true;}});}if(!dojo._hasResource["plugins.form.DndTrash"]){dojo._hasResource["plugins.form.DndTrash"]=true;dojo.provide("plugins.form.DndTrash");dojo.declare("plugins.form.DndTrash",[],{dataFields:["name"],constructor:function(args){console.log("Dnd.constructor     plugins.form.DndTrash.constructor");},postCreate:function(){console.log("Dnd.postCreate    plugins.admin.Controller.postCreate()");this.startup();},startup:function(){console.log("Dnd.startup    plugins.form.DndTrash.startup()");this.setTrash(this.dataFields);},setTrash:function(_575){this.trash=new dojo.dnd.Source(this.trashContainer,{accept:["draggableItem"]});var _576=this;dojo.connect(this.trash,"onDndDrop",dojo.hitch(this,function(_577,_578,copy,_579){if(_579==_576.trash){try{var node=_578[0];var _57a=new Object;for(var i=0;i<_575.length;i++){_57a[_575[i]]=node.data[_575[i]];}node.parentNode.removeChild(node);_576.deleteItem(_57a);}catch(error){}while(_576.trashContainer.childNodes.length>2){_576.trashContainer.removeChild(_576.trashContainer.childNodes[2]);}}}));}});}if(!dojo._hasResource["plugins.form.Inputs"]){dojo._hasResource["plugins.form.Inputs"]=true;dojo.provide("plugins.form.Inputs");dojo.declare("plugins.form.Inputs",[plugins.core.Common],{formInputs:{},defaultInputs:{},requiredInputs:{},invalidInputs:{},constructor:function(args){},postCreate:function(){this.startup();},startup:function(){},setClearValues:function(){for(var name in this.invalidInputs){dojo.connect(this[name],"onclick",dojo.hitch(this,"clearValue",this[name],this.invalidInputs[name]));dojo.connect(this[name],"onfocus",dojo.hitch(this,"clearValue",this[name],this.invalidInputs[name]));}},chainInputs:function(_57b){for(var i=0;i<_57b.length-1;i++){var name=_57b[i];var _57c=_57b[i+1];this.chainOnkey(name,_57c);}},chainOnkey:function(_57d,next){var _57e=this;dojo.connect(this[_57d],"onkeypress",this,function(_57f){if(_57f.charOrCode==13){_57e[next].focus();setTimeout(function(){_57e[_57d].scrollTop=0;},50);}});},saveInputs:function(_580,_581){if(this.saving==true){return;}this.saving=true;var _582=false;if(_580==null){_582=true;_580=this.getFormInputs(this);if(_580==null){this.saving=false;return;}}var _583=new Object;_583.username=Agua.cookie("username");_583.sessionId=Agua.cookie("sessionId");for(var _584 in _580){_583[_584]=_580[_584];}this.saving=false;this.addItem(_583,_582);},getFormInputs:function(_585){var _586=new Object;for(var name in this.formInputs){_586[name]=this.processWidgetValue(_585,name);_586[name]=this.convertBackslash(_586[name],"expand");_586[name]=this.convertAngleBrackets(_586[name],"htmlToText");_586[name]=this.convertAmpersand(_586[name],"htmlToText");}_586=this.checkInputs(_585,_586);return _586;},processWidgetValue:function(_587,name){console.log("Inputs.processWidgetValue    (widget: "+_587+", name: "+name+")");console.dir({widget:_587});var _588=this.getWidgetValue(_587[name]);console.log("Inputs.processWidgetValue    (name: "+name+", value: "+_588+")");if(_588==null){return _588;}if(_588.replace==null){return _588;}if(_588==null){return null;}if(_587.formInputs[name]=="word"){_588=this.cleanWord(_588);}else{if(_587.formInputs[name]=="phrase"){_588=this.cleanEnds(_588);}}if(_588!=null){this.setWidgetValue(_587[name],_588);}console.log("Inputs.processWidgetValue    widget: "+_587+", name: "+name+". Returning value: "+_588);return _588;},getWidgetValue:function(_589){var _58a;if(_589.id!=null&&_589.id.match(/^dijit_form_NumberTextBox/)){_58a=String(_589);}else{if(_589.get&&_589.get("value")){_58a=_589.get("value");}else{if(_589.getValue){_58a=_589.getValue();}else{if(_589.value){_58a=String(_589.value.toString());}else{if(_589.innerHTML){if(_589.innerHTML=="<input type=\"checkbox\">"){_58a=_589.childNodes[0].checked;}else{_58a=_589.innerHTML;}}}}}}if(_58a==null){_58a="";}return _58a;},setWidgetValue:function(_58b,_58c){if(_58b.id!=null&&_58b.id.match(/^dijit_form_NumberTextBox/)){_58b.set("value",_58c);}else{if(_58b.set){_58b.set("value",_58c);}else{if(_58b.setValue){_58b.setValue(_58c);}else{if(_58b.value){_58b.value=_58c;}else{if(_58b.innerHTML){_58b.innerHTML=_58c;}}}}}},clearValue:function(_58d,_58e){if(_58d==null){return;}if(this.getWidgetValue(_58d)==_58e){this.setWidgetValue(_58d,"");}},checkInputs:function(_58f,_590){console.log("Inputs.checkInputs    plugins.form.Inputs.checkInputs(inputs)");console.log("Inputs.checkInputs    inputs: "+dojo.toJson(_590));this.allValid=true;for(var key in this.formInputs){var _591=_590[key];console.log("Inputs.checkInputs    Checking "+key+": "+_591);if(this.isValidInput(key,_591)){console.log("Inputs.checkInputs    removing 'invalid' class for "+key+": "+_591);this.setValid(_58f[key]);}else{console.log("Inputs.checkInputs    adding 'invalid' class for name "+key+", value "+_591);this.setInvalid(_58f[key]);this.allValid=false;}}console.log("Inputs.checkInputs    this.allValid: "+this.allValid);if(this.allValid==false){return null;}for(var key in this.formInputs){console.log("Inputs.checkInputs    BEFORE convert, inputs[key]: "+dojo.toJson(_590[key]));_590[key]=this.convertAngleBrackets(_590[key],"htmlToText");console.log("Inputs.checkInputs    AFTER convert, inputs[key]: "+dojo.toJson(_590[key]));}return _590;},setValid:function(_592){this.removeClass(_592,"invalid");},setInvalid:function(_593){this.addClass(_593,"invalid");},removeClass:function(_594,_595){if(_594.id!=null&&_594.id.match(/^dijit_form_/)){dojo.removeClass(_594.domNode,_595);}else{if(_594.domNode){dojo.removeClass(_594.domNode,_595);}else{dojo.removeClass(_594,_595);}}},addClass:function(_596,_597){if(_596.id!=null&&_596.id.match(/^dijit_form_/)){dojo.addClass(_596.domNode,_597);}else{if(_596.domNode){dojo.addClass(_596.domNode,_597);}else{dojo.addClass(_596,_597);}}},isValidInput:function(name,_598){if(this.invalidInputs[name]==null){return true;}else{if(this.requiredInputs[name]==null){return true;}else{if(_598==null){return false;}else{if(_598==""){return false;}else{if(this.invalidInputs[name]==_598){return false;}}}}}return true;}});}if(!dojo._hasResource["plugins.form.EditForm"]){dojo._hasResource["plugins.form.EditForm"]=true;dojo.provide("plugins.form.EditForm");dojo.declare("plugins.form.EditForm",[plugins.form.EditRow,plugins.form.Inputs,plugins.form.DndTrash,plugins.form.DndSource],{constructor:function(args){},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);}});}if(!dojo._hasResource["plugins.admin.Amis"]){dojo._hasResource["plugins.admin.Amis"]=true;dojo.provide("plugins.admin.Amis");dojo.declare("plugins.admin.Amis",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!--http://aws.amazon.com/ec2/instance-types/-->\n\n\t<!-- ami TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"ami\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"AMIs\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t>\n\n\t<table align=\"center\" width=\"100%\">\n\n\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t<td colspan=\"3\" class=\"tabTitle\" align=\"center\">AMIs</td>\n\t\t</tr>\n\n\t\t<tr height=\"20px\">\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"addAmiButton\"\n\t\t\t\t\tclass=\"addAmiButton\"\n\t\t\t\t\t>Add AMI</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr class=\"headerRow\">\n\t\t\t<td>AMI ID</td>\n\t\t\t<td>AMI Name</td>\n\t\t\t<td>AMI Type</td>\n\t\t</tr>\n\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"amiid\"\n\t\t\t\t\tclass=\"amiid\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"ami-d1c42db8\"\n\t\t\t\t\ttitle=\"AMI ID of the Starcluster image used for all cluster nodes (The base x86_64 StarCluster AMI is ami-d1c42db8)\"\n\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\tregExp=\"^ami-[A-F0-9a-f]{8}$\"\n\t\t\t\t\tmaxlength=\"12\" \n\t\t\t\t\tpromptMessage=\"AMI identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g. ami-d1c42db8\" \n\t\t\t\t\tinvalidMessage=\"AMI identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g., ami-d1c42db8\" \n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\twrap=\"off\"\n\t\t\t\t>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"aminame\"\n\t\t\t\t\tclass=\"aminame\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"myAmi\"\n\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\tregExp=\"^\\S{1,20}$\"\n\t\t\t\t\tmaxlength=\"20\" \n\t\t\t\t\tpromptMessage=\"AMI name: up to 20 characters (no spaces)\" \n\t\t\t\t\tinvalidMessage=\"AMI name: up to 20 characters (no spaces)\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<select\n\t\t\t\t\tdojoAttachPoint=\"amitype\"\n\t\t\t\t\tclass=\"amitype\"\n\t\t\t\t\ttitle=\"AMI type: EBS-backed (stop/startable, retains its state) or emphemeral S3 type\">\n\t\t\t\t\t<option value=\"EBS\">EBS</option> \n\t\t\t\t\t<option value=\"S3\">S3</option>\n\t\t\t\t</select>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr class=\"headerRow\" width=\"95%\" height=\"8px\">\n\t\t\t<td colspan=\"3\">Description</td>\n\t\t</tr>\n\n\t\t<tr width=\"95%\" >\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<textarea\n\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\tclass=\"description\"\n\t\t\t\t\tcols=\"40\"\n\t\t\t\t\trows=\"1\"\n\t\t\t\t\ttitle=\"A brief description of the cluster group\"\n\t\t\t\t>Description</textarea>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t<td colspan=\"3\" width=\"95%\">\n\t\t\t\t<div class=\"label\"> AMIs </div>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\tstyle=\"height: 327px; width: 95%;\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr align=\"center\">\n\t\t\t<td colspan=\"3\" align=\"center\">\n\n\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</table>\n\n\n\t</div>\n\t<!-- END ami TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins")+"/admin/css/ami.css"],parentWidget:null,formInputs:{aminame:"word",amiid:"word",amitype:"word",description:"phrase"},defaultInputs:{aminame:"myAmi",amiid:"AMI ID",description:"Description"},requiredInputs:{aminame:1,amiid:1},invalidInputs:{aminame:"myAmi",amiid:"AMI ID",description:"Description"},dataFields:["amiid","aminame"],rowClass:"plugins.admin.AmiRow",avatarType:"parameters",avatarItems:["aminame","amiid","amitype","description"],constructor:function(args){this.parentWidget=args.parentWidget;this.ami=args.parentWidget.ami;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("Amis.startup    plugins.admin.Amis.startup()");this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.setForm();this.setClearValues();this.setDragSource();console.log("Amis.startup    BEFORE this.setTrash(this.dataFields), I.E., plugins.form.DndTrash.startup()");this.setTrash(this.dataFields);console.log("Amis.startup    AFTER this.setTrash(this.dataFields), I.E., plugins.form.DndTrash.startup()");Agua.updater.subscribe(this,"updateAmis");},updateAmis:function(args){console.log("Amis.updateAmis(args)");console.log("Amis.updateAmis    args: ");console.dir(args);if(args.originator==this){if(args.reload==false){return;}}console.log("Amis.updateAmis    Calling setDragSource()");this.setDragSource();},setForm:function(){console.log("Amis.setForm    plugins.admin.Amis.setForm()");dojo.connect(this.addAmiButton,"onclick",dojo.hitch(this,"saveInputs",null,null));dojo.connect(this.aminame,"onFocus",dojo.hitch(this,"clearValue",this.aminame,this.invalidInputs["aminame"]));this.inherited(arguments);},getItemArray:function(){return Agua.getAmis();},setDragSource:function(){console.log("Amis.setDragSource     plugins.admin.Amis.setDragSource()");if(this.dragSource==null){this.initialiseDragSource();this.setDragSourceCreator();}this.clearDragSource();var _599=this.getItemArray();console.log("Amis.setDragSource     itemArray: "+dojo.toJson(_599));_599=this.sortHasharray(_599,"aminame");console.log("Amis.setDragSource    itemArray: "+dojo.toJson(_599));if(_599==null){console.log("Amis.setDragSource     itemArray is null or empty. Returning.");return;}this.loadDragItems(_599);},saveInputs:function(_59a,_59b){console.log("Amis.saveInputs    plugins.admin.Amis.saveInputs(inputs, reload)");console.log("Amis.saveInputs    inputs: "+dojo.toJson(_59a));console.log("Amis.saveInputs    reload: ");console.dir(_59b);if(this.saving==true){return;}this.saving=true;if(_59a==null){_59a=this.getFormInputs(this);console.log("Amis.saveInputs    inputs: ");console.dir({inputs:_59a});if(_59a==null){this.saving=false;return;}}console.log("Amis.saveInputs    inputs: "+dojo.toJson(_59a));Agua.addAmi(_59a);this.saving=false;Agua.updater.update("updateAmis",{originator:this,reload:_59b});},deleteItem:function(_59c){console.log("Amis.deleteItem    plugins.admin.Amis.deleteItem(name)");console.log("Amis.deleteItem    amiObject: "+dojo.toJson(_59c));Agua.removeAmi(_59c);Agua.updater.update("updateAmis",{originator:this,reload:false});},checkEnter:function(_59d){console.log("Amis.checkEnter    event.keyCode: "+_59d.keyCode);if(_59d.keyCode==dojo.keys.ENTER){this.saveInputs();dojo.stopEvent(_59d);}},checkEnterNodes:function(_59e){console.log("Amis.checkEnterNodes    event.keyCode: "+_59e.keyCode);if(_59e.keyCode==dojo.keys.ENTER){dojo.stopEvent(_59e);console.log("Amis.checkEnterNodes    setting document.body.focus()");document.body.focus();this.checkNodeNumbers();this.saveInputs();}},checkNodeNumbers:function(){console.log("Amis.checkNodeNumbers     plugins.admin.Amis.checkNodeNumbers()");console.log("Amis.checkNodeNumbers     this.minnodes.get('value'): "+this.minnodes.get("value"));console.log("Amis.checkNodeNumbers     this.maxnodes.get('value'): "+this.maxnodes.get("value"));if(this.minnodes.value>this.maxnodes.value){console.log("Amis.checkNodeNumbers     this.minnodes.value > this.maxnodes.value");this.minnodes.set("value",this.maxnodes.value);}}});}if(!dojo._hasResource["plugins.admin.AppRow"]){dojo._hasResource["plugins.admin.AppRow"]=true;dojo.provide("plugins.admin.AppRow");dojo.declare("plugins.admin.AppRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"2\">\n        <tr>\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n\t\t\t\ttitle=\"name: Name of application\"\n                >${name}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"type\"\n                class=\"type\"\n\t\t\t\ttitle=\"type: Type of application (e.g., 'pipeline', 'converter', 'utility')\"\n                >${type}</td>\n        </tr>\n\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n\n\t\t\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"executor\"\n                class=\"executor\"\n\t\t\t\ttitle=\"executor: Additional executable used to run application (e.g., '/usr/bin/perl')\"\n            >${executor}</td>\n\n            <td \n                colspan=\"1\"\n                dojoAttachPoint=\"packageCombo\"\n                class=\"package\"\n\t\t\t\ttitle=\"package: Package to which the application belongs\"\n            >${package}</td>\n            \n            <td colspan=\"1\"\n                class=\"localonly\"\n                title=\"localonly: Select to make application only executable locally (e.g., a herder that manages cluster jobs)\"\n                dojoAttachPoint=\"localonlyContainer\"\n            >\n                <span>\n                    Local Only\n                </span>\n                \n                <span\n                    dojoAttachPoint=\"localonly\"\n                    dojoType=\"dijit.form.CheckBox\"\n                    dojoAttachEvent=\"onClick:submitChange\"\n                    checked=\"false\"\n                    class=\"newLocalOnlyCheckbox\"\n                ></span>\n            </td>\n\n        </tr>\n        <tr>\n\n            <td colspan=\"3\"\n                dojoAttachPoint=\"location\"\n                class='location'\n\t\t\t\ttitle=\"location: Absolute path (e.g., '/home/myname/myapp.pl') or path relative to Agua base folder (e.g., 'bin/apps/myScript.pl')\"\n            >${location}</td>\n\t\t\t\t\t\t\t\n\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                class='description'\n\t\t\t\ttitle=\"description: A brief description of the application\"\n            >${description}</td>\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"notes\"\n                class='notes'\n\t\t\t\ttitle=\"notes: Notes on the application (e.g., release notes, constraints)\"\n            >${notes}</td>\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"url\"\n                class='url'\n\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/applications)\"\n\t\t\t>${url}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.checkboxOn=args.submit;this.parentWidget=args.parentWidget;this.formInputs=this.parentWidget.formInputs;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);var _59f=this;dojo.connect(this.name,"onclick",function(_5a0){_59f.toggle();});var _59f=this;var _5a1=["executor","location","description","notes","url"];for(var i in _5a1){dojo.connect(this[_5a1[i]],"onclick",function(_5a2){_59f.parentWidget.editRow(_59f,_5a2.target);_5a2.stopPropagation();});}if(this.checkboxOn!=null&&this.checkboxOn==1){this.localonly.setValue("on");}},submitChange:function(_5a3){_5a3.stopPropagation();var _5a4=this.parentWidget.getFormInputs(this);if(_5a4==null){return;}this.parentWidget.saveInputs(_5a4,{reload:false});},toggle:function(){var _5a5=["executor","packageCombo","location","localonlyContainer","description","notes","url"];for(var i in _5a5){console.log("AppRow.toggle    this["+_5a5[i]+"]: "+this[_5a5[i]]);if(this[_5a5[i]].style.display=="inline-block"){this[_5a5[i]].style.display="none";}else{this[_5a5[i]].style.display="inline-block";}}}});}if(!dojo._hasResource["dijit.form.ToggleButton"]){dojo._hasResource["dijit.form.ToggleButton"]=true;dojo.provide("dijit.form.ToggleButton");}if(!dojo._hasResource["dijit.form.CheckBox"]){dojo._hasResource["dijit.form.CheckBox"]=true;dojo.provide("dijit.form.CheckBox");dojo.declare("dijit.form.CheckBox",dijit.form.ToggleButton,{templateString:dojo.cache("dijit.form","templates/CheckBox.html","<div class=\"dijit dijitReset dijitInline\" role=\"presentation\"\n\t><input\n\t \t${!nameAttrSetting} type=\"${type}\" ${checkedAttrSetting}\n\t\tclass=\"dijitReset dijitCheckBoxInput\"\n\t\tdojoAttachPoint=\"focusNode\"\n\t \tdojoAttachEvent=\"onclick:_onClick\"\n/></div>\n"),baseClass:"dijitCheckBox",type:"checkbox",value:"on",readOnly:false,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{readOnly:"focusNode"}),_setReadOnlyAttr:function(_5a6){this._set("readOnly",_5a6);dojo.attr(this.focusNode,"readOnly",_5a6);dijit.setWaiState(this.focusNode,"readonly",_5a6);},_setValueAttr:function(_5a7,_5a8){if(typeof _5a7=="string"){this._set("value",_5a7);dojo.attr(this.focusNode,"value",_5a7);_5a7=true;}if(this._created){this.set("checked",_5a7,_5a8);}},_getValueAttr:function(){return (this.checked?this.value:false);},_setLabelAttr:undefined,postMixInProperties:function(){if(this.value==""){this.value="on";}this.checkedAttrSetting=this.checked?"checked":"";this.inherited(arguments);},_fillContent:function(_5a9){},reset:function(){this._hasBeenBlurred=false;this.set("checked",this.params.checked||false);this._set("value",this.params.value||"on");dojo.attr(this.focusNode,"value",this.value);},_onFocus:function(){if(this.id){dojo.query("label[for='"+this.id+"']").addClass("dijitFocusedLabel");}this.inherited(arguments);},_onBlur:function(){if(this.id){dojo.query("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");}this.inherited(arguments);},_onClick:function(e){if(this.readOnly){dojo.stopEvent(e);return false;}return this.inherited(arguments);}});dojo.declare("dijit.form.RadioButton",dijit.form.CheckBox,{type:"radio",baseClass:"dijitRadio",_setCheckedAttr:function(_5aa){this.inherited(arguments);if(!this._created){return;}if(_5aa){var _5ab=this;dojo.query("INPUT[type=radio]",this.focusNode.form||dojo.doc).forEach(function(_5ac){if(_5ac.name==_5ab.name&&_5ac!=_5ab.focusNode&&_5ac.form==_5ab.focusNode.form){var _5ad=dijit.getEnclosingWidget(_5ac);if(_5ad&&_5ad.checked){_5ad.set("checked",false);}}});}},_clicked:function(e){if(!this.checked){this.set("checked",true);}}});}if(!dojo._hasResource["dojo.dnd.TimedMoveable"]){dojo._hasResource["dojo.dnd.TimedMoveable"]=true;dojo.provide("dojo.dnd.TimedMoveable");(function(){var _5ae=dojo.dnd.Moveable.prototype.onMove;dojo.declare("dojo.dnd.TimedMoveable",dojo.dnd.Moveable,{timeout:40,constructor:function(node,_5af){if(!_5af){_5af={};}if(_5af.timeout&&typeof _5af.timeout=="number"&&_5af.timeout>=0){this.timeout=_5af.timeout;}},markupFactory:function(_5b0,node){return new dojo.dnd.TimedMoveable(node,_5b0);},onMoveStop:function(_5b1){if(_5b1._timer){clearTimeout(_5b1._timer);_5ae.call(this,_5b1,_5b1._leftTop);}dojo.dnd.Moveable.prototype.onMoveStop.apply(this,arguments);},onMove:function(_5b2,_5b3){_5b2._leftTop=_5b3;if(!_5b2._timer){var _5b4=this;_5b2._timer=setTimeout(function(){_5b2._timer=null;_5ae.call(_5b4,_5b2,_5b2._leftTop);},this.timeout);}}});})();}if(!dojo._hasResource["dijit.form._FormMixin"]){dojo._hasResource["dijit.form._FormMixin"]=true;dojo.provide("dijit.form._FormMixin");dojo.declare("dijit.form._FormMixin",null,{state:"",reset:function(){dojo.forEach(this.getDescendants(),function(_5b5){if(_5b5.reset){_5b5.reset();}});},validate:function(){var _5b6=false;return dojo.every(dojo.map(this.getDescendants(),function(_5b7){_5b7._hasBeenBlurred=true;var _5b8=_5b7.disabled||!_5b7.validate||_5b7.validate();if(!_5b8&&!_5b6){dojo.window.scrollIntoView(_5b7.containerNode||_5b7.domNode);_5b7.focus();_5b6=true;}return _5b8;}),function(item){return item;});},setValues:function(val){dojo.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",val);},_setValueAttr:function(obj){var map={};dojo.forEach(this.getDescendants(),function(_5b9){if(!_5b9.name){return;}var _5ba=map[_5b9.name]||(map[_5b9.name]=[]);_5ba.push(_5b9);});for(var name in map){if(!map.hasOwnProperty(name)){continue;}var _5bb=map[name],_5bc=dojo.getObject(name,false,obj);if(_5bc===undefined){continue;}if(!dojo.isArray(_5bc)){_5bc=[_5bc];}if(typeof _5bb[0].checked=="boolean"){dojo.forEach(_5bb,function(w,i){w.set("value",dojo.indexOf(_5bc,w.value)!=-1);});}else{if(_5bb[0].multiple){_5bb[0].set("value",_5bc);}else{dojo.forEach(_5bb,function(w,i){w.set("value",_5bc[i]);});}}}},getValues:function(){dojo.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value");},_getValueAttr:function(){var obj={};dojo.forEach(this.getDescendants(),function(_5bd){var name=_5bd.name;if(!name||_5bd.disabled){return;}var _5be=_5bd.get("value");if(typeof _5bd.checked=="boolean"){if(/Radio/.test(_5bd.declaredClass)){if(_5be!==false){dojo.setObject(name,_5be,obj);}else{_5be=dojo.getObject(name,false,obj);if(_5be===undefined){dojo.setObject(name,null,obj);}}}else{var ary=dojo.getObject(name,false,obj);if(!ary){ary=[];dojo.setObject(name,ary,obj);}if(_5be!==false){ary.push(_5be);}}}else{var prev=dojo.getObject(name,false,obj);if(typeof prev!="undefined"){if(dojo.isArray(prev)){prev.push(_5be);}else{dojo.setObject(name,[prev,_5be],obj);}}else{dojo.setObject(name,_5be,obj);}}});return obj;},isValid:function(){return this.state=="";},onValidStateChange:function(_5bf){},_getState:function(){var _5c0=dojo.map(this._descendants,function(w){return w.get("state")||"";});return dojo.indexOf(_5c0,"Error")>=0?"Error":dojo.indexOf(_5c0,"Incomplete")>=0?"Incomplete":"";},disconnectChildren:function(){dojo.forEach(this._childConnections||[],dojo.hitch(this,"disconnect"));dojo.forEach(this._childWatches||[],function(w){w.unwatch();});},connectChildren:function(_5c1){var _5c2=this;this.disconnectChildren();this._descendants=this.getDescendants();var set=_5c1?function(name,val){_5c2[name]=val;}:dojo.hitch(this,"_set");set("value",this.get("value"));set("state",this._getState());var _5c3=(this._childConnections=[]),_5c4=(this._childWatches=[]);dojo.forEach(dojo.filter(this._descendants,function(item){return item.validate;}),function(_5c5){dojo.forEach(["state","disabled"],function(attr){_5c4.push(_5c5.watch(attr,function(attr,_5c6,_5c7){_5c2.set("state",_5c2._getState());}));});});var _5c8=function(){if(_5c2._onChangeDelayTimer){clearTimeout(_5c2._onChangeDelayTimer);}_5c2._onChangeDelayTimer=setTimeout(function(){delete _5c2._onChangeDelayTimer;_5c2._set("value",_5c2.get("value"));},10);};dojo.forEach(dojo.filter(this._descendants,function(item){return item.onChange;}),function(_5c9){_5c3.push(_5c2.connect(_5c9,"onChange",_5c8));_5c4.push(_5c9.watch("disabled",_5c8));});},startup:function(){this.inherited(arguments);this.connectChildren(true);this.watch("state",function(attr,_5ca,_5cb){this.onValidStateChange(_5cb=="");});},destroy:function(){this.disconnectChildren();this.inherited(arguments);}});}if(!dojo._hasResource["dijit._DialogMixin"]){dojo._hasResource["dijit._DialogMixin"]=true;dojo.provide("dijit._DialogMixin");dojo.declare("dijit._DialogMixin",null,{attributeMap:dijit._Widget.prototype.attributeMap,execute:function(_5cc){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"));},_getFocusItems:function(){var _5cd=dijit._getTabNavigable(this.containerNode);this._firstFocusItem=_5cd.lowest||_5cd.first||this.closeButtonNode||this.domNode;this._lastFocusItem=_5cd.last||_5cd.highest||this._firstFocusItem;}});}if(!dojo._hasResource["dijit.DialogUnderlay"]){dojo._hasResource["dijit.DialogUnderlay"]=true;dojo.provide("dijit.DialogUnderlay");dojo.declare("dijit.DialogUnderlay",[dijit._Widget,dijit._Templated],{templateString:"<div class='dijitDialogUnderlayWrapper'><div class='dijitDialogUnderlay' dojoAttachPoint='node'></div></div>",dialogId:"","class":"",attributeMap:{id:"domNode"},_setDialogIdAttr:function(id){dojo.attr(this.node,"id",id+"_underlay");this._set("dialogId",id);},_setClassAttr:function(_5ce){this.node.className="dijitDialogUnderlay "+_5ce;this._set("class",_5ce);},postCreate:function(){dojo.body().appendChild(this.domNode);},layout:function(){var is=this.node.style,os=this.domNode.style;os.display="none";var _5cf=dojo.window.getBox();os.top=_5cf.t+"px";os.left=_5cf.l+"px";is.width=_5cf.w+"px";is.height=_5cf.h+"px";os.display="block";},show:function(){this.domNode.style.display="block";this.layout();this.bgIframe=new dijit.BackgroundIframe(this.domNode);},hide:function(){this.bgIframe.destroy();delete this.bgIframe;this.domNode.style.display="none";}});}if(!dojo._hasResource["dijit.TooltipDialog"]){dojo._hasResource["dijit.TooltipDialog"]=true;dojo.provide("dijit.TooltipDialog");dojo.declare("dijit.TooltipDialog",[dijit.layout.ContentPane,dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin],{title:"",doLayout:false,autofocus:true,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:dojo.cache("dijit","templates/TooltipDialog.html","<div role=\"presentation\" tabIndex=\"-1\">\n\t<div class=\"dijitTooltipContainer\" role=\"presentation\">\n\t\t<div class =\"dijitTooltipContents dijitTooltipFocusNode\" dojoAttachPoint=\"containerNode\" role=\"dialog\"></div>\n\t</div>\n\t<div class=\"dijitTooltipConnector\" role=\"presentation\"></div>\n</div>\n"),_setTitleAttr:function(_5d0){this.containerNode.title=_5d0;this._set("title",_5d0);},postCreate:function(){this.inherited(arguments);this.connect(this.containerNode,"onkeypress","_onKey");},orient:function(node,_5d1,_5d2){var newC="dijitTooltipAB"+(_5d2.charAt(1)=="L"?"Left":"Right")+" dijitTooltip"+(_5d2.charAt(0)=="T"?"Below":"Above");dojo.replaceClass(this.domNode,newC,this._currentOrientClass||"");this._currentOrientClass=newC;},focus:function(){this._getFocusItems(this.containerNode);dijit.focus(this._firstFocusItem);},onOpen:function(pos){this.orient(this.domNode,pos.aroundCorner,pos.corner);this._onShow();},onClose:function(){this.onHide();},_onKey:function(evt){var node=evt.target;var dk=dojo.keys;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.containerNode);}var _5d3=(this._firstFocusItem==this._lastFocusItem);if(evt.charOrCode==dk.ESCAPE){setTimeout(dojo.hitch(this,"onCancel"),0);dojo.stopEvent(evt);}else{if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_5d3){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_5d3){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{if(evt.charOrCode===dk.TAB){evt.stopPropagation();}}}}}});}if(!dojo._hasResource["dijit.Dialog"]){dojo._hasResource["dijit.Dialog"]=true;dojo.provide("dijit.Dialog");dojo.declare("dijit._DialogBase",[dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin,dijit._CssStateMixin],{templateString:dojo.cache("dijit","templates/Dialog.html","<div class=\"dijitDialog\" role=\"dialog\" aria-labelledby=\"${id}_title\">\n\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\n\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"ondijitclick: onCancel\" title=\"${buttonCancel}\" role=\"button\" tabIndex=\"-1\">\n\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t</span>\n\t</div>\n\t\t<div dojoAttachPoint=\"containerNode\" class=\"dijitDialogPaneContent\"></div>\n</div>\n"),baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:[{node:"titleNode",type:"innerHTML"},{node:"titleBar",type:"attribute"}],"aria-describedby":""}),open:false,duration:dijit.defaultDuration,refocus:true,autofocus:true,_firstFocusItem:null,_lastFocusItem:null,doLayout:false,draggable:true,"aria-describedby":"",postMixInProperties:function(){var _5d4=dojo.i18n.getLocalization("dijit","common");dojo.mixin(this,_5d4);this.inherited(arguments);},postCreate:function(){dojo.style(this.domNode,{display:"none",position:"absolute"});dojo.body().appendChild(this.domNode);this.inherited(arguments);this.connect(this,"onExecute","hide");this.connect(this,"onCancel","hide");this._modalconnects=[];},onLoad:function(){this._position();if(this.autofocus&&dijit._DialogLevelManager.isTop(this)){this._getFocusItems(this.domNode);dijit.focus(this._firstFocusItem);}this.inherited(arguments);},_endDrag:function(e){if(e&&e.node&&e.node===this.domNode){this._relativePosition=dojo.position(e.node);}},_setup:function(){var node=this.domNode;if(this.titleBar&&this.draggable){this._moveable=(dojo.isIE==6)?new dojo.dnd.TimedMoveable(node,{handle:this.titleBar}):new dojo.dnd.Moveable(node,{handle:this.titleBar,timeout:0});this._dndListener=dojo.subscribe("/dnd/move/stop",this,"_endDrag");}else{dojo.addClass(node,"dijitDialogFixed");}this.underlayAttrs={dialogId:this.id,"class":dojo.map(this["class"].split(/\s/),function(s){return s+"_underlay";}).join(" ")};},_size:function(){this._checkIfSingleChild();if(this._singleChild){if(this._singleChildOriginalStyle){this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle;}delete this._singleChildOriginalStyle;}else{dojo.style(this.containerNode,{width:"auto",height:"auto"});}var mb=dojo._getMarginSize(this.domNode);var _5d5=dojo.window.getBox();if(mb.w>=_5d5.w||mb.h>=_5d5.h){var w=Math.min(mb.w,Math.floor(_5d5.w*0.75)),h=Math.min(mb.h,Math.floor(_5d5.h*0.75));if(this._singleChild&&this._singleChild.resize){this._singleChildOriginalStyle=this._singleChild.domNode.style.cssText;this._singleChild.resize({w:w,h:h});}else{dojo.style(this.containerNode,{width:w+"px",height:h+"px",overflow:"auto",position:"relative"});}}else{if(this._singleChild&&this._singleChild.resize){this._singleChild.resize();}}},_position:function(){if(!dojo.hasClass(dojo.body(),"dojoMove")){var node=this.domNode,_5d6=dojo.window.getBox(),p=this._relativePosition,bb=p?null:dojo._getBorderBox(node),l=Math.floor(_5d6.l+(p?p.x:(_5d6.w-bb.w)/2)),t=Math.floor(_5d6.t+(p?p.y:(_5d6.h-bb.h)/2));dojo.style(node,{left:l+"px",top:t+"px"});}},_onKey:function(evt){if(evt.charOrCode){var dk=dojo.keys;var node=evt.target;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.domNode);}var _5d7=(this._firstFocusItem==this._lastFocusItem);if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_5d7){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_5d7){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{while(node){if(node==this.domNode||dojo.hasClass(node,"dijitPopup")){if(evt.charOrCode==dk.ESCAPE){this.onCancel();}else{return;}}node=node.parentNode;}if(evt.charOrCode!==dk.TAB){dojo.stopEvent(evt);}else{if(!dojo.isOpera){try{this._firstFocusItem.focus();}catch(e){}}}}}}},show:function(){if(this.open){return;}if(!this._started){this.startup();}if(!this._alreadyInitialized){this._setup();this._alreadyInitialized=true;}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}this._modalconnects.push(dojo.connect(window,"onscroll",this,"layout"));this._modalconnects.push(dojo.connect(window,"onresize",this,function(){var _5d8=dojo.window.getBox();if(!this._oldViewport||_5d8.h!=this._oldViewport.h||_5d8.w!=this._oldViewport.w){this.layout();this._oldViewport=_5d8;}}));this._modalconnects.push(dojo.connect(this.domNode,"onkeypress",this,"_onKey"));dojo.style(this.domNode,{opacity:0,display:""});this._set("open",true);this._onShow();this._size();this._position();var _5d9;this._fadeInDeferred=new dojo.Deferred(dojo.hitch(this,function(){_5d9.stop();delete this._fadeInDeferred;}));_5d9=dojo.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:dojo.hitch(this,function(){dijit._DialogLevelManager.show(this,this.underlayAttrs);}),onEnd:dojo.hitch(this,function(){if(this.autofocus&&dijit._DialogLevelManager.isTop(this)){this._getFocusItems(this.domNode);dijit.focus(this._firstFocusItem);}this._fadeInDeferred.callback(true);delete this._fadeInDeferred;})}).play();return this._fadeInDeferred;},hide:function(){if(!this._alreadyInitialized){return;}if(this._fadeInDeferred){this._fadeInDeferred.cancel();}var _5da;this._fadeOutDeferred=new dojo.Deferred(dojo.hitch(this,function(){_5da.stop();delete this._fadeOutDeferred;}));_5da=dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,function(){this.domNode.style.display="none";dijit._DialogLevelManager.hide(this);this.onHide();this._fadeOutDeferred.callback(true);delete this._fadeOutDeferred;})}).play();if(this._scrollConnected){this._scrollConnected=false;}dojo.forEach(this._modalconnects,dojo.disconnect);this._modalconnects=[];if(this._relativePosition){delete this._relativePosition;}this._set("open",false);return this._fadeOutDeferred;},layout:function(){if(this.domNode.style.display!="none"){if(dijit._underlay){dijit._underlay.layout();}this._position();}},destroy:function(){if(this._fadeInDeferred){this._fadeInDeferred.cancel();}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}if(this._moveable){this._moveable.destroy();}if(this._dndListener){dojo.unsubscribe(this._dndListener);}dojo.forEach(this._modalconnects,dojo.disconnect);dijit._DialogLevelManager.hide(this);this.inherited(arguments);}});dojo.declare("dijit.Dialog",[dijit.layout.ContentPane,dijit._DialogBase],{});dijit._DialogLevelManager={show:function(_5db,_5dc){var ds=dijit._dialogStack;ds[ds.length-1].focus=dijit.getFocus(_5db);var _5dd=dijit._underlay;if(!_5dd||_5dd._destroyed){_5dd=dijit._underlay=new dijit.DialogUnderlay(_5dc);}else{_5dd.set(_5db.underlayAttrs);}var _5de=ds[ds.length-1].dialog?ds[ds.length-1].zIndex+2:950;if(ds.length==1){_5dd.show();}dojo.style(dijit._underlay.domNode,"zIndex",_5de-1);dojo.style(_5db.domNode,"zIndex",_5de);ds.push({dialog:_5db,underlayAttrs:_5dc,zIndex:_5de});},hide:function(_5df){var ds=dijit._dialogStack;if(ds[ds.length-1].dialog==_5df){ds.pop();var pd=ds[ds.length-1];if(ds.length==1){if(!dijit._underlay._destroyed){dijit._underlay.hide();}}else{dojo.style(dijit._underlay.domNode,"zIndex",pd.zIndex-1);dijit._underlay.set(pd.underlayAttrs);}if(_5df.refocus){var _5e0=pd.focus;if(!_5e0||(pd.dialog&&!dojo.isDescendant(_5e0.node,pd.dialog.domNode))){pd.dialog._getFocusItems(pd.dialog.domNode);_5e0=pd.dialog._firstFocusItem;}try{dijit.focus(_5e0);}catch(e){}}}else{var idx=dojo.indexOf(dojo.map(ds,function(elem){return elem.dialog;}),_5df);if(idx!=-1){ds.splice(idx,1);}}},isTop:function(_5e1){var ds=dijit._dialogStack;return ds[ds.length-1].dialog==_5e1;}};dijit._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];}if(!dojo._hasResource["plugins.dijit.SyncDialog"]){dojo._hasResource["plugins.dijit.SyncDialog"]=true;dojo.provide("plugins.dijit.SyncDialog");dojo.declare("plugins.dijit.SyncDialog",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\"\n        height=\"300px\" width=\"100%\" style=\"padding: 0; margin: 0;\"\n        class=\"syncDialog\">\n        <tr>\n            <td align=\"center\">\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    closeText=\"false\"\n                    title=\"Sync\"\n                    style=\"margin-right: auto; margin-left: auto; text-align: center;\"\n                    >\n                    \n                    <table\n                        cellpadding=\"0\"\n                        cellspacing=\"0\"\n                        class=\"syncDialog\"\n                        width=\"100%\"\n                        >\n\n                        <tr class=\"header\" align=\"center\">\n                            <td\n                                align=\"center\"\n                                dojoAttachPoint=\"headerNode\"\n                                colspan=\"2\">${header}</td>\n                        </tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=center\n                                class=\"sublabel\">Commit Message</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"message\"\n\t\t\t\t\t\t\t\t\tclass=\"message\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"52\"\n\t\t\t\t\t\t\t\t\tregExpGen=\"return '[^;^`]{1,52}'\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Max 52 characters, no ';' or '`'\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"Max 52 characters, no ';' or '`'\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=center\n                                class=\"sublabel\">Details</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"details\"\n\t\t\t\t\t\t\t\t\tclass=\"details\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"10\"></textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n                        \n                        <tr>\n                            <td colspan=\"2\"\n                                align=\"center\"\n                                class=\"enterButton\">\n                                <button\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Enter\"\n                                    dojoAttachEvent=\"onClick:doEnter\"\n                                    >\n                                </button>\n                            </td>\n                        </tr>\n                        \n                        \n                    </table>\n\n                </div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","dijit/css/syncdialog.css")],widgetsInTemplate:true,parentWidget:null,message:null,constructor:function(args){console.log("SyncDialog.constructor    args:");console.dir({args:args});this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDialogue();this.setKeyListener();this.setNamespaceClass("syncDialog");},setKeyListener:function(){dojo.connect(this.dialog,"onkeypress",dojo.hitch(this,"handleOnKeyPress"));},handleOnKeyPress:function(_5e2){var key=_5e2.charOrCode;console.log("SyncDialog.handleOnKeyPress    key: "+key);if(key==null){return;}_5e2.stopPropagation();if(key==dojo.keys.ESCAPE){this.hide();}},setNamespaceClass:function(_5e3){dojo.addClass(this.dialog.domNode,_5e3);dojo.addClass(this.dialog.titleNode,_5e3);dojo.addClass(this.dialog.closeButtonNode,_5e3);},show:function(){this.dialog.show();this.message.focus();},hide:function(){this.dialog.hide();},doEnter:function(type){console.log("SyncDialog.doEnter    plugins.dijit.SyncDialog.doEnter()");var _5e4=this.validateInputs(["message","details"]);console.log("SyncDialog.doEnter    inputs:");console.dir({inputs:_5e4});if(!_5e4){console.log("SyncDialog.doEnter    inputs is null. Returning");return;}this.message.set("value","");this.details.value="";this.hide();this.dialog.enterCallback(_5e4);},validateInputs:function(keys){console.log("Hub.validateInputs    keys: ");console.dir({keys:keys});var _5e5=new Object;this.isValid=true;for(var i=0;i<keys.length;i++){console.log("Hub.validateInputs    Doing keys["+i+"]: "+keys[i]);_5e5[keys[i]]=this.verifyInput(keys[i]);}console.log("Hub.validateInputs    inputs: ");console.dir({inputs:_5e5});if(!this.isValid){return null;}return _5e5;},verifyInput:function(_5e6){console.log("Aws.verifyInput    input: ");console.dir({this_input:this[_5e6]});var _5e7=this[_5e6].value;console.log("Aws.verifyInput    value: "+_5e7);var _5e8=this.getClassName(this[_5e6]);console.log("Aws.verifyInput    className: "+_5e8);if(_5e8){console.log("Aws.verifyInput    this[input].isValid(): "+this[_5e6].isValid());if(!_5e7||!this[_5e6].isValid()){console.log("Aws.verifyInput    input "+_5e6+" value is empty. Adding class 'invalid'");dojo.addClass(this[_5e6].domNode,"invalid");this.isValid=false;}else{console.log("SyncDialog.verifyInput    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[_5e6].domNode,"invalid");return _5e7;}}else{if(_5e6.match(/;/)||_5e6.match(/`/)){console.log("SyncDialog.verifyInput    value is INVALID. Adding class 'invalid'");dojo.addClass(this[_5e6],"invalid");this.isValid=false;return null;}else{console.log("SyncDialog.verifyInput    value is VALID. Removing class 'invalid'");dojo.removeClass(this[_5e6],"invalid");return _5e7;}}return null;},doCancel:function(){this.dialog.cancelCallback();this.dialog.hide();},setDialogue:function(){document.body.appendChild(this.dialog.domNode);this.dialog.parentWidget=this;this._fadeOutDeferred=function(){};},load:function(args){console.log("SyncDialog.load    args:");console.dir({args:args});if(args.title){console.log("SyncDialog.load    SETTING TITLE: "+args.title);this.dialog.set("title",args.title);}this.headerNode.innerHTML=args.header;if(args.message){this.message.set("value",args.message);}if(args.details){this.details.value=args.details;}this.dialog.enterCallback=args.enterCallback;this.show();}});}if(!dojo._hasResource["plugins.admin.Apps"]){dojo._hasResource["plugins.admin.Apps"]=true;dojo.provide("plugins.admin.Apps");dojo.declare("plugins.admin.Apps",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- APPS TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"apps\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Apps\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n<table width=\"100%\">\n\t<tr valign=\"top\" width=\"100%\">\n\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\">\n\t\t\tApps\n\t\t</td>\n\t</tr>\n\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td width=\"100%\">\n\t\t\t<table width=\"100%\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\tdojoAttachPoint=\"syncAppsButton\"\n\t\t\t\t\t\tclass=\"syncAppsButton\"\n\t\t\t\t\t\ttitle=\"Click to sync apps to biorepository\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:showSyncDialog\"\n\t\t\t\t\t>\n\t\t\t\t\t\tSync\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\n\t\t\t\t\t<td colspan=\"3\" height=\"32px\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"padding: 0; margin: 0;\">\n\n\t\t\t\t\t\t\t<tr>\n\n\t\t\t\t\t\t\t\t<td \n\t\t\t\t\t\t\t\t\tstyle=\"padding-right: 10px;\" >\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"name\"\n\t\t\t\t\t\t\t\t\t\tclass=\"name\"\n\t\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"name: Name of application\"\n\t\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\n\t\t\t\t\t\t\t\t<td height=\"20px\"\n\t\t\t\t\t\t\t\t\twidth=\"120px\"\n\t\t\t\t\t\t\t\t\talign=\"right\">\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addAppButton\"\n\t\t\t\t\t\t\t\t\t\tclass=\"addAppButton\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tNew App\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"33%\">Type</td>\n\t\t\t\t\t<td width=\"33%\">Executor</td>\n\t\t\t\t\t<td width=\"33%\">Package</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td width=\"33%\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"type\"\n\t\t\t\t\t\t\tclass=\"type\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"type: Type of application (e.g., 'pipeline', 'converter', 'utility')\"\n\t\t\t\t\t\t\t>Type</textarea>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td width=\"34%\"\n\t\t\t\t\t\tstyle=\"padding-left: 4px; padding-right: 4px;\" >\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"executor\"\n\t\t\t\t\t\t\tclass=\"executor\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"executor: Additional executable used to run application (e.g., '/usr/bin/perl')\"\n\t\t\t\t\t\t\t>Executor</textarea>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td width=\"33%\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"packageCombo\"\n\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\tclass=\"packageCombo\"\n\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\ttitle=\"Select the order of the displayed applications\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"67%\" colspan=\"2\">Location</td>\n\t\t\t\t\t<td width=\"33%\">&nbsp;</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"location\"\n\t\t\t\t\t\t\tclass=\"location\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"location: Absolute path (e.g., '/home/myname/myapp.pl') or path relative to Agua base folder (e.g., 'bin/apps/myScript.pl')\"\n\t\t\t\t\t\t\t>Location</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\ttitle=\"localonly: Select so that application will only run locally (e.g., a herder that submits jobs to the cluster))\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tdojoAttachPoint=\"localonly\"\n\t\t\t\t\t\t\tclass=\"localonly\">\n\t\t\t\t\t\t\tLocal Only\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tdojoAttachPoint=\"localonly\"\n\t\t\t\t\t\t\tdojoType=\"dijit.form.CheckBox\"\n\t\t\t\t\t\t\tchecked=\"false\"\n\t\t\t\t\t\t\tclass=\"localonlyCheckbox\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\n\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t<td width=\"100%\"\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\tclass=\"toggleTitle\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggle\"\n\t\t\t\t\t> Details (Click to toggle)</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</td>\n\n\t</tr>\n\t<tr class=\"inputs\" >\n\t\t<td>\n\n\t\t\t<table\n\t\t\t\tstyle=\"display: none\"\n\t\t\t\tdojoAttachPoint=\"togglePoint\"\n\t\t\t\twidth=\"100%\"\n\t\t\t\tstyle=\"padding: 0px;\"\n\t\t\t>\n\t\t\t\t\n\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t<td colspan=\"3\">Description</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"description: A brief description of the application\"\n\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\">Notes</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\tclass=\"notes\"\n\t\t\t\t\t\t\tvalue=\"Notes\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"notes: Notes on the application/build/etc. (e.g., release notes, constraints)\"\n\t\t\t\t\t\t>Notes</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/applications)\"\n\t\t\t\t\t\t>URL</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"url\"\n\t\t\t\t\t\t\tclass=\"url\"\n\t\t\t\t\t\t\tvalue=\"URL\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/applications)\"\n\t\t\t\t\t\t>URL</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\t\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td width=\"95%\">\n\t\t\t<div class=\"label\"> Application List Order </div>\n\t\t</td>\n\t</tr>\n\n\t<tr>\n\t\t<td align=\"center\">\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"appsCombo\"\n\t\t\t\tdojoAttachEvent=\"onChange:changeDragSource\"\n\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\tclass=\"appsCombo\"\n\t\t\t\tpopupClass=\"sources appsCombo dijitReset dijitMenu\"\n\t\t\t\tautocomplete=\"true\"\n\t\t\t\thasDownArrow=\"true\"\n\t\t\t\tdisabled=\"false\"\n\t\t\t\tstyle=\"width: 250px;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\t\n\t<tr>\n\t\t<td>\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\tclass=\"dragSource\"\n\t\t\t\tstyle=\"height: 395px; width: 96%;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n\t<tr align=\"center\">\n\t\t<td align=\"center\">\n\n\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\tclass=\"trash\"\n\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n</table>\n\n\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins","admin/css/apps.css")],parentWidget:null,formInputs:{"name":"word","type":"word","executor":"word","package":"word","location":"word","localonly":"word","description":"phrase","notes":"phrase","url":"word"},requiredInputs:{name:1,type:1,location:1},invalidInputs:{name:"Name",type:"Type",executor:"Executor",packageCombo:"Package",location:"Location",description:"Description",notes:"Notes",url:"URL"},defaultInputs:{name:"Name",type:"Type",executor:"Executor",packageCombo:"Package",location:"Location",description:"Description",notes:"Notes",url:"URL"},dataFields:["name","type","location"],avatarItems:["name","description"],rowClass:"plugins.admin.AppRow",dragTypes:["app"],constructor:function(args){this.parentWidget=args.parentWidget;this.apps=args.parentWidget.apps;},postCreate:function(){this.loadCSS();this.startup();},startup:function(){console.group("Apps-"+this.id+"    startup");this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.setPackageCombo();this.setForm();this.setTrash(this.dataFields);this.setSyncApps();this.setSyncDialog();Agua.updater.subscribe(this,"updateApps");Agua.updater.subscribe(this,"updateSyncApps");console.groupEnd("Apps-"+this.id+"    startup");},updateApps:function(args){console.log("Apps.updateApps    Apps.updateApps(args)");console.log("Apps.updateApps    args:");console.dir(args);if(args!=null&&args.reload==false){return;}console.log("Apps.updateApps    Calling setDragSource()");this.setAppTypesCombo();},updateSyncApps:function(args){console.warn("Apps.updateSyncApps    args:");console.dir({args:args});this.setSyncApps();},setSyncApps:function(){var hub=Agua.getHub();console.log("Apps.setSyncApps    hub:");console.dir({hub:hub});if(!hub.login||!hub.token){this.disableSyncApps();}else{this.enableSyncApps();}},setSyncDialog:function(){console.log("Apps.loadSyncDialog    plugins.admin.Apps.setSyncDialog()");var _5e9=function(){};var _5ea=function(){};var _5eb="Sync";var _5ec="Sync Apps";this.syncDialog=new plugins.dijit.SyncDialog({title:_5eb,header:_5ec,parentWidget:this,enterCallback:_5e9});console.log("Apps.loadSyncDialog    this.syncDialog:");console.dir({this_syncDialog:this.syncDialog});},showSyncDialog:function(){var _5ed=dojo.hasClass(this.syncAppsButton,"disabled");console.log("Apps.loadSyncDialog    disabled: "+_5ed);if(_5ed){console.log("Apps.loadSyncDialog    SyncApps is disabled. Returning");return;}var _5ee="Sync Apps";var _5ef="";var _5f0="";var _5f1="";var _5f2=dojo.hitch(this,"syncApps");this.loadSyncDialog(_5ee,_5ef,_5f0,_5f1,_5f2);},loadSyncDialog:function(_5f3,_5f4,_5f5,_5f6,_5f7){console.log("Apps.loadSyncDialog    title: "+_5f3);console.log("Apps.loadSyncDialog    header: "+_5f4);console.log("Apps.loadSyncDialog    message: "+_5f5);console.log("Apps.loadSyncDialog    details: "+_5f6);console.log("Apps.loadSyncDialog    enterCallback: "+_5f7);this.syncDialog.load({title:_5f3,header:_5f4,message:_5f5,details:_5f6,enterCallback:_5f7});},disableSyncApps:function(){dojo.addClass(this.syncAppsButton,"disabled");dojo.attr(this.syncAppsButton,"title","Input AWS private key and public certificate to enable Sync");},enableSyncApps:function(){dojo.removeClass(this.syncAppsButton,"disabled");dojo.attr(this.syncAppsButton,"title","Click to sync apps to biorepository");},syncApps:function(_5f8){console.log("Hub.syncApps    inputs: ");console.dir({inputs:_5f8});if(this.syncingApps==true){console.log("Hub.syncApps    this.syncingApps: "+this.syncingApps+". Returning.");return;}this.syncingApps=true;var _5f9=new Object;_5f9.username=Agua.cookie("username");_5f9.sessionId=Agua.cookie("sessionId");_5f9.message=_5f8.message;_5f9.details=_5f8.details;_5f9.hubtype="github";_5f9.mode="syncApps";console.log("Hub.syncApps    query: ");console.dir({query:_5f9});var url=Agua.cgiUrl+"workflow.cgi?";var _5fa=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_5f9),load:function(_5fb,_5fc){_5fa.syncingApps=false;console.log("Apps.syncApps    OK. response:");console.dir({response:_5fb});Agua.toast(_5fb);},error:function(_5fd,_5fe){_5fa.syncingApps=false;console.log("Apps.syncApps    ERROR. response:");console.dir({response:_5fd});Agua.toast(_5fd);}});},toggle:function(){if(this.togglePoint.style.display=="inline-block"){this.togglePoint.style.display="none";}else{this.togglePoint.style.display="inline-block";}},setPackageCombo:function(type){var apps=Agua.getApps();console.log("Parameters.setPackageCombo     apps:");console.dir({apps:apps});var _5ff=this.hashArrayKeyToArray(apps,"package");_5ff=this.uniqueValues(_5ff);console.log("Parameters.setPackageCombo     packageArray:");console.dir({packageArray:_5ff});var data={identifier:"name",items:[]};for(var i=0;i<_5ff.length;i++){data.items[i]={name:_5ff[i]};}var _600=new dojo.data.ItemFileWriteStore({data:data});this.packageCombo.store=_600;this.packageCombo.startup();var _601=_5ff[0];this.packageCombo.set("value",_601);this.setAppTypesCombo();},setAppTypesCombo:function(){console.log("Apps.setAppTypesCombo     plugins.admin.Apps.setAppTypesCombo()");var apps=Agua.getApps();console.log("Apps.setAppTypesCombo     this: ");var _602=this.packageCombo.get("value");console.log("Apps.setAppTypesCombo     packageName: "+_602);var keys=["package"];var _603=[_602];apps=this.filterByKeyValues(apps,keys,_603);var _604=this.hashArrayKeyToArray(apps,"type");_604=this.uniqueValues(_604);console.log("Apps.setAppTypesCombo     typesArray.length: "+_604.length);_604=this.sortNoCase(_604);_604.splice(0,0,"Order by Type (A-Z)");_604.splice(0,0,"Order by Name (A-Z)");var data={identifier:"name",items:[]};for(var i=0;i<_604.length;i++){data.items[i]={name:_604[i]};}var _605=new dojo.data.ItemFileWriteStore({data:data});this.appsCombo.store=_605;this.appsCombo.startup();var _606=_604[0];this.appsCombo.set("value",_606);this.setDragSource();},setForm:function(){dojo.connect(this.addAppButton,"onclick",dojo.hitch(this,"saveInputs",null,{reload:true}));this.setClearValues();this.chainInputs(["name","type","executor","package","location","description","notes","url","addAppButton"]);},getItemArray:function(){var _607=Agua.getApps();console.log("Apps.getItemArray    itemArray.length: "+_607.length);var type=this.appsCombo.get("value");if(type=="Order by Name (A-Z)"){_607=this.sortHasharray(_607,"name");}else{if(type=="Order by Type (A-Z)"){_607=this.sortHasharray(_607,"type");}else{for(var i=0;i<_607.length;i++){if(_607[i].type!=type){_607.splice(i,1);i--;}}}}console.log("Apps.setAppTypesCombo     RETURNING itemArray.length: "+_607.length);return _607;},changeDragSource:function(){console.log("Apps.changeDragSource     plugins.admin.Apps.changeDragSource()");console.log("Apps.changeDragSource     this.dragSourceOnchange: "+this.dragSourceOnchange);console.log("Apps.changeDragSource     Doing this.setDragSource");this.setDragSource();},deleteItem:function(_608){_608.name=_608.name.replace(/\s+$/,"");_608.name=_608.name.replace(/^\s+/,"");Agua.removeApp(_608,"custom");var url=Agua.cgiUrl+"admin.cgi?";var _609=new Object;_609.username=Agua.cookie("username");_609.sessionId=Agua.cookie("sessionId");_609.mode="deleteApp";_609.data=_608;dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_609),load:function(_60a,_60b){return _60a;},error:function(_60c,_60d){return _60c;}});Agua.updater.update("updateApps");},saveInputs:function(_60e,_60f){console.log("Apps.saveInputs    plugins.admin.Apps.saveInputs(inputs)");console.log("Apps.saveInputs    BEFORE inputs: ");console.dir({inputs:_60e});if(this.savingApp==true){return;}this.savingApp=true;if(_60e==null){_60e=this.getFormInputs(this);if(_60e==null){this.savingApp=false;return;}}console.log("Apps.saveInputs    AFTER inputs: ");console.dir({inputs:_60e});Agua.removeApp({name:_60e.name});Agua.addApp(_60e);var _610=new Object;_610.username=Agua.cookie("username");_610.sessionId=Agua.cookie("sessionId");_610.mode="saveApp";_610.data=_60e;var url=Agua.cgiUrl+"admin.cgi?";dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_610),timeout:15000,load:function(_611,_612){return _611;},error:function(_613,_614){return _613;}});this.savingApp=false;Agua.updater.update("updateApps",_60f);},getFormInputs:function(_615){console.log("Apps.getFormInputs    plugins.admin.Apps.getFormInputs(textarea)");console.log("Apps.getFormInputs    widget: "+_615);console.dir({widget:_615});var _616=new Object;console.log("Apps.getFormInputs    inputs: "+_616);console.dir({inputs:_616});for(var name in this.formInputs){console.log("Apps.getFormInputs    DOING inputs["+name+"]");var _617;if(name=="localonly"){_617=0;if(_615[name].getValue()=="on"){_617=1;}}else{if(name=="package"){_617=this.processWidgetValue(_615,"packageCombo");}else{console.log("Apps.getFormInputs    DOING processWidgetValue. widget: ");console.dir({widget:_615});_617=this.processWidgetValue(_615,name);}}_616[name]=_617;console.log("Apps.getFormInputs    inputs["+name+"]: "+_616[name]);}_616=this.checkInputs(_615,_616);console.log("Apps.getFormInputs    FINAL inputs: ");console.dir({inputs:_616});return _616;},checkInputs:function(_618,_619){console.log("Apps.checkInputs    inputs: ");console.dir({inputs:_619});this.allValid=true;for(var key in this.formInputs){var _61a=_619[key];console.log("Apps.checkInputs    Checking "+key+": "+_61a);if(key=="package"){if(this.isValidInput("packageCombo",_61a)){this.setValid(_618["packageCombo"]);}else{this.setInvalid(_618["packageCombo"]);this.allValid=false;continuev;}}else{if(this.isValidInput(key,_61a)){console.log("Apps.checkInputs    removing 'invalid' class for "+key+": "+_61a);this.setValid(_618[key]);}else{console.log("Apps.checkInputs    adding 'invalid' class for name "+key+", value "+_61a);this.setInvalid(_618[key]);this.allValid=false;}}}console.log("Apps.checkInputs    this.allValid: "+this.allValid);if(this.allValid==false){return null;}for(var key in this.formInputs){console.log("Apps.checkInputs    BEFORE convert, inputs[key]: "+dojo.toJson(_619[key]));_619[key]=this.convertAngleBrackets(_619[key],"htmlToText");console.log("Apps.checkInputs    AFTER convert, inputs[key]: "+dojo.toJson(_619[key]));}return _619;}});}if(!dojo._hasResource["plugins.admin.Aws"]){dojo._hasResource["plugins.admin.Aws"]=true;dojo.provide("plugins.admin.Aws");dojo.declare("plugins.admin.Aws",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t\n\t<!-- settings TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"aws\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"AWS\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> AWS </td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Amazon Web Services </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"subPane\"\n\t\t\t\t\t\tstyle=\"height: 680px; width: 95%;\"\n\t\t\t\t\t>\n\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tcolspan=\"2\"\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"addAwsButton\"\n\t\t\t\t\t\t\t\tclass=\"addAwsButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addAws\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Amazon User ID</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"amazonuserid\"\n\t\t\t\t\t\t\t\t\tclass=\"amazonUserId\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\t\t\tregExp=\"^\\d{12}$\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"12\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"Enter your 12-digit Amazon User ID (numbers only)\" \n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Invalid User ID (Must be 12 digits, numbers only).\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">AWS Key ID</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"awsaccesskeyid\"\n\t\t\t\t\t\t\t\t\tclass=\"accessKeyId\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"24\"\n\t\t\t\t\t\t\t\t\tuppercase=\"true\"\n\t\t\t\t\t\t\t\t\tregExp=\"[A-Z0-9]{16,24}\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"16-24 characters: capital letters or numbers\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"16-24 characters: capital letters or numbers\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">AWS Secret Key</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"awssecretaccesskey\"\n\t\t\t\t\t\t\t\t\tclass=\"secretAccessKey\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"45\"\n\t\t\t\t\t\t\t\t\tregExpGen=\"return '.{35,45}'\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"35-45 characters\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"35-45 characters\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Private Key</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ec2privatekey\"\n\t\t\t\t\t\t\t\t\tclass=\"ec2privatekey\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"20\"></textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Public Certificate</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ec2publiccert\"\n\t\t\t\t\t\t\t\t\tclass=\"ec2publiccert\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"20\"\n\t\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t</table>\n\n\t\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END settings TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins","admin/css/aws.css"),],requiredInputs:{amazonuserid:1,awsaccesskeyid:1,awssecretaccesskey:1,ec2privatekey:1,ec2publiccert:1},parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.core=args.parentWidget.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.initialiseAws();},addAws:function(_61b){console.clear();console.log("Aws.addAws    plugins.admin.Aws.addAws(event)");console.log("Aws.addAws    event: "+_61b);if(this.savingAws==true){console.log("Aws.addAws    this.savingAws: "+this.savingAws+". Returning.");return;}this.savingAws=true;var _61c=this.validateInputs();if(!_61c){this.savingAws=false;return;}var _61d=_61c;_61d.username=Agua.cookie("username");_61d.sessionId=Agua.cookie("sessionId");_61d.repotype="github";_61d.mode="addAws";console.log("Aws.addAws    query: ");console.dir({query:_61d});var url=Agua.cgiUrl+"workflow.cgi?";var _61e=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_61d),handleAs:"json",load:function(_61f,_620){console.log("Aws.addAws    STATUS response:");console.dir({response:_61f});if(!_61f){Agua.toast({error:"No response from server on 'addAws'"});return;}if(!_61f.error){console.log("Aws.addAWS    DOING Agua.setAws(inputs)");Agua.setAws(_61c);}Agua.toast(_61f);},error:function(_621,_622){console.log("Aws.addAws    ERROR response:");console.dir({response:_621});Agua.toast(_621);}});this.savingAws=false;},validateInputs:function(){var _623=new Object;this.isValid=true;for(var _624 in this.requiredInputs){_623[_624]=this.verifyInput(_624);}console.log("Aws.validateInputs    inputs: ");console.dir({inputs:_623});if(!this.isValid){return null;}return _623;},verifyInput:function(_625){console.log("Aws.verifyInput    input: ");console.dir({this_input:this[_625]});var _626=this[_625].value;_626=this.cleanEdges(_626);console.log("Aws.verifyInput    value: "+_626);var _627=this.getClassName(this[_625]);console.log("Aws.verifyInput    className: "+_627);if(_627){console.log("Aws.verifyInput    this[input].isValid(): "+this[_625].isValid());if(!_626||!this[_625].isValid()){console.log("Aws.verifyInput    input "+_625+" value is empty. Adding class 'invalid'");dojo.addClass(this[_625].domNode,"invalid");this.isValid=false;}else{console.log("Aws.verifyInput    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[_625].domNode,"invalid");return _626;}}else{if(!_626){console.log("Aws.verifyInput    input "+_625+" value is EMPTY. Adding class 'invalid'");dojo.addClass(this[_625],"invalid");this.isValid=false;return null;}else{if(_625=="ec2privatekey"){if(!_626.match(/^\s*-----BEGIN PRIVATE KEY-----[\s\S]+-----END PRIVATE KEY-----\S*$/)){console.log("Aws.verifyInput    value is INVALID. Adding class 'invalid'");dojo.addClass(this[_625],"invalid");this.isValid=false;return null;}console.log("Aws.verifyInput    value is VALID. Removing class 'invalid'");dojo.removeClass(this[_625],"invalid");return _626;}else{if(_625=="ec2publiccert"){if(!_626.match(/^\s*-----BEGIN CERTIFICATE-----[\s\S]+-----END CERTIFICATE-----\S*$/)){console.log("Aws.verifyInput    value is INVALID. Adding class 'invalid'");dojo.addClass(this[_625],"invalid");this.isValid=false;return null;}console.log("Aws.verifyInput    value is VALID. Removing class 'invalid'");dojo.removeClass(this[_625],"invalid");return _626;}}}}return null;},initialiseAws:function(){var aws=Agua.getAws();console.log("Aws.initialiseAws     aws: ");console.dir({aws:aws});this.amazonuserid.set("value",aws.amazonuserid);this.awsaccesskeyid.set("value",aws.awsaccesskeyid);this.awssecretaccesskey.set("value",aws.awssecretaccesskey);this.ec2privatekey.value=aws.ec2privatekey||"";this.ec2publiccert.value=aws.ec2publiccert||"";},cleanEdges:function(_628){_628=_628.toString();if(_628==null||!_628.replace){return null;}_628=_628.replace(/^\s+/,"");_628=_628.replace(/\s+$/,"");return _628;}});}if(!dojo._hasResource["plugins.admin.ClusterRow"]){dojo._hasResource["plugins.admin.ClusterRow"]=true;dojo.provide("plugins.admin.ClusterRow");dojo.declare("plugins.admin.ClusterRow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table class=\"clusterRow\" width=\"100%\">\n        \n        <tr>\n\t\t\t<td colspan=\"3\" width=\"100%\">\n\t\t\t\n\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggle\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"cluster\"\n\t\t\t\t\t\t\tclass=\"cluster\"\n\t\t\t\t\t\t\ttitle=\"Cluster Name\"\n\t\t\t\t\t\t>${cluster}</td>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<td class=\"nodesLabel\">Min nodes</td>\n\t\t\t\t\t\t<td class=\"minnodes\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"minnodes\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onKeyPress:checkEnterNodes\"\n\t\t\t\t\t\t\t\tclass=\"minnodes\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tvalue=\"${minnodes}\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\t\t\t\tmaxlength=\"4\" \n\t\t\t\t\t\t\t\tpromptMessage=\"Minimum nodes: from 1 to 99999\" \n\t\t\t\t\t\t\t\tinvalidMessage=\"Minimum nodes: from 1 to 99999\"\n\t\t\t\t\t\t\t\ttooltipPosition=\"above, below\"\n\t\t\t\t\t\t\t\tstyle=\"display: table-cell; text-align: center; width: 25px !important;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<td class=\"nodesLabel\">Max nodes</td>\n\t\t\t\t\t\t<td class=\"maxnodes\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"maxnodes\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onKeyPress:checkEnterNodes\"\n\t\t\t\t\t\t\t\tclass=\"maxnodes\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\tvalue=\"${maxnodes}\"\n\t\t\t\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\t\t\t\tmaxlength=\"4\" \n\t\t\t\t\t\t\t\tpromptMessage=\"Maximum nodes: from 1 to 99999\" \n\t\t\t\t\t\t\t\tinvalidMessage=\"Maximum nodes: from 1 to 99999\"\n\t\t\t\t\t\t\t\ttooltipPosition=\"above, below\"\n\t\t\t\t\t\t\t\tstyle=\"display: table-cell; text-align: center; width: 25px !important;\"\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n            \n        <tr>\n\t\t\t<td colspan=\"3\">\n\t\t\t\t<table>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tstyle=\"display: none;\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"amiidContainer\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"amiid\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:setAmiInfo\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\tclass=\"amiid\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tvalue=\"ami-d1c42db8\"\n\t\t\t\t\t\t\t\ttitle=\"AMI ID of the Starcluster image used for all cluster nodes (The base x86_64 StarCluster AMI is ami-d1c42db8)\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\tregExp=\"^ami-[A-F0-9a-f]{8}$\"\n\t\t\t\t\t\t\t\tmaxlength=\"12\"\n\t\t\t\t\t\t\t\tpromptMessage=\"Amazon Machine Image (AMI) identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g., ami-d1c42db8\" \n\t\t\t\t\t\t\t\tinvalidMessage=\"Amazon Machine Image (AMI) identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g., ami-d1c42db8\" \n\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"aminame\"\n\t\t\t\t\t\t\tclass=\"aminame\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"amitype\"\n\t\t\t\t\t\t\tclass=\"amitype\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n\n        <tr>\n            <td align=\"center\"\n                dojoAttachPoint=\"instancetypeContainer\"\n                style=\"display: none;\"\n                >\n                <select\n                    dojoAttachPoint=\"instancetype\"\n                    class=\"instancetype\">\n\t\t\t\t\t<option value=\"t1.micro\">t1.micro</option> \n\t\t\t\t\t<option value=\"m1.small\">m1.small</option>\n\t\t\t\t\t<option value=\"m1.large\">m1.large</option>\n\t\t\t\t\t<option value=\"m1.xlarge\">m1.xlarge</option>\n\t\t\t\t\t<option value=\"m1.xlarge\">m2.xlarge</option>\n\t\t\t\t\t<option value=\"m2.2xlarge\">m2.2xlarge</option>\n\t\t\t\t\t<option value=\"m2.4xlarge\">m2.4xlarge</option>\n\t\t\t\t\t<option value=\"c1.medium\">c1.medium</option>\n\t\t\t\t\t<option value=\"c1.xlarge\">c1.xlarge</option>\n\t\t\t\t\t<option value=\"cc1.4xlarge\">cc1.4xlarge</option>\n\t\t\t\t\t<option value=\"cg1.4xlarge\">cg1.4xlarge</option>\n                </select>\n            </td>\n            <td align=\"center\"\n\t\t\t\tdojoAttachPoint=\"regionContainer\"\n\t\t\t\tstyle=\"display: none;\"\n\t\t\t>\n\t\t\t\t<select\n\t\t\t\t\tdojoAttachPoint=\"region\"\n\t\t\t\t\tdojoAttachEvent=\"onchange:setAvailzoneCombo\"\n\t\t\t\t\tclass=\"region\">\n\t\t\t\t\t<option value=\"us-east-1\">us-east-1</option> \n\t\t\t\t\t<option value=\"us-west-1\">us-west-1</option> \n\t\t\t\t\t<option value=\"eu-west-1\">eu-west-1</option> \n\t\t\t\t\t<option value=\"ap-northeast-1\">ap-northeast-1</option> \n\t\t\t\t\t<option value=\"ap-southeast-1\">ap-southeast-1</option> \n\t\t\t\t</select>\n\t\t\t</td>\n\t\t\t<td align=\"center\"\n\t\t\t\tdojoAttachPoint=\"availzoneContainer\"\n\t\t\t\tstyle=\"display: none;\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"availzone\"\n\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t                dojoAttachEvent=\"onchange:saveInputs\"\n\t\t\t\t\tclass=\"availzone\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tpopupClass=\"clusters availzone dijitReset dijitMenu\"\n\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\tstyle=\"width: 50px;\">\n\t\t\t\t</div>\n\t\t\t</td>\n        </tr>\n\n\t\t<tr width=\"95%\">\n\t\t\t<td\n                align=\"center\"\n                colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                dojoAttachEvent=\"onclick:editCluster\"\n                class=\"description\"\n                style=\"display: none;\"\n                width=\"100%\"\n                title=\"A brief description of the cluster group\"\n            >${description}</td>\n\t\t</tr>\n\n    </table>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.lockedValue=args.locked;this.args=args;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _629={target:{selectedIndex:0,options:[{text:"us-east-1"}]}};this.setAvailzoneCombo(_629);if(this.args.availzone!=null){this.availzone.set("value",this.args.availzone);}this.setAmiCombo(this.args.amiid);this.setAmiInfo();this.setOnkeyListeners(["amiid"]);setTimeout(function(_62a){_62a.setComboListeners();},2000,this);Agua.updater.subscribe(this,"updateClusters");Agua.updater.subscribe(this,"updateAmis");},updateClusters:function(args){if(args==null||args.reload!=false){this.setDragSource();}},updateAmis:function(args){if(args.originator==this){if(args.reload==false){return;}}this.setAmiCombo();},setComboListeners:function(){var _62b=this;dojo.connect(this.instancetype,"onchange",function(_62c){if(_62c.stopPropagation==null){return;}var _62d=_62b.parentWidget.getFormInputs(_62b);_62b.parentWidget.saveInputs(_62d,{reload:false});_62c.stopPropagation();});dojo.connect(this.availzone,"onChange",function(_62e){var _62f=_62b.parentWidget.getFormInputs(_62b);_62b.parentWidget.saveInputs(_62f,{reload:false});});dojo.connect(this.amiid,"onChange",function(){var _630=_62b.parentWidget.getFormInputs(_62b);_62b.parentWidget.saveInputs(_630,{reload:false});});},setOnkeyListeners:function(_631){var _632=this;for(var i in _631){dojo.connect(_632[_631[i]],"onKeyPress",function(evt){var key=evt.charOrCode;evt.stopPropagation();if(key==13){_632.saveInputs();}});}},getItemsArray:function(){var amis=Agua.getAmis();return this.hashArrayKeyToArray(amis,["amiid"]);},setAmiCombo:function(_633){var amis=this.getItemsArray();var data={identifier:"name",items:[]};for(var i=0;i<amis.length;i++){data.items[i]={name:amis[i]};}var _634=new dojo.data.ItemFileWriteStore({data:data});this.amiid.store=_634;this.amiid.startup();var _635=_633;if(_635==null){_635=amis[0];}this.amiid.setValue(_635);this.setAmiInfo();},setAmiInfo:function(){var _636=this.amiid.get("value");var _637=Agua.getAmiObjectById(_636);if(_637==null){this.aminame.innerHTML="";this.amitype.innerHTML="";}else{this.aminame.innerHTML=_637.aminame;this.amitype.innerHTML=_637.amitype;}},setAvailzoneCombo:function(_638){var _639=this.getSelectedValue(_638.target);var _63a=Agua.getAvailzonesByRegion(_639);var data={identifier:"name",items:[]};for(var i=0;i<_63a.length;i++){data.items[i]={name:_63a[i]};}var _63b=new dojo.data.ItemFileWriteStore({data:data});this.availzone.store=_63b;this.availzone.startup();var _63c=_63a[0];this.availzone.set("value",_63c);},saveInputs:function(){this.setAmiInfo();this.checkNodeNumbers();var _63d=this.parentWidget.getFormInputs(this);this.parentWidget.saveInputs(_63d,{reload:false});},checkNodeNumbers:function(){if(this.minnodes.get("value")>this.maxnodes.get("value")){this.minnodes.set("value",this.maxnodes.get("value"));}},editCluster:function(_63e){this.parentWidget.editRow(this,_63e.target);_63e.stopPropagation();},checkEnterNodes:function(_63f){if(_63f.keyCode==dojo.keys.ENTER){dojo.stopEvent(_63f);document.body.focus();this.checkNodeNumbers();var _640=this.parentWidget.getFormInputs(this);this.saveInputs(_640,null);}},toggle:function(){var _641=["aminame","amitype","instancetypeContainer","amiidContainer","regionContainer","availzoneContainer","description"];for(var i in _641){if(this[_641[i]].style.display=="table-cell"){this[_641[i]].style.display="none";}else{this[_641[i]].style.display="table-cell";}}}});}if(!dojo._hasResource["plugins.admin.Clusters"]){dojo._hasResource["plugins.admin.Clusters"]=true;dojo.provide("plugins.admin.Clusters");dojo.declare("plugins.admin.Clusters",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!--http://aws.amazon.com/ec2/instance-types/-->\n\n\t<!-- clusters TAB -->\n\t<div\n\t\tdojoAttachPoint=\"clustersTab\"\n\t\tclass=\"clusters\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Clusters\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t>\n\n\t<table align=\"center\" width=\"100%\">\n\n\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t<td colspan=\"3\" class=\"tabTitle\" align=\"center\">Clusters</td>\n\t\t</tr>\n\n\t\t<tr height=\"20px\">\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"addClusterButton\"\n\t\t\t\t\tclass=\"addClusterButton\"\n\t\t\t\t\t>Add Cluster</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr class=\"headerRow\">\n\t\t\t<td>Name</td>\n\t\t\t<td>Min nodes</td>\n\t\t\t<td>Max nodes</td>\n\t\t</tr>\n\n\t\t<tr align=\"center\">\n\n\t\t\t<td>\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"cluster\"\n\t\t\t\t\tclass=\"cluster\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"myCluster\"\n\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\tregExp=\"^\\S{1,20}$\"\n\t\t\t\t\tmaxlength=\"20\" \n\t\t\t\t\tpromptMessage=\"Cluster name: up to 20 characters (no spaces)\" \n\t\t\t\t\tinvalidMessage=\"Cluster name: up to 20 characters (no spaces)\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"minnodes\"\n\t\t\t\t\tdojoAttachEvent=\"onChange:checkNodeNumbers\"\n\t\t\t\t\tclass=\"minnodes\"\n\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\tmaxlength=\"5\" \n\t\t\t\t\tpromptMessage=\"Minimum nodes: from 0 to 99999\" \n\t\t\t\t\tinvalidMessage=\"Minimum nodes: from 0 to 99999\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"maxnodes\"\n\t\t\t\t\tdojoAttachEvent=\"onChange:checkNodeNumbers\"\n\t\t\t\t\tclass=\"maxnodes\"\n\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\tvalue=\"5\"\n\t\t\t\t\tconstraints=\"{min:1,max:99999,places:0}\"\n\t\t\t\t\tmaxlength=\"5\" \n\t\t\t\t\tpromptMessage=\"Maximum nodes: from 1 to 99999\" \n\t\t\t\t\tinvalidMessage=\"Maximum nodes: from 1 to 99999\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr>\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t\t<td\n\t\t\t\t\t\ttitle=\"AMI ID of the Starcluster image used for all cluster nodes (The base x86_64 StarCluster AMI is ami-d1c42db8)\">AMI ID</td>\n\t\t\t\t\t\t<td>AMI Name</td>\n\t\t\t\t\t\t<td>AMI Type</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td align=\"center\" dojoAttachPoint=\"amiidContainer\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"amiid\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:setAmiInfo\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\tclass=\"amiid\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\tregExp=\"^ami-[A-F0-9a-f]{8}$\"\n\t\t\t\t\t\t\t\tmaxlength=\"12\" \n\t\t\t\t\t\t\t\tpromptMessage=\"Amazon Machine Image (AMI) identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g. ami-d1c42db8\" \n\t\t\t\t\t\t\t\tinvalidMessage=\"Amazon Machine Image (AMI) identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g., ami-d1c42db8\" \n\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"aminame\"\n\t\t\t\t\t\t\tclass=\"aminame\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"amitype\"\n\t\t\t\t\t\t\tclass=\"amitype\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t\t<td class=\"info\">Instance Type\n\t\t\t\t\t\t\t<img src=\"plugins/core/images/info-16.png\" onClick=\"window.open('http://aws.amazon.com/ec2/instance-types', '_blank')\"></img>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"info\">Region\n\t\t\t\t\t\t\t<img src=\"plugins/core/images/info-16.png\" onClick=\"window.open('http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/index.html?using-regions-availability-zones.html', '_blank')\"></img>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>Availability Zone</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td align=\"center\" >\n\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"instancetype\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\tclass=\"instancetype\">\n\t\t\t\t\t\t\t\t<option value=\"t1.micro\">t1.micro</option> \n\t\t\t\t\t\t\t\t<option value=\"m1.small\">m1.small</option>\n\t\t\t\t\t\t\t\t<option value=\"m1.large\">m1.large</option>\n\t\t\t\t\t\t\t\t<option value=\"m1.xlarge\">m1.xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"m1.xlarge\">m2.xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"m2.4xlarge\">m2.2xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"m2.4xlarge\">m2.4xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"c1.medium\">c1.medium</option>\n\t\t\t\t\t\t\t\t<option value=\"c1.xlarge\">c1.xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"c1.xlarge\">cc1.4xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"c1.xlarge\">cg1.4xlarge</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td align=\"center\" >\n\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"region\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t                    dojoAttachEvent=\"onChange:setAvailzoneCombo\"\n\t\t\t\t\t\t\t\tclass=\"region\">\n\t\t\t\t\t\t\t\t<option value=\"us-east-1\">us-east-1</option> \n\t\t\t\t\t\t\t\t<option value=\"us-west-1\">us-west-1</option> \n\t\t\t\t\t\t\t\t<option value=\"eu-west-1\">eu-west-1</option> \n\t\t\t\t\t\t\t\t<option value=\"ap-northeast-1\">ap-northeast-1</option> \n\t\t\t\t\t\t\t\t<option value=\"ap-southeast-1\">ap-southeast-1</option> \n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"availzone\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\tclass=\"availzone\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tpopupClass=\"clusters availzone dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\tstyle=\"width: 150px;\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t\n\t\t\t\t</table>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr class=\"headerRow\" width=\"95%\" height=\"8px\">\n\t\t\t<td colspan=\"3\">Description</td>\n\t\t</tr>\n\n\t\t<tr width=\"95%\" >\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<textarea\n\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\tclass=\"description\"\n\t\t\t\t\tcols=\"40\"\n\t\t\t\t\trows=\"1\"\n\t\t\t\t\ttitle=\"A brief description of the cluster group\"\n\t\t\t\t>Description</textarea>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t<td colspan=\"3\" width=\"95%\">\n\t\t\t\t<div class=\"label\"> Clusters </div>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\tstyle=\"height: 350px; width: 95%;\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr align=\"center\">\n\t\t\t<td colspan=\"3\" align=\"center\">\n\n\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</table>\n\n\n\t</div>\n\t<!-- END clusters TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins")+"/admin/css/clusters.css"],parentWidget:null,instancetypeslots:{"t1.micro":1,"m1.small":1,"m1.large":4,"m1.xlarge":8,"m2.xlarge":7,"m2.2xlarge":13,"m2.4xlarge":26,"c1.medium":5,"c1.xlarge":20,"cc1.4xlarge":34,"cg1.4xlarge":34},formInputs:{cluster:"word",minnodes:"number",maxnodes:"number",instancetype:"combo",amiid:"word",availzone:"word",description:"phrase"},defaultInputs:{cluster:"myCluster",minnodes:"minNodes",maxnodes:"maxNodes",instancetype:"instanceType",amiid:"AMI ID",description:"Description",notes:"Notes"},requiredInputs:{cluster:1,minnodes:1,maxnodes:1,amiid:1},invalidInputs:{cluster:"myCluster",minnodes:"",maxnodes:"",amiid:"",description:"Description"},dataFields:["cluster"],rowClass:"plugins.admin.ClusterRow",avatarType:"parameters",avatarItems:["cluster","minnodes","maxnodes","instancetype","description"],constructor:function(args){this.parentWidget=args.parentWidget;this.clusters=args.parentWidget.clusters;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("Clusters.startup    plugins.admin.Clusters.startup()");console.log("Clusters.startup    this: "+this);this.inherited(arguments);this.tabContainer.addChild(this.clustersTab);this.tabContainer.selectChild(this.clustersTab);this.setForm();this.setAmiCombo();this.setDragSource();this.setTrash(this.dataFields);Agua.updater.subscribe(this,"updateClusters");Agua.updater.subscribe(this,"updateAmis");},updateClusters:function(args){if(args==null||args.reload!=false){this.setDragSource();}},updateAmis:function(args){console.log("Amis.updateAmis(args)");console.log("Amis.updateAmis    args: ");console.dir(args);if(args.originator==this){if(args.reload==false){return;}}console.log("Amis.updateAmis    Doing this.setAmiCombo()");this.setAmiCombo();},setForm:function(){dojo.connect(this.addClusterButton,"onclick",dojo.hitch(this,"newCluster",null,null));dojo.connect(this.cluster,"onFocus",dojo.hitch(this,"clearValue",this.cluster,this.invalidInputs["cluster"]));var _642={target:{selectedIndex:0,options:[{text:"us-east-1"}]}};this.setAvailzoneCombo(_642);this.inherited(arguments);},setAmiInfo:function(_643){console.log("Clusters.setAmiInfo     plugins.admin.Clusters.setAmiInfo(event)");var _644=this.amiid.get("value");console.log("Clusters.setAmiInfo     amiid: "+_644);var _645=Agua.getAmiObjectById(_644);console.log("Clusters.setAmiInfo     amiObject: "+dojo.toJson(_645));this.aminame.innerHTML=_645.aminame;this.amitype.innerHTML=_645.amitype;this.amiid.focusNode.title=_645.description;this.amiidContainer.title=_645.description;this.aminame.title=_645.description;this.amitype.title=_645.description;},setAvailzoneCombo:function(_646){var _647=this.getSelectedValue(_646.target);var _648=Agua.getAvailzonesByRegion(_647);var data={identifier:"name",items:[]};for(var i=0;i<_648.length;i++){data.items[i]={name:_648[i]};}var _649=new dojo.data.ItemFileWriteStore({data:data});this.availzone.store=_649;this.availzone.startup();var _64a=_648[0];this.availzone.setValue(_64a);},getItemsArray:function(){var amis=Agua.getAmis();console.log("Clusters.getItemsArray     amis: "+dojo.toJson(amis));return this.hashArrayKeyToArray(amis,["amiid"]);},setAmiCombo:function(){console.log("Clusters.setAmiCombo     plugins.admin.Clusters.setAmiCombo()");var amis=this.getItemsArray();console.log("Clusters.setAmiCombo     amis: "+dojo.toJson(amis));var data={identifier:"name",items:[]};for(var i=0;i<amis.length;i++){data.items[i]={name:amis[i]};}console.log("Clusters.setAmiCombo     data: "+dojo.toJson(data));var _64b=new dojo.data.ItemFileWriteStore({data:data});this.amiid.store=_64b;this.amiid.startup();console.log("Clusters.setAmiCombo     AFTER this.amiid.startup()");var _64c=amis[0];this.amiid.setValue(_64c);console.log("Clusters.setAmiCombo     AFTER this.amiid.setValue(firstValue)");},getItemArray:function(){return Agua.getClusters();},setDragSource:function(){console.log("Clusters.setDragSource     plugins.admin.Clusters.setDragSource()");if(this.dragSource==null){this.initialiseDragSource();this.setDragSourceCreator();}this.clearDragSource();var _64d=this.getItemArray();var _64e=Agua.cookie("username")+"-";for(var i=0;i<_64d.length;i++){_64d[i].cluster=_64d[i].cluster.replace(_64e,"");}_64d=this.sortHasharray(_64d,"cluster");if(_64d==null){return;}this.loadDragItems(_64d);},newCluster:function(_64f,_650){if(this.saving==true){return;}this.saving=true;if(_64f==null){_64f=this.getFormInputs(this);if(_64f==null){this.saving=false;return;}}_64f.cluster=Agua.getClusterLongName(_64f.cluster);Agua.newCluster(_64f);this.saving=false;Agua.updater.update("updateClusters",_650);},saveInputs:function(_651,_652){if(this.saving==true){return;}this.saving=true;if(_651==null){_651=this.getFormInputs(this);if(_651==null){this.saving=false;return;}}_651.cluster=Agua.getClusterLongName(_651.cluster);Agua.addCluster(_651);this.saving=false;Agua.updater.update("updateClusters",_652);},deleteItem:function(_653){_653.cluster=Agua.cookie("username")+"-"+_653.cluster;Agua.removeCluster(_653);Agua.updater.update("updateClusters",{originator:this,reload:false});Agua.updater.update("updateAmis",{originator:this,reload:false});},checkEnter:function(_654){if(_654.keyCode==dojo.keys.ENTER){this.saveInputs();dojo.stopEvent(_654);}},checkEnterNodes:function(_655){if(_655.keyCode==dojo.keys.ENTER){dojo.stopEvent(_655);document.body.focus();this.checkNodeNumbers();this.saveInputs();}},checkNodeNumbers:function(){if(this.minnodes.value>this.maxnodes.value){this.minnodes.set("value",this.maxnodes.value);}}});}if(!dojo._hasResource["dojox.html._base"]){dojo._hasResource["dojox.html._base"]=true;dojo.provide("dojox.html._base");(function(){if(dojo.isIE){var _656=/(AlphaImageLoader\([^)]*?src=(['"]))(?![a-z]+:|\/)([^\r\n;}]+?)(\2[^)]*\)\s*[;}]?)/g;}var _657=/(?:(?:@import\s*(['"])(?![a-z]+:|\/)([^\r\n;{]+?)\1)|url\(\s*(['"]?)(?![a-z]+:|\/)([^\r\n;]+?)\3\s*\))([a-z, \s]*[;}]?)/g;var _658=dojox.html._adjustCssPaths=function(_659,_65a){if(!_65a||!_659){return;}if(_656){_65a=_65a.replace(_656,function(_65b,pre,_65c,url,post){return pre+(new dojo._Url(_659,"./"+url).toString())+post;});}return _65a.replace(_657,function(_65d,_65e,_65f,_660,_661,_662){if(_65f){return "@import \""+(new dojo._Url(_659,"./"+_65f).toString())+"\""+_662;}else{return "url("+(new dojo._Url(_659,"./"+_661).toString())+")"+_662;}});};var _663=/(<[a-z][a-z0-9]*\s[^>]*)(?:(href|src)=(['"]?)([^>]*?)\3|style=(['"]?)([^>]*?)\5)([^>]*>)/gi;var _664=dojox.html._adjustHtmlPaths=function(_665,cont){var url=_665||"./";return cont.replace(_663,function(tag,_666,name,_667,_668,_669,_66a,end){return _666+(name?(name+"="+_667+(new dojo._Url(url,_668).toString())+_667):("style="+_669+_658(url,_66a)+_669))+end;});};var _66b=dojox.html._snarfStyles=function(_66c,cont,_66d){_66d.attributes=[];return cont.replace(/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,function(_66e,_66f,_670,_671,_672,href){var i,attr=(_66f||_671||"").replace(/^\s*([\s\S]*?)\s*$/i,"$1");if(_670){i=_66d.push(_66c?_658(_66c,_670):_670);}else{i=_66d.push("@import \""+href+"\";");attr=attr.replace(/\s*(?:rel|href)=(['"])?[^\s]*\1\s*/gi,"");}if(attr){attr=attr.split(/\s+/);var _673={},tmp;for(var j=0,e=attr.length;j<e;j++){tmp=attr[j].split("=");_673[tmp[0]]=tmp[1].replace(/^\s*['"]?([\s\S]*?)['"]?\s*$/,"$1");}_66d.attributes[i-1]=_673;}return "";});};var _674=dojox.html._snarfScripts=function(cont,_675){_675.code="";cont=cont.replace(/<[!][-][-](.|\s)*?[-][-]>/g,function(_676){return _676.replace(/<(\/?)script\b/ig,"&lt;$1Script");});function _677(src){if(_675.downloadRemote){src=src.replace(/&([a-z0-9#]+);/g,function(m,name){switch(name){case "amp":return "&";case "gt":return ">";case "lt":return "<";default:return name.charAt(0)=="#"?String.fromCharCode(name.substring(1)):"&"+name+";";}});dojo.xhrGet({url:src,sync:true,load:function(code){_675.code+=code+";";},error:_675.errBack});}};return cont.replace(/<script\s*(?![^>]*type=['"]?(?:dojo\/|text\/html\b))(?:[^>]*?(?:src=(['"]?)([^>]*?)\1[^>]*)?)*>([\s\S]*?)<\/script>/gi,function(_678,_679,src,code){if(src){_677(src);}else{_675.code+=code;}return "";});};var _67a=dojox.html.evalInGlobal=function(code,_67b){_67b=_67b||dojo.doc.body;var n=_67b.ownerDocument.createElement("script");n.type="text/javascript";_67b.appendChild(n);n.text=code;};dojo.declare("dojox.html._ContentSetter",[dojo.html._ContentSetter],{adjustPaths:false,referencePath:".",renderStyles:false,executeScripts:false,scriptHasHooks:false,scriptHookReplacement:null,_renderStyles:function(_67c){this._styleNodes=[];var st,att,_67d,doc=this.node.ownerDocument;var head=doc.getElementsByTagName("head")[0];for(var i=0,e=_67c.length;i<e;i++){_67d=_67c[i];att=_67c.attributes[i];st=doc.createElement("style");st.setAttribute("type","text/css");for(var x in att){st.setAttribute(x,att[x]);}this._styleNodes.push(st);head.appendChild(st);if(st.styleSheet){st.styleSheet.cssText=_67d;}else{st.appendChild(doc.createTextNode(_67d));}}},empty:function(){this.inherited("empty",arguments);this._styles=[];},onBegin:function(){this.inherited("onBegin",arguments);var cont=this.content,node=this.node;var _67e=this._styles;if(dojo.isString(cont)){if(this.adjustPaths&&this.referencePath){cont=_664(this.referencePath,cont);}if(this.renderStyles||this.cleanContent){cont=_66b(this.referencePath,cont,_67e);}if(this.executeScripts){var _67f=this;var _680={downloadRemote:true,errBack:function(e){_67f._onError.call(_67f,"Exec","Error downloading remote script in \""+_67f.id+"\"",e);}};cont=_674(cont,_680);this._code=_680.code;}}this.content=cont;},onEnd:function(){var code=this._code,_681=this._styles;if(this._styleNodes&&this._styleNodes.length){while(this._styleNodes.length){dojo.destroy(this._styleNodes.pop());}}if(this.renderStyles&&_681&&_681.length){this._renderStyles(_681);}if(this.executeScripts&&code){if(this.cleanContent){code=code.replace(/(<!--|(?:\/\/)?-->|<!\[CDATA\[|\]\]>)/g,"");}if(this.scriptHasHooks){code=code.replace(/_container_(?!\s*=[^=])/g,this.scriptHookReplacement);}try{_67a(code,this.node);}catch(e){this._onError("Exec","Error eval script in "+this.id+", "+e.message,e);}}this.inherited("onEnd",arguments);},tearDown:function(){this.inherited(arguments);delete this._styles;if(this._styleNodes&&this._styleNodes.length){while(this._styleNodes.length){dojo.destroy(this._styleNodes.pop());}}delete this._styleNodes;dojo.mixin(this,dojo.getObject(this.declaredClass).prototype);}});dojox.html.set=function(node,cont,_682){if(!_682){return dojo.html._setNodeContent(node,cont,true);}else{var op=new dojox.html._ContentSetter(dojo.mixin(_682,{content:cont,node:node}));return op.set();}};})();}if(!dojo._hasResource["dojox.layout.ContentPane"]){dojo._hasResource["dojox.layout.ContentPane"]=true;dojo.provide("dojox.layout.ContentPane");dojo.declare("dojox.layout.ContentPane",dijit.layout.ContentPane,{adjustPaths:false,cleanContent:false,renderStyles:false,executeScripts:true,scriptHasHooks:false,constructor:function(){this.ioArgs={};this.ioMethod=dojo.xhrGet;},onExecError:function(e){},_setContent:function(cont){var _683=this._contentSetter;if(!(_683&&_683 instanceof dojox.html._ContentSetter)){_683=this._contentSetter=new dojox.html._ContentSetter({node:this.containerNode,_onError:dojo.hitch(this,this._onError),onContentError:dojo.hitch(this,function(e){var _684=this.onContentError(e);try{this.containerNode.innerHTML=_684;}catch(e){console.error("Fatal "+this.id+" could not change content due to "+e.message,e);}})});}this._contentSetterParams={adjustPaths:Boolean(this.adjustPaths&&(this.href||this.referencePath)),referencePath:this.href||this.referencePath,renderStyles:this.renderStyles,executeScripts:this.executeScripts,scriptHasHooks:this.scriptHasHooks,scriptHookReplacement:"dijit.byId('"+this.id+"')"};this.inherited("_setContent",arguments);}});}if(!dojo._hasResource["dojox.layout.ResizeHandle"]){dojo._hasResource["dojox.layout.ResizeHandle"]=true;dojo.provide("dojox.layout.ResizeHandle");dojo.experimental("dojox.layout.ResizeHandle");dojo.declare("dojox.layout.ResizeHandle",[dijit._Widget,dijit._Templated],{targetId:"",targetContainer:null,resizeAxis:"xy",activeResize:false,activeResizeClass:"dojoxResizeHandleClone",animateSizing:true,animateMethod:"chain",animateDuration:225,minHeight:100,minWidth:100,constrainMax:false,maxHeight:0,maxWidth:0,fixedAspect:false,intermediateChanges:false,startTopic:"/dojo/resize/start",endTopic:"/dojo/resize/stop",templateString:"<div dojoAttachPoint=\"resizeHandle\" class=\"dojoxResizeHandle\"><div></div></div>",postCreate:function(){this.connect(this.resizeHandle,"onmousedown","_beginSizing");if(!this.activeResize){this._resizeHelper=dijit.byId("dojoxGlobalResizeHelper");if(!this._resizeHelper){this._resizeHelper=new dojox.layout._ResizeHelper({id:"dojoxGlobalResizeHelper"}).placeAt(dojo.body());dojo.addClass(this._resizeHelper.domNode,this.activeResizeClass);}}else{this.animateSizing=false;}if(!this.minSize){this.minSize={w:this.minWidth,h:this.minHeight};}if(this.constrainMax){this.maxSize={w:this.maxWidth,h:this.maxHeight};}this._resizeX=this._resizeY=false;var _685=dojo.partial(dojo.addClass,this.resizeHandle);switch(this.resizeAxis.toLowerCase()){case "xy":this._resizeX=this._resizeY=true;_685("dojoxResizeNW");break;case "x":this._resizeX=true;_685("dojoxResizeW");break;case "y":this._resizeY=true;_685("dojoxResizeN");break;}},_beginSizing:function(e){if(this._isSizing){return false;}dojo.publish(this.startTopic,[this]);this.targetWidget=dijit.byId(this.targetId);this.targetDomNode=this.targetWidget?this.targetWidget.domNode:dojo.byId(this.targetId);if(this.targetContainer){this.targetDomNode=this.targetContainer;}if(!this.targetDomNode){return false;}if(!this.activeResize){var c=dojo.position(this.targetDomNode,true);console.log(c);console.log(dojo.window.getBox());this._resizeHelper.resize({l:c.x,t:c.y,w:c.w,h:c.h});this._resizeHelper.show();}this._isSizing=true;this.startPoint={x:e.clientX,y:e.clientY};var mb=this.targetWidget?dojo.marginBox(this.targetDomNode):dojo.contentBox(this.targetDomNode);this.startSize={w:mb.w,h:mb.h};if(this.fixedAspect){var max,val;if(mb.w>mb.h){max="w";val=mb.w/mb.h;}else{max="h";val=mb.h/mb.w;}this._aspect={prop:max};this._aspect[max]=val;}this._pconnects=[];this._pconnects.push(dojo.connect(dojo.doc,"onmousemove",this,"_updateSizing"));this._pconnects.push(dojo.connect(dojo.doc,"onmouseup",this,"_endSizing"));dojo.stopEvent(e);},_updateSizing:function(e){if(this.activeResize){this._changeSizing(e);}else{var tmp=this._getNewCoords(e);if(tmp===false){return;}this._resizeHelper.resize(tmp);}e.preventDefault();},_getNewCoords:function(e){try{if(!e.clientX||!e.clientY){return false;}}catch(e){return false;}this._activeResizeLastEvent=e;var dx=(this.isLeftToRight()?this.startPoint.x-e.clientX:e.clientX-this.startPoint.x),dy=this.startPoint.y-e.clientY,newW=this.startSize.w-(this._resizeX?dx:0),newH=this.startSize.h-(this._resizeY?dy:0);return this._checkConstraints(newW,newH);},_checkConstraints:function(newW,newH){if(this.minSize){var tm=this.minSize;if(newW<tm.w){newW=tm.w;}if(newH<tm.h){newH=tm.h;}}if(this.constrainMax&&this.maxSize){var ms=this.maxSize;if(newW>ms.w){newW=ms.w;}if(newH>ms.h){newH=ms.h;}}if(this.fixedAspect){var ta=this._aspect[this._aspect.prop];if(newW<newH){newH=newW*ta;}else{if(newH<newW){newW=newH*ta;}}}return {w:newW,h:newH};},_changeSizing:function(e){var tmp=this._getNewCoords(e);if(tmp===false){return;}if(this.targetWidget&&dojo.isFunction(this.targetWidget.resize)){this.targetWidget.resize(tmp);}else{if(this.animateSizing){var anim=dojo.fx[this.animateMethod]([dojo.animateProperty({node:this.targetDomNode,properties:{width:{start:this.startSize.w,end:tmp.w}},duration:this.animateDuration}),dojo.animateProperty({node:this.targetDomNode,properties:{height:{start:this.startSize.h,end:tmp.h}},duration:this.animateDuration})]);anim.play();}else{dojo.style(this.targetDomNode,{width:tmp.w+"px",height:tmp.h+"px"});}}if(this.intermediateChanges){this.onResize(e);}},_endSizing:function(e){dojo.forEach(this._pconnects,dojo.disconnect);var pub=dojo.partial(dojo.publish,this.endTopic,[this]);if(!this.activeResize){this._resizeHelper.hide();this._changeSizing(e);setTimeout(pub,this.animateDuration+15);}else{pub();}this._isSizing=false;this.onResize(e);},onResize:function(e){}});dojo.declare("dojox.layout._ResizeHelper",dijit._Widget,{show:function(){dojo.fadeIn({node:this.domNode,duration:120,beforeBegin:function(n){dojo.style(n,"display","");}}).play();},hide:function(){dojo.fadeOut({node:this.domNode,duration:250,onEnd:function(n){dojo.style(n,"display","none");}}).play();},resize:function(dim){dojo.marginBox(this.domNode,dim);}});}if(!dojo._hasResource["dojox.layout.FloatingPane"]){dojo._hasResource["dojox.layout.FloatingPane"]=true;dojo.provide("dojox.layout.FloatingPane");dojo.experimental("dojox.layout.FloatingPane");dojo.declare("dojox.layout.FloatingPane",[dojox.layout.ContentPane,dijit._Templated],{closable:true,dockable:true,resizable:false,maxable:false,resizeAxis:"xy",title:"",dockTo:"",duration:400,contentClass:"dojoxFloatingPaneContent",_showAnim:null,_hideAnim:null,_dockNode:null,_restoreState:{},_allFPs:[],_startZ:100,templateString:dojo.cache("dojox.layout","resources/FloatingPane.html","<div class=\"dojoxFloatingPane\" id=\"${id}\">\n\t<div tabindex=\"0\" role=\"button\" class=\"dojoxFloatingPaneTitle\" dojoAttachPoint=\"focusNode\">\n\t\t<span dojoAttachPoint=\"closeNode\" dojoAttachEvent=\"onclick: close\" class=\"dojoxFloatingCloseIcon\"></span>\n\t\t<span dojoAttachPoint=\"maxNode\" dojoAttachEvent=\"onclick: maximize\" class=\"dojoxFloatingMaximizeIcon\">&thinsp;</span>\n\t\t<span dojoAttachPoint=\"restoreNode\" dojoAttachEvent=\"onclick: _restore\" class=\"dojoxFloatingRestoreIcon\">&thinsp;</span>\t\n\t\t<span dojoAttachPoint=\"dockNode\" dojoAttachEvent=\"onclick: minimize\" class=\"dojoxFloatingMinimizeIcon\">&thinsp;</span>\n\t\t<span dojoAttachPoint=\"titleNode\" class=\"dijitInline dijitTitleNode\"></span>\n\t</div>\n\t<div dojoAttachPoint=\"canvas\" class=\"dojoxFloatingPaneCanvas\">\n\t\t<div dojoAttachPoint=\"containerNode\" role=\"region\" tabindex=\"-1\" class=\"${contentClass}\">\n\t\t</div>\n\t\t<span dojoAttachPoint=\"resizeHandle\" class=\"dojoxFloatingResizeHandle\"></span>\n\t</div>\n</div>\n"),attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:{type:"innerHTML",node:"titleNode"}}),postCreate:function(){this.inherited(arguments);new dojo.dnd.Moveable(this.domNode,{handle:this.focusNode});if(!this.dockable){this.dockNode.style.display="none";}if(!this.closable){this.closeNode.style.display="none";}if(!this.maxable){this.maxNode.style.display="none";this.restoreNode.style.display="none";}if(!this.resizable){this.resizeHandle.style.display="none";}else{this.domNode.style.width=dojo.marginBox(this.domNode).w+"px";}this._allFPs.push(this);this.domNode.style.position="absolute";this.bgIframe=new dijit.BackgroundIframe(this.domNode);this._naturalState=dojo.coords(this.domNode);},startup:function(){if(this._started){return;}if(this.resizable){if(dojo.isIE){this.canvas.style.overflow="auto";}else{this.containerNode.style.overflow="auto";}this._resizeHandle=new dojox.layout.ResizeHandle({targetId:this.id,resizeAxis:this.resizeAxis},this.resizeHandle);}if(this.dockable){var _686=this.dockTo;if(this.dockTo){this.dockTo=dijit.byId(this.dockTo);}else{this.dockTo=dijit.byId("dojoxGlobalFloatingDock");}if(!this.dockTo){var _687,_688;if(_686){_687=_686;_688=dojo.byId(_686);}else{_688=dojo.create("div",null,dojo.body());dojo.addClass(_688,"dojoxFloatingDockDefault");_687="dojoxGlobalFloatingDock";}this.dockTo=new dojox.layout.Dock({id:_687,autoPosition:"south"},_688);this.dockTo.startup();}if((this.domNode.style.display=="none")||(this.domNode.style.visibility=="hidden")){this.minimize();}}this.connect(this.focusNode,"onmousedown","bringToTop");this.connect(this.domNode,"onmousedown","bringToTop");this.resize(dojo.coords(this.domNode));this._started=true;},setTitle:function(_689){dojo.deprecated("pane.setTitle","Use pane.set('title', someTitle)","2.0");this.set("title",_689);},close:function(){if(!this.closable){return;}dojo.unsubscribe(this._listener);this.hide(dojo.hitch(this,function(){this.destroyRecursive();}));},hide:function(_68a){dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,function(){this.domNode.style.display="none";this.domNode.style.visibility="hidden";if(this.dockTo&&this.dockable){this.dockTo._positionDock(null);}if(_68a){_68a();}})}).play();},show:function(_68b){var anim=dojo.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:dojo.hitch(this,function(){this.domNode.style.display="";this.domNode.style.visibility="visible";if(this.dockTo&&this.dockable){this.dockTo._positionDock(null);}if(typeof _68b=="function"){_68b();}this._isDocked=false;if(this._dockNode){this._dockNode.destroy();this._dockNode=null;}})}).play();this.resize(dojo.coords(this.domNode));this._onShow();},minimize:function(){if(!this._isDocked){this.hide(dojo.hitch(this,"_dock"));}},maximize:function(){if(this._maximized){return;}this._naturalState=dojo.position(this.domNode);if(this._isDocked){this.show();setTimeout(dojo.hitch(this,"maximize"),this.duration);}dojo.addClass(this.focusNode,"floatingPaneMaximized");this.resize(dojo.window.getBox());this._maximized=true;},_restore:function(){if(this._maximized){this.resize(this._naturalState);dojo.removeClass(this.focusNode,"floatingPaneMaximized");this._maximized=false;}},_dock:function(){if(!this._isDocked&&this.dockable){this._dockNode=this.dockTo.addNode(this);this._isDocked=true;}},resize:function(dim){dim=dim||this._naturalState;this._currentState=dim;var dns=this.domNode.style;if("t" in dim){dns.top=dim.t+"px";}if("l" in dim){dns.left=dim.l+"px";}dns.width=dim.w+"px";dns.height=dim.h+"px";var _68c={l:0,t:0,w:dim.w,h:(dim.h-this.focusNode.offsetHeight)};dojo.marginBox(this.canvas,_68c);this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){this._singleChild.resize(_68c);}},bringToTop:function(){var _68d=dojo.filter(this._allFPs,function(i){return i!==this;},this);_68d.sort(function(a,b){return a.domNode.style.zIndex-b.domNode.style.zIndex;});_68d.push(this);dojo.forEach(_68d,function(w,x){w.domNode.style.zIndex=this._startZ+(x*2);dojo.removeClass(w.domNode,"dojoxFloatingPaneFg");},this);dojo.addClass(this.domNode,"dojoxFloatingPaneFg");},destroy:function(){this._allFPs.splice(dojo.indexOf(this._allFPs,this),1);if(this._resizeHandle){this._resizeHandle.destroy();}this.inherited(arguments);}});dojo.declare("dojox.layout.Dock",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dojoxDock\"><ul dojoAttachPoint=\"containerNode\" class=\"dojoxDockList\"></ul></div>",_docked:[],_inPositioning:false,autoPosition:false,addNode:function(_68e){var div=dojo.create("li",null,this.containerNode),node=new dojox.layout._DockNode({title:_68e.title,paneRef:_68e},div);node.startup();return node;},startup:function(){if(this.id=="dojoxGlobalFloatingDock"||this.isFixedDock){this.connect(window,"onresize","_positionDock");this.connect(window,"onscroll","_positionDock");if(dojo.isIE){this.connect(this.domNode,"onresize","_positionDock");}}this._positionDock(null);this.inherited(arguments);},_positionDock:function(e){if(!this._inPositioning){if(this.autoPosition=="south"){setTimeout(dojo.hitch(this,function(){this._inPositiononing=true;var _68f=dojo.window.getBox();var s=this.domNode.style;s.left=_68f.l+"px";s.width=(_68f.w-2)+"px";s.top=(_68f.h+_68f.t)-this.domNode.offsetHeight+"px";this._inPositioning=false;}),125);}}}});dojo.declare("dojox.layout._DockNode",[dijit._Widget,dijit._Templated],{title:"",paneRef:null,templateString:"<li dojoAttachEvent=\"onclick: restore\" class=\"dojoxDockNode\">"+"<span dojoAttachPoint=\"restoreNode\" class=\"dojoxDockRestoreButton\" dojoAttachEvent=\"onclick: restore\"></span>"+"<span class=\"dojoxDockTitleNode\" dojoAttachPoint=\"titleNode\">${title}</span>"+"</li>",restore:function(){this.paneRef.show();this.paneRef.bringToTop();this.destroy();}});}if(!dojo._hasResource["dijit.TitlePane"]){dojo._hasResource["dijit.TitlePane"]=true;dojo.provide("dijit.TitlePane");dojo.declare("dijit.TitlePane",[dijit.layout.ContentPane,dijit._Templated,dijit._CssStateMixin],{title:"",open:true,toggleable:true,tabIndex:"0",duration:dijit.defaultDuration,baseClass:"dijitTitlePane",templateString:dojo.cache("dijit","templates/TitlePane.html","<div>\n\t<div dojoAttachEvent=\"onclick:_onTitleClick, onkeypress:_onTitleKey\"\n\t\t\tclass=\"dijitTitlePaneTitle\" dojoAttachPoint=\"titleBarNode\">\n\t\t<div class=\"dijitTitlePaneTitleFocus\" dojoAttachPoint=\"focusNode\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"arrowNode\" class=\"dijitArrowNode\" role=\"presentation\"\n\t\t\t/><span dojoAttachPoint=\"arrowNodeInner\" class=\"dijitArrowNodeInner\"></span\n\t\t\t><span dojoAttachPoint=\"titleNode\" class=\"dijitTitlePaneTextNode\"></span>\n\t\t</div>\n\t</div>\n\t<div class=\"dijitTitlePaneContentOuter\" dojoAttachPoint=\"hideNode\" role=\"presentation\">\n\t\t<div class=\"dijitReset\" dojoAttachPoint=\"wipeNode\" role=\"presentation\">\n\t\t\t<div class=\"dijitTitlePaneContentInner\" dojoAttachPoint=\"containerNode\" role=\"region\" id=\"${id}_pane\">\n\t\t\t\t<!-- nested divs because wipeIn()/wipeOut() doesn't work right on node w/padding etc.  Put padding on inner div. -->\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n"),attributeMap:dojo.delegate(dijit.layout.ContentPane.prototype.attributeMap,{title:{node:"titleNode",type:"innerHTML"},tooltip:{node:"focusNode",type:"attribute",attribute:"title"},id:""}),buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.titleNode,false);},postCreate:function(){this.inherited(arguments);if(this.toggleable){this._trackMouseState(this.titleBarNode,"dijitTitlePaneTitle");}var _690=this.hideNode,_691=this.wipeNode;this._wipeIn=dojo.fx.wipeIn({node:this.wipeNode,duration:this.duration,beforeBegin:function(){_690.style.display="";}});this._wipeOut=dojo.fx.wipeOut({node:this.wipeNode,duration:this.duration,onEnd:function(){_690.style.display="none";}});},_setOpenAttr:function(open,_692){dojo.forEach([this._wipeIn,this._wipeOut],function(_693){if(_693&&_693.status()=="playing"){_693.stop();}});if(_692){var anim=this[open?"_wipeIn":"_wipeOut"];anim.play();}else{this.hideNode.style.display=this.wipeNode.style.display=open?"":"none";}if(this._started){if(open){this._onShow();}else{this.onHide();}}this.arrowNodeInner.innerHTML=open?"-":"+";dijit.setWaiState(this.containerNode,"hidden",open?"false":"true");dijit.setWaiState(this.focusNode,"pressed",open?"true":"false");this._set("open",open);this._setCss();},_setToggleableAttr:function(_694){dijit.setWaiRole(this.focusNode,_694?"button":"heading");if(_694){dijit.setWaiState(this.focusNode,"controls",this.id+"_pane");dojo.attr(this.focusNode,"tabIndex",this.tabIndex);}else{dojo.removeAttr(this.focusNode,"tabIndex");}this._set("toggleable",_694);this._setCss();},_setContentAttr:function(_695){if(!this.open||!this._wipeOut||this._wipeOut.status()=="playing"){this.inherited(arguments);}else{if(this._wipeIn&&this._wipeIn.status()=="playing"){this._wipeIn.stop();}dojo.marginBox(this.wipeNode,{h:dojo.marginBox(this.wipeNode).h});this.inherited(arguments);if(this._wipeIn){this._wipeIn.play();}else{this.hideNode.style.display="";}}},toggle:function(){this._setOpenAttr(!this.open,true);},_setCss:function(){var node=this.titleBarNode||this.focusNode;var _696=this._titleBarClass;this._titleBarClass="dijit"+(this.toggleable?"":"Fixed")+(this.open?"Open":"Closed");dojo.replaceClass(node,this._titleBarClass,_696||"");this.arrowNodeInner.innerHTML=this.open?"-":"+";},_onTitleKey:function(e){if(e.charOrCode==dojo.keys.ENTER||e.charOrCode==" "){if(this.toggleable){this.toggle();}dojo.stopEvent(e);}else{if(e.charOrCode==dojo.keys.DOWN_ARROW&&this.open){this.containerNode.focus();e.preventDefault();}}},_onTitleClick:function(){if(this.toggleable){this.toggle();}},setTitle:function(_697){dojo.deprecated("dijit.TitlePane.setTitle() is deprecated.  Use set('title', ...) instead.","","2.0");this.set("title",_697);}});}if(!dojo._hasResource["dojo.cookie"]){dojo._hasResource["dojo.cookie"]=true;dojo.provide("dojo.cookie");dojo.cookie=function(name,_698,_699){var c=document.cookie;if(arguments.length==1){var _69a=c.match(new RegExp("(?:^|; )"+dojo.regexp.escapeString(name)+"=([^;]*)"));return _69a?decodeURIComponent(_69a[1]):undefined;}else{_699=_699||{};var exp=_699.expires;if(typeof exp=="number"){var d=new Date();d.setTime(d.getTime()+exp*24*60*60*1000);exp=_699.expires=d;}if(exp&&exp.toUTCString){_699.expires=exp.toUTCString();}_698=encodeURIComponent(_698);var _69b=name+"="+_698,_69c;for(_69c in _699){_69b+="; "+_69c;var _69d=_699[_69c];if(_69d!==true){_69b+="="+_69d;}}document.cookie=_69b;}};dojo.cookie.isSupported=function(){if(!("cookieEnabled" in navigator)){this("__djCookieTest__","CookiesAllowed");navigator.cookieEnabled=this("__djCookieTest__")=="CookiesAllowed";if(navigator.cookieEnabled){this("__djCookieTest__","",{expires:-1});}}return navigator.cookieEnabled;};}if(!dojo._hasResource["dijit.layout.StackController"]){dojo._hasResource["dijit.layout.StackController"]=true;dojo.provide("dijit.layout.StackController");dojo.declare("dijit.layout.StackController",[dijit._Widget,dijit._Templated,dijit._Container],{templateString:"<span role='tablist' dojoAttachEvent='onkeypress' class='dijitStackController'></span>",containerId:"",buttonWidget:"dijit.layout._StackButton",constructor:function(){this.pane2button={};this.pane2connects={};this.pane2watches={};},buildRendering:function(){this.inherited(arguments);dijit.setWaiRole(this.domNode,"tablist");},postCreate:function(){this.inherited(arguments);this.subscribe(this.containerId+"-startup","onStartup");this.subscribe(this.containerId+"-addChild","onAddChild");this.subscribe(this.containerId+"-removeChild","onRemoveChild");this.subscribe(this.containerId+"-selectChild","onSelectChild");this.subscribe(this.containerId+"-containerKeyPress","onContainerKeyPress");},onStartup:function(info){dojo.forEach(info.children,this.onAddChild,this);if(info.selected){this.onSelectChild(info.selected);}},destroy:function(){for(var pane in this.pane2button){this.onRemoveChild(dijit.byId(pane));}this.inherited(arguments);},onAddChild:function(page,_69e){var cls=dojo.getObject(this.buttonWidget);var _69f=new cls({id:this.id+"_"+page.id,label:page.title,dir:page.dir,lang:page.lang,showLabel:page.showTitle,iconClass:page.iconClass,closeButton:page.closable,title:page.tooltip});dijit.setWaiState(_69f.focusNode,"selected","false");var _6a0=["title","showTitle","iconClass","closable","tooltip"],_6a1=["label","showLabel","iconClass","closeButton","title"];this.pane2watches[page.id]=dojo.map(_6a0,function(_6a2,idx){return page.watch(_6a2,function(name,_6a3,_6a4){_69f.set(_6a1[idx],_6a4);});});this.pane2connects[page.id]=[this.connect(_69f,"onClick",dojo.hitch(this,"onButtonClick",page)),this.connect(_69f,"onClickCloseButton",dojo.hitch(this,"onCloseButtonClick",page))];this.addChild(_69f,_69e);this.pane2button[page.id]=_69f;page.controlButton=_69f;if(!this._currentChild){_69f.focusNode.setAttribute("tabIndex","0");dijit.setWaiState(_69f.focusNode,"selected","true");this._currentChild=page;}if(!this.isLeftToRight()&&dojo.isIE&&this._rectifyRtlTabList){this._rectifyRtlTabList();}},onRemoveChild:function(page){if(this._currentChild===page){this._currentChild=null;}dojo.forEach(this.pane2connects[page.id],dojo.hitch(this,"disconnect"));delete this.pane2connects[page.id];dojo.forEach(this.pane2watches[page.id],function(w){w.unwatch();});delete this.pane2watches[page.id];var _6a5=this.pane2button[page.id];if(_6a5){this.removeChild(_6a5);delete this.pane2button[page.id];_6a5.destroy();}delete page.controlButton;},onSelectChild:function(page){if(!page){return;}if(this._currentChild){var _6a6=this.pane2button[this._currentChild.id];_6a6.set("checked",false);dijit.setWaiState(_6a6.focusNode,"selected","false");_6a6.focusNode.setAttribute("tabIndex","-1");}var _6a7=this.pane2button[page.id];_6a7.set("checked",true);dijit.setWaiState(_6a7.focusNode,"selected","true");this._currentChild=page;_6a7.focusNode.setAttribute("tabIndex","0");var _6a8=dijit.byId(this.containerId);dijit.setWaiState(_6a8.containerNode,"labelledby",_6a7.id);},onButtonClick:function(page){var _6a9=dijit.byId(this.containerId);_6a9.selectChild(page);},onCloseButtonClick:function(page){var _6aa=dijit.byId(this.containerId);_6aa.closeChild(page);if(this._currentChild){var b=this.pane2button[this._currentChild.id];if(b){dijit.focus(b.focusNode||b.domNode);}}},adjacent:function(_6ab){if(!this.isLeftToRight()&&(!this.tabPosition||/top|bottom/.test(this.tabPosition))){_6ab=!_6ab;}var _6ac=this.getChildren();var _6ad=dojo.indexOf(_6ac,this.pane2button[this._currentChild.id]);var _6ae=_6ab?1:_6ac.length-1;return _6ac[(_6ad+_6ae)%_6ac.length];},onkeypress:function(e){if(this.disabled||e.altKey){return;}var _6af=null;if(e.ctrlKey||!e._djpage){var k=dojo.keys;switch(e.charOrCode){case k.LEFT_ARROW:case k.UP_ARROW:if(!e._djpage){_6af=false;}break;case k.PAGE_UP:if(e.ctrlKey){_6af=false;}break;case k.RIGHT_ARROW:case k.DOWN_ARROW:if(!e._djpage){_6af=true;}break;case k.PAGE_DOWN:if(e.ctrlKey){_6af=true;}break;case k.HOME:case k.END:var _6b0=this.getChildren();if(_6b0&&_6b0.length){_6b0[e.charOrCode==k.HOME?0:_6b0.length-1].onClick();}dojo.stopEvent(e);break;case k.DELETE:if(this._currentChild.closable){this.onCloseButtonClick(this._currentChild);}dojo.stopEvent(e);break;default:if(e.ctrlKey){if(e.charOrCode===k.TAB){this.adjacent(!e.shiftKey).onClick();dojo.stopEvent(e);}else{if(e.charOrCode=="w"){if(this._currentChild.closable){this.onCloseButtonClick(this._currentChild);}dojo.stopEvent(e);}}}}if(_6af!==null){this.adjacent(_6af).onClick();dojo.stopEvent(e);}}},onContainerKeyPress:function(info){info.e._djpage=info.page;this.onkeypress(info.e);}});dojo.declare("dijit.layout._StackButton",dijit.form.ToggleButton,{tabIndex:"-1",buildRendering:function(evt){this.inherited(arguments);dijit.setWaiRole((this.focusNode||this.domNode),"tab");},onClick:function(evt){dijit.focus(this.focusNode);},onClickCloseButton:function(evt){evt.stopPropagation();}});}if(!dojo._hasResource["dijit.layout.StackContainer"]){dojo._hasResource["dijit.layout.StackContainer"]=true;dojo.provide("dijit.layout.StackContainer");dojo.declare("dijit.layout.StackContainer",dijit.layout._LayoutWidget,{doLayout:true,persist:false,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitLayoutContainer");dijit.setWaiRole(this.containerNode,"tabpanel");},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onkeypress",this._onKeyPress);},startup:function(){if(this._started){return;}var _6b1=this.getChildren();dojo.forEach(_6b1,this._setupChild,this);if(this.persist){this.selectedChildWidget=dijit.byId(dojo.cookie(this.id+"_selectedChild"));}else{dojo.some(_6b1,function(_6b2){if(_6b2.selected){this.selectedChildWidget=_6b2;}return _6b2.selected;},this);}var _6b3=this.selectedChildWidget;if(!_6b3&&_6b1[0]){_6b3=this.selectedChildWidget=_6b1[0];_6b3.selected=true;}dojo.publish(this.id+"-startup",[{children:_6b1,selected:_6b3}]);this.inherited(arguments);},resize:function(){var _6b4=this.selectedChildWidget;if(_6b4&&!this._hasBeenShown){this._hasBeenShown=true;this._showChild(_6b4);}this.inherited(arguments);},_setupChild:function(_6b5){this.inherited(arguments);dojo.replaceClass(_6b5.domNode,"dijitHidden","dijitVisible");_6b5.domNode.title="";},addChild:function(_6b6,_6b7){this.inherited(arguments);if(this._started){dojo.publish(this.id+"-addChild",[_6b6,_6b7]);this.layout();if(!this.selectedChildWidget){this.selectChild(_6b6);}}},removeChild:function(page){this.inherited(arguments);if(this._started){dojo.publish(this.id+"-removeChild",[page]);}if(this._beingDestroyed){return;}if(this.selectedChildWidget===page){this.selectedChildWidget=undefined;if(this._started){var _6b8=this.getChildren();if(_6b8.length){this.selectChild(_6b8[0]);}}}if(this._started){this.layout();}},selectChild:function(page,_6b9){page=dijit.byId(page);if(this.selectedChildWidget!=page){var d=this._transition(page,this.selectedChildWidget,_6b9);this._set("selectedChildWidget",page);dojo.publish(this.id+"-selectChild",[page]);if(this.persist){dojo.cookie(this.id+"_selectedChild",this.selectedChildWidget.id);}}return d;},_transition:function(_6ba,_6bb,_6bc){if(_6bb){this._hideChild(_6bb);}var d=this._showChild(_6ba);if(_6ba.resize){if(this.doLayout){_6ba.resize(this._containerContentBox||this._contentBox);}else{_6ba.resize();}}return d;},_adjacent:function(_6bd){var _6be=this.getChildren();var _6bf=dojo.indexOf(_6be,this.selectedChildWidget);_6bf+=_6bd?1:_6be.length-1;return _6be[_6bf%_6be.length];},forward:function(){return this.selectChild(this._adjacent(true),true);},back:function(){return this.selectChild(this._adjacent(false),true);},_onKeyPress:function(e){dojo.publish(this.id+"-containerKeyPress",[{e:e,page:this}]);},layout:function(){if(this.doLayout&&this.selectedChildWidget&&this.selectedChildWidget.resize){this.selectedChildWidget.resize(this._containerContentBox||this._contentBox);}},_showChild:function(page){var _6c0=this.getChildren();page.isFirstChild=(page==_6c0[0]);page.isLastChild=(page==_6c0[_6c0.length-1]);page._set("selected",true);dojo.replaceClass(page.domNode,"dijitVisible","dijitHidden");return page._onShow()||true;},_hideChild:function(page){page._set("selected",false);dojo.replaceClass(page.domNode,"dijitHidden","dijitVisible");page.onHide();},closeChild:function(page){var _6c1=page.onClose(this,page);if(_6c1){this.removeChild(page);page.destroyRecursive();}},destroyDescendants:function(_6c2){dojo.forEach(this.getChildren(),function(_6c3){this.removeChild(_6c3);_6c3.destroyRecursive(_6c2);},this);}});dojo.extend(dijit._Widget,{selected:false,closable:false,iconClass:"",showTitle:true});}if(!dojo._hasResource["dijit.layout._TabContainerBase"]){dojo._hasResource["dijit.layout._TabContainerBase"]=true;dojo.provide("dijit.layout._TabContainerBase");dojo.declare("dijit.layout._TabContainerBase",[dijit.layout.StackContainer,dijit._Templated],{tabPosition:"top",baseClass:"dijitTabContainer",tabStrip:false,nested:false,templateString:dojo.cache("dijit.layout","templates/TabContainer.html","<div class=\"dijitTabContainer\">\n\t<div class=\"dijitTabListWrapper\" dojoAttachPoint=\"tablistNode\"></div>\n\t<div dojoAttachPoint=\"tablistSpacer\" class=\"dijitTabSpacer ${baseClass}-spacer\"></div>\n\t<div class=\"dijitTabPaneWrapper ${baseClass}-container\" dojoAttachPoint=\"containerNode\"></div>\n</div>\n"),postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&dojo.style(this.srcNodeRef,"visibility","hidden");this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);if(!this.doLayout){dojo.addClass(this.domNode,"dijitTabContainerNoLayout");}if(this.nested){dojo.addClass(this.domNode,"dijitTabContainerNested");dojo.addClass(this.tablist.containerNode,"dijitTabContainerTabListNested");dojo.addClass(this.tablistSpacer,"dijitTabContainerSpacerNested");dojo.addClass(this.containerNode,"dijitTabPaneWrapperNested");}else{dojo.addClass(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"));}},_setupChild:function(tab){dojo.addClass(tab.domNode,"dijitTabPane");this.inherited(arguments);},startup:function(){if(this._started){return;}this.tablist.startup();this.inherited(arguments);},layout:function(){if(!this._contentBox||typeof (this._contentBox.l)=="undefined"){return;}var sc=this.selectedChildWidget;if(this.doLayout){var _6c4=this.tabPosition.replace(/-h/,"");this.tablist.layoutAlign=_6c4;var _6c5=[this.tablist,{domNode:this.tablistSpacer,layoutAlign:_6c4},{domNode:this.containerNode,layoutAlign:"client"}];dijit.layout.layoutChildren(this.domNode,this._contentBox,_6c5);this._containerContentBox=dijit.layout.marginBox2contentBox(this.containerNode,_6c5[2]);if(sc&&sc.resize){sc.resize(this._containerContentBox);}}else{if(this.tablist.resize){var s=this.tablist.domNode.style;s.width="0";var _6c6=dojo.contentBox(this.domNode).w;s.width="";this.tablist.resize({w:_6c6});}if(sc&&sc.resize){sc.resize();}}},destroy:function(){if(this.tablist){this.tablist.destroy();}this.inherited(arguments);}});}if(!dojo._hasResource["dijit._KeyNavContainer"]){dojo._hasResource["dijit._KeyNavContainer"]=true;dojo.provide("dijit._KeyNavContainer");dojo.declare("dijit._KeyNavContainer",dijit._Container,{tabIndex:"0",_keyNavCodes:{},connectKeyNavHandlers:function(_6c7,_6c8){var _6c9=(this._keyNavCodes={});var prev=dojo.hitch(this,this.focusPrev);var next=dojo.hitch(this,this.focusNext);dojo.forEach(_6c7,function(code){_6c9[code]=prev;});dojo.forEach(_6c8,function(code){_6c9[code]=next;});_6c9[dojo.keys.HOME]=dojo.hitch(this,"focusFirstChild");_6c9[dojo.keys.END]=dojo.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){dojo.forEach(this.getChildren(),dojo.hitch(this,"_startupChild"));},addChild:function(_6ca,_6cb){dijit._KeyNavContainer.superclass.addChild.apply(this,arguments);this._startupChild(_6ca);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){var _6cc=this._getFirstFocusableChild();if(_6cc){this.focusChild(_6cc);}},focusLastChild:function(){var _6cd=this._getLastFocusableChild();if(_6cd){this.focusChild(_6cd);}},focusNext:function(){var _6ce=this._getNextFocusableChild(this.focusedChild,1);this.focusChild(_6ce);},focusPrev:function(){var _6cf=this._getNextFocusableChild(this.focusedChild,-1);this.focusChild(_6cf,true);},focusChild:function(_6d0,last){if(this.focusedChild&&_6d0!==this.focusedChild){this._onChildBlur(this.focusedChild);}_6d0.set("tabIndex",this.tabIndex);_6d0.focus(last?"end":"start");this._set("focusedChild",_6d0);},_startupChild:function(_6d1){_6d1.set("tabIndex","-1");this.connect(_6d1,"_onFocus",function(){_6d1.set("tabIndex",this.tabIndex);});this.connect(_6d1,"_onBlur",function(){_6d1.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode){return;}this.focusFirstChild();dojo.attr(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){dojo.attr(this.domNode,"tabIndex",this.tabIndex);}this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();dojo.stopEvent(evt);}},_onChildBlur:function(_6d2){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_6d3,dir){if(_6d3){_6d3=this._getSiblingOfChild(_6d3,dir);}var _6d4=this.getChildren();for(var i=0;i<_6d4.length;i++){if(!_6d3){_6d3=_6d4[(dir>0)?0:(_6d4.length-1)];}if(_6d3.isFocusable()){return _6d3;}_6d3=this._getSiblingOfChild(_6d3,dir);}return null;}});}if(!dojo._hasResource["dijit.MenuItem"]){dojo._hasResource["dijit.MenuItem"]=true;dojo.provide("dijit.MenuItem");dojo.declare("dijit.MenuItem",[dijit._Widget,dijit._Templated,dijit._Contained,dijit._CssStateMixin],{templateString:dojo.cache("dijit","templates/MenuItem.html","<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\"\n\t\tdojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" dojoAttachPoint=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" dojoAttachPoint=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" dojoAttachPoint=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"),attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{label:{node:"containerNode",type:"innerHTML"},iconClass:{node:"iconNode",type:"class"}}),baseClass:"dijitMenuItem",label:"",iconClass:"",accelKey:"",disabled:false,_fillContent:function(_6d5){if(_6d5&&!("label" in this.params)){this.set("label",_6d5.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _6d6=this.id+"_text";dojo.attr(this.containerNode,"id",_6d6);if(this.accelKeyNode){dojo.attr(this.accelKeyNode,"id",this.id+"_accel");_6d6+=" "+this.id+"_accel";}dijit.setWaiState(this.domNode,"labelledby",_6d6);dojo.setSelectable(this.domNode,false);},_onHover:function(){this.getParent().onItemHover(this);},_onUnhover:function(){this.getParent().onItemUnhover(this);this._set("hovering",false);},_onClick:function(evt){this.getParent().onItemClick(this,evt);dojo.stopEvent(evt);},onClick:function(evt){},focus:function(){try{if(dojo.isIE==8){this.containerNode.focus();}dijit.focus(this.focusNode);}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_6d7){dojo.toggleClass(this.domNode,"dijitMenuItemSelected",_6d7);},setLabel:function(_6d8){dojo.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_6d8);},setDisabled:function(_6d9){dojo.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_6d9);},_setDisabledAttr:function(_6da){dijit.setWaiState(this.focusNode,"disabled",_6da?"true":"false");this._set("disabled",_6da);},_setAccelKeyAttr:function(_6db){this.accelKeyNode.style.display=_6db?"":"none";this.accelKeyNode.innerHTML=_6db;dojo.attr(this.containerNode,"colSpan",_6db?"1":"2");this._set("accelKey",_6db);}});}if(!dojo._hasResource["dijit.PopupMenuItem"]){dojo._hasResource["dijit.PopupMenuItem"]=true;dojo.provide("dijit.PopupMenuItem");dojo.declare("dijit.PopupMenuItem",dijit.MenuItem,{_fillContent:function(){if(this.srcNodeRef){var _6dc=dojo.query("*",this.srcNodeRef);dijit.PopupMenuItem.superclass._fillContent.call(this,_6dc[0]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}this.inherited(arguments);if(!this.popup){var node=dojo.query("[widgetId]",this.dropDownContainer)[0];this.popup=dijit.byNode(node);}dojo.body().appendChild(this.popup.domNode);this.popup.startup();this.popup.domNode.style.display="none";if(this.arrowWrapper){dojo.style(this.arrowWrapper,"visibility","");}dijit.setWaiState(this.focusNode,"haspopup","true");},destroyDescendants:function(){if(this.popup){if(!this.popup._destroyed){this.popup.destroyRecursive();}delete this.popup;}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.CheckedMenuItem"]){dojo._hasResource["dijit.CheckedMenuItem"]=true;dojo.provide("dijit.CheckedMenuItem");dojo.declare("dijit.CheckedMenuItem",dijit.MenuItem,{templateString:dojo.cache("dijit","templates/CheckedMenuItem.html","<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\"\n\t\tdojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" dojoAttachPoint=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" dojoAttachPoint=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" dojoAttachPoint=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&nbsp;</td>\n</tr>\n"),checked:false,_setCheckedAttr:function(_6dd){dojo.toggleClass(this.domNode,"dijitCheckedMenuItemChecked",_6dd);dijit.setWaiState(this.domNode,"checked",_6dd);this._set("checked",_6dd);},onChange:function(_6de){},_onClick:function(e){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.MenuSeparator"]){dojo._hasResource["dijit.MenuSeparator"]=true;dojo.provide("dijit.MenuSeparator");dojo.declare("dijit.MenuSeparator",[dijit._Widget,dijit._Templated,dijit._Contained],{templateString:dojo.cache("dijit","templates/MenuSeparator.html","<tr class=\"dijitMenuSeparator\">\n\t<td class=\"dijitMenuSeparatorIconCell\">\n\t\t<div class=\"dijitMenuSeparatorTop\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n\t<td colspan=\"3\" class=\"dijitMenuSeparatorLabelCell\">\n\t\t<div class=\"dijitMenuSeparatorTop dijitMenuSeparatorLabel\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n</tr>\n"),buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});}if(!dojo._hasResource["dijit.Menu"]){dojo._hasResource["dijit.Menu"]=true;dojo.provide("dijit.Menu");dojo.declare("dijit._MenuBase",[dijit._Widget,dijit._Templated,dijit._KeyNavContainer],{parentMenu:null,popupDelay:500,startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(_6df){_6df.startup();});this.startupKeyNavChildren();this.inherited(arguments);},onExecute:function(){},onCancel:function(_6e0){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.focusedChild._onClick(evt);}else{var _6e1=this._getTopMenu();if(_6e1&&_6e1._isMenuBar){_6e1.focusNext();}}},_onPopupHover:function(evt){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _6e2=this.currentPopup.parentMenu;if(_6e2.focusedChild){_6e2.focusedChild._setSelected(false);}_6e2.focusedChild=this.currentPopup.from_item;_6e2.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=setTimeout(dojo.hitch(this,"_openPopup"),this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _6e3=item.popup;if(_6e3){this._stopPendingCloseTimer(_6e3);_6e3._pendingClose_timer=setTimeout(function(){_6e3._pendingClose_timer=null;if(_6e3.parentMenu){_6e3.parentMenu.currentPopup=null;}dijit.popup.close(_6e3);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}},_stopPopupTimer:function(){if(this.hover_timer){clearTimeout(this.hover_timer);this.hover_timer=null;}},_stopPendingCloseTimer:function(_6e4){if(_6e4._pendingClose_timer){clearTimeout(_6e4._pendingClose_timer);_6e4._pendingClose_timer=null;}},_stopFocusTimer:function(){if(this._focus_timer){clearTimeout(this._focus_timer);this._focus_timer=null;}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup();}else{this.onExecute();item.onClick(evt);}},_openPopup:function(){this._stopPopupTimer();var _6e5=this.focusedChild;if(!_6e5){return;}var _6e6=_6e5.popup;if(_6e6.isShowingNow){return;}if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);dijit.popup.close(this.currentPopup);}_6e6.parentMenu=this;_6e6.from_item=_6e5;var self=this;dijit.popup.open({parent:this,popup:_6e6,around:_6e5.domNode,orient:this._orient||(this.isLeftToRight()?{"TR":"TL","TL":"TR","BR":"BL","BL":"BR"}:{"TL":"TR","TR":"TL","BL":"BR","BR":"BL"}),onCancel:function(){self.focusChild(_6e5);self._cleanUp();_6e5._setSelected(true);self.focusedChild=_6e5;},onExecute:dojo.hitch(this,"_cleanUp")});this.currentPopup=_6e6;_6e6.connect(_6e6.domNode,"onmouseenter",dojo.hitch(self,"_onPopupHover"));if(_6e6.focus){_6e6._focus_timer=setTimeout(dojo.hitch(_6e6,function(){this._focus_timer=null;this.focus();}),0);}},_markActive:function(){this.isActive=true;dojo.replaceClass(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(e){console.log("dijit.Menu.onOpen");this.isShowingNow=true;this._markActive();},_markInactive:function(){console.log("dijit.Menu._markInactive");this.isActive=false;dojo.replaceClass(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();var _6e7=this.focusedChild&&this.focusedChild.from_item;if(this.currentPopup){if(dijit._curFocus&&dojo.isDescendant(dijit._curFocus,this.currentPopup.domNode)){this.focusedChild.focusNode.focus();}dijit.popup.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.focusedChild._onUnhover();this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this._hoveredChild._onUnhover();}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});dojo.declare("dijit.Menu",dijit._MenuBase,{constructor:function(){this._bindings=[];},templateString:dojo.cache("dijit","templates/Menu.html","<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\" dojoAttachEvent=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" dojoAttachPoint=\"containerNode\"></tbody>\n</table>\n"),baseClass:"dijitMenu",targetNodeIds:[],contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(dojo.body());}else{dojo.forEach(this.targetNodeIds,this.bindDomNode,this);}var k=dojo.keys,l=this.isLeftToRight();this._openSubMenuKey=l?k.RIGHT_ARROW:k.LEFT_ARROW;this._closeSubMenuKey=l?k.LEFT_ARROW:k.RIGHT_ARROW;this.connectKeyNavHandlers([k.UP_ARROW],[k.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);dojo.stopEvent(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{dojo.stopEvent(evt);}break;}},_iframeContentWindow:function(_6e8){var win=dojo.window.get(this._iframeContentDocument(_6e8))||this._iframeContentDocument(_6e8)["__parent__"]||(_6e8.name&&dojo.doc.frames[_6e8.name])||null;return win;},_iframeContentDocument:function(_6e9){var doc=_6e9.contentDocument||(_6e9.contentWindow&&_6e9.contentWindow.document)||(_6e9.name&&dojo.doc.frames[_6e9.name]&&dojo.doc.frames[_6e9.name].document)||null;return doc;},bindDomNode:function(node){node=dojo.byId(node);var cn;if(node.tagName.toLowerCase()=="iframe"){var _6ea=node,win=this._iframeContentWindow(_6ea);cn=dojo.withGlobal(win,dojo.body);}else{cn=(node==dojo.body()?dojo.doc.documentElement:node);}var _6eb={node:node,iframe:_6ea};dojo.attr(node,"_dijitMenu"+this.id,this._bindings.push(_6eb));var _6ec=dojo.hitch(this,function(cn){return [dojo.connect(cn,this.leftClickToOpen?"onclick":"oncontextmenu",this,function(evt){dojo.stopEvent(evt);this._scheduleOpen(evt.target,_6ea,{x:evt.pageX,y:evt.pageY});}),dojo.connect(cn,"onkeydown",this,function(evt){if(evt.shiftKey&&evt.keyCode==dojo.keys.F10){dojo.stopEvent(evt);this._scheduleOpen(evt.target,_6ea);}})];});_6eb.connects=cn?_6ec(cn):[];if(_6ea){_6eb.onloadHandler=dojo.hitch(this,function(){var win=this._iframeContentWindow(_6ea);cn=dojo.withGlobal(win,dojo.body);_6eb.connects=_6ec(cn);});if(_6ea.addEventListener){_6ea.addEventListener("load",_6eb.onloadHandler,false);}else{_6ea.attachEvent("onload",_6eb.onloadHandler);}}},unBindDomNode:function(_6ed){var node;try{node=dojo.byId(_6ed);}catch(e){return;}var _6ee="_dijitMenu"+this.id;if(node&&dojo.hasAttr(node,_6ee)){var bid=dojo.attr(node,_6ee)-1,b=this._bindings[bid];dojo.forEach(b.connects,dojo.disconnect);var _6ef=b.iframe;if(_6ef){if(_6ef.removeEventListener){_6ef.removeEventListener("load",b.onloadHandler,false);}else{_6ef.detachEvent("onload",b.onloadHandler);}}dojo.removeAttr(node,_6ee);delete this._bindings[bid];}},_scheduleOpen:function(_6f0,_6f1,_6f2){if(!this._openTimer){this._openTimer=setTimeout(dojo.hitch(this,function(){delete this._openTimer;this._openMyself({target:_6f0,iframe:_6f1,coords:_6f2});}),1);}},_openMyself:function(args){var _6f3=args.target,_6f4=args.iframe,_6f5=args.coords;if(_6f5){if(_6f4){var od=_6f3.ownerDocument,ifc=dojo.position(_6f4,true),win=this._iframeContentWindow(_6f4),_6f6=dojo.withGlobal(win,"_docScroll",dojo);var cs=dojo.getComputedStyle(_6f4),tp=dojo._toPixelValue,left=(dojo.isIE&&dojo.isQuirks?0:tp(_6f4,cs.paddingLeft))+(dojo.isIE&&dojo.isQuirks?tp(_6f4,cs.borderLeftWidth):0),top=(dojo.isIE&&dojo.isQuirks?0:tp(_6f4,cs.paddingTop))+(dojo.isIE&&dojo.isQuirks?tp(_6f4,cs.borderTopWidth):0);_6f5.x+=ifc.x+left-_6f6.x;_6f5.y+=ifc.y+top-_6f6.y;}}else{_6f5=dojo.position(_6f3,true);_6f5.x+=10;_6f5.y+=10;}var self=this;var _6f7=dijit.getFocus(this);function _6f8(){if(self.refocus){dijit.focus(_6f7);}dijit.popup.close(self);};dijit.popup.open({popup:this,x:_6f5.x,y:_6f5.y,onExecute:_6f8,onCancel:_6f8,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);dijit.popup.close(this);};},uninitialize:function(){dojo.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout.TabController"]){dojo._hasResource["dijit.layout.TabController"]=true;dojo.provide("dijit.layout.TabController");dojo.declare("dijit.layout.TabController",dijit.layout.StackController,{templateString:"<div role='tablist' dojoAttachEvent='onkeypress:onkeypress'></div>",tabPosition:"top",buttonWidget:"dijit.layout._TabButton",_rectifyRtlTabList:function(){if(0>=this.tabPosition.indexOf("-h")){return;}if(!this.pane2button){return;}var _6f9=0;for(var pane in this.pane2button){var ow=this.pane2button[pane].innerDiv.scrollWidth;_6f9=Math.max(_6f9,ow);}for(pane in this.pane2button){this.pane2button[pane].innerDiv.style.width=_6f9+"px";}}});dojo.declare("dijit.layout._TabButton",dijit.layout._StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},templateString:dojo.cache("dijit.layout","templates/_TabButton.html","<div role=\"presentation\" dojoAttachPoint=\"titleNode\" dojoAttachEvent='onclick:onClick'>\n    <div role=\"presentation\" class='dijitTabInnerDiv' dojoAttachPoint='innerDiv'>\n        <div role=\"presentation\" class='dijitTabContent' dojoAttachPoint='tabContent'>\n        \t<div role=\"presentation\" dojoAttachPoint='focusNode'>\n\t\t        <img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitTabButtonIcon\" dojoAttachPoint='iconNode' />\n\t\t        <span dojoAttachPoint='containerNode' class='tabLabel'></span>\n\t\t        <span class=\"dijitInline dijitTabCloseButton dijitTabCloseIcon\" dojoAttachPoint='closeNode'\n\t\t        \t\tdojoAttachEvent='onclick: onClickCloseButton' role=\"presentation\">\n\t\t            <span dojoAttachPoint='closeText' class='dijitTabCloseText'>[x]</span\n\t\t        ></span>\n\t\t\t</div>\n        </div>\n    </div>\n</div>\n"),scrollOnFocus:false,buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.containerNode,false);},startup:function(){this.inherited(arguments);var n=this.domNode;setTimeout(function(){n.className=n.className;},1);},_setCloseButtonAttr:function(disp){this._set("closeButton",disp);dojo.toggleClass(this.innerDiv,"dijitClosable",disp);this.closeNode.style.display=disp?"":"none";if(disp){var _6fa=dojo.i18n.getLocalization("dijit","common");if(this.closeNode){dojo.attr(this.closeNode,"title",_6fa.itemClose);}var _6fa=dojo.i18n.getLocalization("dijit","common");this._closeMenu=new dijit.Menu({id:this.id+"_Menu",dir:this.dir,lang:this.lang,targetNodeIds:[this.domNode]});this._closeMenu.addChild(new dijit.MenuItem({label:_6fa.itemClose,dir:this.dir,lang:this.lang,onClick:dojo.hitch(this,"onClickCloseButton")}));}else{if(this._closeMenu){this._closeMenu.destroyRecursive();delete this._closeMenu;}}},_setLabelAttr:function(_6fb){this.inherited(arguments);if(this.showLabel==false&&!this.params.title){this.iconNode.alt=dojo.trim(this.containerNode.innerText||this.containerNode.textContent||"");}},destroy:function(){if(this._closeMenu){this._closeMenu.destroyRecursive();delete this._closeMenu;}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout.ScrollingTabController"]){dojo._hasResource["dijit.layout.ScrollingTabController"]=true;dojo.provide("dijit.layout.ScrollingTabController");dojo.declare("dijit.layout.ScrollingTabController",dijit.layout.TabController,{templateString:dojo.cache("dijit.layout","templates/ScrollingTabController.html","<div class=\"dijitTabListContainer-${tabPosition}\" style=\"visibility:hidden\">\n\t<div dojoType=\"dijit.layout._ScrollingTabControllerMenuButton\"\n\t\t\tclass=\"tabStripButton-${tabPosition}\"\n\t\t\tid=\"${id}_menuBtn\" containerId=\"${containerId}\" iconClass=\"dijitTabStripMenuIcon\"\n\t\t\tdropDownPosition=\"below-alt, above-alt\"\n\t\t\tdojoAttachPoint=\"_menuBtn\" showLabel=\"false\">&#9660;</div>\n\t<div dojoType=\"dijit.layout._ScrollingTabControllerButton\"\n\t\t\tclass=\"tabStripButton-${tabPosition}\"\n\t\t\tid=\"${id}_leftBtn\" iconClass=\"dijitTabStripSlideLeftIcon\"\n\t\t\tdojoAttachPoint=\"_leftBtn\" dojoAttachEvent=\"onClick: doSlideLeft\" showLabel=\"false\">&#9664;</div>\n\t<div dojoType=\"dijit.layout._ScrollingTabControllerButton\"\n\t\t\tclass=\"tabStripButton-${tabPosition}\"\n\t\t\tid=\"${id}_rightBtn\" iconClass=\"dijitTabStripSlideRightIcon\"\n\t\t\tdojoAttachPoint=\"_rightBtn\" dojoAttachEvent=\"onClick: doSlideRight\" showLabel=\"false\">&#9654;</div>\n\t<div class='dijitTabListWrapper' dojoAttachPoint='tablistWrapper'>\n\t\t<div role='tablist' dojoAttachEvent='onkeypress:onkeypress'\n\t\t\t\tdojoAttachPoint='containerNode' class='nowrapTabStrip'></div>\n\t</div>\n</div>\n"),useMenu:true,useSlider:true,tabStripClass:"",widgetsInTemplate:true,_minScroll:5,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{"class":"containerNode"}),buildRendering:function(){this.inherited(arguments);var n=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();if(!this.tabStripClass){this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"")+"None";dojo.addClass(n,"tabStrip-disabled");}dojo.addClass(this.tablistWrapper,this.tabStripClass);},onStartup:function(){this.inherited(arguments);dojo.style(this.domNode,"visibility","visible");this._postStartup=true;},onAddChild:function(page,_6fc){this.inherited(arguments);dojo.forEach(["label","iconClass"],function(attr){this.pane2watches[page.id].push(this.pane2button[page.id].watch(attr,dojo.hitch(this,function(name,_6fd,_6fe){if(this._postStartup&&this._dim){this.resize(this._dim);}})));},this);dojo.style(this.containerNode,"width",(dojo.style(this.containerNode,"width")+200)+"px");},onRemoveChild:function(page,_6ff){var _700=this.pane2button[page.id];if(this._selectedTab===_700.domNode){this._selectedTab=null;}this.inherited(arguments);},_initButtons:function(){this._btnWidth=0;this._buttons=dojo.query("> .tabStripButton",this.domNode).filter(function(btn){if((this.useMenu&&btn==this._menuBtn.domNode)||(this.useSlider&&(btn==this._rightBtn.domNode||btn==this._leftBtn.domNode))){this._btnWidth+=dojo._getMarginSize(btn).w;return true;}else{dojo.style(btn,"display","none");return false;}},this);},_getTabsWidth:function(){var _701=this.getChildren();if(_701.length){var _702=_701[this.isLeftToRight()?0:_701.length-1].domNode,_703=_701[this.isLeftToRight()?_701.length-1:0].domNode;return _703.offsetLeft+dojo.style(_703,"width")-_702.offsetLeft;}else{return 0;}},_enableBtn:function(_704){var _705=this._getTabsWidth();_704=_704||dojo.style(this.scrollNode,"width");return _705>0&&_704<_705;},resize:function(dim){if(this.domNode.offsetWidth==0){return;}this._dim=dim;this.scrollNode.style.height="auto";this._contentBox=dijit.layout.marginBox2contentBox(this.domNode,{h:0,w:dim.w});this._contentBox.h=this.scrollNode.offsetHeight;dojo.contentBox(this.domNode,this._contentBox);var _706=this._enableBtn(this._contentBox.w);this._buttons.style("display",_706?"":"none");this._leftBtn.layoutAlign="left";this._rightBtn.layoutAlign="right";this._menuBtn.layoutAlign=this.isLeftToRight()?"right":"left";dijit.layout.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,layoutAlign:"client"}]);if(this._selectedTab){if(this._anim&&this._anim.status()=="playing"){this._anim.stop();}var w=this.scrollNode,sl=this._convertToScrollLeft(this._getScrollForSelectedTab());w.scrollLeft=sl;}this._setButtonClass(this._getScroll());this._postResize=true;return {h:this._contentBox.h,w:dim.w};},_getScroll:function(){var sl=(this.isLeftToRight()||dojo.isIE<8||(dojo.isIE&&dojo.isQuirks)||dojo.isWebKit)?this.scrollNode.scrollLeft:dojo.style(this.containerNode,"width")-dojo.style(this.scrollNode,"width")+(dojo.isIE==8?-1:1)*this.scrollNode.scrollLeft;return sl;},_convertToScrollLeft:function(val){if(this.isLeftToRight()||dojo.isIE<8||(dojo.isIE&&dojo.isQuirks)||dojo.isWebKit){return val;}else{var _707=dojo.style(this.containerNode,"width")-dojo.style(this.scrollNode,"width");return (dojo.isIE==8?-1:1)*(val-_707);}},onSelectChild:function(page){var tab=this.pane2button[page.id];if(!tab||!page){return;}var node=tab.domNode;if(this._postResize&&node!=this._selectedTab){this._selectedTab=node;var sl=this._getScroll();if(sl>node.offsetLeft||sl+dojo.style(this.scrollNode,"width")<node.offsetLeft+dojo.style(node,"width")){this.createSmoothScroll().play();}}this.inherited(arguments);},_getScrollBounds:function(){var _708=this.getChildren(),_709=dojo.style(this.scrollNode,"width"),_70a=dojo.style(this.containerNode,"width"),_70b=_70a-_709,_70c=this._getTabsWidth();if(_708.length&&_70c>_709){return {min:this.isLeftToRight()?0:_708[_708.length-1].domNode.offsetLeft,max:this.isLeftToRight()?(_708[_708.length-1].domNode.offsetLeft+dojo.style(_708[_708.length-1].domNode,"width"))-_709:_70b};}else{var _70d=this.isLeftToRight()?0:_70b;return {min:_70d,max:_70d};}},_getScrollForSelectedTab:function(){var w=this.scrollNode,n=this._selectedTab,_70e=dojo.style(this.scrollNode,"width"),_70f=this._getScrollBounds();var pos=(n.offsetLeft+dojo.style(n,"width")/2)-_70e/2;pos=Math.min(Math.max(pos,_70f.min),_70f.max);return pos;},createSmoothScroll:function(x){if(arguments.length>0){var _710=this._getScrollBounds();x=Math.min(Math.max(x,_710.min),_710.max);}else{x=this._getScrollForSelectedTab();}if(this._anim&&this._anim.status()=="playing"){this._anim.stop();}var self=this,w=this.scrollNode,anim=new dojo._Animation({beforeBegin:function(){if(this.curve){delete this.curve;}var oldS=w.scrollLeft,newS=self._convertToScrollLeft(x);anim.curve=new dojo._Line(oldS,newS);},onAnimate:function(val){w.scrollLeft=val;}});this._anim=anim;this._setButtonClass(x);return anim;},_getBtnNode:function(e){var n=e.target;while(n&&!dojo.hasClass(n,"tabStripButton")){n=n.parentNode;}return n;},doSlideRight:function(e){this.doSlide(1,this._getBtnNode(e));},doSlideLeft:function(e){this.doSlide(-1,this._getBtnNode(e));},doSlide:function(_711,node){if(node&&dojo.hasClass(node,"dijitTabDisabled")){return;}var _712=dojo.style(this.scrollNode,"width");var d=(_712*0.75)*_711;var to=this._getScroll()+d;this._setButtonClass(to);this.createSmoothScroll(to).play();},_setButtonClass:function(_713){var _714=this._getScrollBounds();this._leftBtn.set("disabled",_713<=_714.min);this._rightBtn.set("disabled",_713>=_714.max);}});dojo.declare("dijit.layout._ScrollingTabControllerButtonMixin",null,{baseClass:"dijitTab tabStripButton",templateString:dojo.cache("dijit.layout","templates/_ScrollingTabControllerButton.html","<div dojoAttachEvent=\"onclick:_onButtonClick\">\n\t<div role=\"presentation\" class=\"dijitTabInnerDiv\" dojoattachpoint=\"innerDiv,focusNode\">\n\t\t<div role=\"presentation\" class=\"dijitTabContent dijitButtonContents\" dojoattachpoint=\"tabContent\">\n\t\t\t<img role=\"presentation\" alt=\"\" src=\"${_blankGif}\" class=\"dijitTabStripIcon\" dojoAttachPoint=\"iconNode\"/>\n\t\t\t<span dojoAttachPoint=\"containerNode,titleNode\" class=\"dijitButtonText\"></span>\n\t\t</div>\n\t</div>\n</div>\n"),tabIndex:"",isFocusable:function(){return false;}});dojo.declare("dijit.layout._ScrollingTabControllerButton",[dijit.form.Button,dijit.layout._ScrollingTabControllerButtonMixin]);dojo.declare("dijit.layout._ScrollingTabControllerMenuButton",[dijit.form.Button,dijit._HasDropDown,dijit.layout._ScrollingTabControllerButtonMixin],{containerId:"",tabIndex:"-1",isLoaded:function(){return false;},loadDropDown:function(_715){this.dropDown=new dijit.Menu({id:this.containerId+"_menu",dir:this.dir,lang:this.lang});var _716=dijit.byId(this.containerId);dojo.forEach(_716.getChildren(),function(page){var _717=new dijit.MenuItem({id:page.id+"_stcMi",label:page.title,iconClass:page.iconClass,dir:page.dir,lang:page.lang,onClick:function(){_716.selectChild(page);}});this.dropDown.addChild(_717);},this);_715();},closeDropDown:function(_718){this.inherited(arguments);if(this.dropDown){this.dropDown.destroyRecursive();delete this.dropDown;}}});}if(!dojo._hasResource["dijit.layout.TabContainer"]){dojo._hasResource["dijit.layout.TabContainer"]=true;dojo.provide("dijit.layout.TabContainer");dojo.declare("dijit.layout.TabContainer",dijit.layout._TabContainerBase,{useMenu:true,useSlider:true,controllerWidget:"",_makeController:function(_719){var cls=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout"),_71a=dojo.getObject(this.controllerWidget);return new _71a({id:this.id+"_tablist",dir:this.dir,lang:this.lang,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,"class":cls,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?"":"No")+"Strip":null},_719);},postMixInProperties:function(){this.inherited(arguments);if(!this.controllerWidget){this.controllerWidget=(this.tabPosition=="top"||this.tabPosition=="bottom")&&!this.nested?"dijit.layout.ScrollingTabController":"dijit.layout.TabController";}}});}if(!dojo._hasResource["plugins.admin.ConfirmDialogue"]){dojo._hasResource["plugins.admin.ConfirmDialogue"]=true;dojo.provide("plugins.admin.ConfirmDialogue");dojo.declare("plugins.admin.ConfirmDialogue",[dijit._Widget,dijit._Templated],{templateString:"<div dojoType=\"dojox.widget.Dialog\"\n     title=\"${title}\"\n     class=\"adminConfirmDialogue\" >\n\n<table class=\"adminConfirmDialogueTable\">\n    <tr>\n        <td colspan=\"2\">${message}</td>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <button dojoType=\"dijit.form.Button\" iconClass=\"plusIcon\" type=submit\">\n                ${option1}\n            </button>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <button dojoType=\"dijit.form.Button\" iconClass=\"plusIcon\" type=submit\">\n                ${option2}\n            </button>\n        </td>\n    </tr>\n</table>\n",widgetsInTemplate:true,parentWidget:null,title:"Please confirm",message:"Do you really want to delete this application?",option1:"Cancel",option2:"Delete it",widgets:[],constructor:function(args){this.title=args.title;this.message=args.message;this.option1=args.option1;this.option2=args.option2;this.parentWidget=args.parentWidget;},postCreate:function(args){}});}if(!dojo._hasResource["dijit.layout.BorderContainer"]){dojo._hasResource["dijit.layout.BorderContainer"]=true;dojo.provide("dijit.layout.BorderContainer");dojo.declare("dijit.layout.BorderContainer",dijit.layout._LayoutWidget,{design:"headline",gutters:true,liveSplitters:true,persist:false,baseClass:"dijitBorderContainer",_splitterClass:"dijit.layout._Splitter",postMixInProperties:function(){if(!this.gutters){this.baseClass+="NoGutter";}this.inherited(arguments);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),this._setupChild,this);this.inherited(arguments);},_setupChild:function(_71b){var _71c=_71b.region;if(_71c){this.inherited(arguments);dojo.addClass(_71b.domNode,this.baseClass+"Pane");var ltr=this.isLeftToRight();if(_71c=="leading"){_71c=ltr?"left":"right";}if(_71c=="trailing"){_71c=ltr?"right":"left";}if(_71c!="center"&&(_71b.splitter||this.gutters)&&!_71b._splitterWidget){var _71d=dojo.getObject(_71b.splitter?this._splitterClass:"dijit.layout._Gutter");var _71e=new _71d({id:_71b.id+"_splitter",container:this,child:_71b,region:_71c,live:this.liveSplitters});_71e.isSplitter=true;_71b._splitterWidget=_71e;dojo.place(_71e.domNode,_71b.domNode,"after");_71e.startup();}_71b.region=_71c;}},layout:function(){this._layoutChildren();},addChild:function(_71f,_720){this.inherited(arguments);if(this._started){this.layout();}},removeChild:function(_721){var _722=_721.region;var _723=_721._splitterWidget;if(_723){_723.destroy();delete _721._splitterWidget;}this.inherited(arguments);if(this._started){this._layoutChildren();}dojo.removeClass(_721.domNode,this.baseClass+"Pane");dojo.style(_721.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});dojo.style(_721.domNode,_722=="top"||_722=="bottom"?"width":"height","auto");},getChildren:function(){return dojo.filter(this.inherited(arguments),function(_724){return !_724.isSplitter;});},getSplitter:function(_725){return dojo.filter(this.getChildren(),function(_726){return _726.region==_725;})[0]._splitterWidget;},resize:function(_727,_728){if(!this.cs||!this.pe){var node=this.domNode;this.cs=dojo.getComputedStyle(node);this.pe=dojo._getPadExtents(node,this.cs);this.pe.r=dojo._toPixelValue(node,this.cs.paddingRight);this.pe.b=dojo._toPixelValue(node,this.cs.paddingBottom);dojo.style(node,"padding","0px");}this.inherited(arguments);},_layoutChildren:function(_729,_72a){if(!this._borderBox||!this._borderBox.h){return;}var _72b=dojo.map(this.getChildren(),function(_72c,idx){return {pane:_72c,weight:[_72c.region=="center"?Infinity:0,_72c.layoutPriority,(this.design=="sidebar"?1:-1)*(/top|bottom/.test(_72c.region)?1:-1),idx]};},this);_72b.sort(function(a,b){var aw=a.weight,bw=b.weight;for(var i=0;i<aw.length;i++){if(aw[i]!=bw[i]){return aw[i]-bw[i];}}return 0;});var _72d=[];dojo.forEach(_72b,function(_72e){var pane=_72e.pane;_72d.push(pane);if(pane._splitterWidget){_72d.push(pane._splitterWidget);}});var dim={l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h};dijit.layout.layoutChildren(this.domNode,dim,_72d,_729,_72a);},destroyRecursive:function(){dojo.forEach(this.getChildren(),function(_72f){var _730=_72f._splitterWidget;if(_730){_730.destroy();}delete _72f._splitterWidget;});this.inherited(arguments);}});dojo.extend(dijit._Widget,{region:"",layoutPriority:0,splitter:false,minSize:0,maxSize:Infinity});dojo.declare("dijit.layout._Splitter",[dijit._Widget,dijit._Templated],{live:true,templateString:"<div class=\"dijitSplitter\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse\" tabIndex=\"0\" role=\"separator\"><div class=\"dijitSplitterThumb\"></div></div>",postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region;},buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var _731=dojo.cookie(this._cookieName);if(_731){this.child.domNode.style[this.horizontal?"height":"width"]=_731;}}},_computeMaxSize:function(){var dim=this.horizontal?"h":"w",_732=dojo.marginBox(this.child.domNode)[dim],_733=dojo.filter(this.container.getChildren(),function(_734){return _734.region=="center";})[0],_735=dojo.marginBox(_733.domNode)[dim];return Math.min(this.child.maxSize,_732+_735);},_startDrag:function(e){if(!this.cover){this.cover=dojo.doc.createElement("div");dojo.addClass(this.cover,"dijitSplitterCover");dojo.place(this.cover,this.child.domNode,"after");}dojo.addClass(this.cover,"dijitSplitterCoverActive");if(this.fake){dojo.destroy(this.fake);}if(!(this._resize=this.live)){(this.fake=this.domNode.cloneNode(true)).removeAttribute("id");dojo.addClass(this.domNode,"dijitSplitterShadow");dojo.place(this.fake,this.domNode,"after");}dojo.addClass(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");if(this.fake){dojo.removeClass(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");}var _736=this._factor,_737=this.horizontal,axis=_737?"pageY":"pageX",_738=e[axis],_739=this.domNode.style,dim=_737?"h":"w",_73a=dojo.marginBox(this.child.domNode)[dim],max=this._computeMaxSize(),min=this.child.minSize||20,_73b=this.region,_73c=_73b=="top"||_73b=="bottom"?"top":"left",_73d=parseInt(_739[_73c],10),_73e=this._resize,_73f=dojo.hitch(this.container,"_layoutChildren",this.child.id),de=dojo.doc;this._handlers=(this._handlers||[]).concat([dojo.connect(de,"onmousemove",this._drag=function(e,_740){var _741=e[axis]-_738,_742=_736*_741+_73a,_743=Math.max(Math.min(_742,max),min);if(_73e||_740){_73f(_743);}_739[_73c]=_741+_73d+_736*(_743-_742)+"px";}),dojo.connect(de,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent),dojo.connect(de,"onmouseup",this,"_stopDrag")]);dojo.stopEvent(e);},_onMouse:function(e){var o=(e.type=="mouseover"||e.type=="mouseenter");dojo.toggleClass(this.domNode,"dijitSplitterHover",o);dojo.toggleClass(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",o);},_stopDrag:function(e){try{if(this.cover){dojo.removeClass(this.cover,"dijitSplitterCoverActive");}if(this.fake){dojo.destroy(this.fake);}dojo.removeClass(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow");this._drag(e);this._drag(e,true);}finally{this._cleanupHandlers();delete this._drag;}if(this.container.persist){dojo.cookie(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365});}},_cleanupHandlers:function(){dojo.forEach(this._handlers,dojo.disconnect);delete this._handlers;},_onKeyPress:function(e){this._resize=true;var _744=this.horizontal;var tick=1;var dk=dojo.keys;switch(e.charOrCode){case _744?dk.UP_ARROW:dk.LEFT_ARROW:tick*=-1;case _744?dk.DOWN_ARROW:dk.RIGHT_ARROW:break;default:return;}var _745=dojo._getMarginSize(this.child.domNode)[_744?"h":"w"]+this._factor*tick;this.container._layoutChildren(this.child.id,Math.max(Math.min(_745,this._computeMaxSize()),this.child.minSize));dojo.stopEvent(e);},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments);}});dojo.declare("dijit.layout._Gutter",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitGutter\" role=\"presentation\"></div>",postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);},buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"));}});}if(!dojo._hasResource["plugins.admin.Controller"]){dojo._hasResource["plugins.admin.Controller"]=true;dojo.provide("plugins.admin.Controller");var adminController;dojo.declare("plugins.admin.Controller",[dijit._Widget,dijit._Templated],{paneId:null,templateString:"<div dojoAttachPoint=\"containerNode\" class=\"admin\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"adminIcon\"\n        type=\"button\"\n        label=\"Admin\"\n        ></button>\n</div>\n        \n",widgetsInTemplate:true,tabPanes:[],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _746=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(){var _747=new plugins.admin.Admin({});console.log("admin.Controller.createTab    Doing this.tabPanes.push(widget)");this.tabPanes.push(_747);this._supportingWidgets.push(_747);},createMenu:function(){var _748=new dijit.Menu({id:"admin"+this.paneId+"dynamicMenuPopup"});_748.addChild(new dijit.MenuItem({label:"Application Menu",disabled:false}));_748.addChild(new dijit.MenuSeparator());var _749=new dijit.MenuItem({id:"admin"+this.paneId+"remove",label:"Remove",disabled:false});_748.addChild(_749);dojo.connect(_749,"onClick",function(){var _74a=_748.currentTarget.parentNode;_74a.removeChild(_748.currentTarget);});_748.addChild(new dijit.MenuSeparator());var _74b=new dijit.MenuItem({id:"admin"+this.paneId+"run",label:"Run",disabled:false});_748.addChild(_74b);dojo.connect(_74b,"onClick",function(){var _74c=_748.currentTarget;var _74d=_74c.parentNode;});return _748;},loadCSS:function(){var _74e=["plugins/admin/css/controller.css"];for(var i in _74e){var _74f=_74e[i];var _750=document.createElement("link");_750.type="text/css";_750.rel="stylesheet";_750.href=_74f;_750.media="screen";document.getElementsByTagName("head")[0].appendChild(_750);}}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.admin.Hub"]){dojo._hasResource["plugins.admin.Hub"]=true;dojo.provide("plugins.admin.Hub");dojo.declare("plugins.admin.Hub",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- settings TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"hub\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Hub\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> GitHub </td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> GitHub Account Info </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"subPane\"\n\t\t\t\t\t>\n\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"addHubButton\"\n\t\t\t\t\t\t\t\tclass=\"addHubButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addHub\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"subLabel\">GitHub User ID</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"login\"\n\t\t\t\t\t\t\t\t\tclass=\"login\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\tmissingMessage=\"Please input your GitHub Login ID\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"Please input your GitHub Login ID\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"addTokenButton\"\n\t\t\t\t\t\t\t\tclass=\"addTokenButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggleAddToken\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCreate GitHub Token\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr dojoAttachPoint=\"addToken\"\n\t\t\t\t\t\t\tclass=\"addToken\"\n\t\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<td width=\"10%\">\n\t\t\t\t\t\t\t\t<table class=\"subPane\" width=\"100%\">\n\t\t\t\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t\t\t\t<td class=\"subSubLabel\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Enter GitHub password. Password will not be stored on server\">\n\t\t\t\t\t\t\t\t\t\t\tGitHub password\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t\t<tr align=\"center\">\n\n\t\t\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"goButton\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"goButton\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addHubToken\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tGenerate Token\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"subLabel\">GitHub Token</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"token\"\n\t\t\t\t\t\t\t\t\tclass=\"token\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"40\"\n\t\t\t\t\t\t\t\t\tuppercase=\"false\"\n\t\t\t\t\t\t\t\t\tregExp=\"[a-z0-9]{40}\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"GitHub OAuth access token - 40 characters: letters or lowercase numbers\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"GitHub OAuth access token - 40 characters: letters or lowercase numbers\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"addHubCertificateButton\"\n\t\t\t\t\t\t\t\tclass=\"addHubCertificateButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addHubCertificate\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCreate Public Certificate\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td >\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"publiccert\"\n\t\t\t\t\t\t\t\t\tclass=\"publiccert\"\n\t\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t</table>\n\n\t\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END settings TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins","admin/css/hub.css"),],parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.core=args.parentWidget.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);Agua.updater.subscribe(this,"updateSyncWorkflows");Agua.updater.subscribe(this,"updateSyncApps");this.initialise();},updateSyncApps:function(args){console.warn("Hub.updateSyncApps    args:");console.dir({args:args});},updateSyncWorkflows:function(args){console.warn("Hub.updateSyncWorkflows    args:");console.dir({args:args});},initialise:function(){var hub=Agua.getHub();console.log("Hub.initialiseHub     hub: ");console.dir({hub:hub});hub.login=hub.login||"";this.login.set("value",hub.login);hub.token=hub.token||"";this.token.set("value",hub.token);hub.publiccert=hub.publiccert||"";this.publiccert.innerHTML=hub.publiccert;},addHub:function(_751){console.log("Hub.addHub    plugins.admin.Hub.addHub(event)");if(this.addingHub==true){console.log("Hub.addHub    this.addingHub: "+this.addingHub+". Returning.");return;}this.addingHub=true;var _752=this.validateInputs(["login","token"]);if(!_752){this.addingHub=false;return;}var _753=_752;_753.username=Agua.cookie("username");_753.sessionId=Agua.cookie("sessionId");_753.login=this.login.value;_753.token=this.token.value;_753.hubtype="github";_753.mode="addHub";console.log("Hub.addHub    query: ");console.dir({query:_753});var url=Agua.cgiUrl+"workflow.cgi?";var _754=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_753),timeout:15000,load:function(_755,_756){console.log("Hub.addHub    OK. response:");console.dir({response:_755});_754.addingHub=false;Agua.updater.update("updateSyncWorkflows",{originator:_754,reload:false});Agua.updater.update("updateSyncWorkflows",{originator:_754,reload:false});Agua.toast(_755);},error:function(_757,_758){_754.addingHub=false;console.log("Hub.addHub    ERROR. response:");console.dir({response:_757});Agua.toast(_757);}});},addHubCertificate:function(){console.log("Hub.addHubCertificate");if(this.creatingCert){console.log("Hub.addHubCertificate    this.creatingCert: "+this.creatingCert+". Returning.");return;}this.creatingCert=true;var aws=Agua.getAws();console.log("Hub.addHubCertificate    aws:");console.dir({aws:aws});if(!aws||!aws.ec2privatekey){Agua.toastError("Please input EC2 Private Key in 'AWS' panel and press 'Save'");this.creatingToken=false;return;}var _759=this.validateInputs(["login"]);if(!_759){this.creatingCert=false;return;}var _75a=_759;_75a.username=Agua.cookie("username");_75a.sessionId=Agua.cookie("sessionId");_75a.hubtype="github";_75a.mode="addHubCertificate";console.log("Hub.addHubCertificate    query: ");console.dir({query:_75a});var url=Agua.cgiUrl+"workflow.cgi?";var _75b=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_75a),handleAs:"json",load:function(_75c,_75d){_75b.creatingCert=false;console.log("Hub.addHubCertificate    response:");console.dir({response:_75c});var _75e=_75c.data.publiccert;console.log("Hub.addHubCertificate    publiccert:");console.dir({publiccert:_75e});Agua.setHubCertificate(_75e);_75b.publiccert.innerHTML=_75e;},error:function(_75f,_760){_75b.creatingCert=false;console.log("Hub.addHubCertificate    ERROR response:");console.dir({response:_75f});}});},toggleAddToken:function(){console.log("Hub.showCreateToken    this.password:"+this.password);console.log("Hub.showCreateToken    dojo.hasClass:"+dojo.hasClass(this.password,"showCreateToken"));if(!dojo.hasClass(this.addToken,"showAddToken")){this.addTokenButton.innerHTML="Hide Panel";dojo.addClass(this.addToken,"showAddToken");}else{this.addTokenButton.innerHTML="Add GitHub Token";dojo.removeClass(this.addToken,"showAddToken");}},closeAddToken:function(){console.log("Hub.closeAddToken    Removing class 'showAddToken'");this.addTokenButton.innerHTML="Add GitHub Token";dojo.removeClass(this.addToken,"showAddToken");},addHubToken:function(){console.log("Hub.addHubToken");if(this.addingToken==true){console.log("Hub.addHubToken    this.addingToken: "+this.addingToken+". Returning.");return;}this.addingToken=true;var _761=this.validateInputs(["login","password"]);if(!_761){this.addingToken=false;return;}var _762=_761;_762.username=Agua.cookie("username");_762.sessionId=Agua.cookie("sessionId");_762.hubtype="github";_762.mode="addHubToken";console.log("Hub.addHubToken    query: ");console.dir({query:_762});var url=Agua.cgiUrl+"workflow.cgi?";var _763=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_762),handleAs:"json",load:function(_764,_765){console.log("Hub.addHubToken    response:");console.dir({response:_764});_763.addingToken=false;if(_764.error){Agua.toastError(_764.error);return;}_763.closeAddToken();var _766=_764.data.token;console.log("Hub.addHubToken    token:");console.dir({token:_766});_763.token.set("value",_766);Agua.updater.update("updateSyncWorkflows");},error:function(_767,_768){_763.addingToken=false;console.log("Hub.addHubToken    ERROR response:");console.dir({response:_767});return _767;}});},validateInputs:function(keys){console.log("Hub.validateInputs    keys: ");console.dir({keys:keys});var _769=new Object;this.isValid=true;for(var i=0;i<keys.length;i++){_769[keys[i]]=this.verifyInput(keys[i]);}console.log("Hub.validateInputs    inputs: ");console.dir({inputs:_769});if(!this.isValid){return null;}return _769;},verifyInput:function(_76a){console.log("Hub.verifyInput    input: ");console.dir({this_input:this[_76a]});var _76b=this[_76a].value;_76b=this.cleanEdges(_76b);console.log("Hub.verifyInput    value: "+_76b);var _76c=this.getClassName(this[_76a]);console.log("Hub.verifyInput    className: "+_76c);if(_76c){console.log("Hub.verifyInput    this[input].isValid(): "+this[_76a].isValid());if(!_76b||!this[_76a].isValid()){console.log("Hub.verifyInput    input "+_76a+" value is empty. Adding class 'invalid'");dojo.addClass(this[_76a].domNode,"invalid");this.isValid=false;}else{console.log("Hub.verifyInput    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[_76a].domNode,"invalid");return _76b;}}else{if(!_76b){console.log("Hub.verifyInput    input "+_76a+" value is empty. Adding class 'invalid'");dojo.addClass(this[_76a],"invalid");this.isValid=false;return null;}else{console.log("Hub.verifyInput    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[_76a],"invalid");return _76b;}}return null;},clearInvalid:function(){var _76d=["login","token",""];console.log("Hub.clearInvalid    input: ");console.dir({this_input:this[input]});var _76e=this[input].value;_76e=this.cleanEdges(_76e);console.log("Hub.clearInvalid    value: "+_76e);var _76f=this.getClassName(this[input]);console.log("Hub.clearInvalid    className: "+_76f);if(_76f){console.log("Hub.clearInvalid    this[input].isValid(): "+this[input].isValid());if(!_76e||!this[input].isValid()){console.log("Hub.clearInvalid    input "+input+" value is empty. Adding class 'invalid'");dojo.addClass(this[input].domNode,"invalid");this.isValid=false;}else{console.log("Hub.clearInvalid    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[input].domNode,"invalid");return _76e;}}else{if(!_76e){console.log("Hub.clearInvalid    input "+input+" value is empty. Adding class 'invalid'");dojo.addClass(this[input],"invalid");this.isValid=false;return null;}else{console.log("Hub.clearInvalid    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[input],"invalid");return _76e;}}return null;},cleanEdges:function(_770){_770=_770.toString();if(_770==null||!_770.replace){return null;}_770=_770.replace(/^\s+/,"");_770=_770.replace(/\s+$/,"");return _770;}});}if(!dojo._hasResource["plugins.admin.PackageRow"]){dojo._hasResource["plugins.admin.PackageRow"]=true;dojo.provide("plugins.admin.PackageRow");dojo.declare("plugins.admin.PackageRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"2\">\n        <tr>\n            <td\n                dojoAttachPoint=\"package\"\n                class=\"package\"\n\t\t\t\ttitle=\"package: Name of package\"\n                >${package}</td>\n            <td\n                dojoAttachPoint=\"privacy\"\n                class=\"privacy\"\n\t\t\t\ttitle=\"privacy: Name of privacy\"\n                >${privacy}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"version\"\n                class=\"version\"\n\t\t\t\ttitle=\"version: Version number of package (e.g., '0.8.0')\"\n                >${version}</td>\n        </tr>\n\n\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n\n\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"opsdir\"\n\t\t\t\t\t\t\tclass='opsdir'\n\t\t\t\t\t\t\ttitle=\"opsdir: Absolute path to directory containing *.ops file\"\n\t\t\t\t\t\t>${opsdir}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"installdir\"\n\t\t\t\t\t\t\tclass='installdir'\n\t\t\t\t\t\t\ttitle=\"installdir: Absolute path to base installation directory\"\n\t\t\t\t\t\t>${installdir}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\tclass='description'\n\t\t\t\t\t\t\ttitle=\"description: A brief description of the package\"\n\t\t\t\t\t\t>${description}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\tclass='notes'\n\t\t\t\t\t\t\ttitle=\"notes: Notes on the package (e.g., release notes)\"\n\t\t\t\t\t\t>${notes}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"url\"\n\t\t\t\t\t\t\tclass='url'\n\t\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/packages)\"\n\t\t\t\t\t\t>${url}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.formInputs=this.parentWidget.formInputs;},postCreate:function(){this.startup();},startup:function(){console.log("PackageRow.startup    this: "+this);this.inherited(arguments);this.setToggle();this.setEdit();},setToggle:function(){var _771=this;var _772=["package","version"];for(var i in _772){dojo.connect(this[_772[i]],"onclick",function(_773){_771.toggle();});}},setEdit:function(){var _774=this;var _775=["opsdir","description","notes","url"];for(var i in _775){dojo.connect(this[_775[i]],"onclick",function(_776){_774.parentWidget.editRow(_774,_776.target);_776.stopPropagation();});}},toggle:function(){var _777=["opsdir","installdir","description","notes","url"];for(var i in _777){if(this[_777[i]].style.display=="inline-block"){this[_777[i]].style.display="none";}else{this[_777[i]].style.display="inline-block";}}}});}if(!dojo._hasResource["plugins.admin.Packages"]){dojo._hasResource["plugins.admin.Packages"]=true;dojo.provide("plugins.admin.Packages");dojo.declare("plugins.admin.Packages",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- APPS TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"packages\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Packages\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n<table width=\"100%\">\n\t<tr valign=\"top\" width=\"100%\">\n\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\">\n\t\t\t<!--<div class=\"tabTitleIcon\">-->\n\t\t\t\tPackages\n\t\t\t<!--</div>-->\n\t\t</td>\n\t</tr>\n\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td width=\"100%\">\n\t\t\t<!--<div class=\"label\"> New Package </div>-->\n\t\t\t<table width=\"100%\">\n\t\t\t\t<tr width=\"100%\">\n\n\t\t\t\t\t<td colspan=\"3\" height=\"32px\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"padding: 0; margin: 0;\">\n\n\t\t\t\t\t\t\t<tr>\n\n\t\t\t\t\t\t\t\t<td \n\t\t\t\t\t\t\t\t\tstyle=\"padding-right: 10px;\" >\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"package\"\n\t\t\t\t\t\t\t\t\t\tclass=\"package\"\n\t\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"name: Name of package\"\n\t\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\n\t\t\t\t\t\t\t\t<td height=\"20px\"\n\t\t\t\t\t\t\t\t\twidth=\"120px\"\n\t\t\t\t\t\t\t\t\talign=\"right\">\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addPackageButton\"\n\t\t\t\t\t\t\t\t\t\tclass=\"addPackageButton\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tNew Package\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td >Version</td>\n\t\t\t\t\t<td>Privacy</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td >\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"version\"\n\t\t\t\t\t\t\tclass=\"version\"\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"version: Version of package (format: N.N.N, i.e., major.minor.patch)\"\n\t\t\t\t\t\t\t>Version</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tclass=\"privacy\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"privacy\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"public\">public</option>\n\t\t\t\t\t\t\t<option value=\"private\">private</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">Opsdir</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"opsdir\"\n\t\t\t\t\t\t\tclass=\"opsdir\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"opsdir: Absolute path to directory containing *.ops file\"\n\t\t\t\t\t\t\t>Opsdir</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">Installdir</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"installdir\"\n\t\t\t\t\t\t\tclass=\"installdir\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"installdir: Absolute path to base installation directory\"\n\t\t\t\t\t\t\t>Installdir</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\"\n\t\t\t\t\t\tclass=\"toggleTitle\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggle\"\n\t\t\t\t\t\ttitle=\"description: A brief description of the package\"\n\t\t\t\t\t> Details (Click to toggle)</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\"\n\t\t\t\t\t\tstyle=\"display: none;\"\n\t\t\t\t\t\ttitle=\"notes: A brief description of the package\"\n\t\t\t\t\t\tdojoAttachPoint=\"descriptionTitle\"\n\t\t\t\t\t>Description</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\tstyle=\"display: none; width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"description: A brief description of the package\"\n\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\"\n\t\t\t\t\t\tstyle=\"display: none;\"\n\t\t\t\t\t\ttitle=\"notes: Notes on the package (e.g., release notes)\"\n\t\t\t\t\t\tdojoAttachPoint=\"notesTitle\"\n\t\t\t\t\t>Notes</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\tclass=\"notes\"\n\t\t\t\t\t\t\tvalue=\"Notes\"\n\t\t\t\t\t\t\tstyle=\"display: none; width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"notes: Notes on the package (e.g., release notes)\"\n\t\t\t\t\t\t>Notes</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\tstyle=\"display: none;\"\n\t\t\t\t\t\tdojoAttachPoint=\"urlTitle\"\n\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/packages)\"\n\t\t\t\t\t\t>URL</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"url\"\n\t\t\t\t\t\t\tclass=\"url\"\n\t\t\t\t\t\t\tvalue=\"URL\"\n\t\t\t\t\t\t\tstyle=\"display: none; width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/packages)\"\n\t\t\t\t\t\t>URL</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\t\n\t<tr>\n\t\t<td>\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\tclass=\"dragSource\"\n\t\t\t\tstyle=\"height: 385px; width: 96%;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n\t<tr align=\"center\">\n\t\t<td align=\"center\">\n\n\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\tclass=\"trash\"\n\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n</table>\n\n\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingPackage:false,cssFiles:[dojo.moduleUrl("plugins","admin/css/packages.css")],parentWidget:null,formInputs:{"package":"word","version":"word","privacy":"word","opsdir":"word","installdir":"word","description":"phrase","notes":"phrase","url":"word"},requiredInputs:{"package":1,version:1,opsdir:1,installdir:1},invalidInputs:{"package":"Name",version:"Version",privacy:"Privacy",opsdir:"Opsdir",installdir:"Installdir",description:"Description",notes:"Notes",url:"URL"},defaultInputs:{"package":"Name",version:"Version",privacy:"Privacy",opsdir:"Opsdir",installdir:"Installdir",description:"Description",notes:"Notes",url:"URL"},dataFields:["package","version","privacy","opsdir","installdir"],avatarItems:["package","description"],rowClass:"plugins.admin.PackageRow",constructor:function(args){this.parentWidget=args.parentWidget;this.packages=args.parentWidget.packages;},postCreate:function(){this.loadCSS();this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updatePackages");this.setTrash(this.dataFields);},updatePackages:function(args){console.log("Packages.updatePackages    Packages.updatePackages(args)");console.log("Packages.updatePackages    args:");console.dir(args);if(args!=null&&args.reload==false){return;}if(args.originator&&args.originator==this){return;}console.log("Packages.updatePackages    Calling setDragSource()");this.setDragSource();},setForm:function(){dojo.connect(this.addPackageButton,"onclick",dojo.hitch(this,"saveInputs",null,{reload:true}));this.setClearValues();this.chainInputs(["package","type","executor","version","location","description","notes","url","addPackageButton"]);},getItemArray:function(){var _778=Agua.getPackages();console.log("Packages.getItemArray    itemArray.length: "+_778.length);_778=_778.sort();return _778;},changeDragSource:function(){this.setDragSource();},deleteItem:function(_779){_779["package"]=_779["package"].replace(/\s+$/,"");_779["package"]=_779["package"].replace(/^\s+/,"");Agua.removePackage(_779,"custom");var url=Agua.cgiUrl+"admin.cgi?";var _77a=new Object;_77a.username=Agua.cookie("username");_77a.sessionId=Agua.cookie("sessionId");_77a.mode="removePackage";_77a.data=_779;console.log("Packages.deleteItem    query: "+dojo.toJson(_77a));this.doPut({url:url,query:_77a,doToast:false});Agua.updater.update("updatePackages",{originator:this});},saveInputs:function(_77b,_77c){console.log("Packages.saveInputs    caller: "+this.saveInputs.caller.nom);console.log("Packages.saveInputs    inputs: ");console.dir({inputs:_77b});if(this.savingPackage==true){return;}this.savingPackage=true;if(_77b==null){_77b=this.getFormInputs(this);if(_77b==null){this.savingPackage=false;return;}}console.log("Packages.saveInputs    FINAL inputs: ");console.dir({inputs:_77b});var _77d=Agua.isPackage(_77b["package"]);console.log("Packages.saveInputs    isPackage: "+_77d);if(_77d){console.log("Packages.saveInputs    package exits already. Returning");this.setInvalid(this["package"]);Agua.toastMessage({message:"Package exists already: "+_77b["package"],type:"error"});this.savingPackage=false;return;}_77b.owner=Agua.cookie("username");_77b.username=Agua.cookie("username");Agua.removePackage({thisPackage:_77b["package"]});Agua.addPackage(_77b);var _77e=new Object;_77e.username=Agua.cookie("username");_77e.sessionId=Agua.cookie("sessionId");_77e.mode="addPackage";_77e.data=_77b;var url=Agua.cgiUrl+"admin.cgi?";dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_77e),handle:function(_77f,_780){return _77f;},error:function(_781,_782){return _781;}});this.savingPackage=false;Agua.updater.update("updatePackages",_77c);},toggle:function(){var _783=["descriptionTitle","description","notesTitle","notes","urlTitle","url"];for(var i in _783){if(this[_783[i]].style.display=="inline"){this[_783[i]].style.display="none";}else{this[_783[i]].style.display="inline";}}},getFormInputs:function(_784){var _785=new Object;for(var name in this.formInputs){_785[name]=this.processWidgetValue(_784,name);}_785=this.checkInputs(_784,_785);return _785;}});}if(!dojo._hasResource["plugins.admin.ParameterRow"]){dojo._hasResource["plugins.admin.ParameterRow"]=true;dojo.provide("plugins.admin.ParameterRow");dojo.declare("plugins.admin.ParameterRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table class=\"parameterrow\" width=\"100%\" cellspacing=\"2\">\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                width=\"100px\"\n                title=\"name: Name of parameter\"\n                >${name}</td>\n\n\n            <td colspan=\"1\"\n                width=\"100px\"\n                class=\"lockedValueTypeContainer\"\n            >\n\n                <table>\n                    <tr>\n                        <td dojoAttachPoint=\"locked\"\n                            dojoAttachEvent=\"onclick:toggleLock\"\n                            class=\"unlocked\"\n                        >\n                        </td>\n                        \n                        <td\n                            colspan=\"1\"\n                        >\n            \n                            <select\n                                dojoAttachPoint=\"paramtype\"\n                                class='paramtype'\n                                title=\"paramtype: Select type of parameter (input, resource or output)\"\n                                >\n                                <option selected=\"true\" class=\"default\" value=\"${paramtype}\">${paramtype}</option>\n                                <option value=\"input\">input</option>\n                                <option value=\"resource\">resource</option>\n                                <option value=\"output\">output</option>\n                            </select>\n                        \n                        </td>\n                    </tr>\n                </table>\n            \n            </td>\n\n            <td\n                colspan=\"1\"\n                width=\"100px\"\n                class=\"discretion\"\n            >\n\n                <select\n                    dojoAttachPoint=\"discretion\"\n                    class='discretionSelect'\n                    title=\"discretion: Select 'optional',  'required' (must not be empty) or 'essential' (file/directory must be present)\"\n                >\n                    <option selected=\"true\" class=\"default\" value=\"${discretion}\">${discretion}</option>\n                    <option value=\"essential\">essential</option>\n                    <option value=\"required\">required</option>\n                    <option value=\"optional\">optional</option>\n                </select>\n            \n            </td>\n        </tr>\n        \n        \n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n\n        \n        <tr>\n            <td \n                dojoAttachPoint=\"argument\"\n                colspan=\"1\"\n                class=\"argument\"\n                title=\"argument: Command line argument for parameter (e.g., '--inputfile')\"\n                >${argument}</td>\n\n            <td\n                dojoAttachPoint=\"valuetypeToggle\"\n                class=\"valuetype\"\n                colspan=\"1\"\n                >\n\n                <select\n                    dojoAttachPoint=\"valuetype\"\n                    class=\"valuetype\"\n                    title=\"valuetype: Type of parameter may be physical (e.g., file or directory) or abstract (e.g., integer or text string)\"\n                    >\n                    <option selected=\"true\" value=\"${valuetype}\">${valuetype}</option>\n                    <option value=\"file\">file</option>\n                    <option value=\"files\">files</option>\n                    <option value=\"directory\">directory</option>\n                    <option value=\"directories\">directories</option>\n                    <option value=\"integer\">integer</option>\n                    <option value=\"string\">string</option>\n                    <option value=\"flag\">flag</option>\n                </select>            \n            </td>\n\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"category\"\n                class=\"category\"\n                title=\"category: User-defined category for parameter to be used with input/output chaining. (E.g, the category 'inputfile' includes parameters with arguments '-i', '-infile' and '--inputfile'.)\"\n                >${category}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"value\"\n                class='value'\n                title=\"value: Default value of parameter (use '%project%/%workflow%/' for default file path)\"\n                >${value}</td>\n\n            <td colspan=\"1\"\n                class=\"ordinal\"\n                dojoAttachPoint=\"ordinalToggle\"\n            >\n                <table>\n                    <tr>\n                        <td>\n                            <select\n                                class=\"ordinal\"\n                                dojoAttachPoint=\"ordinal\"\n                                title=\"ordinal: Adjust the ordinal value if your application requires the parameters to be in a certain order. Parameters with the same ordinal will be grouped together in alphabetical order.\"\n                                >\n                                <option selected=\"true\" value=\"${ordinal}\">${ordinal}</option>\n                                <option value=\"0\">0</option>\n                                <option value=\"1\">1</option>\n                                <option value=\"2\">2</option>\n                                <option value=\"3\">3</option>\n                                <option value=\"4\">4</option>\n                                <option value=\"5\">5</option>\n                                <option value=\"6\">6</option>\n                                <option value=\"7\">7</option>\n                                <option value=\"8\">8</option>\n                                <option value=\"9\">9</option>\n                                <option value=\"10\">10</option>\n                                <option value=\"11\">11</option>\n                                <option value=\"12\">12</option>\n                                <option value=\"13\">13</option>\n                                <option value=\"14\">14</option>\n                                <option value=\"15\">15</option>\n                            </select>            \n            \n            \n                        <td \n                            colspan=\"1\"\n                            dojoAttachPoint=\"format\"\n                            class=\"format\"\n                            title=\"format: Special file format, to be used for parameter chaining or file checking (e.g., FASTA, FASTQ)\"\n                        >${format}</td>\n\n                    </tr>\n                </table>\n\n            </td>\n            \n        </tr>\n\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                class='description'\n                title=\"description: A description of the parameter and its usage\"\n            >${description}</td>\n\n        </tr>\n\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"args\"\n                class=\"args\"\n                title=\"args: Arguments for input/output chaining function (e.g., 'input.inputfile.value')\"\n            >${args}</td>\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"inputParams\"\n                class=\"inputParams\"\n                title=\"inputParams: Comma-separated list of variable names for each arg in the list of args for the paramFunction (e.g., 'inputfile')\"\n            >${inputParams}</td>\n        </tr>\n\n        <tr>\n            <td colspan=\"3\"\n                width=\"360px\"\n                dojoAttachPoint=\"paramFunction\"\n                class='paramFunction'\n                title=\"paramFunction: Input/output chaining function to automatically determine parameter value from the application itself or the preceding application in the workflow (e.g., 'if ( inputfile != null ) return inputfile')\"\n            >${paramFunction}</td>\n        </tr>\n\n    </table>\n</div>\n\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.lockedValue=args.locked;},postCreate:function(args){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _786=this;dojo.connect(this.name,"onclick",function(_787){_786.toggle();});this.setRowHeightListeners();if(this.lockedValue==1){dojo.removeClass(this.locked,"unlocked");dojo.addClass(this.locked,"locked");}else{dojo.removeClass(this.locked,"locked");dojo.addClass(this.locked,"unlocked");}var _786=this;var _788=["argument","category","value","description","format","args","inputParams","paramFunction"];for(var i in _788){dojo.connect(this[_788[i]],"onclick",function(_789){console.log("ParameterRow.startup    onclick listener fired: "+_788[i]);_786.parentWidget.editRow(_786,_789.target);_789.stopPropagation();});}var _786=this;var _78a=["valuetype","ordinal","discretion","paramtype"];for(var i in _78a){dojo.connect(this[_78a[i]],"onchange",function(_78b){console.log("ParameterRow.startup    onchange listener fired: "+_78a[i]);var _78c=_786.parentWidget.getFormInputs(_786);_786.parentWidget.saveInputs(_78c,{originator:_786.parentWidget,reload:false});_78b.stopPropagation();});}},setRowHeightListeners:function(){var _78d=this;dojo.connect(this.args,"onchange",dojo.hitch(function(_78e){setTimeout(function(_78f){_78f.levelRowHeight(_78f);},100,_78d);_78e.stopPropagation();}));dojo.connect(this.inputParams,"onchange",dojo.hitch(function(_790){setTimeout(function(_791){_791.levelRowHeight(_791);},100,_78d);_790.stopPropagation();}));},levelRowHeight:function(_792){dojo.attr(_792.inputParams,"style","display: inline-block; max-height: "+_792.inputParams.clientHeight+"px !important");dojo.attr(_792.args,"style","display: inline-block; max-height: "+_792.args.clientHeight+"px !important");dojo.attr(_792.inputParams,"style",{display:"inline-block","min-height":"20px !important"});dojo.attr(_792.args,"style",{display:"inline-block","min-height":"20px !important"});if(_792.inputParams.clientHeight<_792.args.clientHeight){dojo.attr(_792.inputParams,"style","display: inline-block; height: 0px !important");dojo.attr(_792.inputParams,"style","display: inline-block; min-height: "+_792.args.offsetHeight+"px !important");}else{if(_792.inputParams.clientHeight>=_792.args.clientHeight){dojo.attr(_792.args,"style","display: inline-block; height: 0px !important");dojo.attr(_792.args,"style","display: inline-block; min-height: "+_792.inputParams.offsetHeight+"px !important");}}},toggle:function(){var _793=["argument","valuetype","valuetypeToggle","category","value","ordinal","ordinalToggle","description","format","args","inputParams","paramFunction"];for(var i in _793){this.toggleNode(this[_793[i]]);}var _794=dojo.attr(this.args,"style");var _795=_794.match(/display:\s*([^;]+)/)[1];if(_795=="inline-block"){this.levelRowHeight(this);}},toggleNode:function(node){if(node.style.display=="inline-block"){node.style.display="none";}else{node.style.display="inline-block";}},toggleLock:function(_796){console.log("ParameterRow.toggleLock    plugins.admin.Parameter.toggleLock(name)");if(dojo.hasClass(this.locked,"locked")){dojo.removeClass(this.locked,"locked");dojo.addClass(this.locked,"unlocked");Agua.toastMessage({message:"ParameterRow has been unlocked. Users can change this parameter",type:warning});}else{dojo.removeClass(this.locked,"unlocked");dojo.addClass(this.locked,"locked");Agua.toastMessage({message:"ParameterRow has been locked. Users cannot change this parameter",type:"warning"});}var _797=this.parentWidget.getFormInputs(this);this.parentWidget.saveInputs(_797,null);_796.stopPropagation();},formInputs:{locked:"",name:"word",argument:"word",type:"word",category:"word",value:"word",discretion:"word",description:"phrase",format:"word",args:"word",inputParams:"phrase",paramFunction:"phrase"}});}if(!dojo._hasResource["plugins.admin.Parameters"]){dojo._hasResource["plugins.admin.Parameters"]=true;dojo.provide("plugins.admin.Parameters");dojo.declare("plugins.admin.Parameters",[plugins.form.DndSource,plugins.form.Inputs,plugins.form.EditRow,plugins.form.DndTrash,plugins.core.Common,dijit._Widget,dijit._Templated],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"parametersTab\"\n\t\tclass=\"parameters\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Parameters\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n<table width=\"100%\">\n\t<tr valign=\"top\" width=\"100%\">\n\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\">\n\t\t\tParameters\n\t\t</td>\n\t</tr>\n\n\t<tr class=\"inputs\" valign=\"top\" width=\"95%\">\n\t\t<td>\n\t\t\t<table width=\"100%\" style=\"padding: 0px;\">\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t\n\t\t\t\t\t<td colspan=\"3\" height=\"32px\" width=\"100%\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<table cellspacing=\"0px\" cellpadding=\"0px\" border=\"0\" style=\"padding: 0; margin: 0;\">\n\t\t\t\t\t\t\t<tr>\n\n\t\t\t\t\t\t\t\t<td align=\"center\" >\n\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"name\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"name\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"width: 220px !important; font-weight: bolder;\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"name: Name of parameter\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td dojoAttachPoint=\"locked\"\n\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggleLock\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"unlocked\"\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"locked: Click to lock/unlock user access to edit this parameter\">\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\n\t\t\t\t\t\t\t\t<td height=\"20px\"\n\t\t\t\t\t\t\t\t\twidth=\"120px\"\n\t\t\t\t\t\t\t\t\talign=\"right\">\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addParameterButton\"\n\t\t\t\t\t\t\t\t\t\tclass=\"addParameterButton\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"Click to create new parameter\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tNew Param\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"160px\">Argument</td>\n\t\t\t\t\t<td width=\"100px\">ParamType</td>\n\t\t\t\t\t<td width=\"33%\">Discretion</td>\n\t\t\t\t</tr>\n\t\t\t\t\t\n\t\t\t\t<tr width=\"100%\">\n\n\t\t\t\t\t<td width=\"160px\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"argument\"\n\t\t\t\t\t\t\tclass=\"argument\"\n\t\t\t\t\t\t\tstyle=\"width: 160px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"`\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"argument: Command line argument for parameter (e.g., '--inputfile')\"\n\t\t\t\t\t\t\t>Argument</textarea>\n\t\t\t\t\t</td>\n\n\n\t\t\t\t\t<td colspan=\"1\" width=\"100px\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tdojoAttachPoint=\"paramtype\"\n\t\t\t\t\t\t\tclass=\"paramtype\"\n\t\t\t\t\t\t\tvalue=\"Paramtype\"\n\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\ttitle=\"paramtype: Select type of parameter (input, resource or output)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option style=\"text-style: italic; text-weight: normal; background-color: #DDD;\" value=\"Paramtype\">Paramtype</option>\n\t\t\t\t\t\t\t<option value=\"input\">input</option>\n\t\t\t\t\t\t\t<option value=\"resource\">resource</option>\n\t\t\t\t\t\t\t<option value=\"output\">output</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td colspan=\"1\" width=\"100px\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tdojoAttachPoint=\"discretion\"\n\t\t\t\t\t\t\tclass=\"discretion\"\n\t\t\t\t\t\t\tvalue=\"Discretion\"\n\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\ttitle=\"discretion: Select optional, required (must not be empty) or essential (file/directory must be present)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option style=\"text-style: italic; text-weight: normal; background-color: #DDD;\" value=\"Discretion\">Discretion</option>\n\t\t\t\t\t\t\t<option value=\"essential\">essential</option>\n\t\t\t\t\t\t\t<option value=\"required\">required</option>\n\t\t\t\t\t\t\t<option value=\"optional\">optional</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"160px\">Value</td>\n\t\t\t\t\t<td width=\"100px\">Ordinal</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td colspan=\"1\" width=\"160px\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"value\"\n\t\t\t\t\t\t\tclass=\"value\"\n\t\t\t\t\t\t\tstyle=\"width: 160px !important; font-weight: bolder; font-family: Verdana; overflow: hidden !important;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t                title=\"value: Default value of parameter (use '%project%/%workflow%/' for default file path)\"\n\t\t\t\t\t\t\t>Value</textarea>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td width=\"100px\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tdojoAttachPoint=\"valuetype\"\n\t\t\t\t\t\t\tclass=\"valuetype\"\n\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t                    title=\"valuetype: Type of parameter may be physical (e.g., file or directory) or abstract (e.g., integer or text string)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option selected=\"true\" class=\"default\" value=\"Type\">ValueType</option>\n\t\t\t\t\t\t\t<option value=\"file\">file</option>\n\t\t\t\t\t\t\t<option value=\"files\">files</option>\n\t\t\t\t\t\t\t<option value=\"directory\">directory</option>\n\t\t\t\t\t\t\t<option value=\"directories\">directories</option>\n\t\t\t\t\t\t\t<option value=\"integer\">integer</option>\n\t\t\t\t\t\t\t<option value=\"string\">string</option>\n\t\t\t\t\t\t\t<option value=\"flag\">flag</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\n\n\t\t\t\t\t<td width=\"100px\"\n\t\t\t\t\t\tstyle=\"padding-left: 5px;\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"category\"\n\t\t\t\t\t\t\tclass=\"category\"\n\t\t\t\t\t\t\tstyle=\"width: 90px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t                title=\"category: User-defined category for parameter to be used with input/output chaining. (E.g, the category 'inputfile' includes parameters with arguments '-i', '-infile' and '--inputfile'.)\"\n\t\t\t\t\t\t\t>Category</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t<td width=\"100%\"\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\tclass=\"toggleTitle\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggleDescription\"\n\t\t\t\t\t> Details (Click to toggle)</td>\n\t\t\t\t</tr>\n\n\t\t\t</table>\n\t\t</td>\n\n\t</tr>\n\t<tr class=\"inputs\" >\n\t\t<td>\n\n\t\t\t<table\n\t\t\t\tstyle=\"display: none\"\n\t\t\t\tdojoAttachPoint=\"togglePoint\"\n\t\t\t\twidth=\"100%\"\n\t\t\t\tstyle=\"padding: 0px;\"\n\t\t\t>\n\n\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t<td width=\"67%\"\n\t\t\t\t\t\tcolspan=\"2\"\n\t\t\t\t\t>Description</td>\n\n\t\t\t\t\t<td width=\"33%\"\n\t\t\t\t\t>Ordinal</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td\n\t\t\t\t\tcolspan=\"3\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"2\" width=\"270px\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 270px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"24\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"description: A brief description of the parameter\"\n\t\t\t\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\n\t\t\t\t\t\t\t\t<td width=\"100px\">\n\t\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ordinal\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ordinal\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\ttitle=\"ordinal: Adjust the ordinal value if your application requires the parameters to be in a certain order. Parameters with the same ordinal will be grouped together in alphabetical order.\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option selected=\"true\" class=\"default\" value=\"1\">Ordinal</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"1\">1</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"2\">2</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"3\">3</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"4\">4</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"5\">5</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"6\">6</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"7\">7</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"8\">8</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"9\">9</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"10\">10</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"11\">11</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"12\">12</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"13\">13</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"14\">14</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"15\">15</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\n\t\t\t\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t\t\t\t<td width=\"160px\">Format</td>\n\t\t\t\t\t\t\t\t<td width=\"100px\">Arguments</td>\n\t\t\t\t\t\t\t\t<td width=\"100px\">Parameters</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t\t\t\t<td width=\"162px\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"format\"\n\t\t\t\t\t\t\t\t\t\tclass=\"format\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 162px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"24\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"format: Special file format, to be used for parameter chaining or file checking (e.g., FASTA, FASTQ)\"\n\t\t\t\t\t\t\t\t\t\t>Format</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"100px\"\n\t\t\t\t\t\t\t\t\tstyle=\"padding-left: 4px; padding-right: 4px;\" >\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"args\"\n\t\t\t\t\t\t\t\t\t\tclass=\"args\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"args: Arguments for input/output chaining function (e.g., 'input.inputfile.value')\"\n\t\t\t\t\t\t\t\t\t\t>Args</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\n\t\t\t\t\t\t\t\t<td width=\"100px\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"inputParams\"\n\t\t\t\t\t\t\t\t\t\tclass=\"inputParams\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 96px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"10\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"inputParams: Comma-separated list of variable names for each arg in the list of args for the paramFunction (e.g., 'inputfile')\"\n\t\t\t\t\t\t\t\t\t\t>Params</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t\t\t\t<td colspan=\"3\">Parameter Function</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\" width=\"380px\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"paramFunction\"\n\t\t\t\t\t\t\t\t\t\tclass=\"paramFunction\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 380px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"paramFunction: Input/output chaining function to automatically determine parameter value from the application itself or the preceding application in the workflow (e.g., 'if ( inputfile != null ) return inputfile')\"\n\t\t\t\t\t\t\t\t\t>ParamFunction</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\t\n\t<tr>\n\t\t<td width=\"50%\" align=\"center\">\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t<table>\t\t\t\n\t\t\t\t\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t\t\t\t\t<div class=\"label\"> Application </div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"appsCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"appsCombo\"\n\t\t\t\t\t\t\t\t\t\tpopupClass=\"parameters appsCombo dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"Select the order of the displayed applications\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"appNamesCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"appNamesCombo\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"Select an application to view its inputs below\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td width=\"50%\" align=\"center\" valign=\"top\">\n\t\t\t\t\t\t<table valign=\"top\">\n\t\t\t\t\t\t\t<tr valign=\"top\">\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div class=\"label paramTypes\"> Parameters </div>\n\t\t\t\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"paramOrderCombo\"\n\t\t\t\t\t\t\t\t\t\tclass='paramOrderCombo'\n\t\t\t\t\t\t\t\t\t\ttitle=\"Filter displayed parameters\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tselected=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"Order by Name\">Order by Name</option>\n\t\t\t\t\t\t\t\t\t\t<option \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"Order by Ordinal\">Order by Ordinal</option>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"Order by Type\">Order by Type</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"paramFilterCombo\"\n\t\t\t\t\t\t\t\t\t\tclass='paramFilterCombo'\n\t\t\t\t\t\t\t\t\t\ttitle=\"Filter displayed parameters\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tselected=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"All\">All</option>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"input\">input</option>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"resource\">resource</option>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"output\">output</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\t\t\t\n\n\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\n\t<tr>\n\t\t<td>\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\tclass=\"dragSource\"\n\t\t\t\tstyle=\"height: 361px; width: 94%;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n\t<tr align=\"center\">\n\t\t<td align=\"center\">\n\n\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\tclass=\"trash\"\n\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n</table>\n\n\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingParameter:false,cssFiles:[dojo.moduleUrl("plugins","admin/css/parameters.css"),dojo.moduleUrl("dojo","tests/dnd/dndDefault.css")],parentWidget:null,formInputs:{locked:"",name:"word",argument:"word",valuetype:"word",category:"word",value:"word",ordinal:"word",discretion:"word",description:"phrase",paramtype:"paramtype",format:"word",args:"word",inputParams:"phrase",paramFunction:"phrase"},defaultInputs:{name:"Name",argument:"Argument",category:"Category",value:"Value",description:"Description",format:"Format",args:"Args",inputParams:"Params",paramFunction:"ParamFunction"},requiredInputs:{name:1,paramtype:1,valuetype:1,category:1,discretion:1,paramtype:1},invalidInputs:{name:"Name",argument:"Argument",valuetype:"ValueType",category:"Category",value:"Value",discretion:"Discretion",description:"Description",paramtype:"Paramtype",format:"Format",args:"Args",inputParams:"Params",paramFunction:"ParamFunction"},dataFields:["name","appname","paramtype"],rowClass:"plugins.admin.ParameterRow",avatarItems:["name","description"],avatarType:"parameters",childWidgets:[],constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.loadCSS();this.inherited(arguments);this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.parametersTab);this.tabContainer.selectChild(this.parametersTab);this.setAppTypesCombo();this.setForm();this.setTrash(this.dataFields);setTimeout(function(_798){_798.setComboListeners();},1000,this);Agua.updater.subscribe(this,"updateApps");Agua.updater.subscribe(this,"updateParameters");},updateApps:function(args){this.setAppNamesCombo();this.setAppTypesCombo();this.setDragSource();},updateParameters:function(args){if(args.originator==this){if(args.reload==false){return;}}this.setDragSource();},toggleDescription:function(){console.log("Packages.toggle    this.togglePoint.style.display: "+this.togglePoint.style.display);if(this.togglePoint.style.display=="inline-block"){this.togglePoint.style.display="none";}else{this.togglePoint.style.display="inline-block";}},setAppTypesCombo:function(type){var apps=Agua.getApps();var _799=this.hashArrayKeyToArray(apps,"type");_799=this.uniqueValues(_799);_799=this.sortNoCase(_799);_799.splice(0,0,"Order by Type");_799.splice(0,0,"Order by Name");var data={identifier:"name",items:[]};for(var i=0;i<_799.length;i++){data.items[i]={name:_799[i]};}var _79a=new dojo.data.ItemFileWriteStore({data:data});this.appsCombo.store=_79a;this.appsCombo.startup();var _79b=_799[0];this.appsCombo.set("value",_79b);this.setAppNamesCombo();},setAppNamesCombo:function(){var type=this.appsCombo.get("value");var _79c=Agua.getApps();var _79d=["type"];var _79e=[type];if(type=="Order by Name"){_79c=this.sortHasharray(_79c,"name");}else{if(type=="Order by Type"){_79c=this.sortHasharray(_79c,"name");_79c=this.sortHasharray(_79c,"type");}else{_79c=this.filterByKeyValues(_79c,_79d,_79e);}}if(_79c==null||_79c.length==0){return;}var data={identifier:"name",items:[]};for(var i=0;i<_79c.length;i++){data.items[i]={name:_79c[i].name};}var _79f=new dojo.data.ItemFileWriteStore({data:data});this.appNamesCombo.store=_79f;this.appNamesCombo.startup();var _7a0=_79c[0].name;this.appNamesCombo.set("value",_7a0);this.setDragSource();},setComboListeners:function(){dojo.connect(this.paramOrderCombo,"onchange",this,"setDragSource");dojo.connect(this.paramFilterCombo,"onchange",this,"setDragSource");dojo.connect(this.appsCombo,"onChange",dojo.hitch(this,function(){this.setAppNamesCombo();}));var _7a1=this;dojo.connect(this.appNamesCombo,"onChange",dojo.hitch(this,function(){_7a1.setDragSource();}));},toggleLock:function(){if(dojo.hasClass(this.locked,"locked")){dojo.removeClass(this.locked,"locked");dojo.addClass(this.locked,"unlocked");Agua.warning("Parameter has been unlocked. Users can change this parameter");}else{dojo.removeClass(this.locked,"unlocked");dojo.addClass(this.locked,"locked");Agua.warning("Parameter has been locked. Users cannot change this parameter");}},setForm:function(){dojo.connect(this.addParameterButton,"onclick",dojo.hitch(this,"saveInputs",null,{originator:this,reload:true}));this.setClearValues();this.chainInputs(["name","argument","valuetype","category","value","ordinal","paramtype","description","discretion","format","args","inputParams","paramFunction","addParameterButton"]);},getItemArray:function(){var _7a2=this.appNamesCombo.get("value");var _7a3=Agua.getParametersByAppname(_7a2);var _7a4=this.paramOrderCombo.value;if(_7a4=="Order by Name"){_7a3=this.sortHasharray(_7a3,"name");}else{if(_7a4=="Order by Type"){_7a3=this.sortHasharray(_7a3,"paramtype");}else{if(_7a4=="Order by Ordinal"){_7a3=this.sortHasharray(_7a3,"ordinal");}else{_7a3=this.sortHasharray(_7a3,"name");}}}var _7a5=this.paramFilterCombo.value;var _7a6=["paramtype"];var _7a7=[_7a5];if(_7a5=="All"){}else{_7a3=this.filterByKeyValues(_7a3,_7a6,_7a7);}return _7a3;},deleteItem:function(_7a8){if(_7a8.name==null){return;}if(_7a8.appname==null){return;}_7a8.owner=Agua.cookie("username");Agua.removeParameter(_7a8);Agua.updater.update("updateParameters",{originator:this});},saveInputs:function(_7a9,_7aa){if(this.savingInputs==true){return;}this.savingInputs=true;if(_7a9==null){_7a9=this.getFormInputs(this);if(_7a9==null||this.allValid==false){this.savingInputs=false;return;}}_7a9.owner=Agua.cookie("username");var _7ab=this.appNamesCombo.get("value");_7a9.appname=_7ab;var _7ac=Agua.getAppType(_7ab);_7a9.apptype=_7ac;Agua.addParameter(_7a9);for(var name in this.invalidInputs){if(_7a9[name]==null){_7a9[name]="";}if(_7a9[name]==this.invalidInputs[name]){_7a9[name]="";}_7a9[name]=_7a9[name].replace(/'/g,"\"");}for(var i=0;i<_7a9.length;i++){_7a9[i]=this.convertBackslash(_7a9[i],"expand");}var url=Agua.cgiUrl+"admin.cgi?";var _7ad=new Object;_7ad.username=Agua.cookie("username");_7ad.sessionId=Agua.cookie("sessionId");_7ad.mode="saveParameter";_7ad.data=_7a9;this.doPut({url:url,query:_7ad,sync:false});this.savingInputs=false;Agua.updater.update("updateParameters",_7aa);},getFormInputs:function(_7ae){var _7af=new Object;for(var name in this.formInputs){var _7b0;if(dojo.hasClass(_7ae[name],"locked")){_7b0="1";}else{if(dojo.hasClass(_7ae[name],"unlocked")){_7b0="0";}else{_7b0=this.getWidgetValue(_7ae[name]);}}_7af[name]=_7b0;}_7af=this.checkInputs(_7ae,_7af);return _7af;},checkInputs:function(_7b1,_7b2){var _7b3=false;var _7b4=this.paramtype.value;if(_7b4=="input"){_7b3=true;}this.allValid=true;for(var key in this.formInputs){if(key=="argument"&&_7b3==false){dojo.removeClass(_7b1[key],"invalid");continue;}_7b2[key]=this.convertString(_7b2[key],"htmlToText");_7b2[key]=this.convertBackslash(_7b2[key],"expand");if((this.isValidInput(key,_7b2[key])==false&&this.requiredInputs[key]!=null)||(this.requiredInputs[key]!=null&&(_7b2[key]==null||_7b2[key]==""))){this.addClass(_7b1[key],"invalid");this.allValid=false;}else{this.removeClass(_7b1[key],"invalid");}}this.checkArgsBalance(_7b1);this.checkSyntax(_7b1);if(this.allValid==false){return null;}return _7b2;},checkArgsBalance:function(_7b5){console.log("Parameters.checkArgsBalance    plugins.admin.Parameters.checkArgsBalance(widget)");console.log("Parameters.checkArgsBalance    console.dir(widget):");console.dir({widget:_7b5});var args=_7b5.args.innerHTML;var _7b6=_7b5.inputParams.innerHTML;console.log("Parameters.checkArgsBalance    args: "+args);console.log("Parameters.checkArgsBalance    inputParams: "+_7b6);var _7b7=args.split(/,/);console.log("Parameters.checkArgsBalance    argsArray.length: "+_7b7.length);var _7b8=_7b6.split(/,/);console.log("Parameters.checkArgsBalance    paramsArray.length: "+_7b8.length);if(_7b8==null){return;}if(_7b8.length==null||_7b8.length==0){return;}if(_7b7.length==null||_7b7.length!=_7b8.length){this.allValid=false;this.setInvalid(_7b5.args);this.setInvalid(_7b5.inputParams);}else{this.setValid(_7b5.args);this.setValid(_7b5.inputParams);}console.log("Parameters.checkArgsBalance    FINAL this.allValid: "+this.allValid);},checkSyntax:function(_7b9){console.log("Parameters.checkSyntax    plugins.admin.Parameterss.checkSyntax(widget)");console.log("Parameters.checkSyntax    console.dir(widget):");console.dir({widget:_7b9});var _7ba=_7b9.inputParams.innerHTML;var _7bb=_7b9.paramFunction.innerHTML;console.log("Parameters.checkSyntax    inputParams: "+_7ba);console.log("Parameters.checkSyntax    paramFunction: "+_7bb);try{var _7bc="var func = function("+_7ba+") {"+_7bb+"}";console.log("Parameters.checkSyntax    funcString: "+_7bc);eval(_7bc);console.log("Parameters.checkSyntax    eval OK");this.setValid(_7b9.paramFunction);}catch(error){console.log("error: "+error);this.allValid=false;this.setInvalid(_7b9.paramFunction);}console.log("Parameters.checkArgsBalance    FINAL this.allValid: "+this.allValid);}});}if(!dojo._hasResource["plugins.admin.UserRow"]){dojo._hasResource["plugins.admin.UserRow"]=true;dojo.provide("plugins.admin.UserRow");dojo.declare("plugins.admin.UserRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr class=\"username\" width=\"100%\">\n            <td\n                width=\"100%\"\n                colspan=\"2\"\n                dojoAttachPoint=\"username\"\n                class=\"username\"\n            >${username}</td>\n        </tr>\n        <tr class='firstname' width=\"100%\">\n            <td \n                dojoAttachPoint=\"firstname\"\n                class='firstname'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${firstname}</td>\n        </tr>\n        <tr class='lastname' width=\"100%\">\n            <td \n                dojoAttachPoint=\"lastname\"\n                class='lastname'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${lastname}</td>\n        </tr>\n        <tr class=\"email\" width=\"100%\">\n            <td \n                dojoAttachPoint=\"email\"\n                class='email'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${email}</td>\n        </tr>\n        <tr class=\"password\" width=\"100%\">\n            <td \n                dojoAttachPoint=\"password\"\n                class='password'\n                style=\"display: none;\"\n                type=\"password\"\n                value=\"its-a-secret\"\n                width=\"100%\" colspan=\"2\"\n            >reset-password</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _7bd=this;dojo.connect(this.username,"onclick",function(_7be){_7bd.toggle();_7be.stopPropagation();});var _7bd=this;dojo.connect(this.firstname,"onclick",function(_7bf){_7bd.parentWidget.editRow(_7bd,_7bf.target);_7bf.stopPropagation();});dojo.connect(this.lastname,"onclick",function(_7c0){_7bd.parentWidget.editRow(_7bd,_7c0.target);_7c0.stopPropagation();});dojo.connect(this.email,"onclick",function(_7c1){_7bd.parentWidget.editRow(_7bd,_7c1.target);_7c1.stopPropagation();});dojo.connect(this.password,"onclick",function(_7c2){_7bd.clearValue(_7c2.target);_7bd.parentWidget.editRow(_7bd,_7c2.target);_7c2.stopPropagation();});},toggle:function(){if(this.firstname.style.display=="block"){this.firstname.style.display="none";}else{this.firstname.style.display="block";}if(this.lastname.style.display=="block"){this.lastname.style.display="none";}else{this.lastname.style.display="block";}if(this.email.style.display=="block"){this.email.style.display="none";}else{this.email.style.display="block";}if(this.password.style.display=="block"){this.password.style.display="none";}else{this.password.style.display="block";}},clearValue:function(_7c3){if(_7c3.clicked==true){return;}_7c3.clicked=true;_7c3.innerHTML="";_7c3.focus();}});}if(!dojo._hasResource["plugins.admin.Personal"]){dojo._hasResource["plugins.admin.Personal"]=true;dojo.provide("plugins.admin.Personal");dojo.declare("plugins.admin.ValidationTextBox",[dijit.form.ValidationTextBox],{validate:function(_7c4){console.log("plugins.admin.ValidationTextBox.validate    plugins.admin.ValidationTextBox.validate(isFocused)");console.log("plugins.admin.ValidationTextBox.validate    this.target: "+this.target);if(this.parentWidget==null){return;}if(this.target!=null){return this.target.validate(_7c4);}var _7c5="";var _7c6=this.parentWidget.passwordsMatch();console.log("plugins.admin.ValidationTextBox.validate    isValid: "+_7c6);if(_7c6){this._maskValidSubsetError=true;}var _7c7=this._isEmpty(this.textbox.value);var _7c8=!_7c6&&!_7c7&&_7c4&&this._isValidSubset();this.state=((_7c6||((!this._hasBeenBlurred||_7c4)&&_7c7)||_7c8)&&this._maskValidSubsetError)?"":"Error";if(this.state=="Error"){this._maskValidSubsetError=_7c4;}this._setStateClass();dijit.setWaiState(this.focusNode,"invalid",_7c6?"false":"true");if(_7c4){if(this.state=="Error"){_7c5=this.getErrorMessage(true);}else{_7c5=this.getPromptMessage(true);}this._maskValidSubsetError=true;}this.displayMessage(_7c5);return _7c6;}});dojo.declare("plugins.admin.Personal",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t\n\t<!-- personal TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"personal\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Personal\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table>\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Personal </td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Personal Information </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"subPane\"\n\t\t\t\t\t\tstyle=\"height: 195px; width: 95%;\"\n\t\t\t\t\t>\n\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Username</td>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"username\"\n\t\t\t\t\t\t\t\t\tclass=\"username\"\n\t\t\t\t\t\t\t></td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"updateUserButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:updateUser\"\n\t\t\t\t\t\t\t\tclass=\"updateUserButton\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Firstname</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"firstname\"\n\t\t\t\t\t\t\t\t\tclass=\"firstname\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Lastname</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"lastname\"\n\t\t\t\t\t\t\t\t\tclass=\"lastname\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Email</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"email\"\n\t\t\t\t\t\t\t\t\tclass=\"email\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Old Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"oldPassword\"\n\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">New Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"newPassword\"\n\t\t\t\t\t\t\t\t\tdojoType=\"plugins.admin.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\tclass=\"newPassword\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Confirm Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\tdojoType=\"plugins.admin.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\tclass=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END personal TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins","admin/css/personal.css"),],parentWidget:null,constructor:function(args){console.log("Personal.constructor     plugins.admin.Personal.constructor");this.parentWidget=args.parentWidget;this.personal=args.parentWidget.personal;this.loadCSS();},postCreate:function(){console.log("Controller.postCreate    plugins.admin.Controller.postCreate()");this.startup();},startup:function(){console.log("Personal.startup    plugins.admin.GroupPersonal.startup()");console.log("Personal.startup    BEFORE inherited(arguments)");this.inherited(arguments);console.log("Personal.startup    AFTER inherited(arguments)");this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);console.log("Personal.startup    this.confirmPassword: "+this.confirmPassword);this.confirmPassword.parentWidget=this;this.newPassword.parentWidget=this;this.newPassword.target=this.confirmPassword;this.initialisePersonal();},passwordsMatch:function(){console.log("Personal.confirmPassword    plugins.admin.GroupPersonal.confirmPassword()");var _7c9=this.newPassword.textbox.value;console.log("Personal.confirmPassword    newPassword: "+_7c9);var _7ca=this.confirmPassword.textbox.value;console.log("Personal.confirmPassword    confirmPassword: "+_7ca);return _7c9==_7ca;},getInputValue:function(name){console.log("Personal.getInputValue    name: "+name);var _7cb=this[name];var _7cc=_7cb.get?_7cb.get("value"):_7cb;console.log("Personal.getInputValue    value: "+_7cc);_7cc=this.cleanEdges(_7cc);return _7cc;},getTextAreaValue:function(name){console.log("Personal.getTextAreaValue    name: "+name);var _7cd=this[name].value;_7cd=this.cleanEdges(_7cd);this[name].value=_7cd;return _7cd;},updateUser:function(_7ce){console.clear();console.log("Personal.updateUser    plugins.admin.Personal.updateUser(event)");console.log("Personal.updateUser    event: "+_7ce);console.log("Personal.updateUser    this.savingUser: "+this.savingUser);if(this.savingUser==true){return;}this.savingUser=true;var _7cf=this.cleanEdges(this.oldPassword.value);var _7d0=this.cleanEdges(this.newPassword.value);var _7d1=this.cleanEdges(this.confirmPassword.value);if(!(!_7cf&&!_7d0&&!_7d1)){if(!_7cf){dojo.addClass(this.oldPassword,"invalid");}else{dojo.removeClass(this.oldPassword,"invalid");}if(!_7d0){dojo.addClass(this.newPassword,"invalid");}else{dojo.removeClass(this.newPassword,"invalid");}if(!_7d1){dojo.addClass(this.confirmPassword,"invalid");}else{dojo.removeClass(this.confirmPassword,"invalid");}if(!_7cf){console.log("Personal.updateUser    NO PASSWORD. Returning");this.savingUser=false;return;}}if(_7d0!=_7d1){console.log("Users.updateUser    passwords do not match. Adding class 'invalid'");dojo.addClass(this.newPassword,"invalid");dojo.addClass(this.confirmPassword,"invalid");console.log("Users.updateUser    Finished adding class 'invalid'");this.savingUser=false;return;}else{console.log("Users.updateUser    passwords match. Removing class 'invalid'");dojo.removeClass(this.newPassword,"invalid");dojo.removeClass(this.confirmPassword,"invalid");}var user=new Object;user.username=Agua.cookie("username");user.firstname=this.cleanEdges(this.firstname.value);user.lastname=this.cleanEdges(this.lastname.value);user.email=this.cleanEdges(this.email.value);user.oldpassword=_7cf;user.newpassword=_7d0;console.log("Personal.updateUser    user: "+dojo.toJson(user));var url=Agua.cgiUrl+"admin.cgi?";var _7d2=new Object;_7d2.username=Agua.cookie("username");_7d2.sessionId=Agua.cookie("sessionId");_7d2.mode="updateUser";_7d2.data=user;var _7d3=this;dojo.xhrPut({url:url,contentType:"text",handleAs:"json",putData:dojo.toJson(_7d2),timeout:15000,load:function(_7d4,_7d5){console.log("Personal.updateUser    response: "+_7d4);if(_7d4.error){dojo.addClass(_7d3.oldPassword,"invalid");Agua.toastError(_7d4.error);}_7d3.savingUser=false;},error:function(_7d6,_7d7){_7d3.savingUser=false;}});this.savingUser=false;},cleanEdges:function(_7d8){_7d8=_7d8.toString();if(_7d8==null||!_7d8.replace){return null;}_7d8=_7d8.replace(/^\s+/,"");_7d8=_7d8.replace(/\s+$/,"");return _7d8;},initialisePersonal:function(){console.log("Personal.initialisePersonal     plugins.admin.GroupPersonal.initialisePersonal()");var _7d9=Agua.cookie("username");console.log("Personal.initialisePersonal     username: "+_7d9);this.username.innerHTML=_7d9;var user=Agua.getUser(_7d9);console.log("Personal.initialisePersonal     user: "+dojo.toJson(user));this.firstname.value=user["firstname"]||"";this.lastname.value=user["lastname"];this.email.value=user["email"];},reloadPersonalTabs:function(){console.log("Personal.reloadPersonalTabs    plugins.admin.Personal.reloadPersonalTabs()");console.log("Personal.reloadPersonalTabs    this.parentWidget: "+this.parentWidget);console.log("Personal.reloadPersonalTabs    this.parentWidget.paneWidgets: "+this.parentWidget.paneWidgets);var _7da=["plugins.admin.GroupPersonal"];for(var i in _7da){if(this.parentWidget.paneWidgets[_7da[i]]!=null){console.log("Personal.reloadPersonalTabs    this.parentWidget.paneWidgets['"+_7da[i]+"']: "+this.parentWidget.paneWidgets[_7da[i]]);this.parentWidget.paneWidgets[_7da[i]].reload();}}},setTable:function(){console.log("Personal.setTable     plugins.admin.GroupPersonal.setTable()");while(this.mainTable.firstChild){this.mainTable.removeChild(this.mainTable.firstChild);}},});}if(!dojo._hasResource["plugins.dijit.form.ValidationTextBox"]){dojo._hasResource["plugins.dijit.form.ValidationTextBox"]=true;dojo.provide("plugins.dijit.form.ValidationTextBox");dojo.declare("plugins.dijit.form.ValidationTextBox",[dijit.form.ValidationTextBox],{validate:function(_7db){if(this.parentWidget==null){return;}if(this.target!=null){var _7dc=this.target.validate(_7db);console.log("plugins.dijit.form.ValidationTextBox.validate    TARGET isValid: "+_7dc);if(!_7dc){this.state="Error";}else{this.state="Incomplete";}this._setStateClass();}var _7dd="";var _7dc=this.parentWidget.passwordsMatch();if(_7dc){this._maskValidSubsetError=true;}var _7de=this._isEmpty(this.textbox.value);var _7df=!_7dc&&!_7de&&_7db&&this._isValidSubset();this.state=((_7dc||((!this._hasBeenBlurred||_7db)&&_7de)||_7df)&&this._maskValidSubsetError)?"":"Error";if(!_7dc){this.state="Error";}else{this.state="Incomplete";}if(this.state=="Error"){this._maskValidSubsetError=_7db;}this._setStateClass();dijit.setWaiState(this.focusNode,"invalid",_7dc?"false":"true");if(_7db){if(this.state=="Error"){_7dd=this.getErrorMessage(true);}else{_7dd=this.getPromptMessage(true);}this._maskValidSubsetError=true;}this.displayMessage(_7dd);if(this.source){if(!_7dc){this.source.state="Error";}else{this.source.state="Incomplete";}this.source._setStateClass();}return _7dc;}});}if(!dojo._hasResource["plugins.admin.Settings"]){dojo._hasResource["plugins.admin.Settings"]=true;dojo.provide("plugins.admin.Settings");dojo.declare("plugins.admin.ValidationTextBox",[dijit.form.ValidationTextBox],{validate:function(_7e0){console.log("plugins.admin.ValidationTextBox.validate    plugins.admin.ValidationTextBox.validate(isFocused)");console.log("plugins.admin.ValidationTextBox.validate    this.target: "+this.target);if(this.parentWidget==null){return;}if(this.target!=null){return this.target.validate(_7e0);}var _7e1="";var _7e2=this.parentWidget.passwordsMatch();console.log("plugins.admin.ValidationTextBox.validate    isValid: "+_7e2);if(_7e2){this._maskValidSubsetError=true;}var _7e3=this._isEmpty(this.textbox.value);var _7e4=!_7e2&&!_7e3&&_7e0&&this._isValidSubset();this.state=((_7e2||((!this._hasBeenBlurred||_7e0)&&_7e3)||_7e4)&&this._maskValidSubsetError)?"":"Error";console.log("plugins.admin.ValidationTextBox.validate    this.state: "+this.state);if(this.state=="Error"){this._maskValidSubsetError=_7e0;}this._setStateClass();dijit.setWaiState(this.focusNode,"invalid",_7e2?"false":"true");if(_7e0){if(this.state=="Error"){_7e1=this.getErrorMessage(true);}else{_7e1=this.getPromptMessage(true);}this._maskValidSubsetError=true;}this.displayMessage(_7e1);return _7e2;}});dojo.declare("plugins.admin.Settings",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t\n\t<!-- settings TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"settings\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Settings\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table>\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Settings </td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Personal Info </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"subPane\"\n\t\t\t\t\t\tstyle=\"height: 195px; width: 95%;\"\n\t\t\t\t\t>\n\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Username</td>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"username\"\n\t\t\t\t\t\t\t\t\tclass=\"username\"\n\t\t\t\t\t\t\t></td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"updateUserButton\"\n\t\t\t\t\t\t\t\tclass=\"addUserButton\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Firstname</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"firstname\"\n\t\t\t\t\t\t\t\t\tclass=\"firstname\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Lastname</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"lastname\"\n\t\t\t\t\t\t\t\t\tclass=\"lastname\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Email</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"email\"\n\t\t\t\t\t\t\t\t\tclass=\"email\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Old Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"oldPassword\"\n\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">New Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"newPassword\"\n\t\t\t\t\t\t\t\t\tdojoType=\"plugins.admin.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\tclass=\"newPassword\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Confirm Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\tdojoType=\"plugins.admin.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\tclass=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END settings TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins","admin/css/settings.css"),],parentWidget:null,constructor:function(args){console.log("Settings.constructor     plugins.admin.Settings.constructor");this.parentWidget=args.parentWidget;this.settings=args.parentWidget.settings;this.loadCSS();},postCreate:function(){console.log("Controller.postCreate    plugins.admin.Controller.postCreate()");this.startup();},startup:function(){console.log("Settings.startup    plugins.admin.GroupSettings.startup()");console.log("Settings.startup    BEFORE inherited(arguments)");this.inherited(arguments);console.log("Settings.startup    AFTER inherited(arguments)");this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);console.log("Settings.startup    BEFORE dojo.connect");dojo.connect(this.updateUserButton,"onClick",dojo.hitch(this,"updateUser"));console.log("Settings.startup    AFTER dojo.connect");console.log("Settings.startup    this.confirmPassword: "+this.confirmPassword);this.confirmPassword.parentWidget=this;this.newPassword.parentWidget=this;this.newPassword.target=this.confirmPassword;this.initialiseSettings();},passwordsMatch:function(){console.log("Settings.confirmPassword    plugins.admin.GroupSettings.confirmPassword()");var _7e5=this.newPassword.textbox.value;console.log("Settings.confirmPassword    newPassword: "+_7e5);var _7e6=this.confirmPassword.textbox.value;console.log("Settings.confirmPassword    confirmPassword: "+_7e6);return _7e5==_7e6;},getInputValue:function(name){console.log("Settings.getInputValue    name: "+name);var _7e7=this[name];var _7e8=_7e7.get?_7e7.get("value"):_7e7;console.log("Settings.getInputValue    value: "+_7e8);_7e8=this.cleanEdges(_7e8);return _7e8;},getTextAreaValue:function(name){console.log("Settings.getTextAreaValue    name: "+name);var _7e9=this[name].value;_7e9=this.cleanEdges(_7e9);this[name].value=_7e9;return _7e9;},updateUser:function(_7ea){console.log("Settings.updateUser    plugins.admin.Settings.updateUser(event)");console.log("Settings.updateUser    event: "+_7ea);console.log("Settings.updateUser    this.savingUser: "+this.savingUser+". Returning.");if(this.savingUser==true){return;}this.savingUser=true;var _7eb=this.cleanEdges(this.oldPassword.value);var _7ec=this.cleanEdges(this.newPassword.value);var _7ed=this.cleanEdges(this.confirmPassword.value);if(!(_7eb==""&&_7ec==""&&_7ed=="")){if(_7eb==""){dojo.addClass(this.oldPassword,"invalid");}else{dojo.removeClass(this.oldPassword,"invalid");}if(_7ec==""){dojo.addClass(this.newPassword,"invalid");}else{dojo.removeClass(this.newPassword,"invalid");}if(_7ed==""){dojo.addClass(this.confirmPassword,"invalid");}else{dojo.removeClass(this.confirmPassword,"invalid");}if(_7eb==""||_7ec==""||_7ed==""){return;}}if(_7ec!=_7ed){console.log("Users.updateUser    passwords do not match. Adding class 'invalid'");dojo.addClass(this.newPassword,"invalid");dojo.addClass(this.confirmPassword,"invalid");console.log("Users.updateUser    Finished adding class 'invalid'");this.savingUser=false;return;}else{console.log("Users.updateUser    passwords match. Removing class 'invalid'");dojo.removeClass(this.newPassword,"invalid");dojo.removeClass(this.confirmPassword,"invalid");}var user=new Object;user.username=Agua.cookie("username");user.firstname=this.cleanEdges(this.firstname.value);user.lastname=this.cleanEdges(this.lastname.value);user.email=this.cleanEdges(this.email.value);user.oldpassword=_7eb;user.newpassword=_7ec;console.log("Settings.updateUser    user: "+dojo.toJson(user));var url=Agua.cgiUrl+"admin.cgi?";var _7ee=new Object;_7ee.username=Agua.cookie("username");_7ee.sessionId=Agua.cookie("sessionId");_7ee.mode="updateUser";_7ee.data=user;var _7ef=this;dojo.xhrPut({url:url,contentType:"text",handleAs:"json",putData:dojo.toJson(_7ee),timeout:15000,load:function(_7f0,_7f1){console.log("Settings.updateUser    response: "+_7f0);if(_7f0.error!=null){dojo.addClass(_7ef.oldPassword,"invalid");}},error:function(_7f2,_7f3){}});this.savingUser=false;},cleanEdges:function(_7f4){_7f4=_7f4.toString();if(_7f4==null||!_7f4.replace){return null;}_7f4=_7f4.replace(/^\s+/,"");_7f4=_7f4.replace(/\s+$/,"");return _7f4;},initialiseSettings:function(){console.log("Settings.initialiseSettings     plugins.admin.GroupSettings.initialiseSettings()");var _7f5=Agua.cookie("username");console.log("Settings.initialiseSettings     username: "+_7f5);this.username.innerHTML=_7f5;var user=Agua.getUser(_7f5);console.log("Settings.initialiseSettings     user: "+dojo.toJson(user));this.firstname.value=user["firstname"]||"";this.lastname.value=user["lastname"];this.email.value=user["email"];},reloadSettingsTabs:function(){console.log("Settings.reloadSettingsTabs    plugins.admin.Settings.reloadSettingsTabs()");console.log("Settings.reloadSettingsTabs    this.parentWidget: "+this.parentWidget);console.log("Settings.reloadSettingsTabs    this.parentWidget.paneWidgets: "+this.parentWidget.paneWidgets);var _7f6=["plugins.admin.GroupSettings"];for(var i in _7f6){if(this.parentWidget.paneWidgets[_7f6[i]]!=null){console.log("Settings.reloadSettingsTabs    this.parentWidget.paneWidgets['"+_7f6[i]+"']: "+this.parentWidget.paneWidgets[_7f6[i]]);this.parentWidget.paneWidgets[_7f6[i]].reload();}}},setTable:function(){console.log("Settings.setTable     plugins.admin.GroupSettings.setTable()");while(this.mainTable.firstChild){this.mainTable.removeChild(this.mainTable.firstChild);}},});}if(!dojo._hasResource["dijit.ToolbarSeparator"]){dojo._hasResource["dijit.ToolbarSeparator"]=true;dojo.provide("dijit.ToolbarSeparator");dojo.declare("dijit.ToolbarSeparator",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});}if(!dojo._hasResource["dijit.Toolbar"]){dojo._hasResource["dijit.Toolbar"]=true;dojo.provide("dijit.Toolbar");dojo.declare("dijit.Toolbar",[dijit._Widget,dijit._Templated,dijit._KeyNavContainer],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" dojoAttachPoint=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",postCreate:function(){this.inherited(arguments);this.connectKeyNavHandlers(this.isLeftToRight()?[dojo.keys.LEFT_ARROW]:[dojo.keys.RIGHT_ARROW],this.isLeftToRight()?[dojo.keys.RIGHT_ARROW]:[dojo.keys.LEFT_ARROW]);},startup:function(){if(this._started){return;}this.startupKeyNavChildren();this.inherited(arguments);}});}if(!dojo._hasResource["dojox.widget.Standby"]){dojo._hasResource["dojox.widget.Standby"]=true;dojo.provide("dojox.widget.Standby");dojo.experimental("dojox.widget.Standby");dojo.declare("dojox.widget.Standby",[dijit._Widget,dijit._Templated],{templateString:"<div>"+"<div style=\"display: none; opacity: 0; z-index: 9999; "+"position: absolute; cursor:wait;\" dojoAttachPoint=\"_underlayNode\"></div>"+"<img src=\"${image}\" style=\"opacity: 0; display: none; z-index: -10000; "+"position: absolute; top: 0px; left: 0px; cursor:wait;\" "+"dojoAttachPoint=\"_imageNode\">"+"<div style=\"opacity: 0; display: none; z-index: -10000; position: absolute; "+"top: 0px;\" dojoAttachPoint=\"_textNode\"></div>"+"</div>",_underlayNode:null,_imageNode:null,_textNode:null,_centerNode:null,image:dojo.moduleUrl("dojox","widget/Standby/images/loading.gif").toString(),imageText:"Please Wait...",text:"Please wait...",centerIndicator:"image",_displayed:false,_resizeCheck:null,target:"",color:"#C0C0C0",duration:500,_started:false,_parent:null,zIndex:"auto",startup:function(args){if(!this._started){if(typeof this.target==="string"){var w=dijit.byId(this.target);if(w){this.target=w.domNode;}else{this.target=dojo.byId(this.target);}}if(this.text){this._textNode.innerHTML=this.text;}if(this.centerIndicator==="image"){this._centerNode=this._imageNode;dojo.attr(this._imageNode,"src",this.image);dojo.attr(this._imageNode,"alt",this.imageText);}else{this._centerNode=this._textNode;}dojo.style(this._underlayNode,{display:"none",backgroundColor:this.color});dojo.style(this._centerNode,"display","none");this.connect(this._underlayNode,"onclick","_ignore");if(this.domNode.parentNode&&this.domNode.parentNode!=dojo.body()){dojo.body().appendChild(this.domNode);}if(dojo.isIE==7){this._ieFixNode=dojo.doc.createElement("div");dojo.style(this._ieFixNode,{opacity:"0",zIndex:"-1000",position:"absolute",top:"-1000px"});dojo.body().appendChild(this._ieFixNode);}}},show:function(){if(!this._displayed){if(this._anim){this._anim.stop();delete this._anim;}this._displayed=true;this._size();this._disableOverflow();this._fadeIn();}},hide:function(){if(this._displayed){if(this._anim){this._anim.stop();delete this._anim;}this._size();this._fadeOut();this._displayed=false;if(this._resizeCheck!==null){clearInterval(this._resizeCheck);this._resizeCheck=null;}}},isVisible:function(){return this._displayed;},onShow:function(){},onHide:function(){},uninitialize:function(){this._displayed=false;if(this._resizeCheck){clearInterval(this._resizeCheck);}dojo.style(this._centerNode,"display","none");dojo.style(this._underlayNode,"display","none");if(dojo.isIE==7){dojo.body().removeChild(this._ieFixNode);delete this._ieFixNode;}if(this._anim){this._anim.stop();delete this._anim;}this.target=null;this._imageNode=null;this._textNode=null;this._centerNode=null;this.inherited(arguments);},_size:function(){if(this._displayed){var dir=dojo.attr(dojo.body(),"dir");if(dir){dir=dir.toLowerCase();}var _7f7;var _7f8=this._scrollerWidths();var _7f9=this.target;var _7fa=dojo.style(this._centerNode,"display");dojo.style(this._centerNode,"display","block");var box=dojo.position(_7f9,true);if(_7f9===dojo.body()||_7f9===dojo.doc){box=dojo.window.getBox();box.x=box.l;box.y=box.t;}var _7fb=dojo.marginBox(this._centerNode);dojo.style(this._centerNode,"display",_7fa);if(this._ieFixNode){_7f7=-this._ieFixNode.offsetTop/1000;box.x=Math.floor((box.x+0.9)/_7f7);box.y=Math.floor((box.y+0.9)/_7f7);box.w=Math.floor((box.w+0.9)/_7f7);box.h=Math.floor((box.h+0.9)/_7f7);}var zi=dojo.style(_7f9,"zIndex");var ziUl=zi;var ziIn=zi;if(this.zIndex==="auto"){if(zi!="auto"){ziUl=parseInt(ziUl,10)+1;ziIn=parseInt(ziIn,10)+2;}else{var _7fc=_7f9.parentNode;var _7fd=-100000;while(_7fc&&_7fc!==dojo.body()){zi=dojo.style(_7fc,"zIndex");if(!zi||zi==="auto"){_7fc=_7fc.parentNode;}else{var _7fe=parseInt(zi,10);if(_7fd<_7fe){_7fd=_7fe;ziUl=_7fe+1;ziIn=_7fe+2;}_7fc=_7fc.parentNode;}}}}else{ziUl=parseInt(this.zIndex,10)+1;ziIn=parseInt(this.zIndex,10)+2;}dojo.style(this._centerNode,"zIndex",ziIn);dojo.style(this._underlayNode,"zIndex",ziUl);var pn=_7f9.parentNode;if(pn&&pn!==dojo.body()&&_7f9!==dojo.body()&&_7f9!==dojo.doc){var obh=box.h;var obw=box.w;var _7ff=dojo.position(pn,true);if(this._ieFixNode){_7f7=-this._ieFixNode.offsetTop/1000;_7ff.x=Math.floor((_7ff.x+0.9)/_7f7);_7ff.y=Math.floor((_7ff.y+0.9)/_7f7);_7ff.w=Math.floor((_7ff.w+0.9)/_7f7);_7ff.h=Math.floor((_7ff.h+0.9)/_7f7);}_7ff.w-=pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7f8.v:0;_7ff.h-=pn.scrollWidth>pn.clientWidth&&pn.clientWidth>0?_7f8.h:0;if(dir==="rtl"){if(dojo.isOpera){box.x+=pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7f8.v:0;_7ff.x+=pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7f8.v:0;}else{if(dojo.isIE){_7ff.x+=pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7f8.v:0;}else{if(dojo.isWebKit){}}}}if(_7ff.w<box.w){box.w=box.w-_7ff.w;}if(_7ff.h<box.h){box.h=box.h-_7ff.h;}var _800=_7ff.y;var _801=_7ff.y+_7ff.h;var bTop=box.y;var _802=box.y+obh;var _803=_7ff.x;var _804=_7ff.x+_7ff.w;var _805=box.x;var _806=box.x+obw;var _807;if(_802>_800&&bTop<_800){box.y=_7ff.y;_807=_800-bTop;var _808=obh-_807;if(_808<_7ff.h){box.h=_808;}else{box.h-=2*(pn.scrollWidth>pn.clientWidth&&pn.clientWidth>0?_7f8.h:0);}}else{if(bTop<_801&&_802>_801){box.h=_801-bTop;}else{if(_802<=_800||bTop>=_801){box.h=0;}}}if(_806>_803&&_805<_803){box.x=_7ff.x;_807=_803-_805;var _809=obw-_807;if(_809<_7ff.w){box.w=_809;}else{box.w-=2*(pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7f8.w:0);}}else{if(_805<_804&&_806>_804){box.w=_804-_805;}else{if(_806<=_803||_805>=_804){box.w=0;}}}}if(box.h>0&&box.w>0){dojo.style(this._underlayNode,{display:"block",width:box.w+"px",height:box.h+"px",top:box.y+"px",left:box.x+"px"});var _80a=["borderRadius","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"];this._cloneStyles(_80a);if(!dojo.isIE){_80a=["MozBorderRadius","MozBorderRadiusTopleft","MozBorderRadiusTopright","MozBorderRadiusBottomleft","MozBorderRadiusBottomright","WebkitBorderRadius","WebkitBorderTopLeftRadius","WebkitBorderTopRightRadius","WebkitBorderBottomLeftRadius","WebkitBorderBottomRightRadius"];this._cloneStyles(_80a,this);}var _80b=(box.h/2)-(_7fb.h/2);var _80c=(box.w/2)-(_7fb.w/2);if(box.h>=_7fb.h&&box.w>=_7fb.w){dojo.style(this._centerNode,{top:(_80b+box.y)+"px",left:(_80c+box.x)+"px",display:"block"});}else{dojo.style(this._centerNode,"display","none");}}else{dojo.style(this._underlayNode,"display","none");dojo.style(this._centerNode,"display","none");}if(this._resizeCheck===null){var self=this;this._resizeCheck=setInterval(function(){self._size();},100);}}},_cloneStyles:function(list){dojo.forEach(list,function(_80d){dojo.style(this._underlayNode,_80d,dojo.style(this.target,_80d));},this);},_fadeIn:function(){var self=this;var _80e=dojo.animateProperty({duration:self.duration,node:self._underlayNode,properties:{opacity:{start:0,end:0.75}}});var _80f=dojo.animateProperty({duration:self.duration,node:self._centerNode,properties:{opacity:{start:0,end:1}},onEnd:function(){self.onShow();delete self._anim;}});this._anim=dojo.fx.combine([_80e,_80f]);this._anim.play();},_fadeOut:function(){var self=this;var _810=dojo.animateProperty({duration:self.duration,node:self._underlayNode,properties:{opacity:{start:0.75,end:0}},onEnd:function(){dojo.style(this.node,{"display":"none","zIndex":"-1000"});}});var _811=dojo.animateProperty({duration:self.duration,node:self._centerNode,properties:{opacity:{start:1,end:0}},onEnd:function(){dojo.style(this.node,{"display":"none","zIndex":"-1000"});self.onHide();self._enableOverflow();delete self._anim;}});this._anim=dojo.fx.combine([_810,_811]);this._anim.play();},_ignore:function(_812){if(_812){dojo.stopEvent(_812);}},_scrollerWidths:function(){var div=dojo.doc.createElement("div");dojo.style(div,{position:"absolute",opacity:0,overflow:"hidden",width:"50px",height:"50px",zIndex:"-100",top:"-200px",left:"-200px",padding:"0px",margin:"0px"});var iDiv=dojo.doc.createElement("div");dojo.style(iDiv,{width:"200px",height:"10px"});div.appendChild(iDiv);dojo.body().appendChild(div);var b=dojo.contentBox(div);dojo.style(div,"overflow","scroll");var a=dojo.contentBox(div);dojo.body().removeChild(div);return {v:b.w-a.w,h:b.h-a.h};},_setTextAttr:function(text){this._textNode.innerHTML=text;this.text=text;},_setColorAttr:function(c){dojo.style(this._underlayNode,"backgroundColor",c);this.color=c;},_setImageTextAttr:function(text){dojo.attr(this._imageNode,"alt",text);this.imageText=text;},_setImageAttr:function(url){dojo.attr(this._imageNode,"src",url);this.image=url;},_setCenterIndicatorAttr:function(_813){this.centerIndicator=_813;if(_813==="image"){this._centerNode=this._imageNode;dojo.style(this._textNode,"display","none");}else{this._centerNode=this._textNode;dojo.style(this._imageNode,"display","none");}},_disableOverflow:function(){if(this.target===dojo.body()||this.target===dojo.doc){this._overflowDisabled=true;var body=dojo.body();if(body.style&&body.style.overflow){this._oldOverflow=dojo.style(body,"overflow");}else{this._oldOverflow="";}if(dojo.isIE&&!dojo.isQuirks){if(body.parentNode&&body.parentNode.style&&body.parentNode.style.overflow){this._oldBodyParentOverflow=body.parentNode.style.overflow;}else{try{this._oldBodyParentOverflow=dojo.style(body.parentNode,"overflow");}catch(e){this._oldBodyParentOverflow="scroll";}}dojo.style(body.parentNode,"overflow","hidden");}dojo.style(body,"overflow","hidden");}},_enableOverflow:function(){if(this._overflowDisabled){delete this._overflowDisabled;var body=dojo.body();if(dojo.isIE&&!dojo.isQuirks){body.parentNode.style.overflow=this._oldBodyParentOverflow;delete this._oldBodyParentOverflow;}dojo.style(body,"overflow",this._oldOverflow);if(dojo.isWebKit){var div=dojo.create("div",{style:{height:"2px"}});body.appendChild(div);setTimeout(function(){body.removeChild(div);},0);}delete this._oldOverflow;}}});}if(!dojo._hasResource["plugins.core.Updater"]){dojo._hasResource["plugins.core.Updater"]=true;dojo.provide("plugins.core.Updater");dojo.declare("plugins.core.Updater",null,{loadedCssFiles:null,updates:null,constructor:function(){this.startup();},startup:function(){this.updates=new Object;},subscribe:function(_814,_815){if(_814[_815]==null){return;}if(this.updates[_815]==null){this.updates[_815]=new Array;}for(currentSubscriber in this.updates[_815]){if(currentSubscriber==_814){return;}}this.updates[_815].push(_814);},update:function(_816,args){console.log("core.Updater.update    subscription: "+_816);console.log("core.Updater.update    args: ");console.dir(args);var _817=this.getSubscribers(_816);console.log("core.Updater.update    subscribers: ");console.dir({subscribers:_817});for(var i in _817){var _818=_817[i];console.log("core.Updater.update    subscriber: ");console.dir({subscriber:_818});_818[_816](args);}},getSubscribers:function(_819){return this.updates[_819];},unsubscribe:function(_81a,_81b){if(_81a[_81b]==null){return;}if(this.updates[_81b]==null){this.updates=new Array;}for(var i=0;i<this.updates[_81b].length;i++){if(this.updates[_81b][i]==_81a){this.updates[_81b].splice(i,1);break;}}}});}if(!dojo._hasResource["plugins.core.Agua.Data"]){dojo._hasResource["plugins.core.Agua.Data"]=true;dojo.provide("plugins.core.Agua.Data");dojo.declare("plugins.core.Agua.Data",[],{cloneData:function(name){var _81c=this.cloneData.caller.nom;if(this.data[name]!=null){return dojo.clone(this.data[name]);}else{return [];}},getData:function(name){if(this.data[name]==null){this.data[name]=[];}return this.data[name];},setData:function(name,_81d){this.data[name]=_81d;},addData:function(name,_81e,keys){return this._addObjectToArray(this.data[name],_81e,keys);},removeData:function(name,_81f,keys){return this._removeObjectFromArray(this.data[name],_81f,keys);},removeArrayFromData:function(name,_820,keys){return this._removeArrayFromArray(this.data[name],_820,keys);},addArrayToData:function(name,_821,keys){return this._addArrayToArray(this.data[name],_821,keys);},removeObjectsFromData:function(name,_822,keys){console.log("Data.removeObjectsFromData    BEFORE REMOVE, this.data["+name+"]");console.dir({this_data:this.data[name]});return this._removeObjectsFromArray(this.data[name],_822,keys);},sortData:function(name,key){this.sortHasharray(this.getData(name),key);},loadData:function(data){Agua.data=dojo.clone(data);},});}if(!dojo._hasResource["plugins.core.Agua.Admin"]){dojo._hasResource["plugins.core.Agua.Admin"]=true;dojo.provide("plugins.core.Agua.Admin");dojo.declare("plugins.core.Agua.Admin",[],{getAdminHeadings:function(){console.log("Agua.Admin.getAdminHeadings    plugins.core.Data.getAdminHeadings()");var _823=this.cloneData("adminheadings");console.log("Agua.Admin.getAdminHeadings    headings: "+dojo.toJson(_823));return _823;},getAccess:function(){return this.cloneData("access");}});}if(!dojo._hasResource["plugins.core.Agua.App"]){dojo._hasResource["plugins.core.Agua.App"]=true;dojo.provide("plugins.core.Agua.App");dojo.declare("plugins.core.Agua.App",[],{getApps:function(){return this.cloneData("apps");},getAppTypes:function(apps){var _824=new Object;for(var i=0;i<apps.length;i++){_824[apps[i].type]=1;}var _825=this.hashkeysToArray(_824);_825=this.sortNoCase(_825);return _825;},getAppType:function(_826){console.log("Agua.App.getAppType    plugins.core.Data.getAppType(appName)");var apps=this.cloneData("apps");for(var i in apps){var app=apps[i];if(app.name.toLowerCase()==_826.toLowerCase()){return app.type;}}return null;},hasApps:function(){if(this.getData("apps").length==0){return false;}return true;},addApp:function(_827){console.log("Agua.App.addApp    plugins.core.Data.addApp(appObject)");var _828=this.addData("apps",_827,["name"]);if(_828==true){this.sortData("apps","name");}return _828;},removeApp:function(_829){console.log("Agua.App.removeApp    plugins.core.Data.removeApp(appObject)");var _82a=this.removeData("apps",_829,["name"]);return _82a;},isApp:function(_82b){console.log("Agua.App.isApp    plugins.core.Data.isApp(appName, appObject)");console.log("Agua.App.isApp    appName: *"+_82b+"*");var apps=this.getApps();for(var i in apps){var app=apps[i];console.log("Agua.App.isApp    Checking app.name: *"+app.name+"*");if(app.name.toLowerCase()==_82b.toLowerCase()){return true;}}return false;}});}if(!dojo._hasResource["plugins.core.Agua.Aws"]){dojo._hasResource["plugins.core.Agua.Aws"]=true;dojo.provide("plugins.core.Agua.Aws");dojo.declare("plugins.core.Agua.Aws",[],{getAws:function(){return this.cloneData("aws");},setAws:function(aws){console.log("Agua.Aws.setAws    plugins.core.Data.setAws(aws)");console.log("Agua.Aws.setAws    aws: "+dojo.toJson(aws));if(aws==null){console.log("Agua.Aws.setAws    aws is null. Returning");return;}if(aws.amazonuserid==null){console.log("Agua.Aws.setAws    aws.amazonuserid is null. Returning");return;}this.setData("aws",aws);return aws;},getAvailzonesByRegion:function(_82c){if(_82c==null){return;}var _82d=this.cloneData("regionzones");if(_82d[_82c]!=null){return _82d[_82c];}return [];}});}if(!dojo._hasResource["plugins.core.Agua.Cluster"]){dojo._hasResource["plugins.core.Agua.Cluster"]=true;dojo.provide("plugins.core.Agua.Cluster");dojo.declare("plugins.core.Agua.Cluster",[],{getClusterObject:function(_82e){console.log("Agua.Cluster.getClusterObject    plugins.core.Data.getClusterObject(clusterName)");console.log("Agua.Cluster.getClusterObject    clusterName: "+_82e);var _82f=this.getClusters();console.log("Agua.Cluster.getClusterObject    clusters: "+dojo.toJson(_82f));if(_82f==null){return [];}var _830=["cluster"];var _831=[_82e];_82f=this.filterByKeyValues(_82f,_830,_831);console.log("Agua.Cluster.getClusterObject    FILTERED clusters: "+dojo.toJson(_82f));if(_82f!=null&&_82f.length!=0){return _82f[0];}return null;},getClusters:function(){return this.cloneData("clusters");},getClusterByWorkflow:function(_832,_833){var _834=this.cloneData("clusterworkflows");_834=this.filterByKeyValues(_834,["project","workflow"],[_832,_833]);if(_834!=null&&_834.length>0){return _834[0].cluster;}return null;},isClusterWorkflow:function(_835){var _836=this.cloneData("clusterworkflows");_836=this.filterByKeyValues(_836,["project","workflow","cluster"],[_835.project,_835.workflow,_835.cluster]);if(_836!=null&&_836.length>0){return 1;}return 0;},getClusterObjectByWorkflow:function(_837,_838){var _839=this.getClusterByWorkflow(_837,_838);if(_839==null||!_839){return null;}console.log("Agua.Cluster.getClusterObjectByWorkflow    clusterName: "+_839);return this.getClusterObject(_839);},getClusterLongName:function(_83a){var _83b=this.cookie("username");var _83c="";if(_83a!=null&&_83a){_83c=_83b+"-"+_83a;}return _83c;},isCluster:function(_83d){var _83e=this.getClusters();var _83f=this._objectInArray(_83e,{cluster:_83d},["cluster"]);return _83f;},addCluster:function(_840){this._removeCluster(_840);this._addCluster(_840);var url=this.cgiUrl+"workflow.cgi?";_840.username=this.cookie("username");_840.sessionId=this.cookie("sessionId");_840.mode="addCluster";console.log("Agua.Cluster.addCluster    clusterObject: "+dojo.toJson(_840));this.doPut({url:url,query:_840,sync:false,timeout:15000});},newCluster:function(_841){console.log("Agua.Cluster.newCluster    core.Data.newCluster(clusterObject)");console.log("Agua.Cluster.newCluster    clusterObject: "+dojo.toJson(_841));this._removeCluster(_841);this._addCluster(_841);var url=this.cgiUrl+"workflow.cgi?";_841.username=this.cookie("username");_841.sessionId=this.cookie("sessionId");_841.mode="newCluster";console.log("Agua.Cluster.newCluster    clusterObject: "+dojo.toJson(_841));this.doPut({url:url,query:_841,sync:false,timeout:15000,callback:dojo.hitch(this,"toast")});},removeCluster:function(_842){var _843=this._removeCluster(_842);if(_843==false){console.log("this.removeCluster    this._removeCluster(clusterObject) returned false for cluster: "+_842.cluster);return;}var url=this.cgiUrl+"workflow.cgi?";_842.username=this.cookie("username");_842.sessionId=this.cookie("sessionId");_842.mode="removeCluster";console.log("this.removeCluster    clusterObject: "+dojo.toJson(_842));this.doPut({url:url,query:_842,sync:false,timeout:15000});},_removeCluster:function(_844){console.log("Agua.Cluster._removeCluster    plugins.core.Data._removeCluster(clusterObject)");console.log("Agua.Cluster._removeCluster    clusterObject: "+dojo.toJson(_844));var _845=["cluster"];return this.removeData("clusters",_844,_845);},_addCluster:function(_846){console.log("Agua.Cluster._addCluster    plugins.core.Data._addCluster(clusterObject)");var _847=["cluster"];return this.addData("clusters",_846,_847);},_removeClusterWorkflow:function(_848){console.log("Agua.Cluster._removeClusterWorkflow    plugins.core.Data._removeClusterWorkflow(clusterObject)");var _849=["project","workflow"];return this.removeData("clusterworkflows",_848,_849);},_addClusterWorkflow:function(_84a){console.log("Agua.Cluster._addClusterWorkflow    plugins.core.Data._addClusterWorkflow(clusterObject)");console.log("Agua.Cluster._addClusterWorkflow    clusterObject: "+dojo.toJson(_84a));var _84b=["cluster","project","workflow"];return this.addData("clusterworkflows",_84a,_84b);},getAmis:function(){return this.cloneData("amis");},getAmiObjectById:function(_84c){var amis=this.getAmis();return this._getObjectByKeyValue(amis,["amiid"],_84c);},addAmi:function(_84d){this._removeAmi(_84d);this._addAmi(_84d);var url=this.cgiUrl+"workflow.cgi?";_84d.username=this.cookie("username");_84d.sessionId=this.cookie("sessionId");_84d.mode="addAmi";console.log("Agua.Cluster.addAmi    amiObject: "+dojo.toJson(_84d));this.doPut({url:url,query:_84d,sync:false,timeout:15000});},removeAmi:function(_84e){console.log("Agua.Cluster.removeAmi    Agua.removeAmi(amiObject)");var _84f=this._removeAmi(_84e);if(_84f==false){console.log("this.removeAmi    this._removeAmi(amiObject) returned false for ami: "+_84e.ami);return;}var url=this.cgiUrl+"sharing.cgi?";_84e.username=this.cookie("username");_84e.sessionId=this.cookie("sessionId");_84e.mode="removeAmi";this.doPut({url:url,query:_84e,sync:false,timeout:15000});},_removeAmi:function(_850){console.log("Agua.Cluster._removeAmi    plugins.core.Data._removeAmi(amiObject)");var _851=["amiid"];return this.removeData("amis",_850,_851);},_addAmi:function(_852){console.log("Agua.Cluster._addAmi    plugins.core.Data._addAmi(amiObject)");var _853=["amiid"];return this.addData("amis",_852,_853);}});}if(!dojo._hasResource["plugins.core.Agua.Feature"]){dojo._hasResource["plugins.core.Agua.Feature"]=true;dojo.provide("plugins.core.Agua.Feature");dojo.declare("plugins.core.Agua.Feature",[],{getViewFeatures:function(_854,_855){if(_854==null||!_854){return;}var _856=this.cloneData("viewfeatures");var _857=["project","view"];var _858=[_854,_855];_856=this.filterByKeyValues(_856,_857,_858);return _856;},hasViewFeature:function(_859,_85a,_85b){var _85c=this.getViewFeatures(_859,_85a);if(_85c==null||_85c==[]){return;}var _85d={project:_859,view:_85a,feature:_85b};var keys=["project","view","feature"];return this._objectInArray(_85c,_85d,keys);},getFeatureProjects:function(){var _85e=this.cloneData("features");var _85f=this.hashArrayKeyToArray(_85e,"project");console.log("Agua.Feature.getFeatureProjects     projects: ");console.dir({projects:_85f});_85f=this.uniqueValues(_85f);return _85f;},getViewProjectWorkflows:function(_860){if(_860==null||!_860){console.log("Agua.Feature.getViewProjectWorkflows     projectName is null or empty. Returning");return;}var _861=this.cloneData("features");var _862=["project"];var _863=[_860];_861=this.filterByKeyValues(_861,_862,_863);var _864=new Array;for(var i=0;i<_861.length;i++){_864.push(_861[i].workflow);}_864=this.uniqueValues(_864);return _864;},getViewWorkflowFeatures:function(_865,_866){var _867=this.cloneData("features");var _868=["project","workflow"];var _869=[_865,_866];_867=this.filterByKeyValues(_867,_868,_869);return _867;},getViewSpeciesFeatureNames:function(_86a,_86b,_86c,_86d){var _86e=this.getViewSpeciesFeatures(_86a,_86b,_86c,_86d);var _86f=new Array;for(var i=0;i<_86e.length;i++){_86f.push(_86e[i].feature);}_86f=this.uniqueValues(_86f);return _86f;},getViewSpeciesFeatures:function(_870,_871,_872,_873){if(_870==null||!_870||_871==null||!_871||_872==null||!_872){console.log("Agua.Feature.getViewSpeciesFeatures     projectName is null or empty. Returning");return;}var _874=this.cloneData("features");var _875=["project","workflow","species","build"];var _876=[_870,_871,_872,_873];_874=this.filterByKeyValues(_874,_875,_876);return _874;},_removeViewFeature:function(_877){var _878=["project","view","feature"];var _879=Agua.removeData("viewfeatures",_877,_878);if(!_879){return;}var _87a=Agua.getViewObject(_877.project,_877.view);var _87b=_87a.tracklist;console.log("Agua.Feature.removeViewFeature    BEFORE tracklist: "+dojo.toJson(_87b));var _87c=_87b.split(/,/);for(var i=0;i<_87c.length;i++){if(_87c[i]==_877.feature){console.log("matched feature in array["+i+"]: "+_87c[i]);_87c.splice(i,1);}}_87b=_87c.join(",");_87a.tracklist=_87b;console.log("Agua.Feature.removeViewFeature    AFTER tracklist: "+dojo.toJson(_87b));Agua.removeData("views",_87a,["project","view"]);Agua.addData("views",_87a,["project","view"]);views=Agua.getData("views");console.dir({views:views});return true;},isFeature:function(_87d){var _87e=this.getViewFeatures(_87d.project,_87d.view);if(this._objectInArray(_87e,_87d,["project","view","feature","species","build"])){return true;}return false;},_addViewFeature:function(_87f){if(this.isFeature(_87f)){return;}var _880=["project","view","feature","species","build"];return this.addData("viewfeatures",_87f,_880);}});}if(!dojo._hasResource["plugins.core.Agua.File"]){dojo._hasResource["plugins.core.Agua.File"]=true;dojo.provide("plugins.core.Agua.File");dojo.declare("plugins.core.Agua.File",[],{getFoldersUrl:function(){return Agua.cgiUrl+"folders.cgi?";},setFileCaches:function(url){console.log("Agua.File.setFileCache    url: "+url);var _881=dojo.hitch(this,function(data){this.setData("filecaches",data);});this.fetchJson(url,_881);},fetchJson:function(url,_882){console.log("Agua.File.fetchJson    url: "+url);var _883=this;dojo.xhrGet({url:url,sync:false,handleAs:"json",handle:function(data){_882(data);},error:function(_884){console.log("Agua.File.fetchJson    Error with JSON Post, response: "+_884);}});},getFileCache:function(_885,_886){console.log("Agua.File.getFileCache    username: "+_885);console.log("Agua.File.getFileCache    location: "+_886);var _887=this.cloneData("filecaches");console.log("Agua.File.getFileCache    fileCaches: ");console.dir({fileCaches:_887});if(!_887[_885]){return null;}return _887[_885][_886];},setFileCache:function(_888,_889,item){console.log("Agua.File.setFileCache    username: "+_888);console.log("Agua.File.setFileCache    location: "+_889);console.log("Agua.File.setFileCache    item: ");console.dir({item:item});var _88a=this.getData("filecaches");if(!_88a){_88a={};}if(!_88a[_888]){_88a[_888]={};}_88a[_888][_889]=item;var _88b=this.getParentDir(_889);console.log("Agua.File.setFileCache    parentDir: "+_88b);if(!_88b){return;}var _88c=_88a[_888][_88b];if(!_88c){return;}console.log("Agua.File.setFileCache    parent: "+_88c);this.addItemToParent(_88c,item);console.log("Agua.File.setFileCache    parent: "+_88c);console.dir({parent:_88c});},addItemToParent:function(_88d,item){_88d.items.push(item);},getFileSystem:function(_88e,_88f,_890){console.log("Agua.File.getFileSystem    caller: "+this.getFileSystem.caller.nom);console.log("Agua.File.getFileSystem    putData:");console.dir({putData:_88e});console.log("Agua.File.getFileSystem    callback: "+_88f);console.dir({callback:_88f});console.log("Agua.File.getFileSystem    request:");console.dir({request:_890});if(!_890){_890=new Array;}var _891="";if(_88e.location||_88e.query){_891=_88e.query||_88e.location;}console.log("Agua.File.getFileSystem    location: "+_891);var _892=_88e.username;console.log("Agua.File.getFileSystem    username: "+_892);var _893=this.getFileCache(_892,_891);console.log("Agua.File.getFileSystem    fileCache:");console.dir({fileCache:_893});if(_893){console.log("Agua.File.getFileSystem    fileCache IS DEFINED. Doing setTimeout callback(fileCache, request)");setTimeout(function(){_88f(_893,_890);},10,this);return;}else{console.log("Agua.File.getFileSystem    fileCache NOT DEFINED. Doing remote query");this.queryFileSystem(_88e,_88f,_890);}},queryFileSystem:function(_894,_895,_896){console.log("Agua.File.queryFileSystem    putData:");console.dir({putData:_894});console.log("Agua.File.queryFileSystem    callback:");console.dir({callback:_895});console.log("Agua.File.queryFileSystem    request:");console.dir({request:_896});var _897="";if(_894.location||_894.query){_897=_894.query;}if(!_894.path&&_897){_894.path=_897;}console.log("Agua.File.queryFileSystem    location: "+_897);var _898=_894.username;var url=this.cgiUrl+"folders.cgi";var _899=this;var _89a={url:url,contentType:"text",sync:false,preventCache:true,handleAs:"json-comment-optional",putData:dojo.toJson(_894),handle:function(_89b){console.log("Agua.File.queryFileSystem    handle response:");console.dir({response:_89b});_899.setFileCache(_898,_897,dojo.clone(_89b));_895(_89b,_896);}};var _89c=dojo.xhrPut(_89a);_89c.addCallback(_895);var _89d=_896.scope||dojo.global;_89c.addErrback(function(_89e){if(_896.onError){_896.onError.call(_89d,_89e,_896);}});},removeFileTree:function(_89f,_8a0){console.log("Agua.File.removeFileTree    username: "+_89f);console.log("Agua.File.removeFileTree    location: "+_8a0);var _8a1=this.getData("filecaches");console.log("Agua.File.removeFileTree    fileCaches: ");console.dir({fileCaches:_8a1});if(!_8a1){console.log("Agua.File.removeFileTree    fileCaches is null. Returning");return;}var _8a2=_8a1[_89f];console.log("Agua.File.removeFileTree    rootTree: ");console.dir({rootTree:_8a2});if(!_8a2){console.log("Agua.File.removeFileTree    rootTree is null. Returning");return;}for(var _8a3 in _8a1[_89f]){if(_8a3.match("^"+_8a0+"$")||_8a3.match("^"+_8a0+"/")){console.log("Agua.File.removeFileTree    DELETING fileRoot: "+_8a3);}}if(!_8a0.match(/^(.+)\/[^\/]+$/)){console.log("Agua.File.removeFileTree    No parentDir. Returning");return;}var _8a4=_8a0.match(/^(.+)\/[^\/]+$/)[1];var _8a5=_8a0.match(/^.+\/([^\/]+)$/)[1];console.log("Agua.File.removeFileTree    parentDir: "+_8a4);console.log("Agua.File.removeFileTree    child: "+_8a5);this.removeItemFromParent(_8a1[_89f][_8a4],_8a5);var _8a6=_8a1[_89f][_8a4];console.log("Agua.File.removeFileTree    project1: "+_8a6);console.dir({project1:_8a6});console.log("Agua.File.removeFileTree    END");},removeItemFromParent:function(_8a7,_8a8){for(i=0;i<_8a7.items.length;i++){var _8a9=_8a7.items[i];if(_8a9.name==_8a8){_8a7.items.splice(i,1);break;}}},removeRemoteFile:function(_8aa,_8ab,_8ac){console.log("Agua.File.removeRemoteFile    username: "+_8aa);console.log("Agua.File.removeRemoteFile    location: "+_8ab);console.log("Agua.File.removeRemoteFile    callback: "+_8ac);var url=this.getFoldersUrl();var _8ad=new Object;_8ad.mode="removeFile";_8ad.sessionId=Agua.cookie("sessionId");_8ad.username=Agua.cookie("username");_8ad.file=_8ab;var _8ae=this;dojo.xhrPut({url:url,putData:dojo.toJson(_8ad),handleAs:"json",sync:false,handle:function(_8af){if(_8ac){_8ac(_8af);}}});},renameFileTree:function(_8b0,_8b1,_8b2){console.log("Agua.File.renameFileTree    username: "+_8b0);console.log("Agua.File.renameFileTree    oldLocation: "+_8b1);console.log("Agua.File.renameFileTree    newLocation: "+_8b2);var _8b3=this.getData("filecaches");console.log("Agua.File.renameFileTree    fileCaches: ");console.dir({fileCaches:_8b3});if(!_8b3){console.log("Agua.File.renameFileTree    fileCaches is null. Returning");return;}var _8b4=_8b3[_8b0];console.log("Agua.File.renameFileTree    rootTree: ");console.dir({rootTree:_8b4});if(!_8b4){console.log("Agua.File.renameFileTree    rootTree is null. Returning");return;}for(var _8b5 in _8b3[_8b0]){if(_8b5.match("^"+_8b1+"$")||_8b5.match("^"+_8b1+"/")){console.log("Agua.File.renameFileTree    DELETING fileRoot: "+_8b5);var _8b6=_8b3[_8b0][_8b5];var re=new RegExp("^"+_8b1);var _8b7=_8b5.replace(re,_8b2);console.log("Agua.File.renameFileTree    ADDING newRoot: "+_8b7);delete _8b3[_8b0][_8b5];_8b3[_8b0][_8b7]=_8b6;}}var _8b8=this.getParentDir(_8b1);if(!_8b8){return;}console.log("Agua.File.renameFileTree    Doing this.renameItemInParent()");var _8b9=this.getChild(_8b1);var _8ba=_8b2.match(/^.+\/([^\/]+)$/)[1];console.log("Agua.File.renameFileTree    parentDir: "+_8b8);console.log("Agua.File.renameFileTree    child: "+_8b9);console.log("Agua.File.renameFileTree    newChild: "+_8ba);var _8bb=_8b3[_8b0][_8b8];this.renameItemInParent(_8bb,_8b9,_8ba);console.log("Agua.File.renameFileTree    parent: "+_8bb);console.dir({parent:_8bb});console.log("Agua.File.renameFileTree    END");},renameItemInParent:function(_8bc,_8bd,_8be){for(i=0;i<_8bc.items.length;i++){var _8bf=_8bc.items[i];if(_8bf.name==_8bd){var re=new RegExp(_8bd+"$");_8bc.items[i].name=_8bc.items[i].name.replace(re,_8be);console.log("Agua.File.renameItemInParent    NEW parent.items["+i+"].name: "+_8bc.items[i].name);_8bc.items[i].path=_8bc.items[i].path.replace(re,_8be);console.log("Agua.File.repathItemInParent    NEW parent.items["+i+"].path: "+_8bc.items[i].path);break;}}},getParentDir:function(_8c0){if(!_8c0.match(/^(.+)\/[^\/]+$/)){return null;}return _8c0.match(/^(.+)\/[^\/]+$/)[1];},getChild:function(_8c1){if(!_8c1.match(/^.+\/([^\/]+)$/)){return null;}return _8c1.match(/^.+\/([^\/]+)$/)[1];},isDirectory:function(_8c2,_8c3){var _8c4=this.getFileCache(_8c2,_8c3);console.log("Agua.File.isDirectory    username: "+_8c2);console.log("Agua.File.isDirectory    location: "+_8c3);console.log("Agua.File.isDirectory    fileCache: ");console.dir({fileCache:_8c4});if(_8c4){return _8c4.directory;}return null;},isFileCacheItem:function(_8c5,_8c6,_8c7){console.log("Agua.isFileCacheItem     username: "+_8c5);console.log("Agua.isFileCacheItem     directory: "+_8c6);console.log("Agua.isFileCacheItem     itemName: "+_8c7);var _8c8=this.getFileCache(_8c5,_8c6);console.log("Agua.isFileCacheItem     fileCache: "+_8c8);console.dir({fileCache:_8c8});if(!_8c8||!_8c8.items){return false;}for(var i=0;i<_8c8.items.length;i++){if(_8c8.items[i].name==_8c7){return true;}}return false;},renameFile:function(_8c9,_8ca){var url=this.getFoldersUrl();var _8cb=new Object;_8cb.mode="renameFile";_8cb.sessionId=Agua.cookie("sessionId");_8cb.username=Agua.cookie("username");_8cb.oldpath=_8c9;_8cb.newpath=_8ca;this.doPut({url:url,query:_8cb,sync:false});},createFolder:function(_8cc){var url=this.getFoldersUrl();var _8cd=new Object;_8cd.mode="newFolder";_8cd.sessionId=Agua.cookie("sessionId");_8cd.username=Agua.cookie("username");_8cd.folderpath=_8cc;this.doPut({url:url,query:_8cd,sync:false});},getFileInfo:function(_8ce,_8cf){if(_8cf!=null){console.log("Agua.File.getFileInfo    fileinfo parameter is present. Should you be using setFileInfo instead?. Returning null.");return null;}return this._fileInfo(_8ce,_8cf);},setFileInfo:function(_8d0,_8d1){if(!_8d0){return;}if(_8d1==null){console.log("Agua.File.setFileInfo    fileinfo is null. Returning null.");return null;}return this._fileInfo(_8d0,_8d1);},_fileInfo:function(_8d2,_8d3){console.log("Agua.File._fileInfo    plugins.core.Data._fileInfo()");console.log("Agua.File._fileInfo    stageParameterObject: ");console.dir({stageParameterObject:_8d2});console.log("Agua.File._fileInfo    fileinfo: ");console.dir({fileinfo:_8d3});var _8d4=["username","project","workflow","appname","appnumber","name","paramtype"];var _8d5=new Array;for(var i=0;i<_8d4.length;i++){_8d5.push(_8d2[_8d4[i]]);}var _8d6=this.getEntry(this.cloneData("stageparameters"),_8d4,_8d5);console.log("Agua.File._fileInfo    stageParameter found: ");console.dir({stageParameter:_8d6});if(_8d6==null){console.log("Agua.File._fileInfo    stageParameter is null. Returning null");return null;}if(_8d3==null){console.log("Agua.File._fileInfo    DOING the GETTER. Returning stageParameter.exists: "+_8d6.fileinfo.exists);return _8d6.fileinfo.exists;}console.log("Agua.File._fileInfo    DOING the SETTER");_8d6.fileinfo=_8d3;var _8d7=this._removeStageParameter(_8d6);if(_8d7==false){console.log("Agua.File._fileInfo    Could not remove stage parameter. Returning null");return null;}console.log("Agua.File._fileInfo    \tBEFORE success = this._addStageParameter(stageParameter)");_8d7=this._addStageParameter(_8d6);if(_8d7==false){console.log("Agua.File._fileInfo    Could not add stage parameter. Returning null");return null;}return true;},getParameterValidity:function(_8d8,_8d9){if(_8d9!=null){return null;}var _8da=this._parameterValidity(_8d8,_8d9);return _8da;},setParameterValidity:function(_8db,_8dc){if(_8dc==null){return null;}var _8dd=this._parameterValidity(_8db,_8dc);return _8dd;},_parameterValidity:function(_8de,_8df){var _8e0=["project","workflow","appname","appnumber","name","paramtype"];var _8e1=new Array;for(var i=0;i<_8e0.length;i++){_8e1.push(_8de[_8e0[i]]);}var _8e2=this.getEntry(this._getStageParameters(),_8e0,_8e1);if(_8e2==null){return null;}if(_8df==null){return _8e2.isValid;}_8e2.isValid=_8df;var _8e3=this._removeStageParameter(_8e2);if(_8e3==false){return null;}_8e3=this._addStageParameter(_8e2);if(_8e3==false){return null;}return true;}});}if(!dojo._hasResource["plugins.core.Agua.Group"]){dojo._hasResource["plugins.core.Agua.Group"]=true;dojo.provide("plugins.core.Agua.Group");dojo.declare("plugins.core.Agua.Group",[],{getGroups:function(){console.log("Agua.Group.getGroups    plugins.core.Data.getGroups()");return this.cloneData("groups");},addGroup:function(_8e4){console.log("Agua.Group.addGroup    plugins.core.Data.addGroup(groupObject)");console.log("Agua.Group.addGroup    groupObject: "+dojo.toJson(_8e4));this.removeData("groups",_8e4,["groupname"]);if(!this.addData("groups",_8e4,["groupname"])){return;}this.sortData("groups","groupname");_8e4.groupname=this.jsonSafe(_8e4.groupname,"toJson");_8e4.description=this.jsonSafe(_8e4.description,"toJson");_8e4.notes=this.jsonSafe(_8e4.notes,"toJson");var url=Agua.cgiUrl+"sharing.cgi?";var _8e5=new Object;_8e5.username=this.cookie("username");_8e5.sessionId=this.cookie("sessionId");_8e5.mode="addGroup";_8e5.data=_8e4;this.doPut({url:url,query:_8e5});if(Agua.isAccess(_8e4)){return;}var _8e6=new Object;_8e6.groupname=_8e4.groupname;_8e6.owner=this.cookie("username");_8e6.groupwrite=0;_8e6.groupcopy=1;_8e6.groupview=1;_8e6.worldwrite=0;_8e6.worldcopy=0;_8e6.worldview=0;console.log("Agua.Group.addGroup    Adding accessObject: "+dojo.toJson(_8e6));this.addData("access",_8e6,["groupname"]);this.sortData("access","groupname");},removeGroup:function(_8e7){console.log("Agua.Group.removeGroup    plugins.core.Data.removeGroup(groupObject)");console.log("Agua.Group.removeGroup    groupObject: "+dojo.toJson(_8e7));if(!this._removeGroup(_8e7)){return;}this.sortData("groups","groupname");this._removeAccess(_8e7);this._removeGroupMembers(_8e7);var url=Agua.cgiUrl+"sharing.cgi?";var _8e8=new Object;_8e8.username=this.cookie("username");_8e8.sessionId=this.cookie("sessionId");_8e8.mode="removeGroup";_8e8.data=_8e7;this.doPut({url:url,query:_8e8,sync:false});},_removeGroup:function(_8e9){return this.removeData("groups",_8e9,["groupname"]);},_removeGroupMembers:function(_8ea){console.log("Agua.Group._removeGroupMembers    plugins.core.Data._removeGroupMembers(groupObject)");console.log("Agua.Group._removeGroupMembers    groupObject: "+dojo.toJson(_8ea));return this._removeObjectsFromData("groupmembers",_8ea,["groupname"]);},_removeAccess:function(_8eb){this.removeData("access",_8eb,["groupname"]);},isAccess:function(_8ec){var _8ed=this.cloneData(_8ed);return this._objectInArray(_8ed,_8ec,["groupname"]);},isGroup:function(_8ee){console.log("Agua.Group.isGroup    plugins.core.Data.isGroup(groupObject, groupObject)");console.log("Agua.Group.isGroup    groupObject: "+dojo.toJson(_8ee));var _8ef=this.getGroups();if(this._getIndexInArray(_8ef,_8ee,["groupname"])){return true;}return false;},getGroupNames:function(){console.log("Agua.Group.getGroupNames    plugins.core.Data.getGroupNames()");var _8f0=this.getGroups();var _8f1=new Array;var _8f0=this.getGroups();for(var i in _8f0){_8f1.push(_8f0[i].groupname);}return _8f1;},getGroupMembers:function(_8f2){var _8f3=this.cloneData("groupmembers");var _8f4=["type"];var _8f5=[_8f2];return this.filterByKeyValues(_8f3,_8f4,_8f5);},getGroupMembersHash:function(_8f6){console.log("Agua.Group.getGroupMembersHash    plugins.core.Data.getGroupMembersHash(memberType)");console.log("Agua.Group.getGroupMembersHash    memberType"+_8f6);var _8f7=this.cloneData("groupmembers");for(var _8f8 in _8f7){for(var j=0;j<_8f7[_8f8].length;j++){if(_8f7[_8f8][j].type!=_8f6){_8f7[_8f8].splice(j,1);j--;}}}return _8f7;},getGroupSources:function(){return this.getGroupMembers("source");},getGroupUsers:function(){return this.getGroupMembers("user");},getGroupProjects:function(){return this.getGroupMembers("project");}});}if(!dojo._hasResource["plugins.core.Agua.Hub"]){dojo._hasResource["plugins.core.Agua.Hub"]=true;dojo.provide("plugins.core.Agua.Hub");dojo.declare("plugins.core.Agua.Hub",[],{getHub:function(){return this.cloneData("hub");},setHub:function(hub){console.log("Agua.Hub.setHub    plugins.core.Data.setHub(hub)");console.log("Agua.Hub.setHub    hub: "+dojo.toJson(hub));if(hub==null){console.log("Agua.Hub.setHub    hub is null. Returning");return;}if(hub.amazonuserid==null){console.log("Agua.Hub.setHub    hub.amazonuserid is null. Returning");return;}this.setData("hub",hub);return hub;},setHubCertificate:function(_8f9){console.log("Agua.Hub.setHubCertificate    publiccert: "+_8f9);if(!_8f9){console.log("Agua.Hub.setHubCertificate    publiccert is null. Returning");return;}var hub=this.getData("hub");console.log("Agua.Hub.setHubCertificate    hub: ");console.dir({hub:hub});if(!hub){console.log("Agua.Hub.setHubCertificate    hub is null. Returning");return;}if(!hub.login){console.log("Agua.Hub.setHubCertificate    hub.login is null. Returning");return;}hub.publiccert=_8f9;this.setData("hub",hub);return hub;}});}if(!dojo._hasResource["plugins.core.Agua.Package"]){dojo._hasResource["plugins.core.Agua.Package"]=true;dojo.provide("plugins.core.Agua.Package");dojo.declare("plugins.core.Agua.Package",[],{getPackages:function(){console.log("Agua.Package.getPackages    plugins.core.Data.getPackages()");return this.cloneData("packages");},getPackageTypes:function(_8fa){var _8fb=new Object;for(var i=0;i<_8fa.length;i++){_8fb[_8fa[i].type]=1;}var _8fc=this.hashkeysToArray(_8fb);_8fc=this.sortNoCase(_8fc);return _8fc;},getPackageType:function(_8fd){console.log("Agua.Package.getPackageType    plugins.core.Data.getPackageType(packageName)");var _8fe=this.cloneData("packages");for(var i in _8fe){var _8ff=_8fe[i];if(_8ff["package"].toLowerCase()==_8fd.toLowerCase()){return _8ff.type;}}return null;},hasPackages:function(){if(this.getData("packages").length==0){return false;}return true;},addPackage:function(_900){var _901=this.getData("packages");var _902=this.addData("packages",_900,["package","owner","installdir"]);if(_902==true){this.sortData("packages","package");}_901=this.getData("packages");return _902;},removePackage:function(_903){var _904=this.getData("packages");var _905=this.removeData("packages",_903,["package","owner","installdir"]);_904=this.getData("packages");return _905;},isPackage:function(_906){console.log("Agua.Package.isPackage    packageName: *"+_906+"*");var _907=this.getPackages();for(var i in _907){var _908=_907[i];console.log("Agua.Package.isPackage    Checking package.package: *"+_908["package"]+"*");if(_908["package"].toLowerCase()==_906.toLowerCase()){return true;}}return false;}});}if(!dojo._hasResource["plugins.core.Agua.Parameter"]){dojo._hasResource["plugins.core.Agua.Parameter"]=true;dojo.provide("plugins.core.Agua.Parameter");dojo.declare("plugins.core.Agua.Parameter",[],{addParameter:function(_909){console.log("Agua.Parameter.addParameter    plugins.core.Data.addParameter(parameterObject)");var _90a=this.removeData("parameters",_909,["appname","name","paramtype"]);var _90b=["appname","name","paramtype"];return _90a=this.addData("parameters",_909,_90b);},removeParameter:function(_90c){console.log("Agua.Parameter.removeParameter    plugins.core.Data.removeParameter(parameterObject)");console.log("Agua.Parameter.removeParameter    parameterObject: "+dojo.toJson(_90c));if(!this._removeParameter(_90c)){return false;}var url=Agua.cgiUrl+"workflow.cgi";var _90d=new Object;_90d.username=this.cookie("username");_90d.sessionId=this.cookie("sessionId");_90d.mode="deleteParameter";_90d.data=_90c;this.doPut({url:url,query:_90d});return true;},_removeParameter:function(_90e){return this.removeData("parameters",_90e,["appname","name","paramtype"]);},isParameter:function(_90f,_910){console.log("Agua.Parameter.isParameter    plugins.core.Data.isParameter(parameterName, parameterObject)");console.log("Agua.Parameter.isParameter    parameterName: *"+_910+"*");var _911=getParametersByAppname(_90f);if(_911==null){return false;}for(var i in _911){if(_911[i].name.toLowerCase()==_910.toLowerCase()){return true;}}return false;},getParametersByAppname:function(_912){if(_912==null){return null;}var _913=new Array;var _914=this.cloneData("parameters");for(var i=0;i<_914.length;i++){var _915=_914[i];if(_915.appname==_912){_913.push(_915);}}return _913;},getParameter:function(_916,_917){if(_916==null){return null;}if(_917==null){return null;}var _918=getParametersByAppname(_916);if(_918==null){return false;}for(var i in _918){if(_918[i].name.toLowerCase()==_917.toLowerCase()){return _918[i];}}return null;}});}if(!dojo._hasResource["plugins.core.Agua.Project"]){dojo._hasResource["plugins.core.Agua.Project"]=true;dojo.provide("plugins.core.Agua.Project");dojo.declare("plugins.core.Agua.Project",[],{getProjects:function(){var _919=this.cloneData("projects");return this.sortHasharray(_919,"name");},getProjectNames:function(_91a){console.log("Agua.Project.getProjectNames    plugins.core.Data.getProjectNames()");if(_91a==null){_91a=this.getProjects();}return this.hashArrayKeyToArray(_91a,"name");},addProject:function(_91b){console.log("Agua.Project.addProject    plugins.core.Data.addProject(projectName)");console.log("Agua.Project.addProject    projectObject: "+dojo.toJson(_91b));_91b.description=_91b.description||"";_91b.notes=_91b.notes||"";console.log("Agua.Project.addProject    this.addingProject: "+this.addingProject);if(this.addingProject==true){return;}this.addingProject==true;this.removeData("projects",_91b,["name"]);if(!this.addData("projects",_91b,["name"])){console.log("Agua.Project.addProject    Could not add project to projects: "+projectName);this.addingProject==false;return;}this.sortData("projects","name");this.addingProject==false;var url=Agua.cgiUrl+"workflow.cgi";var _91c=dojo.clone(_91b);_91c.username=this.cookie("username");_91c.sessionId=this.cookie("sessionId");_91c.mode="addProject";console.log("Agua.Project.addProject    query: "+dojo.toJson(_91c,true));this.doPut({url:url,query:_91c,sync:false});},copyProject:function(_91d,_91e,_91f,_920,_921){console.log("Agua.Project.copyProject    plugins.folders.Agua.copyProject(sourceUser, sourceProject, sourceProject, targetUser, targetProject, targetProject)");console.log("Agua.Project.copyProject    sourceUser: "+_91d);console.log("Agua.Project.copyProject    sourceProject: "+_91e);console.log("Agua.Project.copyProject    targetUser: "+_91f);console.log("Agua.Project.copyProject    targetProject: "+_920);console.log("Agua.Project.copyProject    copyFiles: "+_921);if(this.isProject(_920)==true){console.log("Agua.Project.copyProject    Project '"+_920+"' already exists. Returning.");return;}var _922=this.getSharedProjectsByUsername(_91d);console.log("Agua.Project.copyProject    projects: "+dojo.toJson(_922));_922=this.filterByKeyValues(_922,["project"],[_91e]);if(!_922||_922.length==0){console.log("Agua.Project.copyProject    Returning becacuse  projects is null or empty: "+dojo.toJson(_922));}var _923=_922[0];var date=this.currentMysqlDate();_923=this.setProvenance(_923,date);_923.name=_920;_923.project=_920;_923.username=_91f;console.dir({projectObject:_923});var keys=["name"];var _924=this.addData("projects",_923,keys);if(_924==false){console.log("Agua.Project.copyProject    Could not copy project "+_923.name+" to projects");return;}var _925=this.getSharedWorkflowsByProject(_91d,_91e);for(var i=0;i<_925.length;i++){var _926=_925[i].name;console.log("Agua.Project.copyProject    workflows["+i+"]: "+dojo.toJson(_925[i]));this._copyWorkflow(_925[i],_91f,_920,_926,date);}var url=Agua.cgiUrl+"workflow.cgi";var _927=new Object;_927.sourceuser=_91d;_927.targetuser=_91f;_927.sourceproject=_91e;_927.targetproject=_920;_927.copyfiles=_921;_927.date=date;_927.provenance=_923.provenance;_927.username=this.cookie("username");_927.sessionId=this.cookie("sessionId");_927.mode="copyProject";console.log("Agua.Project.copyProject    query: "+dojo.toJson(_927,true));this.doPut({url:url,query:_927,sync:false});},removeProject:function(_928){console.log("Agua.Project.removeProject    plugins.core.Data.removeProject(projectObject)");console.log("Agua.Project.removeProject    projectObject: "+dojo.toJson(_928));_928.project=_928.name;_928.owner=this.cookie("username");_928.type="project";var _929=this.removeData("projects",_928,["name"]);if(_929==true){console.log("Agua.Project.removeProject    Removed project from projects: "+_928.name);}else{console.log("Agua.Project.removeProject    Could not remove project from projects: "+_928.name);}this.removeData("workflows",_928,["project"]);var keys=["owner","name","type"];this.removeData("groupmembers",_928,keys);var keys=["project"];this.removeData("stages",_928,keys);var keys=["project"];this.removeData("stageparameters",_928,keys);var url=Agua.cgiUrl+"workflow.cgi";var _92a=_928;_92a.username=this.cookie("username");_92a.sessionId=this.cookie("sessionId");_92a.mode="removeProject";console.log("Agua.Project.removeProject    query: "+dojo.toJson(_92a,true));this.doPut({url:url,query:_92a,sync:false});},isProject:function(_92b){var _92c=this.getProjects();for(var i in _92c){var _92d=_92c[i];if(_92d.name.toLowerCase()==_92b.toLowerCase()){return true;}}return false;},isGroupProject:function(_92e,_92f){console.log("Agua.Project.isGroupProject    plugins.core.Data.isGroupProject(groupName, projectObject)");console.log("Agua.Project.isGroupProject    groupName: "+_92e);console.log("Agua.Project.isGroupProject    projectObject: "+dojo.toJson(_92f));var _930=this.getGroupProjects();if(_930==null){return false;}_930=this.filterByKeyValues(_930,["groupname"],[_92e]);return this._objectInArray(_930,_92f,["groupname","name"]);},addProjectToGroup:function(_931,_932){console.log("Agua.Project.addProjectToGroup    caller: "+this.addProjectToGroup.caller.nom);console.log("Agua.Project.addProjectToGroup    groupName: "+_931);console.log("Agua.Project.addProjectToGroup    projectObject: "+dojo.toJson(_932));if(this.isGroupProject(_931,_932)==true){console.log("Agua.Project.addProjectToGroup     project already exists in projects: "+_932.name+". Returning.");return false;}_932.owner=_932.username;_932.groupname=_931;_932.type="project";var _933=this.getGroups();console.log("Agua.Project.addProjectToGroup    groups: "+dojo.toJson(_933));var _934=this._getObjectByKeyValue(_933,"groupname",_931);if(_934==null){return false;}console.log("Agua.Project.addProjectToGroup    group: "+dojo.toJson(_934));_932.groupdesc=_934.description;console.log("Agua.Project.addProjectToGroup    New projectObject: "+dojo.toJson(_932));var _935=["owner","groupname","name","type"];return this.addData("groupmembers",_932,_935);},removeProjectFromGroup:function(_936,_937){console.log("Agua.Project.removeProjectFromGroup     caller: "+this.removeProjectFromGroup.caller.nom);console.log("Agua.Project.removeProjectFromGroup     groupName: "+_936);console.log("Agua.Project.removeProjectFromGroup     projectObject: "+dojo.toJson(_937));_937.owner=_937.username;_937.groupname=_936;_937.type="project";var _938=this.getGroups();console.log("Agua.Project.removeProjectFromGroup    groups: "+dojo.toJson(_938));var _939=this._getObjectByKeyValue(_938,"groupname",_936);if(_939==null){return false;}console.log("Agua.Project.removeProjectFromGroup    group: "+dojo.toJson(_939));_937.groupdesc=_939.description;var _93a=["owner","groupname","name","type"];return this.removeData("groupmembers",_937,_93a);},getProjectsByGroup:function(_93b){var _93c=this.getGroupProjects();if(_93c==null){return null;}var _93d=["groupname"];var _93e=[_93b];var _93f=this.filterByKeyValues(_93c,_93d,_93e);return this.sortHasharray(_93f,"name");},getGroupsByProject:function(_940){var _941=this.getGroupProjects();if(_941==null){return null;}var _942=["type","name"];var _943=["project",_940];return this.filterByKeyValues(_941,_942,_943);}});}if(!dojo._hasResource["plugins.core.Agua.Report"]){dojo._hasResource["plugins.core.Agua.Report"]=true;dojo.provide("plugins.core.Agua.Report");dojo.declare("plugins.core.Agua.Report",[],{getReports:function(){console.log("Agua.Report.getReports    plugins.core.Data.getReports()");var _944=this.getStages();if(_944==null){return;}var keys=["type"];var _945=["report"];var _946=this.filterByKeyValues(_944,keys,_945);return _946;},getReportsByWorkflow:function(_947,_948){var _949=this.getReports();if(_949==null){return null;}var _94a=["project","workflow"];var _94b=[_947,_948];return this.filterByKeyValues(_949,_94a,_94b);},removeReport:function(_94c){console.log("Agua.Report.removeReport    plugins.core.Data.removeReport(reportObject)");console.log("Agua.Report.removeReport    reportObject: "+dojo.toJson(_94c));var _94d=["project","workflow","name"];var _94e=this.removeData("reports",_94c,_94d);if(_94e==true){console.log("Agua.Report.removeReport    Removed report from this.reports: "+_94c.name);}else{console.log("Agua.Report.removeReport    Could not remove report from this.reports: "+_94c.name);}var _94f=this.getGroupsByReport(_94c.name);console.log("Agua.Report.removeReport    groupNames: "+dojo.toJson(_94f));for(var i=0;i<_94f.length;i++){if(this.removeReportFromGroup(_94f[i],_94c)==false){_94e=false;}}return _94e;},isReport:function(_950){console.log("Agua.Report.isReport    plugins.core.Data.isReport(reportName)");console.log("Agua.Report.isReport    reportName: *"+_950+"*");var _951=this.getReports();for(var i in _951){var _952=_951[i];if(_952.name.toLowerCase()==_950.toLowerCase()){console.log("Agua.Report.isReport    report.name is a report: *"+_952.name+"*");return true;}}return false;},addReport:function(_953){console.log("Agua.Report.addReport+     plugins.core.Data.addReport(projectName)");console.log("Agua.Report.addReport    reportObject: "+dojo.toJson(_953));var _954=["project","workflow","name"];var _955=this.addData("reports",_953,_954);if(_955==true){console.log("Agua.Report.addReport    Added report to this.reports["+_953.name);}else{console.log("Agua.Report.addReport    Could not add report to this.reports["+_953.name);}return _955;}});}if(!dojo._hasResource["plugins.core.Agua.Shared"]){dojo._hasResource["plugins.core.Agua.Shared"]=true;dojo.provide("plugins.core.Agua.Shared");dojo.declare("plugins.core.Agua.Shared",[],{getSharedSources:function(){return this.cloneData("sharedsources");},getSharedSourcesByUsername:function(_956){var _957=this.cloneData("sharedsources");if(!_957||!_957[_956]){return [];}else{return _957[_956];}},getSharedUsernames:function(){console.log("Agua.Shared.getSharedUsernames    plugins.core.Data.getSharedUsernames()");var _958=this.getSharedProjects();var _959=new Array;for(var name in _958){_959.push(name);}_959=_959.sort();console.log("Agua.Shared.getSharedUsernames    usernames: "+dojo.toJson(_959));return _959;},getSharedProjects:function(){console.log("Agua.Shared.getSharedProjects    plugins.core.Data.getSharedProjects()");var _95a=this.cloneData("sharedprojects");console.log("Agua.Shared.getSharedProjects    sharedProjects: ");console.dir({sharedProjects:_95a});return _95a;},getSharedProjectsByUsername:function(_95b){var _95c=this.cloneData("sharedprojects");if(!_95c||!_95c[_95b]){return [];}else{return _95c[_95b];}},getSharedStagesByUsername:function(_95d){var _95e=this.cloneData("sharedstages");if(_95e==null||_95e[_95d]==null){return [];}else{return _95e[_95d];}},getSharedWorkflowsByProject:function(_95f,_960){console.log("Agua.Shared.getSharedWorkflowsByProject    plugins.core.Data.getSharedWorkflowsByProject(username, project)");console.log("Agua.Shared.getSharedWorkflowsByProject    username: "+_95f);console.log("Agua.Shared.getSharedWorkflowsByProject    project: "+_960);var _961=this.cloneData("sharedworkflows")||[];_961=_961[_95f]||[];console.dir({sharedWorkflows:_961});_961=this.filterByKeyValues(_961,["project"],[_960]);console.log("Agua.Shared.getSharedWorkflowsByProject    sharedWorkflows: ");console.dir({sharedWorkflows:_961});return _961;},getSharedStagesByWorkflow:function(_962,_963,_964){console.log("Agua.Shared.getSharedStagesByWorkflow    plugins.core.Data.getSharedStagesByWorkflow(username, project, workflow)");console.log("Agua.Shared.getSharedStagesByWorkflow    username: "+_962);console.log("Agua.Shared.getSharedStagesByWorkflow    project: "+_963);console.log("Agua.Shared.getSharedStagesByWorkflow    workflow: "+_964);var _965=this.getSharedStagesByUsername(_962);console.log("Agua.Shared.getSharedStagesByWorkflow    BEFORE FILTER PROJECT, sharedStages: ");console.dir({sharedStages:_965});_965=this.filterByKeyValues(_965,["project"],[_963]);console.log("Agua.Shared.getSharedStagesByWorkflow    BEFORE FILTER WORKFLOW, sharedStages: ");console.dir({sharedStages:_965});_965=this.filterByKeyValues(_965,["workflow"],[_964]);console.log("Agua.Shared.getSharedStagesByWorkflow    AFTER sharedStages: ");console.dir({sharedStages:_965});return _965;},getSharedParametersByAppname:function(_966,_967){if(_966==null){return null;}var _968=this.cloneData("sharedparameters");var keys=["owner","appname"];var _969=[_967,_966];var _96a=this.filterByKeyValues(_968,keys,_969);return _96a;},getSharedStageParameters:function(_96b){var keys=["username","project","workflow","name","number"];var _96c=this.notDefined(_96b,keys);console.log("Agua.Shared.getSharedStageParameters    notDefined: "+dojo.toJson(_96c));if(_96c.length!=0){console.log("Agua.Shared.getSharedStageParameters    not defined: "+dojo.toJson(_96c));return;}var _96d=_96b.username;var _96e=this.cloneData("sharedstageparameters");if(_96e==null||_96e[_96d]==null){return [];}var _96f=_96e[_96d];_96b.appname=_96b.name;_96b.appnumber=_96b.number;var _970=["username","project","workflow","appname","appnumber"];var _971=[_96b.username,_96b.project,_96b.workflow,_96b.name,_96b.number];_96f=this.filterByKeyValues(_96f,_970,_971);return _96f;},getSharedViews:function(_972){console.log("Agua.Shared.getSharedViews    plugins.core.Data.getSharedViews(viewObject)");console.log("Agua.Shared.getSharedViews    viewObject: "+dojo.toJson(_972));var keys=["project","username"];var _973=this.notDefined(_972,keys);console.log("Agua.Shared.getSharedViews    notDefined: "+dojo.toJson(_973));if(_973.length!=0){console.log("Agua.Shared.getSharedViews    not defined: "+dojo.toJson(_973));return;}var _974=_972.username;var _975=this.cloneData("sharedsharedViews");if(_975==null||_975[_974]==null){return [];}var _976=_975[_974];console.log("Agua.Shared.getSharedViews    BEFORE views: "+dojo.toJson(_976,true));var _977=["project","username"];var _978=[_972.username,_972.project,_972.workflow,_972.name,_972.number];_976=this.filterByKeyValues(_976,_977,_978);console.log("Agua.Shared.getSharedViews    AFTER  views: "+dojo.toJson(_976));return _976;},getSharedApps:function(){return this.cloneData("sharedapps");}});}if(!dojo._hasResource["plugins.core.Agua.Sharing"]){dojo._hasResource["plugins.core.Agua.Sharing"]=true;dojo.provide("plugins.core.Agua.Sharing");dojo.declare("plugins.core.Agua.Sharing",[],{getSharingHeadings:function(){console.log("Agua.Sharing.getSharingHeadings    plugins.core.Data.getSharingHeadings()");var _979=this.cloneData("sharingheadings");console.log("Agua.Sharing.getSharingHeadings    headings: "+dojo.toJson(_979));return _979;},getAccess:function(){return this.cloneData("access");}});}if(!dojo._hasResource["plugins.core.Agua.Source"]){dojo._hasResource["plugins.core.Agua.Source"]=true;dojo.provide("plugins.core.Agua.Source");dojo.declare("plugins.core.Agua.Source",[],{getSources:function(){var _97a=this.cloneData("sources");return this.sortHasharray(_97a,"name");},isSource:function(_97b){console.log("Agua.Source.isSource    plugins.core.Data.isSource(sourceObject)");console.log("Agua.Source.isSource    sourceObject: "+dojo.toJson(_97b));var _97c=this.getSources();if(_97c==null){return false;}return this._objectInArray(_97c,_97b,["name"]);},addSource:function(_97d){console.log("Agua.Source.addSource    plugins.core.Data.addSource(sourceObject)");console.log("Agua.Source.addSource    sourceObject: "+dojo.toJson(_97d));this._removeSource(_97d);if(!this._addSource(_97d)){return false;}var url=Agua.cgiUrl+"sharing.cgi?";var _97e=new Object;_97e.username=this.cookie("username");_97e.sessionId=this.cookie("sessionId");_97e.mode="addSource";_97e.data=_97d;this.doPut({url:url,query:_97e,sync:false});},_addSource:function(_97f){console.log("Agua.Source._addSource    plugins.core.Data._addSource(sourceObject)");console.log("Agua.Source._addSource    sourceObject: "+dojo.toJson(_97f));return this.addData("sources",_97f,["name","description","location"]);},removeSource:function(_980){if(!this._removeSource(_980)){console.log("Agua.Source.removeSource    FAILED TO REMOVE sourceObject: "+dojo.toJson(_980));return false;}_980.username=this.cookie("username");_980.type="source";var _981=["username","name","type"];this.removeData("groupmembers",_980,_981);var url=Agua.cgiUrl+"sharing.cgi?";var _982=new Object;_982.username=this.cookie("username");_982.sessionId=this.cookie("sessionId");_982.mode="removeSource";_982.data=_980;this.doPut({url:url,query:_982,sync:false});},_removeSource:function(_983){return this.removeData("sources",_983,["name"]);},isGroupSource:function(_984,_985){console.log("Agua.Source.isGroupSource    plugins.core.Data.isGroupSource(groupName, sourceObject)");var _986=this.getGroupSources();if(_986==null){return false;}_986=this.filterByKeyValues(_986,["groupname"],[_984]);return this._objectInArray(_986,_985,["name"]);},addSourceToGroup:function(_987,_988){console.log("Agua.Source.addSourceToGroup     plugins.core.Data.addSourceToGroup");if(this.isGroupSource(_987,_988)==true){console.log("Agua.Source.addSourceToGroup     source already exists in sources: "+_988.name+". Returning.");return false;}var _989=this.getGroups();var _98a=this._getObjectByKeyValue(_989,"groupname",_987);if(_98a==null){return null;}_988.username=_98a.username;_988.groupname=_987;_988.groupdesc=_98a.description;_988.type="source";var _98b=["username","groupname","name","type"];return this.addData("groupmembers",_988,_98b);},removeSourceFromGroup:function(_98c,_98d){console.log("Agua.Source.removeSourceFromGroup     groupName: "+_98c);console.log("Agua.Source.removeSourceFromGroup     sourceObject: ");console.dir({sourceObject:_98d});var _98e=this.getGroups();console.log("Agua.Source.removeSourceFromGroup     groups: ");console.dir({groups:_98e});var _98f=this._getObjectByKeyValue(_98e,"groupname",_98c);console.log("Agua.Source.removeSourceFromGroup     group: ");console.dir({group:_98f});if(_98f==null){console.log("Agua.Source.removeSourceFromGroup     group is null. Returning.");return null;}_98d.owner=_98f.username;_98d.groupname=_98c;_98d.groupdesc=_98f.description;_98d.type="source";console.log("Agua.Source.removeSourceFromGroup     BEFORE removeData, sourceObject: ");console.dir({sourceObject:_98d});var _990=["username","groupname","name","type"];return this.removeData("groupmembers",_98d,_990);},getSourcesByGroup:function(_991){var _992=this.getGroupSources();var _993=["groupname"];var _994=[_991];return this.filterByKeyValues(_992,_993,_994);}});}if(!dojo._hasResource["plugins.core.Agua.Stage"]){dojo._hasResource["plugins.core.Agua.Stage"]=true;dojo.provide("plugins.core.Agua.Stage");dojo.declare("plugins.core.Agua.Stage",[],{addStage:function(_995){console.log("Agua.Stage.addStage    stageObject: ");console.dir({stageObject:_995});var _996=this._addStage(_995);if(_996==true){_996=this.addStageParametersForStage(_995);}if(_996==false){return;}var url=Agua.cgiUrl+"workflow.cgi";var _997=_995;_997.username=this.cookie("username");_997.sessionId=this.cookie("sessionId");_997.mode="addStage";this.doPut({url:url,query:_997});return _996;},_addStage:function(_998){var _999=["project","workflow","name","number"];var _99a=this.addData("stages",_998,_999);if(_99a==false){return false;}return _99a;},insertStage:function(_99b){console.log("Agua.Stage.insertStage    plugins.core.Data.insertStage(stageObject)");delete _99b.avatarType;console.log("Agua.Stage.insertStage    stageObject: ");console.dir({stageObject:_99b});var _99c=Agua.getWorkflowNumber(_99b.project,_99b.workflow);_99b.workflownumber=_99c;if(_99b==null){return;}var _99d=this.getStagesByWorkflow(_99b.project,_99b.workflow);_99d=this.sortHasharray(_99d,"number");var _99e=_99b.number-1;var _99f=_99b.owner;var _9a0=_99b.username;var _9a1=true;for(var i=_99d.length-1;i>_99e-1;i--){var _9a2=this.getStageParameters(_99d[i]);if(_9a2==null){console.log("Agua.Stage.insertStage    Result = false because no stage parameters for stage: "+dojo.toJson(_99d[i],true));_9a1=false;}var _9a3=this;for(var j=0;j<_9a2.length;j++){if(_9a3._removeStageParameter(_9a2[j])==false){console.log("Agua.Stage.insertStage    Result = false because there was a problem removing stageParameter: "+dojo.toJson(_9a2[j],true));_9a1=false;}_9a2[j].appnumber=(i+2).toString();if(_9a3._addStageParameter(_9a2[j])==false){console.log("Agua.Stage.insertStage    Result = false because there was a problem adding stageParameter: "+dojo.toJson(_9a2[j],true));_9a1=false;}}}if(_9a1==false){console.log("Agua.Stage.insertStage    Returning because there was a problem updating the stage parameters");return false;}for(var i=_99d.length-1;i>_99e-1;i--){if(this._removeStage(_99d[i])==false){console.log("Agua.Stage.spliceStage    Returning because there was a problem removing stages["+i+"]: "+dojo.toJson(_99d[i]));return false;}_99d[i].number=(i+2).toString();if(this._addStage(_99d[i])==false){console.log("Agua.Stage.spliceStage    Returning because there was a problem adding back stages["+i+"]: "+dojo.toJson(_99d[i]));return false;}}_9a1=this._addStage(_99b);if(_9a1==false){console.log("Agua.Stage.insertStage    Returning FALSE because there was a problem adding the stage to stages: "+dojo.toJson(_99b));return false;}if(_9a1==true){_9a1=this.addStageParametersForStage(_99b);}if(_9a1==false){console.log("Agua.Stage.insertStage    Returning because there was a problem copying parameters for the stage:"+dojo.toJson(_99b));return false;}var url=Agua.cgiUrl+"workflow.cgi";var _9a4=_99b;_9a4.username=this.cookie("username");_9a4.sessionId=this.cookie("sessionId");_9a4.mode="insertStage";this.doPut({url:url,query:_9a4});return true;},removeStage:function(_9a5){console.log("Agua.Stage.removeStage    plugins.core.Data.removeStage(stageObject)");console.log("Agua.Stage.removeStage    stageObject: "+_9a5);var _9a6=this._removeStage(_9a5);console.log("Agua.Stage.removeStage    Doing this.removeStageParameters(stageObject)");if(_9a6==true){_9a6=this.removeStageParameters(_9a5);}if(_9a6==false){console.log("Agua.Stage.removeStage    Problem removing stage or stageparameters. Returning.");return;}var url=Agua.cgiUrl+"workflow.cgi";var _9a7=_9a5;_9a7.username=this.cookie("username");_9a7.sessionId=this.cookie("sessionId");_9a7.mode="removeStage";this.doPut({url:url,query:_9a7});return _9a6;},_removeStage:function(_9a8){var _9a9=["project","workflow","name","number"];var _9aa=this.removeData("stages",_9a8,_9a9);if(_9aa==false){return false;}return _9aa;},updateStagesStatus:function(_9ab){if(_9ab==null||_9ab.length==0){return;}var _9ac=this.getData("stages");_9ac=this.sortNumericHasharray(_9ac,"number");var _9ad=_9ac[0].project;var _9ae=_9ac[0].workflow;var _9af=0;for(var i=0;i<_9ac.length;i++){if(_9ac[i].project!=_9ad){continue;}if(_9ac[i].workflow!=_9ae){continue;}_9af++;}for(var i=0;i<_9ac.length;i++){if(_9ac[i].project!=_9ad){continue;}if(_9ac[i].workflow!=_9ae){continue;}for(var k=0;k<_9ab.length;k++){if(_9ac[i].number==_9ab[k].number){_9ac[i].status=_9ab[k].status;_9ac[i].started=_9ab[k].started;_9ac[i].completed=_9ab[k].completed;continue;}}}_9ac=this.getData("stages");_9ac=this.sortNumericHasharray(_9ac,"number");_9af=0;for(var i=0;i<_9ac.length;i++){if(_9ac[i].project!=_9ad){continue;}if(_9ac[i].workflow!=_9ae){continue;}_9af++;}},updateStageSubmit:function(_9b0){var _9b1=this.getData("stages");var _9b2=this._getIndexInArray(_9b1,_9b0,["project","workflow","number"]);if(_9b2==null){return 0;}_9b1[_9b2].submit=_9b0.submit;var url=Agua.cgiUrl+"workflow.cgi";_9b0.username=this.cookie("username");_9b0.sessionId=this.cookie("sessionId");_9b0.mode="updateStageSubmit";this.doPut({url:url,query:_9b0});return 1;},spliceStage:function(_9b3){if(_9b3==null){return;}var _9b4=this.getStagesByWorkflow(_9b3.project,_9b3.workflow);_9b4=this.sortHasharray(_9b4,"number");var _9b5=_9b3.number-1;_9b4.splice(_9b5,1);var _9b6=this._removeStage(_9b3);if(_9b6==false){return false;}_9b6=this.removeStageParameters(_9b3);if(_9b6==false){console.log("Agua.Stage.spliceStage    Returning because there was a problem removing parameters for the stage:"+dojo.toJson(_9b3));return false;}for(var i=_9b5;i<_9b4.length;i++){this._removeStage(_9b4[i]);_9b4[i].number=(i+1).toString();this._addStage(_9b4[i]);}var _9b7=this.getStagesByWorkflow(_9b3.project,_9b3.workflow);for(var i=0;i<_9b7.length;i++){}for(var i=_9b4.length-1;i>_9b5-1;i--){_9b4[i].number=(i+2).toString();var _9b8=this.getStageParameters(_9b4[i]);if(_9b8==null){return false;}var _9b9=this;for(var j=0;j<_9b8.length;j++){if(_9b9._removeStageParameter(_9b8[j])==false){_9b6=false;}_9b8[j].appnumber=(i+1).toString();if(_9b9._addStageParameter(_9b8[j])==false){_9b6=false;}}_9b4[i].number=(i+1).toString();}if(_9b6==false){return false;}var url=Agua.cgiUrl+"workflow.cgi";var _9ba=_9b3;_9ba.username=this.cookie("username");_9ba.sessionId=this.cookie("sessionId");_9ba.mode="removeStage";this.doPut({url:url,query:_9ba});},isStage:function(_9bb){var _9bc=this.getStages();for(var i in _9bc){var _9bd=_9bc[i];if(_9bd.name.toLowerCase()==_9bb.toLowerCase()){return true;}}return false;},getStageType:function(_9be){var _9bf=this.getStages();for(var i in _9bf){var _9c0=_9bf[i];if(_9c0.name.toLowerCase()==_9be.toLowerCase()){return _9c0.type;}}return null;},getStages:function(){return this.cloneData("stages");},getStagesByWorkflow:function(_9c1,_9c2){if(_9c1==null){return;}if(_9c2==null){return;}var _9c3=this.cloneData("stages");var _9c4=["project","workflow"];var _9c5=[_9c1,_9c2];_9c3=this.filterByKeyValues(_9c3,_9c4,_9c5);return _9c3;}});}if(!dojo._hasResource["plugins.core.Agua.StageParameter"]){dojo._hasResource["plugins.core.Agua.StageParameter"]=true;dojo.provide("plugins.core.Agua.StageParameter");dojo.declare("plugins.core.Agua.StageParameter",[],{addStageParameter:function(_9c6){this._removeStageParameter(_9c6);var _9c7=this._addStageParameter(_9c6);if(_9c7==false){console.log("Agua.StageParameteraddStageParameter    result of _addStageParameter is "+_9c7+". Returning");return _9c7;}var url=this.cgiUrl+"workflow.cgi";var _9c8=_9c6;_9c8.username=this.cookie("username");_9c8.sessionId=this.cookie("sessionId");_9c8.mode="addStageParameter";this.doPut({url:url,query:_9c8});return _9c7;},_addStageParameter:function(_9c9){if(_9c9.chained==null){_9c9.chained="0";}var _9ca=["project","workflow","appname","appnumber","name","paramtype"];return this.addData("stageparameters",_9c9,_9ca);},removeStageParameter:function(_9cb){var _9cc=this._removeStageParameter(_9cb);if(_9cc==false){return _9cc;}var url=this.cgiUrl+"workflow.cgi";var _9cd=_9cb;_9cd.username=this.cookie("username");_9cd.sessionId=this.cookie("sessionId");_9cd.mode="addStageParameter";this.doPut({url:url,query:_9cd,timeout:15000});return _9cc;},_removeStageParameter:function(_9ce){var _9cf=["project","workflow","appname","appnumber","name","paramtype"];return this.removeData("stageparameters",_9ce,_9cf);},getStageParameters:function(_9d0){if(_9d0==null){return;}var keys=["project","workflow","name","number"];var _9d1=this.notDefined(_9d0,keys);if(_9d1.length!=0){console.log("Agua.StageParametergetStageParameters    not defined: "+dojo.toJson(_9d1));return;}_9d0.appnumber=_9d0.number;_9d0.appname=_9d0.name;var _9d2=this._getStageParameters();var _9d3=["project","workflow","appname","appnumber"];var _9d4=[_9d0.project,_9d0.workflow,_9d0.name,_9d0.number];_9d2=this.filterByKeyValues(_9d2,_9d3,_9d4);return _9d2;},_getStageParameters:function(){return this.cloneData("stageparameters");},addStageParametersForStage:function(_9d5){if(_9d5.name==null){return null;}if(_9d5.number==null){return null;}var _9d6;if(_9d5.owner==this.cookie("username")){_9d6=dojo.clone(this.getParametersByAppname(_9d5.name));}else{_9d6=dojo.clone(this.getSharedParametersByAppname(_9d5.name,_9d5.owner));}dojo.forEach(_9d6,function(_9d7){_9d7.project=_9d5.project;_9d7.workflow=_9d5.workflow;_9d7.appnumber=_9d5.number;_9d7.appname=_9d5.name;});var _9d8=Agua.cloneData("stageparameters");var _9d9=["owner","project","workflow","appname","appnumber","name","paramtype"];var _9da=true;var _9db=this;dojo.forEach(_9d6,function(_9dc){if(_9db.addData("stageparameters",_9dc,_9d9)==false){_9da=false;}_9d8=Agua.cloneData("stageparameters");});if(!_9da){return;}return _9da;},removeStageParameters:function(_9dd){if(_9dd.name==null){console.log("Agua.StageParameterremoveStageParameters    stageObject.name is null. Returning.");return null;}if(_9dd.number==null){console.log("Agua.StageParameterremoveStageParameters    stageObject.number is null. Returning.");return null;}var keys=["owner","project","workflow","appname","appnumber"];var _9de=[_9dd.owner,_9dd.project,_9dd.workflow,_9dd.name,_9dd.number];var _9df=this.filterByKeyValues(this._getStageParameters(),keys,_9de);var _9e0=["project","workflow","appname","appnumber","name"];var _9e1=this.removeArrayFromData("stageparameters",_9df,_9e0);console.log("Agua.StageParameterremoveStageParameters    removeOk: "+_9e1);if(_9e1==false){console.log("Agua.StageParameterremoveStageParameters    Could not remove one or more parameters from stageparameters");return false;}return true;},getStageParametersByApp:function(_9e2){var _9e3=new Array;dojo.forEach(this.getStageParameters(),function(_9e4){if(_9e4.appname==_9e2){_9e3.push(_9e4);}});return _9e3;}});}if(!dojo._hasResource["plugins.core.Agua.User"]){dojo._hasResource["plugins.core.Agua.User"]=true;dojo.provide("plugins.core.Agua.User");dojo.declare("plugins.core.Agua.User",[],{getUser:function(_9e5){console.log("Agua.User.getUser    plugins.core.Data.getUser(username)");console.log("Agua.User.getUser    username: "+_9e5);var _9e6=this.getUsers();console.log("Agua.User.getUser    users: "+dojo.toJson(_9e6));var _9e7=this._getIndexInArray(_9e6,{"username":_9e5},["username"]);console.log("Agua.User.getUser    index: "+_9e7);if(_9e7!=null){return _9e6[_9e7];}return null;},getUsers:function(){console.log("Agua.User.getUsers    plugins.core.Data.getUsers(userObject)");this.sortData("users","username");return this.cloneData("users");},addUser:function(_9e8){console.log("Agua.User.addUser    plugins.core.Data.addUser(userObject)");this._removeUser(_9e8);if(!Agua._addUser(_9e8)){return;}var url=Agua.cgiUrl+"workflow.cgi?";var _9e9=new Object;_9e9.username=this.cookie("username");_9e9.sessionId=this.cookie("sessionId");_9e9.mode="addUser";_9e9.data=_9e8;console.log("query: ");console.dir(_9e9);console.log("Users.saveUser    query: "+dojo.toJson(_9e9));this.doPut({url:url,query:_9e9,sync:false});},_addUser:function(_9ea){console.log("Agua.User._addUser    plugins.core.Data._addUser(userObject)");if(!this.addData("users",_9ea,["username"])){return false;}this.sortData("users","username");return true;},isUser:function(_9eb){var _9ec=this.getUsers();if(this._getIndexInArray(_9ec,_9eb,["username"])){return true;}return false;},removeUser:function(_9ed){console.log("Agua.User.removeUser    plugins.core.Data.removeUser(userObject)");if(!this._removeUser(_9ed)){return;}var url=Agua.cgiUrl+"sharing.cgi?";var _9ee=new Object;_9ee.username=this.cookie("username");_9ee.sessionId=this.cookie("sessionId");_9ee.mode="removeUser";_9ee.data=_9ed;this.doPut({url:url,query:_9ee,sync:false});},_removeUser:function(_9ef){console.log("Agua.User._removeUser    plugins.core.Data._removeUser(userObject)");if(!this.removeData("users",_9ef,["username"])){return false;}this._removeUserFromGroups(_9ef);return true;},_removeUserFromGroups:function(_9f0){console.log("Agua.User._removeUserFromGroups    plugins.core.Data._removeUserFromGroups");_9f0.type="user";_9f0.name=_9f0.username;return this._removeObjectsFromData("groupmembers",_9f0,["name","type"]);},isGroupUser:function(_9f1,_9f2){var _9f3=this.getGroupUsers();if(_9f3==null){return false;}_9f3=this.filterByKeyValues(_9f3,["groupname"],[_9f1]);return this._objectInArray(_9f3,_9f2,["name"]);},addUserToGroup:function(_9f4,_9f5){if(this.isGroupUser(_9f4,_9f5)==true){return false;}var _9f6=this.getGroups();var _9f7=this._getObjectByKeyValue(_9f6,"groupname",_9f4);if(_9f7==null){return false;}_9f5.username=_9f7.username;_9f5.groupname=_9f4;_9f5.groupdesc=_9f7.description;_9f5.type="user";var _9f8=["username","groupname","name","type"];return this.addData("groupmembers",_9f5,_9f8);},removeUserFromGroup:function(_9f9,_9fa){var _9fb=this.getGroups();var _9fc=this._getObjectByKeyValue(_9fb,"groupname",_9f9);if(_9fc==null){return false;}_9fa.owner=_9fc.username;_9fa.groupname=_9f9;_9fa.groupdesc=_9fc.description;_9fa.type="user";var _9fd=["username","groupname","name","type"];return this.removeData("groupmembers",_9fa,_9fd);}});}if(!dojo._hasResource["plugins.core.Agua.View"]){dojo._hasResource["plugins.core.Agua.View"]=true;dojo.provide("plugins.core.Agua.View");dojo.declare("plugins.core.Agua.View",[],{getViewObject:function(_9fe,_9ff){var _a00=this.getViews();if(_a00==null){return [];}var _a01=["project","view"];var _a02=[_9fe,_9ff];var _a00=this.filterByKeyValues(_a00,_a01,_a02);if(_a00==null||_a00.length==0){return null;}return _a00[0];},getViews:function(){return this.cloneData("views");},getPreviousView:function(_a03){var _a04=this.getViews();if(!_a04||_a04.length==0){return;}var _a05=dojo.clone(_a04);var _a06=this.filterByKeyValues(_a05,["project"],[_a03.project]);if(!_a06||_a06.length==0){_a04.push(_a03);var _a07=this;_a04.sort(function(a,b){return _a07.sortObjectsNaturally(a,b,"project");});var _a08=this.hashArrayKeyToArray(dojo.clone(_a04),"project");_a08=this.uniqueValues(_a08);if(_a08.length==1){return;}var _a09=this._getIndex(_a08,_a03.project);var _a0a;if(_a09==0){_a0a=_a08[1];var _a06=this.filterByKeyValues(_a04,["project"],[_a0a]);_a06.sort(function(a,b){return _a07.sortObjectsNaturally(a,b,"view");});return _a06[0];}else{_a0a=_a08[_a09-1];var _a06=this.filterByKeyValues(_a04,["project"],[_a0a]);_a06.sort(function(a,b){return _a07.sortObjectsNaturally(a,b,"view");});return _a06[(_a06.length-1)];}}else{_a04.push(_a03);var _a07=this;_a04.sort(function(a,b){return _a07.sortObjectsNaturally(a,b,"view");});var _a09=this._getIndexInArray(_a04,_a03,["project","view"]);if(_a09==0){return _a04[1];}else{return _a04[_a09-1];}}},removeView:function(_a0b){var _a0c=["project","view"];if(!this.removeData("views",_a0b,_a0c)){console.log("Agua.View.removeView    Could not remove view from views table: "+_a0b.name);return false;}this.removeObjectsFromData("viewfeatures",_a0b,_a0c);return true;},isView:function(_a0d,_a0e){var _a0f=this.getViewsByProject(_a0d);for(var i in _a0f){var _a10=_a0f[i];if(_a10.view.toLowerCase()==_a0e.toLowerCase()){console.log("Agua.View.isView    Match found for view: *"+_a10.view+"*");return true;}}return false;},addView:function(_a11){var _a12=["project","view"];return this.addData("views",_a11,_a12);},getViewNames:function(_a13){var _a14=this.getViewsByProject(_a13);return this.hashArrayKeyToArray(_a14,"view");},getViewsByProject:function(_a15){var _a16=this.getViews();if(_a16==null){return [];}var _a17=["project"];var _a18=[_a15];var _a16=this.filterByKeyValues(_a16,_a17,_a18);return _a16;},getViewSpecies:function(_a19,_a1a){if(_a19==null||!_a19){return;}var _a1b=this.getViewFeatures(_a19,_a1a);if(_a1b==null||_a1b.length==0){return new Array;}var _a1c=new Object;_a1c.species=_a1b[0].species;_a1c.build=_a1b[0].build;return _a1c;},getViewProjects:function(){var _a1d=this.cloneData("viewfeatures");var _a1e=this.hashArrayKeyToArray(_a1d,"project");_a1e=this.uniqueValues(_a1e);return _a1e;},getSpeciesBuilds:function(){var _a1f=this.cloneData("features");var _a20=new Array;for(var i=1;i<_a1f.length;i++){_a20.push(_a1f[i].species+"("+_a1f[i].build+")");}_a20=this.uniqueValues(_a20);return _a20;},getSpecies:function(_a21,_a22){var _a23=this.cloneData("views");_a23=this.filterByKeyValues(_a23,["project","view"],[_a21,_a22]);if(_a23==null||_a23.length==0){return;}return _a23[0].species;},getBuild:function(_a24,_a25){var _a26=this.cloneData("views");_a26=this.filterByKeyValues(_a26,["project","view"],[_a24,_a25]);if(_a26==null||_a26.length==0){return;}return _a26[0].build;}});}if(!dojo._hasResource["plugins.core.Agua.Workflow"]){dojo._hasResource["plugins.core.Agua.Workflow"]=true;dojo.provide("plugins.core.Agua.Workflow");dojo.declare("plugins.core.Agua.Workflow",[],{getWorkflows:function(){var _a27=this.cloneData("workflows");return this.sortHasharray(_a27,"name");},getWorkflowNamesByProject:function(_a28){var _a29=this.getWorkflowsByProject(_a28);_a29=this.sortNumericHasharray(_a29,"number");return this.hashArrayKeyToArray(_a29,"name");},getWorkflowsByProject:function(_a2a){var _a2b=this.cloneData("workflows");return this.filterByKeyValues(_a2b,["project"],[_a2a]);},getWorkflow:function(_a2c){console.log("Agua.Workflow.getWorkflow     plugins.core.Data.getWorkflow(workflowObject)");console.log("Agua.Workflow.getWorkflow     workflowObject: ");console.dir({workflowObject:_a2c});var _a2d=this._getWorkflow(_a2c);if(!_a2d){console.log("Agua.Workflow.getWorkflow     No workflowObject.name "+_a2c.name+" found. Returning");return null;}console.log("Agua.Workflow.getWorkflow     object.name: "+_a2d.name);console.log("Agua.Workflow.getWorkflow     object: ");console.dir({object:_a2d});return _a2d;},_getWorkflow:function(_a2e){console.log("Agua.Workflow._getWorkflow     plugins.core.Data._getWorkflow(workflowObject)");console.log("Agua.Workflow._getWorkflow     workflowObject: "+dojo.toJson(_a2e));if(!this.isProject(_a2e.project)){console.log("Agua.Workflow._getWorkflow     No project found in workflowObject. Returning false.");return false;}var _a2f=this.getWorkflows();if(_a2f==null){console.log("Agua.Workflow._getWorkflow     workflows is null. Returning false.");return false;}var _a30=["project","name"];var _a31=[_a2e.project,_a2e.name];var _a2f=this.filterByKeyValues(_a2f,_a30,_a31);if(!_a2f||_a2f.length==0){return;}return _a2f[0];},isWorkflow:function(_a32){console.log("Agua.Workflow.isWorkflow     caller: "+this.isWorkflow.caller.nom);var _a33=this._getWorkflow(_a32);if(!_a33){console.log("Agua.Workflow.isWorkflow     Returning false");return false;}console.log("Agua.Workflow.isWorkflow     Returning true");return true;},getWorkflowNumber:function(_a34,_a35){var _a36=this._getWorkflow({project:_a34,name:_a35});if(!_a36){return null;}console.log("Agua.Workflow.getWorkflowNumber    workflowObject:");console.dir({workflowObject:_a36});return _a36.number;},getMaxWorkflowNumber:function(_a37){console.log("Agua.Workflow.getMaxWorkflowNumber     plugins.core.Data.getMaxWorkflowNumber(projectName)");console.log("Agua.Workflow.getMaxWorkflowNumber     projectName: "+_a37);var _a38=this.getWorkflowsByProject(_a37);if(_a38==null){return null;}if(_a38.length==0){return null;}console.log("Agua.Workflow.getMaxWorkflowNumber     Returning workflowObjects.length: "+_a38.length);return _a38.length;},moveWorkflow:function(_a39,_a3a){console.log("Agua.Workflow.moveWorkflow    workflowObject: "+dojo.toJson(_a39,true));var _a3b=_a39.number;if(_a3b==null){return false;}if(_a3b==_a3a){return false;}var _a3c=this.getData("workflows");_a3c=this.sortNumericHasharray(_a3c,"number");for(var i=0;i<_a3c.length;i++){if(_a3c[i].project!=_a3d){continue;}_a3e++;}var _a3d=_a39.project;var _a3e=0;for(var i=0;i<_a3c.length;i++){if(_a3c[i].project!=_a3d){continue;}_a3e++;if(_a3e<_a3b&&_a3e<_a3a){_a3c[i].number=_a3e;}else{if(_a3b<_a3a){if(_a3e==_a3b){_a3c[i].number=_a3a;}else{if(_a3e<=_a3a){_a3c[i].number=_a3e-1;}else{_a3c[i].number=_a3e;}}}else{if(_a3e<_a3b){_a3c[i].number=_a3e+1;}else{if(_a3b==_a3e){_a3c[i].number=_a3a;}else{_a3c[i].number=_a3e;}}}}}var _a3f=_a39;_a3f.newnumber=_a3a;_a3f.mode="moveWorkflow";_a3f.username=Agua.cookie("username");_a3f.sessionId=Agua.cookie("sessionId");var url=Agua.cgiUrl+"workflow.cgi";this.doPut({url:url,query:_a3f,sync:false});},renumberWorkflows:function(_a40){console.log("Agua.Workflow.renumberWorkflows     plugins.core.Data.renumberWorkflows(projectName)");console.log("Agua.Workflow.renumberWorkflows     projectName: "+_a40);var _a41=this.getWorkflowsByProject(_a40);console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a41.length);this.printObjectKeys(_a41,"number","UNSORTED workflows");console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a41.length);this.printObjectKeys(_a41,"name","UNSORTED workflows");console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a41.length);_a41=this.sortHasharrayByKeys(_a41,["number"]);console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a41.length);this.printObjectKeys(_a41,"number","SORTED workflows");console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a41.length);this.printObjectKeys(_a41,"name","SORTED workflows");console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a41.length);console.log("Agua.Workflow.renumberWorkflows     RENUMBERING workflows");var _a42=0;for(var i=0;i<_a41.length;i++){console.log("Agua.Workflow.renumberWorkflows     REMOVING workflow ["+i+"].number: "+_a41[i].number);this._removeWorkflow(_a41[i]);_a42++;_a41[i].number=_a42;console.log("Agua.Workflow.renumberWorkflows     ADDING workflows ["+i+"].number: "+_a41[i].number);this._addWorkflow(_a41[i]);}_a41=this.getWorkflowsByProject(_a40);console.log("Agua.Workflow.renumberWorkflows     BEFORE FILTER workflows.length: "+_a41.length);_a41=this.filterByKeyValues(_a41,["project"],[_a40]);console.log("Agua.Workflow.renumberWorkflows     AFTER FILTER workflows.length: "+_a41.length);},addWorkflow:function(_a43){console.log("Agua.Workflow.addWorkflow    plugins.workflow.Agua.addWorkflow(workflowObject)");console.log("Agua.Workflow.addWorkflow    workflowObject: "+dojo.toJson(_a43));var _a44=_a43.project;var _a45=_a43.name;if(this.isWorkflow(_a43)==true){console.log("Agua.Workflow.addWorkflow    Workflow '"+_a45+"' already exists in project '"+_a44+"'. Returning.");return;}var _a46=this.getMaxWorkflowNumber(_a44);console.log("Agua.Workflow.addWorkflow    maxNumber: "+_a46);var _a47;if(_a46==null){_a47=1;}else{_a47=_a46+1;}_a43.number=_a47;console.log("Agua.Workflow.addWorkflow    workflowObject.number: "+_a43.number);var _a48=this._addWorkflow(_a43);if(_a48==false){console.log("Agua.Workflow.addWorkflow    Could not add workflow "+_a45+" to workflows");return;}var url=Agua.cgiUrl+"workflow.cgi";var _a49=new Object;_a49.project=_a44;_a49.name=_a45;_a49.number=_a47;_a49.username=this.cookie("username");_a49.sessionId=this.cookie("sessionId");_a49.mode="addWorkflow";console.log("Agua.Workflow.addWorkflow    query: "+dojo.toJson(_a49,true));this.doPut({url:url,query:_a49,sync:false});},_addWorkflow:function(_a4a){var keys=["project","name","number"];var _a4b=this.addData("workflows",_a4a,keys);},removeWorkflow:function(_a4c){console.log("Agua.Workflow.removeWorkflow    caller: "+this.removeWorkflow.caller.nom);console.log("Agua.Workflow.removeWorkflow    workflowObject: "+dojo.toJson(_a4c));this._removeWorkflow(_a4c);this.renumberWorkflows(_a4c.project);var url=Agua.cgiUrl+"workflow.cgi";var _a4d=new Object;_a4d.project=_a4c.project;_a4d.name=_a4c.name;_a4d.number=_a4c.number;_a4d.username=this.cookie("username");_a4d.sessionId=this.cookie("sessionId");_a4d.mode="removeWorkflow";console.log("Agua.Workflow.removeWorkflow    query: "+dojo.toJson(_a4d,true));this.doPut({url:url,query:_a4d,sync:false});},_removeWorkflow:function(_a4e){console.log("Agua.Workflow._removeWorkflow    BEFORE delete workflows.length: "+this.getWorkflows().length);var keys=["project","number","name"];var _a4f=this.removeData("workflows",_a4e,keys);console.log("Agua.Workflow._removeWorkflow    delete result: "+_a4f);console.log("Agua.Workflow._removeWorkflow    AFTER delete workflows.length: "+this.getWorkflows().length);_a4e.workflow=_a4e.name;keys=["project","workflow"];this.removeObjectsFromData("stages",_a4e,keys);this.removeObjectsFromData("stageparameters",_a4e,keys);},renameWorkflow:function(_a50,_a51,_a52,_a53){console.log("Agua.Workflow.renameWorkflow    plugins.core.Data.renameWorkflow(workflowObject, newName)");console.log("Agua.Workflow.renameWorkflow    workflowObject: "+dojo.toJson(_a50));console.log("Agua.Workflow.renameWorkflow    newName: "+_a51);console.log("Agua.Workflow.renameWorkflow    callback: "+_a52);if(_a50.name==null){return;}if(_a50.project==null){return;}if(_a51==null){return;}var _a54=this.cookie("username");var date=this.currentMysqlDate();this._copyWorkflow(_a50,_a54,_a50.project,_a51,date,_a50.number);this._removeWorkflow(_a50);var url=Agua.cgiUrl+"workflow.cgi";var _a55=new Object;_a55.project=_a50.project;_a55.name=_a50.name;_a55.newname=_a51;_a55.username=this.cookie("username");_a55.sessionId=this.cookie("sessionId");_a55.mode="renameWorkflow";console.log("Agua.Workflow.renameWorkflow    query: "+dojo.toJson(_a55,true));this.doPut({url:url,query:_a55,sync:false,callback:_a52});},copyWorkflow:function(_a56,_a57,_a58,_a59,_a5a,_a5b,_a5c){console.log("Agua.Workflow.copyWorkflow    plugins.workflow.Agua.copyWorkflow(sourceUser, sourceProject, sourceWorkflow, targetUser, targetProject, targetWorkflow)");console.log("Agua.Workflow.copyWorkflow    sourceUser: "+_a56);console.log("Agua.Workflow.copyWorkflow    sourceProject: "+_a57);console.log("Agua.Workflow.copyWorkflow    sourceWorkflow: "+_a58);console.log("Agua.Workflow.copyWorkflow    targetUser: "+_a59);console.log("Agua.Workflow.copyWorkflow    targetProject: "+_a5a);console.log("Agua.Workflow.copyWorkflow    targetWorkflow: "+_a5b);console.log("Agua.Workflow.copyWorkflow    copyFiles: "+_a5c);if(this.isWorkflow({project:_a5a,name:_a5b})==true){console.log("Agua.Workflow.copyWorkflow    Workflow "+_a5b+" already exists in project "+_a5a+". Returning FALSE.");return false;}var _a5d=this.getSharedWorkflowsByProject(_a56,_a57);_a5d=this.filterByKeyValues(_a5d,["name"],[_a58]);if(!_a5d||_a5d.length==0){console.log("Agua.Workflow.copyWorkflow    Returning because workflows is not defined or empty");return;}var _a5e=_a5d[0];var date=this.currentMysqlDate();var _a5f=this._copyWorkflow(_a5e,_a59,_a5a,_a5b,date);if(_a5f==false){console.log("Agua.Workflow.copyWorkflow    Failed to copy workflow: "+dojo.toJson(_a5e));return false;}_a5e=this.setProvenance(_a5e,date);var url=Agua.cgiUrl+"workflow.cgi";var _a60=new Object;_a60.sourceuser=_a56;_a60.targetuser=_a59;_a60.sourceworkflow=_a58;_a60.sourceproject=_a57;_a60.targetworkflow=_a5b;_a60.targetproject=_a5a;_a60.copyfiles=_a5c;_a60.date=date;_a60.provenance=_a5e.provenance;_a60.username=this.cookie("username");_a60.sessionId=this.cookie("sessionId");_a60.mode="copyWorkflow";console.log("Agua.Workflow.copyWorkflow    query: "+dojo.toJson(_a60,true));this.doPut({url:url,query:_a60,sync:false});return _a5f;},_copyWorkflow:function(_a61,_a62,_a63,_a64,date,_a65){console.log("XXXXXXXXXXXX Data._copyWorkflow    Data._copyWorkflow(sourceUser, sourceProject, sourceWorkflow, targetUser, targetProject, targetWorkflow, copyFiles, workflowNumber)");console.log("Agua.Workflow._copyWorkflow    BEFORE workflowObject: "+dojo.toJson(_a61));console.dir({workflowObject:_a61});console.log("Agua.Workflow._copyWorkflow    BEFORE workflowObject.name: "+_a61.name);console.log("Agua.Workflow._copyWorkflow    targetUser: "+_a62);console.log("Agua.Workflow._copyWorkflow    targetProject: "+_a63);console.log("Agua.Workflow._copyWorkflow    targetWorkflow: "+_a64);console.log("Agua.Workflow._copyWorkflow    date: "+date);var _a66=_a61.username;var _a67=_a61.name;var _a68=_a61.project;console.log("Agua.Workflow._copyWorkflow    sourceWorkflow: "+_a67);_a61=this.setProvenance(_a61,date);var _a69=this.getMaxWorkflowNumber(_a63);var _a6a;if(_a65){_a6a=_a65;}else{if(!_a69){_a6a=1;}else{_a6a=_a69+1;}}var _a6b=dojo.clone(_a61);_a6b.name=_a64;_a6b.project=_a63;_a6b.username=_a62;_a6b.number=_a6a;console.log("Agua.Workflow._copyWorkflow    AFTER newObject: ");console.dir({newObject:_a6b});console.dir({workflowObject:_a61});var keys=["project","name","number"];var _a6c=this.addData("workflows",_a6b,keys);if(_a6c==false){console.log("Agua.Workflow._copyWorkflow    Could not copy workflow to targetWorkflow: "+_a64);return false;}var _a6d;if(_a66!=_a62){_a6d=this.getSharedStagesByWorkflow(_a66,_a68,_a67);}else{_a6d=this.getStagesByWorkflow(_a68,_a67);}console.log("Agua.Workflow._copyWorkflow    stages.length: "+_a6d.length);for(var i=0;i<_a6d.length;i++){console.log("Agua.Workflow._copyWorkflow    stages["+i+"]: "+_a6d[i]);var _a6e=dojo.clone(_a6d[i]);_a6e.project=_a63;_a6e.workflow=_a64;this._addStage(_a6e);var _a6f;if(_a66!=_a62){_a6f=this.getSharedStageParameters(_a6d[i]);}else{_a6f=this.getStageParameters(_a6d[i]);}console.log("Agua.Workflow._copyWorkflow    stageparams.length: "+_a6f.length);var _a70=this;var _a71=_a68+"/"+_a67;var _a72=_a63+"/"+_a64;dojo.forEach(_a6f,function(_a73,j){_a6f[j].project=_a63;_a6f[j].workflow=_a64;if(_a6f[j].value!=null&&_a6f[j].value.replace){_a6f[j].value=_a6f[j].value.replace(_a71,_a72);}_a70._addStageParameter(_a6f[j]);});}var _a74=this.getSharedViews({username:_a66,project:_a68});if(_a74==null){_a74=[];}for(var i=0;i<_a74.length;i++){this._addStage(_a74[i]);}return true;},getWorkflowSubmit:function(_a75){if(!_a75){return;}var _a76=0;var _a77=this.getStagesByWorkflow(_a75.project,_a75.workflow);if(!_a77){return 1;}for(var i=0;i<_a77.length;i++){if(_a77[i].submit==1){return 1;}}return 0;},setProvenance:function(_a78,date){var _a79=_a78.provenance;var _a7a;if(!_a79){_a7a=[];}else{_a7a=dojo.fromJson(_a79);}if(!date){date=this.currentMysqlDate();}var item={copiedby:Agua.cookie("username"),original:dojo.clone(_a78),date:date};_a7a.push(item);_a79=dojo.toJson(_a7a);_a78.provenance=_a79;return _a78;}});}if(!dojo._hasResource["plugins.core.Plugin"]){dojo._hasResource["plugins.core.Plugin"]=true;dojo.provide("plugins.core.Plugin");dojo.declare("plugins.core.Plugin",null,{installed:false,setInstalled:function(){if(this.installed!=false&&installed!=true){return 0;}this.installed=true;return 1;},getInstalled:function(){return this.installed;},getVersion:function(){return this.version;},getDescription:function(){return this.description;},getPluginUrl:function(){return this.pluginUrl;},getInfo:function(){var info="";info+="Status: ";info+=this.getInstalled();info+="\n";info+="Version: ";info+=this.version();info+="\n";info+="Description: ";info+=this.description();info+="\n";info+="Plugin Url: ";info+=this.pluginUrl();info+="\n";return info;}});}if(!dojo._hasResource["plugins.core.PluginManager"]){dojo._hasResource["plugins.core.PluginManager"]=true;dojo.provide("plugins.core.PluginManager");dojo.declare("plugins.core.PluginManager",null,{_installedPlugins:{},plugins:[],parentWidget:null,constructor:function(args){if(args.pluginsList!=null&&args.pluginsList){this.pluginsList=args.pluginsList;}if(args.parentWidget!=null&&args.parentWidget){this.parentWidget=args.parentWidget;}Agua.controllers["core"]=Agua;this.loadPlugins();},loadPlugins:function(){console.group("PluginManager.loadPlugins    this.pluginsList: ");console.dir({this_pluginsList:this.pluginsList});var _a7b=this.pluginsList.length;if(!_a7b){return;}var _a7c=2*_a7b;for(var i=0;i<this.pluginsList.length;i++){var _a7d=parseInt((i*2)+1);this.percentProgress(_a7c,_a7d);console.log("PluginManager.loadPlugins    ******* plugin number"+_a7d);var _a7e=this.pluginsList[i];console.log("PluginManager.loadPlugins     this.pluginsList["+i+"]:  "+_a7e);var _a7f=_a7e.match(/^plugins\.([^\.]+)\./)[1];dojo["require"](_a7e);var _a80=eval("new "+_a7e+"()");Agua.controllers[_a7f]=_a80;console.log("PluginManager.loadPlugins    DOING newPlugin.postLoad: "+_a80.postLoad);if(_a80.postLoad){_a80.postLoad();}var _a81=this.checkDependencies(_a80.dependencies);var _a7d=parseInt((i*2)+2);this.percentProgress(_a7c,_a7d);}console.log("PluginManager.loadPlugins    \tFINAL Agua.data: "+Agua.data);},percentProgress:function(_a82,_a83){var _a84=0;if(_a82==_a83){_a84=100;}else{_a84=parseInt((_a83/_a82)*100);}console.log("PluginManager.percentProgress    percent: "+_a84);if(!Agua.login){return;}Agua.login.progressBar.set({value:_a84,progress:_a84});},checkDependencies:function(_a85){return 1;if(!_a85){return 1;}for(var i=0;i<_a85.length;i++){var _a86=_a85[i].name;var _a87=_a85[i].version;if(_a86){var _a88=Agua.controllers[_a86];if(_a88.version>=_a87){if(!_a88.installed){return 0;}else{}}else{return 0;}}else{return 0;}}return 1;},getInstalledPlugins:function(){return this._installedPlugins;}});}if(!dojo._hasResource["plugins.core.Agua"]){dojo._hasResource["plugins.core.Agua"]=true;dojo.provide("plugins.core.Agua");if(1){}dojo.declare("plugins.core.Agua",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.core.Agua.Data,plugins.core.Agua.Admin,plugins.core.Agua.App,plugins.core.Agua.Aws,plugins.core.Agua.Cluster,plugins.core.Agua.Feature,plugins.core.Agua.File,plugins.core.Agua.Group,plugins.core.Agua.Hub,plugins.core.Agua.Package,plugins.core.Agua.Parameter,plugins.core.Agua.Project,plugins.core.Agua.Report,plugins.core.Agua.Shared,plugins.core.Agua.Sharing,plugins.core.Agua.Source,plugins.core.Agua.Stage,plugins.core.Agua.StageParameter,plugins.core.Agua.User,plugins.core.Agua.View,plugins.core.Agua.Workflow],{name:"plugins.core.Agua",version:"0.01",description:"Create widget for positioning Plugin buttons and tab container for displaying Plugin tabs",url:"",dependencies:[],pluginsList:["plugins.data.Controller","plugins.files.Controller","plugins.admin.Controller","plugins.sharing.Controller","plugins.folders.Controller","plugins.workflow.Controller","plugins.view.Controller","plugins.home.Controller"],templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"controls\"\n\t\tclass=\"controls\"\n\t\tstyle=\"min-height: 100% !important; min-width: 100% !important;\"\t\t\n\t>\n\n\t\t<div\n            dojoAttachPoint=\"toolbar\"\n            dojoType=\"dijit.Toolbar\"\n            class=\"toolbar\"\n        >\n        </div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"tabs\"\n\t\t\tdojoType=\"dijit.layout.TabContainer\"\n\t\t\tclass=\"tabs\"\n\t\t\tuseSlider=\"false\"\n\t\t\ttabPosition=\"top\"\n\t\t\ttabStrip=\"false\"\n\t\t\tstyle=\"position: relative; top: 0px; left: 0px; height: 100% !important; min-height: 850px !important; width: 1200px !important; min-width: 100% !important; right: auto; bottom: auto;\"\n\t\t>\n\t\t</div>\n\t\n<!--\t\t<div\n\t\t\tdojoAttachPoint=\"toaster\"\n\t\t\tdojoType=\"dojox.widget.Toaster\"\n\t\t\tclass=\"toaster\" \n\t\t\tpositionDirection=\"bl-right\"\n\t\t\tduration=\"500\" \n\t\t\tmessageTopic=\"toastTopic\"\n\t\t></div> \n-->\t\t\n\t</div>\n\t\n\t<div dojoAttachPoint=\"fileManagerNode\"></div>\n\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","core/css/agua.css"),dojo.moduleUrl("plugins","core/css/controls.css"),],widgetsInTemplate:true,controllers:new Object(),splashNode:null,messageNode:null,pluginManager:null,cookies:new Object,css:new Object,cgiUrl:null,htmlUrl:null,widgets:new Object,testing:false,constructor:function(args){console.log("Agua.constructor     plugins.core.Agua.constructor    args:");console.dir({args:args});this.cgiUrl=args.cgiUrl;this.htmlUrl=args.htmlUrl;if(args.pluginsList!=null){this.pluginsList=args.pluginsList;}this.database=args.database;this.dataUrl=args.dataUrl;console.log("Agua.constructor     this.database: "+this.database);console.log("Agua.constructor     this.testing: "+this.testing);console.log("Agua.constructor     this.dataUrl: "+this.dataUrl);},postCreate:function(){this.startup();},startup:function(){console.log("Agua.startup    plugins.core.Agua.startup()");console.log("Agua.startup    BEFORE loadCSS()");this.loadCSS();console.log("Agua.startup    AFTER loadCSS()");var _a89=dojo.byId("attachPoint");_a89.appendChild(this.containerNode);var _a8a=dojo.connect(this.aguaButton,"onClick",this,"reload");this.inherited(arguments);this.updater=new plugins.core.Updater();this.setStandby();this.setToaster();console.log("Agua.startup    AFTER this.setToaster()");},displayVersion:function(){console.log("Agua.displayVersion     plugins.core.Agua.displayVersion()");var _a8b=this.getPackages();console.log("Agua.displayVersion    packages: ");console.dir({packages:_a8b});var _a8c=this._getObjectByKeyValue(_a8b,"package","agua");console.log("Agua.displayVersion    packageObject:");console.dir({packageObject:_a8c});if(!_a8c){return;}var _a8d=_a8c.version;console.log("Agua.displayVersion     version: "+_a8d);},startPlugins:function(){console.log("Agua.startPlugins     plugins.core.Agua.startPlugins()");return this.loadPlugins(this.pluginsList);},loadPlugins:function(_a8e){console.log("Agua.loadPlugins    pluginsList: "+dojo.toJson(_a8e));if(_a8e==null){_a8e=this.pluginsList;}this.setStandby();console.dir({standby:this.standby});console.log("DOING this.standby.show()");this.standby.show();console.log("Agua.loadPlugins    Creating pluginsManager...");this.pluginManager=new plugins.core.PluginManager({parentWidget:this,pluginsList:_a8e});console.log("Agua.loadPlugins    After load PluginManager");if(this.controllers["home"]){console.log("Agua.loadPlugins    this.controllers[home].createTab()");this.controllers["home"].createTab();}},setStandby:function(){console.log("Agua.setStandby    _GroupDragPane.setStandby()");if(this.standby!=null){return this.standby;}var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.containerNode,centerIndicator:"text",text:"Waiting for remote featureName",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);dojo.addClass(this.standby.domNode,"view");dojo.addClass(this.standby.domNode,"standby");console.log("Agua.setStandby    this.standby: "+this.standby);return this.standby;},addWidget:function(type,_a8f){if(Agua.widgets[type]==null){Agua.widgets[type]=new Array;}Agua.widgets[type].push(_a8f);},removeWidget:function(type,_a90){console.log("Agua.removeWidget    core.Agua.removeWidget(type, widget)");console.log("Agua.removeWidget    type: "+type);console.log("Agua.removeWidget    widget: "+_a90);if(Agua.widgets[type]==null){console.log("Agua.removeWidget    No widgets of type: "+type);return;}console.log("Agua.removeWidget    BEFORE Agua.widgets[type].length: "+Agua.widgets[type].length);for(var i=0;i<Agua.widgets[type].length;i++){if(Agua.widgets[type][i].id==_a90.id){Agua.widgets[type].splice(i,1);}}console.log("Agua.removeWidget    AFTER Agua.widgets[type].length: "+Agua.widgets[type].length);},addToolbarButton:function(_a91){console.log("Agua.addToolbarButton    label: "+_a91);console.log("Agua.addToolbarButton    this.toolbar: "+this.toolbar);if(this.toolbar==null){return;}var _a92=new dijit.form.Button({label:_a91,showLabel:true,iconClass:"dijitEditorIcon dijitEditorIcon"+_a91});this.toolbar.addChild(_a92);return _a92;},cookie:function(name,_a93){if(_a93!=null){this.cookies[name]=_a93;}else{if(name!=null){return this.cookies[name];}}return 0;},loadCSSFile:function(_a94){if(this.loadedCssFiles==null||!this.loadedCssFiles){this.loadedCssFiles=new Object;}if(!this.loadedCssFiles[_a94]){console.log("Agua.loadCSSFile    Loading cssFile: "+_a94);var _a95=document.createElement("link");_a95.type="text/css";_a95.rel="stylesheet";_a95.href=_a94;document.getElementsByTagName("head")[0].appendChild(_a95);this.loadedCssFiles[_a94]=1;}else{}return this.loadedCssFiles;},fetchJsonData:function(){console.log("Agua.fetchJsonData    plugins.core.Agua.fetchJsonData()");var url=this.dataUrl;console.log("Agua.fetchJsonData    url: "+url);var _a96=this;dojo.xhrGet({url:url,sync:true,handleAs:"json",handle:function(data){console.log("Agua.fetchJsonData    Setting this.data: "+data);_a96.data=data;},error:function(){console.log("Agua.Error with JSON Post, response: "+response);}});},reload:function(){var url=window.location;window.open(location,"_blank","toolbar=1,location=0,directories=0,status=0,menubar=1,scrollbars=1,resizable=1,navigation=0");},logout:function(){console.clear();var _a97=Agua.toolbar.getChildren();if(!_a97){return;}for(var i=0;i<_a97.length;i++){var _a98=_a97[i];controller=_a98.parentWidget;console.log("Agua.logout    controller "+i);console.dir({controller:controller});var name=controller.id.match(/plugins_([^_]+)/)[1];console.log("Agua.logout    Doing delete Agua.controllers["+name+"]");delete Agua.controllers[name];console.log("Agua.logout    Doing controllers.destroyRecursive()");controller.destroyRecursive();}delete this.data;}});}if(!dojo._hasResource["plugins.core.PluginController"]){dojo._hasResource["plugins.core.PluginController"]=true;dojo.provide("plugins.core.PluginController");dojo.declare("plugins.core.PluginController",[dijit._Widget,dijit._Templated,plugins.core.Common],{paneId:null,templatePath:null,widgetsInTemplate:true,cssFiles:[],tabPanes:[],tabClass:null,constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _a99=dojo.connect(this.menuButton,"onClick",this,"createTab",{});},createTab:function(args){console.log("core.Controller.createTab    args: ");console.dir({args:args});window.getSelection().removeAllRanges();if(!args){args={};}var _a9a=dojo.getObject(this.tabClass);var _a9b=new _a9a(args);this.tabPanes.push(_a9b);this._supportingWidgets.push(_a9b);}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.data.Controller"]){dojo._hasResource["plugins.data.Controller"]=true;dojo.provide("plugins.data.Controller");dojo.declare("plugins.data.Controller",[plugins.core.Common],{name:"plugins.data.Controller",version:"0.01",description:"Load data from remote host",url:"",dependencies:[],data:null,constructor:function(args){console.log("data.Controller.constructor     plugins.data.Controller.constructor");this.startup();},startup:function(){console.log("data.Controller.startup    plugins.data.Controller.startup()");console.log("data.Controller.startup    Data: "+Data);if(Data!=null){if(Data.data!=null){console.log("data.Controller.startup    Data.data: ");console.dir({data:Data.data});this.data=Data.data;Agua.data=Data.data;}else{this.getData();}}else{this.getData();}Data=this;},getData:function(){console.log("data.Controller.getData    plugins.data.Controller.getData()");console.log("data.Controller.getData    Agua.dataUrl: "+Agua.dataUrl);if(Agua.dataUrl!=null){return this.fetchJsonData();}var url=Agua.cgiUrl+"workflow.cgi";var _a9c=new Object;_a9c.username=Agua.cookie("username");_a9c.sessionId=Agua.cookie("sessionId");if(Agua.database){_a9c.database=Agua.database;}_a9c.mode="getData";console.log("data.Controller.getData    query: ");console.dir({query:_a9c});if(Data==null){Data=new Object;}var _a9d=this;dojo.xhrPut({url:url,putData:dojo.toJson(_a9c),handleAs:"json",preventCache:true,sync:true,load:function(_a9e,_a9f){if(_a9e.error){Agua.error(_a9e.error);}else{Data.data=_a9e;_a9d.data=_a9e;Agua.data=_a9e;console.log("data.Controller.getData    BEFORE thisObject.responseToData(response)");Agua.displayVersion();}},error:function(_aa0,_aa1){console.log("Error with JSON Post, response: "+dojo.toJson(_aa0)+", ioArgs: "+dojo.toJson(_aa1));}});if(this.testing){Agua.cgiUrl="../";}return null;},fetchJsonData:function(){console.log("data.Controller.fetchJsonData    plugins.data.Controller.fetchJsonData()");var url=Agua.dataUrl;console.log("data.Controller.fetchJsonData    url: "+url);console.log("data.Controller.fetchJsonData    DOING dojo.xhrGet");var _aa2=this;dojo.xhrGet({url:url,sync:true,handleAs:"json",load:function(_aa3){console.log("data.Controller.fetchJsonData    response: ",dojo.toJson(_aa3));if(Data!=null){Data.data=_aa3;}Agua.data=_aa3;},error:function(){Agua.error("Failed to fetch data");}});},getTable:function(_aa4){console.log("data.Controller.getTable    plugins.data.Controller.getTable(table)");console.log("data.Controller.getTable    table: "+_aa4);if(Agua.dataUrl!=null){console.log("data.Controller.getTable    Agua.dataUrl: "+Agua.dataUrl);console.log("data.Controller.getTable    Agua.dataUrl not null. Doing return this.fetchJsonData()");return this.fetchJsonData();}var url=Agua.cgiUrl+"workflow.cgi";var _aa5=new Object;_aa5.username=Agua.cookie("username");_aa5.sessionId=Agua.cookie("sessionId");if(this.database!=null){_aa5.database=this.database;}_aa5.mode="getTable";_aa5.table=_aa4;console.log("data.Controller.getTable    query: "+dojo.toJson(_aa5,true));var _aa6=this;dojo.xhrPut({url:url,putData:dojo.toJson(_aa5),handleAs:"json",sync:true,load:function(_aa7,_aa8){console.log("data.Controller.JSON Post worked.");if(_aa7.error){console.log("data.Controller.getTable    xhrPut error: "+_aa7.error);}else{_aa6.responseToData(_aa7);}},error:function(_aa9,_aaa){console.log("data.Controller.Error with JSON Post, response: "+_aa9+", ioArgs: "+_aaa);}});},responseToData:function(_aab){console.log("data.Controller.responseToData    response: "+_aab);console.log("data.Controller.responseToData    response: "+dojo.toJson(_aab));var keys=this.hashkeysToArray(_aab);keys.sort();var _aac=this;dojo.forEach(keys,function(key){console.log("data.Controller.getData    storing key: "+key);Agua.data[key]=_aab[key];});},destroyRecursive:function(){dojo.destroy(this);}});}if(!dojo._hasResource["dojox.data.FileStore"]){dojo._hasResource["dojox.data.FileStore"]=true;dojo.provide("dojox.data.FileStore");dojo.declare("dojox.data.FileStore",null,{constructor:function(args){if(args&&args.label){this.label=args.label;}if(args&&args.url){this.url=args.url;}if(args&&args.options){if(dojo.isArray(args.options)){this.options=args.options;}else{if(dojo.isString(args.options)){this.options=args.options.split(",");}}}if(args&&args.pathAsQueryParam){this.pathAsQueryParam=true;}if(args&&"urlPreventCache" in args){this.urlPreventCache=args.urlPreventCache?true:false;}},url:"",_storeRef:"_S",label:"name",_identifier:"path",_attributes:["children","directory","name","path","modified","size","parentDir"],pathSeparator:"/",options:[],failOk:false,urlPreventCache:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojox.data.FileStore: a function was passed an item argument that was not an item");}},_assertIsAttribute:function(_aad){if(typeof _aad!=="string"){throw new Error("dojox.data.FileStore: a function was passed an attribute argument that was not an attribute name string");}},pathAsQueryParam:false,getFeatures:function(){return {"dojo.data.api.Read":true,"dojo.data.api.Identity":true};},getValue:function(item,_aae,_aaf){var _ab0=this.getValues(item,_aae);if(_ab0&&_ab0.length>0){return _ab0[0];}return _aaf;},getAttributes:function(item){return this._attributes;},hasAttribute:function(item,_ab1){this._assertIsItem(item);this._assertIsAttribute(_ab1);return (_ab1 in item);},getIdentity:function(item){console.log("dojox.data.FileStore.getIdentity    caller: "+this.isItem.caller.nom);console.log("dojox.data.FileStore.getIdentity    item: "+dojo.toJson(item));return this.getValue(item,this._identifier);},getIdentityAttributes:function(item){return [this._identifier];},isItemLoaded:function(item){var _ab2=this.isItem(item);if(_ab2&&typeof item._loaded=="boolean"&&!item._loaded){_ab2=false;}return _ab2;},loadItem:function(_ab3){var item=_ab3.item;var self=this;var _ab4=_ab3.scope||dojo.global;var _ab5={};if(this.options.length>0){_ab5.options=dojo.toJson(this.options);}if(this.pathAsQueryParam){_ab5.path=item.parentPath+this.pathSeparator+item.name;}var _ab6={url:this.pathAsQueryParam?this.url:this.url+"/"+item.parentPath+"/"+item.name,handleAs:"json-comment-optional",content:_ab5,preventCache:this.urlPreventCache,failOk:this.failOk};var _ab7=dojo.xhrGet(_ab6);_ab7.addErrback(function(_ab8){if(_ab3.onError){_ab3.onError.call(_ab4,_ab8);}});_ab7.addCallback(function(data){delete item.parentPath;delete item._loaded;dojo.mixin(item,data);self._processItem(item);if(_ab3.onItem){_ab3.onItem.call(_ab4,item);}});},getLabel:function(item){return this.getValue(item,this.label);},getLabelAttributes:function(item){return [this.label];},containsValue:function(item,_ab9,_aba){var _abb=this.getValues(item,_ab9);for(var i=0;i<_abb.length;i++){if(_abb[i]==_aba){return true;}}return false;},getValues:function(item,_abc){this._assertIsItem(item);this._assertIsAttribute(_abc);var _abd=item[_abc];if(typeof _abd!=="undefined"&&!dojo.isArray(_abd)){_abd=[_abd];}else{if(typeof _abd==="undefined"){_abd=[];}}return _abd;},isItem:function(item){console.log("dojox.data.FileStore.isItem    caller: "+this.isItem.caller.nom);console.log("dojox.data.FileStore.isItem    item: ");console.dir({item:item});console.log("dojox.data.FileStore.isItem    this._storeRef: "+this._storeRef);console.log("dojox.data.FileStore.isItem    item[this._storeRef]: "+item[this._storeRef]);if(item&&item[this._storeRef]===this){return true;}return false;},close:function(_abe){},fetch:function(_abf){console.log("dojox.data.FileStore.fetch    caller: "+this.fetch.caller.nom);console.log("dojox.data.FileStore.fetch    request: ");console.dir({request:_abf});_abf=_abf||{};if(!_abf.store){_abf.store=this;}var self=this;var _ac0=_abf.scope||dojo.global;var _ac1={};if(_abf.query){_ac1.query=dojo.toJson(_abf.query);}if(_abf.sort){_ac1.sort=dojo.toJson(_abf.sort);}if(_abf.queryOptions){_ac1.queryOptions=dojo.toJson(_abf.queryOptions);}if(typeof _abf.start=="number"){_ac1.start=""+_abf.start;}if(typeof _abf.count=="number"){_ac1.count=""+_abf.count;}if(this.options.length>0){_ac1.options=dojo.toJson(this.options);}console.log("dojox.data.FileStore.fetch    reqParams:");console.dir({reqParams:_ac1});var _ac2={url:this.url,preventCache:this.urlPreventCache,failOk:this.failOk,handleAs:"json-comment-optional",content:_ac1};var _ac3=dojo.xhrGet(_ac2);_ac3.addCallback(function(data){self._processResult(data,_abf);});_ac3.addErrback(function(_ac4){if(_abf.onError){_abf.onError.call(_ac0,_ac4,_abf);}});},fetchItemByIdentity:function(_ac5){var path=_ac5.identity;var self=this;var _ac6=_ac5.scope||dojo.global;var _ac7={};if(this.options.length>0){_ac7.options=dojo.toJson(this.options);}if(this.pathAsQueryParam){_ac7.path=path;}var _ac8={url:this.pathAsQueryParam?this.url:this.url+"/"+path,handleAs:"json-comment-optional",content:_ac7,preventCache:this.urlPreventCache,failOk:this.failOk};var _ac9=dojo.xhrGet(_ac8);_ac9.addErrback(function(_aca){if(_ac5.onError){_ac5.onError.call(_ac6,_aca);}});_ac9.addCallback(function(data){var item=self._processItem(data);if(_ac5.onItem){_ac5.onItem.call(_ac6,item);}});},_processResult:function(data,_acb){var _acc=_acb.scope||dojo.global;try{if(data.pathSeparator){this.pathSeparator=data.pathSeparator;}if(_acb.onBegin){_acb.onBegin.call(_acc,data.total,_acb);}var _acd=this._processItemArray(data.items);if(_acb.onItem){var i;for(i=0;i<_acd.length;i++){_acb.onItem.call(_acc,_acd[i],_acb);}_acd=null;}if(_acb.onComplete){_acb.onComplete.call(_acc,_acd,_acb);}}catch(e){if(_acb.onError){_acb.onError.call(_acc,e,_acb);}else{console.log(e);}}},_processItemArray:function(_ace){var i;for(i=0;i<_ace.length;i++){this._processItem(_ace[i]);}return _ace;},_processItem:function(item){if(!item){return null;}item[this._storeRef]=this;if(item.children&&item.directory){if(dojo.isArray(item.children)){var _acf=item.children;var i;for(i=0;i<_acf.length;i++){var name=_acf[i];if(dojo.isObject(name)){_acf[i]=this._processItem(name);}else{_acf[i]={name:name,_loaded:false,parentPath:item.path};_acf[i][this._storeRef]=this;}}}else{delete item.children;}}return item;}});}if(!dojo._hasResource["plugins.data.FileStore"]){dojo._hasResource["plugins.data.FileStore"]=true;dojo.provide("plugins.data.FileStore");dojo.declare("plugins.data.FileStore",[dojox.data.FileStore],{_processItemArray:function(_ad0){if(_ad0==null){return [];}var i;for(i=0;i<_ad0.length;i++){this._processItem(_ad0[i]);}return _ad0;},_assertIsItem:function(item){if(item==null){return false;}if(!this.isItem(item)){throw new Error("dojox.data.FileStore: a function was passed an item argument that was not an item");}},});}if(!dojo._hasResource["plugins.dnd.Target"]){dojo._hasResource["plugins.dnd.Target"]=true;dojo.provide("plugins.dnd.Target");dojo.declare("plugins.dnd.Target",[dojo.dnd.Target],{contextMenu:null,parentWidget:null,droppingApp:null,dragTypes:["draggableItem"],constructor:function(node,_ad1){console.log("Target.constructor    params: "+_ad1);console.log("Target.constructor    params.contextMenu: "+_ad1.contextMenu);console.log("Target.constructor    params.this.parentWidget: "+_ad1.parentWidget);this.contextMenu=_ad1.contextMenu;this.parentWidget=_ad1.parentWidget;this.core=_ad1.core;if(_ad1&&_ad1.dragTypes){this.dragTypes=_ad1.dragTypes;}this.isSource=false;dojo.removeClass(this.node,"dojoDndSource");},resetDropping:function(){this.droppingApp=false;},onDndDrop:function(_ad2,_ad3,copy){console.log("Target.onDndDrop    XXXXXXXXXXXXXXXXXXXXXXXX this.droppingApp: "+this.droppingApp);var _ad4=this.checkAcceptance(_ad2,_ad3);console.log("Target.onDndDrop    XXXXXXXXXXXXXXXXXXXXXXXX acceptance: "+_ad4);if(!_ad4){console.log("Target.onDndDrop    acceptance is FALSE. Returning");return;}if(!this.accept||this.accept.length<1){console.log("Target.onDndDrop    this.accept is empty. Returning");return;}if(this.droppingApp){console.log("Target.onDndDrop    this.droppingApp is true. Returning");return;}else{this.droppingApp=true;}console.log("Target.onDndDrop    Set this.droppingApp: "+this.droppingApp);console.log("Target.onDndDrop    this: "+this);console.log("Target.onDndDrop    source: ");console.dir({source:_ad2});console.log("Target.onDndDrop    nodes.length: "+_ad3.length);console.log("Target.onDndDrop    nodes[0].data: "+_ad3[0].data);console.dir({nodes_0:_ad3[0]});var _ad5=this;if(_ad3[0].data==null){return;}var _ad6;do{if(this.containerState!="Over"){break;}var _ad7=this._normalizedCreator;if(this!=_ad2){this._normalizedCreator=function(node,hint){var t=_ad2.getItem(node.id);var n=node.cloneNode(true);n.parentWidget=node.parentWidget;n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}this._removeSelection();if(this!=_ad2){this._removeAnchor();}if(this!=_ad2&&!copy&&!this.creator){_ad2.selectNone();}this.insertNodes(true,_ad3,this.before,this.current);this.sync();var _ad8=false;var _ad9=this.getAllNodes();console.log("Target.onDndDrop    allNodes: "+_ad9);console.log("Target.onDndDrop    allNodes.length: "+_ad9.length);dojo.forEach(_ad9,function(node,i){if(node.application==null){node.application=dojo.clone(_ad3[0].data);console.log("Target.onDndDrop    Setting node.application: ");console.dir({node_application:node.application});node.application.appname=node.application.name;node.application.appnumber=(i+1).toString();node.application.number=(i+1).toString();node.number=(i+1).toString();if(node.application["cluster"]==null){node.application["cluster"]="";}var _ada=_ad5.core.userWorkflows.getProject();var _adb=_ad5.core.userWorkflows.getWorkflow();node.application.project=_ada;node.application.workflow=_adb;var _adc=Agua._getWorkflow({name:_adb,project:_ada});console.log("Target.onDndDrop    workflowobject: ");console.dir({workflowobject:_adc});var _add=_adc.number;console.log("Target.onDndDrop    workflownumber: "+_add);node.application.workflownumber=dojo.clone(_add);node.application.username=Agua.cookie("username");console.log("Target.onDndDrop    node.application: ");console.dir({application:node.application});var _ade=new plugins.workflow.StageRow(node.application);console.log("Target.onDndDrop    stageRow: "+_ade);console.log("Target.onDndDrop    stageRow.domNode: "+_ade.domNode);console.log("Target.onDndDrop    stageRow.application: "+dojo.toJson(_ade.application));_ade.core=_ad5.core;_ade.workflowWidget=_ad5.core.userWorkflows.parentWidget;node.innerHTML="";node.appendChild(_ade.domNode);_ad5.contextMenu.bind(node);node.parentWidget=_ade;console.log("Target.onDndDrop    node.id: "+node.id);console.log("Target.onDndDrop    Set node.parentWidget: "+node.parentWidget);console.log("Target.onDndDrop    BEFORE    Agua.insertStage(node.application)");var _adf=Agua.insertStage(node.application);if(!_adf){console.log("Target.onDndDrop    Failed to add stage to Agua data");console.log("Target.onDndDrop    Setting thisObject.droppingApp to false and returning");setTimeout(_ad5.resetDropping,1000);return;}console.log("Target.onDndDrop    AFTER    Agua.insertStage(node.application)");node.onclick=function(e){console.log("Target.onDndDrop    node.onclick fired, calling thisObject.core.userWorkflows.loadParametersPane(node, null)");console.log("Target.onDndDrop    node: "+node);_ad5.core.userWorkflows.loadParametersPane(node,null);};_ad5.contextMenu.bind(node);_ad5.core.userWorkflows.getChainedValues(node);_ad8=true;console.log("Target.onDndDrop    Setting thisObject.droppingApp = false");_ad5.droppingApp=false;_ad6=node;return;}console.log("Target.onDndDrop    belowInsertedNode: "+_ad8);if(_ad8==true){console.log("Target.onDndDrop    node "+i+" is belowInsertedNode");console.log("Target.onDndDrop    DOING thisObject.core.io.chainStage(node.application, force)");console.log("Target.onDndDrop    thisObject.core.userWorkflows: "+_ad5.core.userWorkflows);var _ae0=true;console.log("Target.onDndDrop    Doing thisObject.core.io.chainStage(node.application, force)");_ad5.core.io.chainStage(node.application,_ae0);}});console.log("Target.onDndDrop    BEFORE thisObject.droppingApp = false");console.log("Target.onDndDrop    thisObject.core.userWorkflows: "+_ad5.core.userWorkflows);_ad5.droppingApp=false;_ad5._normalizedCreator=_ad7;}while(false);setTimeout(function(){console.log("Target.onDndDrop    Doing this.core.userWorkflows.resetNumbers()");_ad5.core.userWorkflows.resetNumbers();console.log("Target.onDndDrop    Setting this.core.runStatus.polling TO FALSE");if(_ad5.core.runStatus){_ad5.core.runStatus.polling=false;}console.log("Target.onDndDrop    Doing this.core.userWorkflows.loadParametersPane(newNode)");console.dir({thisObject:_ad5});_ad5.core.userWorkflows.loadParametersPane(_ad6);},100);console.log("Target.onDndDrop    BEFORE this.onDndCancel");this.onDndCancel();console.log("Target.onDndDrop    END OF this.onDndCancel");}});}if(!dojo._hasResource["dojox.html.metrics"]){dojo._hasResource["dojox.html.metrics"]=true;dojo.provide("dojox.html.metrics");(function(){var dhm=dojox.html.metrics;dhm.getFontMeasurements=function(){var _ae1={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(dojo.isIE){dojo.doc.documentElement.style.fontSize="100%";}var div=dojo.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";dojo.body().appendChild(div);for(var p in _ae1){ds.fontSize=p;_ae1[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}dojo.body().removeChild(div);div=null;return _ae1;};var _ae2=null;dhm.getCachedFontMeasurements=function(_ae3){if(_ae3||!_ae2){_ae2=dhm.getFontMeasurements();}return _ae2;};var _ae4=null,_ae5={};dhm.getTextBox=function(text,_ae6,_ae7){var m,s;if(!_ae4){m=_ae4=dojo.doc.createElement("div");var c=dojo.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";dojo.body().appendChild(c);}else{m=_ae4;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_ae6){for(var i in _ae6){if(i in _ae5){continue;}s[i]=_ae6[i];}}if(arguments.length>2&&_ae7){m.className=_ae7;}m.innerHTML=text;var box=dojo.position(m);box.w=m.parentNode.scrollWidth;return box;};var _ae8={w:16,h:16};dhm.getScrollbar=function(){return {w:_ae8.w,h:_ae8.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_ae9){var f=dhm._fontResizeNode=dojo.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";if(dojo.isIE){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[dojox._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[dojox._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");dojo.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};dojo.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(dojo.isIE&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});dojo.addOnLoad(function(){try{var n=dojo.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";dojo.body().appendChild(n);_ae8.w=n.offsetWidth-n.clientWidth;_ae8.h=n.offsetHeight-n.clientHeight;dojo.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in dojo.config&&!!dojo.config.fontSizeWatch){dhm.initOnFontResize();}});})();}if(!dojo._hasResource["dojox.widget.RollingList"]){dojo._hasResource["dojox.widget.RollingList"]=true;dojo.provide("dojox.widget.RollingList");dojo.experimental("dojox.widget.RollingList");dojo.declare("dojox.widget._RollingListPane",[dijit.layout.ContentPane,dijit._Templated,dijit._Contained],{templateString:"<div class=\"dojoxRollingListPane\"><table><tbody><tr><td dojoAttachPoint=\"containerNode\"></td></tr></tbody></div>",parentWidget:null,parentPane:null,store:null,items:null,query:null,queryOptions:null,_focusByNode:true,minWidth:0,_setContentAndScroll:function(cont,_aea){this._setContent(cont,_aea);this.parentWidget.scrollIntoView(this);},_updateNodeWidth:function(n,min){n.style.width="";var _aeb=dojo.marginBox(n).w;if(_aeb<min){dojo.marginBox(n,{w:min});}},_onMinWidthChange:function(v){this._updateNodeWidth(this.domNode,v);},_setMinWidthAttr:function(v){if(v!==this.minWidth){this.minWidth=v;this._onMinWidthChange(v);}},startup:function(){if(this._started){return;}if(this.store&&this.store.getFeatures()["dojo.data.api.Notification"]){window.setTimeout(dojo.hitch(this,function(){this.connect(this.store,"onSet","_onSetItem");this.connect(this.store,"onNew","_onNewItem");this.connect(this.store,"onDelete","_onDeleteItem");}),1);}this.connect(this.focusNode||this.domNode,"onkeypress","_focusKey");this.parentWidget._updateClass(this.domNode,"Pane");this.inherited(arguments);this._onMinWidthChange(this.minWidth);},_focusKey:function(e){if(e.charOrCode==dojo.keys.BACKSPACE){dojo.stopEvent(e);return;}else{if(e.charOrCode==dojo.keys.LEFT_ARROW&&this.parentPane){this.parentPane.focus();this.parentWidget.scrollIntoView(this.parentPane);}else{if(e.charOrCode==dojo.keys.ENTER){this.parentWidget._onExecute();}}}},focus:function(_aec){if(this.parentWidget._focusedPane!=this){this.parentWidget._focusedPane=this;this.parentWidget.scrollIntoView(this);if(this._focusByNode&&(!this.parentWidget._savedFocus||_aec)){try{(this.focusNode||this.domNode).focus();}catch(e){}}}},_onShow:function(){if((this.store||this.items)&&((this.refreshOnShow&&this.domNode)||(!this.isLoaded&&this.domNode))){console.log("dojox.widget.RollingListPane._onShow    Doing this.refresh()");this.refresh();}},_load:function(){console.log("dojox.widget.RollingListPane._load    caller: "+this._load.caller.nom);this.isLoaded=false;if(this.items){this._setContentAndScroll(this.onLoadStart(),true);window.setTimeout(dojo.hitch(this,"_doQuery"),1);}else{console.log("dojox.widget.RollingListPane._load    Doing this._doQuery()");this._doQuery();}},_doLoadItems:function(_aed,_aee){var _aef=0,_af0=this.store;dojo.forEach(_aed,function(item){if(!_af0.isItemLoaded(item)){_aef++;}});if(_aef===0){_aee();}else{var _af1=function(item){_aef--;if((_aef)===0){_aee();}};dojo.forEach(_aed,function(item){if(!_af0.isItemLoaded(item)){_af0.loadItem({item:item,onItem:_af1});}});}},_doQuery:function(){if(!this.domNode){return;}var _af2=this.parentWidget.preloadItems;_af2=(_af2===true||(this.items&&this.items.length<=Number(_af2)));if(this.items&&_af2){this._doLoadItems(this.items,dojo.hitch(this,"onItems"));}else{if(this.items){this.onItems();}else{this._setContentAndScroll(this.onFetchStart(),true);console.log("dojox.widget.RollingList._doQuery    this.query: "+this.query);this.store.fetch({query:this.query,onComplete:function(_af3){this.items=_af3;this.onItems();},onError:function(e){this._onError("Fetch",e);},scope:this});}}},_hasItem:function(item){var _af4=this.items||[];for(var i=0,_af5;(_af5=_af4[i]);i++){if(this.parentWidget._itemsMatch(_af5,item)){return true;}}return false;},_onSetItem:function(item,_af6,_af7,_af8){if(this._hasItem(item)){this.refresh();}},_onNewItem:function(_af9,_afa){var sel;if((!_afa&&!this.parentPane)||(_afa&&this.parentPane&&this.parentPane._hasItem(_afa.item)&&(sel=this.parentPane._getSelected())&&this.parentWidget._itemsMatch(sel.item,_afa.item))){this.items.push(_af9);this.refresh();}else{if(_afa&&this.parentPane&&this._hasItem(_afa.item)){this.refresh();}}},_onDeleteItem:function(_afb){if(this._hasItem(_afb)){this.items=dojo.filter(this.items,function(i){return (i!=_afb);});this.refresh();}},onFetchStart:function(){return this.loadingMessage;},onFetchError:function(_afc){return this.errorMessage;},onLoadStart:function(){return this.loadingMessage;},onLoadError:function(_afd){return this.errorMessage;},onItems:function(){if(!this.onLoadDeferred){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));}console.log("RollingList.onItems    Doing this._onLoadHandler()");this._onLoadHandler();}});dojo.declare("dojox.widget._RollingListGroupPane",[dojox.widget._RollingListPane],{templateString:"<div><div dojoAttachPoint=\"containerNode\"></div>"+"<div dojoAttachPoint=\"menuContainer\">"+"<div dojoAttachPoint=\"menuNode\"></div>"+"</div></div>",_menu:null,_setContent:function(cont){if(!this._menu){this.inherited(arguments);}},_onMinWidthChange:function(v){if(!this._menu){return;}var _afe=dojo.marginBox(this.domNode).w;var _aff=dojo.marginBox(this._menu.domNode).w;this._updateNodeWidth(this._menu.domNode,v-(_afe-_aff));},onItems:function(){var _b00,_b01=false;if(this._menu){_b00=this._getSelected();this._menu.destroyRecursive();}this._menu=this._getMenu();var _b02,_b03;if(this.items.length){dojo.forEach(this.items,function(item){_b02=this.parentWidget._getMenuItemForItem(item,this);if(_b02){if(_b00&&this.parentWidget._itemsMatch(_b02.item,_b00.item)){_b03=_b02;}this._menu.addChild(_b02);}},this);}else{_b02=this.parentWidget._getMenuItemForItem(null,this);if(_b02){this._menu.addChild(_b02);}}if(_b03){this._setSelected(_b03);if((_b00&&!_b00.children&&_b03.children)||(_b00&&_b00.children&&!_b03.children)){var _b04=this.parentWidget._getPaneForItem(_b03.item,this,_b03.children);if(_b04){this.parentWidget.addChild(_b04,this.getIndexInParent()+1);}else{this.parentWidget._removeAfter(this);this.parentWidget._onItemClick(null,this,_b03.item,_b03.children);}}}else{if(_b00){this.parentWidget._removeAfter(this);}}this.containerNode.innerHTML="";this.containerNode.appendChild(this._menu.domNode);this.parentWidget.scrollIntoView(this);this._checkScrollConnection(true);this.inherited(arguments);this._onMinWidthChange(this.minWidth);},_checkScrollConnection:function(_b05){var _b06=this.store;if(this._scrollConn){this.disconnect(this._scrollConn);}delete this._scrollConn;if(!dojo.every(this.items,function(i){return _b06.isItemLoaded(i);})){if(_b05){this._loadVisibleItems();}this._scrollConn=this.connect(this.domNode,"onscroll","_onScrollPane");}},startup:function(){this.inherited(arguments);this.parentWidget._updateClass(this.domNode,"GroupPane");},focus:function(_b07){if(this._menu){if(this._pendingFocus){this.disconnect(this._pendingFocus);}delete this._pendingFocus;var _b08=this._menu.focusedChild;if(!_b08){var _b09=dojo.query(".dojoxRollingListItemSelected",this.domNode)[0];if(_b09){_b08=dijit.byNode(_b09);}}if(!_b08){_b08=this._menu.getChildren()[0]||this._menu;}this._focusByNode=false;if(_b08.focusNode){if(!this.parentWidget._savedFocus||_b07){try{_b08.focusNode.focus();}catch(e){}}window.setTimeout(function(){try{dojo.window.scrollIntoView(_b08.focusNode);}catch(e){}},1);}else{if(_b08.focus){if(!this.parentWidget._savedFocus||_b07){_b08.focus();}}else{this._focusByNode=true;}}this.inherited(arguments);}else{if(!this._pendingFocus){this._pendingFocus=this.connect(this,"onItems","focus");}}},_getMenu:function(){var self=this;var menu=new dijit.Menu({parentMenu:this.parentPane?this.parentPane._menu:null,onCancel:function(_b0a){if(self.parentPane){self.parentPane.focus(true);}},_moveToPopup:function(evt){if(this.focusedChild&&!this.focusedChild.disabled){this.focusedChild._onClick(evt);}}},this.menuNode);this.connect(menu,"onItemClick",function(item,evt){if(item.disabled){return;}evt.alreadySelected=dojo.hasClass(item.domNode,"dojoxRollingListItemSelected");if(evt.alreadySelected&&((evt.type=="keypress"&&evt.charOrCode!=dojo.keys.ENTER)||(evt.type=="internal"))){var p=this.parentWidget.getChildren()[this.getIndexInParent()+1];if(p){p.focus(true);this.parentWidget.scrollIntoView(p);}}else{this._setSelected(item,menu);this.parentWidget._onItemClick(evt,this,item.item,item.children);if(evt.type=="keypress"&&evt.charOrCode==dojo.keys.ENTER){this.parentWidget._onExecute();}}});if(!menu._started){menu.startup();}return menu;},_onScrollPane:function(){if(this._visibleLoadPending){window.clearTimeout(this._visibleLoadPending);}this._visibleLoadPending=window.setTimeout(dojo.hitch(this,"_loadVisibleItems"),500);},_loadVisibleItems:function(){delete this._visibleLoadPending;var menu=this._menu;if(!menu){return;}var _b0b=menu.getChildren();if(!_b0b||!_b0b.length){return;}var _b0c=function(n,m,pb){var s=dojo.getComputedStyle(n);var r=0;if(m){r+=dojo._getMarginExtents(n,s).t;}if(pb){r+=dojo._getPadBorderExtents(n,s).t;}return r;};var _b0d=_b0c(this.domNode,false,true)+_b0c(this.containerNode,true,true)+_b0c(menu.domNode,true,true)+_b0c(_b0b[0].domNode,true,false);var h=dojo.contentBox(this.domNode).h;var _b0e=this.domNode.scrollTop-_b0d-(h/2);var _b0f=_b0e+(3*h/2);var _b10=dojo.filter(_b0b,function(c){var cnt=c.domNode.offsetTop;var s=c.store;var i=c.item;return (cnt>=_b0e&&cnt<=_b0f&&!s.isItemLoaded(i));});var _b11=dojo.map(_b10,function(c){return c.item;});var _b12=dojo.hitch(this,function(){var _b13=this._getSelected();var _b14;dojo.forEach(_b11,function(item,idx){var _b15=this.parentWidget._getMenuItemForItem(item,this);var _b16=_b10[idx];var oIdx=_b16.getIndexInParent();menu.removeChild(_b16);if(_b15){if(_b13&&this.parentWidget._itemsMatch(_b15.item,_b13.item)){_b14=_b15;}menu.addChild(_b15,oIdx);if(menu.focusedChild==_b16){menu.focusChild(_b15);}}_b16.destroy();},this);this._checkScrollConnection(false);});this._doLoadItems(_b11,_b12);},_getSelected:function(menu){if(!menu){menu=this._menu;}if(menu){var _b17=this._menu.getChildren();for(var i=0,item;(item=_b17[i]);i++){if(dojo.hasClass(item.domNode,"dojoxRollingListItemSelected")){return item;}}}return null;},_setSelected:function(item,menu){if(!menu){menu=this._menu;}if(menu){dojo.forEach(menu.getChildren(),function(i){this.parentWidget._updateClass(i.domNode,"Item",{"Selected":(item&&(i==item&&!i.disabled))});},this);}}});dojo.declare("dojox.widget.RollingList",[dijit._Widget,dijit._Templated,dijit._Container],{templateString:dojo.cache("dojox.widget","RollingList/RollingList.html","<div class=\"dojoxRollingList ${className}\"\n\t><div class=\"dojoxRollingListContainer\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onkeypress:_onKey\"\n\t></div\n\t><div class=\"dojoxRollingListButtons\" dojoAttachPoint=\"buttonsNode\"\n        ><button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"okButton\"\n\t\t\t\tdojoAttachEvent=\"onClick:_onExecute\">${okButtonLabel}</button\n        ><button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"cancelButton\"\n\t\t\t\tdojoAttachEvent=\"onClick:_onCancel\">${cancelButtonLabel}</button\n\t></div\n></div>\n"),widgetsInTemplate:true,className:"",store:null,query:null,queryOptions:null,childrenAttrs:["children"],parentAttr:"",value:null,executeOnDblClick:true,preloadItems:false,showButtons:false,okButtonLabel:"",cancelButtonLabel:"",minPaneWidth:0,postMixInProperties:function(){this.inherited(arguments);var loc=dojo.i18n.getLocalization("dijit","common");this.okButtonLabel=this.okButtonLabel||loc.buttonOk;this.cancelButtonLabel=this.cancelButtonLabel||loc.buttonCancel;},_setShowButtonsAttr:function(_b18){var _b19=false;if((this.showButtons!=_b18&&this._started)||(this.showButtons==_b18&&!this.started)){_b19=true;}dojo.toggleClass(this.domNode,"dojoxRollingListButtonsHidden",!_b18);this.showButtons=_b18;if(_b19){if(this._started){this.layout();}else{window.setTimeout(dojo.hitch(this,"layout"),0);}}},_itemsMatch:function(_b1a,_b1b){if(!_b1a&&!_b1b){return true;}else{if(!_b1a||!_b1b){return false;}}return (_b1a==_b1b||(this._isIdentity&&this.store.getIdentity(_b1a)==this.store.getIdentity(_b1b)));},_removeAfter:function(idx){if(typeof idx!="number"){idx=this.getIndexOfChild(idx);}if(idx>=0){dojo.forEach(this.getChildren(),function(c,i){if(i>idx){this.removeChild(c);c.destroyRecursive();}},this);}var _b1c=this.getChildren(),_b1d=_b1c[_b1c.length-1];var _b1e=null;while(_b1d&&!_b1e){var val=_b1d._getSelected?_b1d._getSelected():null;if(val){_b1e=val.item;}_b1d=_b1d.parentPane;}if(!this._setInProgress){this._setValue(_b1e);}},addChild:function(_b1f,_b20){if(_b20>0){this._removeAfter(_b20-1);}this.inherited(arguments);if(!_b1f._started){_b1f.startup();}_b1f.attr("minWidth",this.minPaneWidth);this.layout();if(!this._savedFocus){_b1f.focus();}},_setMinPaneWidthAttr:function(_b21){if(_b21!==this.minPaneWidth){this.minPaneWidth=_b21;dojo.forEach(this.getChildren(),function(c){c.attr("minWidth",_b21);});}},_updateClass:function(node,type,_b22){if(!this._declaredClasses){this._declaredClasses=("dojoxRollingList "+this.className).split(" ");}dojo.forEach(this._declaredClasses,function(c){if(c){dojo.addClass(node,c+type);for(var k in _b22||{}){dojo.toggleClass(node,c+type+k,_b22[k]);}dojo.toggleClass(node,c+type+"FocusSelected",(dojo.hasClass(node,c+type+"Focus")&&dojo.hasClass(node,c+type+"Selected")));dojo.toggleClass(node,c+type+"HoverSelected",(dojo.hasClass(node,c+type+"Hover")&&dojo.hasClass(node,c+type+"Selected")));}});},scrollIntoView:function(_b23){if(this._scrollingTimeout){window.clearTimeout(this._scrollingTimeout);}delete this._scrollingTimeout;this._scrollingTimeout=window.setTimeout(dojo.hitch(this,function(){if(_b23.domNode){dojo.window.scrollIntoView(_b23.domNode);}delete this._scrollingTimeout;return;}),1);},resize:function(args){dijit.layout._LayoutWidget.prototype.resize.call(this,args);},layout:function(){var _b24=this.getChildren();if(this._contentBox){var bn=this.buttonsNode;var _b25=this._contentBox.h-dojo.marginBox(bn).h-dojox.html.metrics.getScrollbar().h;dojo.forEach(_b24,function(c){dojo.marginBox(c.domNode,{h:_b25});});}if(this._focusedPane){var foc=this._focusedPane;delete this._focusedPane;if(!this._savedFocus){foc.focus();}}else{if(_b24&&_b24.length){if(!this._savedFocus){_b24[0].focus();}}}},_onChange:function(_b26){this.onChange(_b26);},_setValue:function(_b27){delete this._setInProgress;if(!this._itemsMatch(this.value,_b27)){this.value=_b27;this._onChange(_b27);}},_setValueAttr:function(_b28){if(this._itemsMatch(this.value,_b28)&&!_b28){return;}if(this._setInProgress&&this._setInProgress===_b28){return;}this._setInProgress=_b28;if(!_b28||!this.store.isItem(_b28)){var pane=this.getChildren()[0];pane._setSelected(null);this._onItemClick(null,pane,null,null);return;}var _b29=dojo.hitch(this,function(item,_b2a){var _b2b=this.store,id;if(this.parentAttr&&_b2b.getFeatures()["dojo.data.api.Identity"]&&((id=this.store.getValue(item,this.parentAttr))||id==="")){var cb=function(i){if(_b2b.getIdentity(i)==_b2b.getIdentity(item)){_b2a(null);}else{_b2a([i]);}};if(id===""){_b2a(null);}else{if(typeof id=="string"){_b2b.fetchItemByIdentity({identity:id,onItem:cb});}else{if(_b2b.isItem(id)){cb(id);}}}}else{var _b2c=this.childrenAttrs.length;var _b2d=[];dojo.forEach(this.childrenAttrs,function(attr){var q={};q[attr]=item;_b2b.fetch({query:q,scope:this,onComplete:function(_b2e){if(this._setInProgress!==_b28){return;}_b2d=_b2d.concat(_b2e);_b2c--;if(_b2c===0){_b2a(_b2d);}}});},this);}});var _b2f=dojo.hitch(this,function(_b30,idx){var set=_b30[idx];var _b31=this.getChildren()[idx];var conn;if(set&&_b31){var fx=dojo.hitch(this,function(){if(conn){this.disconnect(conn);}delete conn;if(this._setInProgress!==_b28){return;}var _b32=dojo.filter(_b31._menu.getChildren(),function(i){return this._itemsMatch(i.item,set);},this)[0];if(_b32){idx++;_b31._menu.onItemClick(_b32,{type:"internal",stopPropagation:function(){},preventDefault:function(){}});if(_b30[idx]){_b2f(_b30,idx);}else{this._setValue(set);this.onItemClick(set,_b31,this.getChildItems(set));}}});if(!_b31.isLoaded){conn=this.connect(_b31,"onLoad",fx);}else{fx();}}else{if(idx===0){this.set("value",null);}}});var _b33=[];var _b34=dojo.hitch(this,function(_b35){if(_b35&&_b35.length){_b33.push(_b35[0]);_b29(_b35[0],_b34);}else{if(!_b35){_b33.pop();}_b33.reverse();_b2f(_b33,0);}});var ns=this.domNode.style;if(ns.display=="none"||ns.visibility=="hidden"){this._setValue(_b28);}else{if(!this._itemsMatch(_b28,this._visibleItem)){_b34([_b28]);}}},_onItemClick:function(evt,pane,item,_b36){if(evt){var _b37=this._getPaneForItem(item,pane,_b36);var _b38=(evt.type=="click"&&evt.alreadySelected);if(_b38&&_b37){this._removeAfter(pane.getIndexInParent()+1);var next=pane.getNextSibling();if(next&&next._setSelected){next._setSelected(null);}this.scrollIntoView(next);}else{if(_b37){this.addChild(_b37,pane.getIndexInParent()+1);if(this._savedFocus){_b37.focus(true);}}else{this._removeAfter(pane);this.scrollIntoView(pane);}}}else{if(pane){this._removeAfter(pane);this.scrollIntoView(pane);}}if(!evt||evt.type!="internal"){this._setValue(item);this.onItemClick(item,pane,_b36);}this._visibleItem=item;},_getPaneForItem:function(item,_b39,_b3a){var ret=this.getPaneForItem(item,_b39,_b3a);ret.store=this.store;ret.parentWidget=this;ret.parentPane=_b39||null;if(!item){ret.query=this.query;ret.queryOptions=this.queryOptions;}else{if(_b3a){ret.items=_b3a;}else{ret.items=[item];}}return ret;},_getMenuItemForItem:function(item,_b3b){var _b3c=this.store;if(!item||!_b3c||!_b3c.isItem(item)){var i=new dijit.MenuItem({label:"---",disabled:true,iconClass:"dojoxEmpty",focus:function(){}});this._updateClass(i.domNode,"Item");return i;}else{var _b3d=_b3c.isItemLoaded(item);var _b3e=_b3d?this.getChildItems(item):undefined;var _b3f;if(_b3e){_b3f=this.getMenuItemForItem(item,_b3b,_b3e);_b3f.children=_b3e;this._updateClass(_b3f.domNode,"Item",{"Expanding":true});if(!_b3f._started){var c=_b3f.connect(_b3f,"startup",function(){this.disconnect(c);dojo.style(this.arrowWrapper,"display","");});}else{dojo.style(_b3f.arrowWrapper,"display","");}}else{_b3f=this.getMenuItemForItem(item,_b3b,null);if(_b3d){this._updateClass(_b3f.domNode,"Item",{"Single":true});}else{this._updateClass(_b3f.domNode,"Item",{"Unloaded":true});_b3f.attr("disabled",true);}}_b3f.store=this.store;_b3f.item=item;if(!_b3f.label){_b3f.attr("label",this.store.getLabel(item).replace(/</,"&lt;"));}if(_b3f.focusNode){var self=this;_b3f.focus=function(){if(!this.disabled){try{this.focusNode.focus();}catch(e){}}};_b3f.connect(_b3f.focusNode,"onmouseenter",function(){if(!this.disabled){self._updateClass(this.domNode,"Item",{"Hover":true});}});_b3f.connect(_b3f.focusNode,"onmouseleave",function(){if(!this.disabled){self._updateClass(this.domNode,"Item",{"Hover":false});}});_b3f.connect(_b3f.focusNode,"blur",function(){self._updateClass(this.domNode,"Item",{"Focus":false,"Hover":false});});_b3f.connect(_b3f.focusNode,"focus",function(){self._updateClass(this.domNode,"Item",{"Focus":true});self._focusedPane=_b3b;});if(this.executeOnDblClick){_b3f.connect(_b3f.focusNode,"ondblclick",function(){self._onExecute();});}}return _b3f;}},_setStore:function(_b40){if(_b40===this.store&&this._started){return;}this.store=_b40;this._isIdentity=_b40.getFeatures()["dojo.data.api.Identity"];var _b41=this._getPaneForItem();this.addChild(_b41,0);},_onKey:function(e){if(e.charOrCode==dojo.keys.BACKSPACE){dojo.stopEvent(e);return;}else{if(e.charOrCode==dojo.keys.ESCAPE&&this._savedFocus){try{dijit.focus(this._savedFocus);}catch(e){}dojo.stopEvent(e);return;}else{if(e.charOrCode==dojo.keys.LEFT_ARROW||e.charOrCode==dojo.keys.RIGHT_ARROW){dojo.stopEvent(e);return;}}}},_resetValue:function(){this.set("value",this._lastExecutedValue);},_onCancel:function(){this._resetValue();this.onCancel();},_onExecute:function(){this._lastExecutedValue=this.get("value");this.onExecute();},focus:function(){var _b42=this._savedFocus;this._savedFocus=dijit.getFocus(this);if(!this._savedFocus.node){delete this._savedFocus;}if(!this._focusedPane){var _b43=this.getChildren()[0];if(_b43&&!_b42){_b43.focus(true);}}else{this._savedFocus=dijit.getFocus(this);var foc=this._focusedPane;delete this._focusedPane;if(!_b42){foc.focus(true);}}},handleKey:function(e){if(e.charOrCode==dojo.keys.DOWN_ARROW){delete this._savedFocus;this.focus();return false;}else{if(e.charOrCode==dojo.keys.ESCAPE){this._onCancel();return false;}}return true;},_updateChildClasses:function(){var _b44=this.getChildren();var _b45=_b44.length;dojo.forEach(_b44,function(c,idx){dojo.toggleClass(c.domNode,"dojoxRollingListPaneCurrentChild",(idx==(_b45-1)));dojo.toggleClass(c.domNode,"dojoxRollingListPaneCurrentSelected",(idx==(_b45-2)));});},startup:function(){if(this._started){return;}if(!this.getParent||!this.getParent()){this.resize();this.connect(dojo.global,"onresize","resize");}this.connect(this,"addChild","_updateChildClasses");this.connect(this,"removeChild","_updateChildClasses");this._setStore(this.store);this.set("showButtons",this.showButtons);this.inherited(arguments);this._lastExecutedValue=this.get("value");},getChildItems:function(item){var _b46,_b47=this.store;dojo.forEach(this.childrenAttrs,function(attr){var vals=_b47.getValues(item,attr);if(vals&&vals.length){_b46=(_b46||[]).concat(vals);}});return _b46;},getMenuItemForItem:function(item,_b48,_b49){return new dijit.MenuItem({});},getPaneForItem:function(item,_b4a,_b4b){if(!item||_b4b){return new dojox.widget._RollingListGroupPane({});}else{return null;}},onItemClick:function(item,pane,_b4c){},onExecute:function(){},onCancel:function(){},onChange:function(_b4d){}});}if(!dojo._hasResource["plugins.dojox.layout.Dock"]){dojo._hasResource["plugins.dojox.layout.Dock"]=true;dojo.provide("plugins.dojox.layout.Dock");dojo.declare("plugins.dojox.layout.Dock",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dojoxDock\"><ul dojoAttachPoint=\"containerNode\" class=\"dojoxDockList\"></ul></div>",_docked:[],_inPositioning:false,autoPosition:false,dockClass:"dojoxDockNode",addNode:function(_b4e){var div=dojo.create("li",null,this.containerNode);var node=new plugins.dojox.layout._DockNode({title:_b4e.title,paneRef:_b4e,dockClass:_b4e.dockClass},div);node.startup();return node;},startup:function(){if(this.id=="dojoxGlobalFloatingDock"||this.isFixedDock){this.connect(window,"onresize","_positionDock");this.connect(window,"onscroll","_positionDock");if(dojo.isIE){this.connect(this.domNode,"onresize","_positionDock");}}this._positionDock(null);this.inherited(arguments);},_positionDock:function(e){if(!this._inPositioning){if(this.autoPosition=="south"){setTimeout(dojo.hitch(this,function(){this._inPositiononing=true;var _b4f=dojo.window.getBox();var s=this.domNode.style;s.left=_b4f.l+"px";s.width=(_b4f.w-2)+"px";s.top=(_b4f.h+_b4f.t)-this.domNode.offsetHeight+"px";this._inPositioning=false;}),125);}}}});dojo.declare("plugins.dojox.layout._DockNode",[dojox.layout.Dock],{templateString:"<li dojoAttachEvent=\"onclick: restore\" class=\"dojoxDockNode\">"+"<span dojoAttachPoint=\"restoreNode\" class=\"dojoxDockRestoreButton\" dojoAttachEvent=\"onclick: restore\"></span>"+"<span class=\"dojoxDockTitleNode\" dojoAttachPoint=\"titleNode\">${title}</span>"+"</li>",dockClass:null,postCreate:function(){var _b50=this.dockClass;if(_b50){dojo.attr(this.domNode,"class",_b50);}if(this.dockClass){this.templateString="<li dojoAttachEvent=\"onclick: restore\" class=\"dojoxDockNode "+this.dockClass+"\">"+"<span dojoAttachPoint=\"restoreNode\" class=\"dojoxDockRestoreButton\" dojoAttachEvent=\"onclick: restore\"></span>"+"<span class=\"dojoxDockTitleNode\" dojoAttachPoint=\"titleNode\">${title}</span>"+"</li>";}},restore:function(){this.paneRef.show();this.paneRef.bringToTop();this.destroy();}});}if(!dojo._hasResource["plugins.dojox.layout.FloatingPane"]){dojo._hasResource["plugins.dojox.layout.FloatingPane"]=true;dojo.provide("plugins.dojox.layout.FloatingPane");dojo.declare("plugins.dojox.layout.FloatingPane",[dojox.layout.FloatingPane],{dockClass:"dojoxDockNode",constructor:function(){this.inherited(arguments);},postCreate:function(){console.log("FloatingPane.postCreate    this.dockClass: "+this.dockClass);this.inherited(arguments);new dojo.dnd.Moveable(this.domNode,{handle:this.focusNode});if(!this.dockable){this.dockNode.style.display="none";}if(!this.closable){this.closeNode.style.diDocsplay="none";}if(!this.maxable){this.maxNode.style.display="none";this.restoreNode.style.display="none";}if(!this.resizable){this.resizeHandle.style.display="none";}else{this.domNode.style.width=dojo.marginBox(this.domNode).w+"px";}this._allFPs.push(this);this.domNode.style.position="absolute";this.bgIframe=new dijit.BackgroundIframe(this.domNode);this._naturalState=dojo.coords(this.domNode);},startup:function(){if(this._started){return;}if(this.resizable){if(dojo.isIE){this.canvas.style.overflow="auto";}else{this.containerNode.style.overflow="auto";}this._resizeHandle=new dojox.layout.ResizeHandle({targetId:this.id,resizeAxis:this.resizeAxis},this.resizeHandle);}if(this.dockable){var _b51=this.dockTo;if(this.dockTo){this.dockTo=dijit.byId(this.dockTo);}else{this.dockTo=dijit.byId("dojoxGlobalFloatingDock");}if(!this.dockTo){var _b52,_b53;if(_b51){_b52=_b51;_b53=dojo.byId(_b51);}else{_b53=dojo.create("div",null,dojo.body());dojo.addClass(_b53,"dojoxFloatingDockDefault");_b52="dojoxGlobalFloatingDock";}console.log("FloatingPane.startup    this:");console.dir({this_ie_FloatingPane:this});console.log("FloatingPane.startup    this.dockClass: "+this.dockClass);this.dockTo=new plugins.dojox.layout.Dock({id:_b52,autoPosition:"south",dockClass:this.dockClass,paneRef:this},_b53);this.dockTo.startup();}if((this.domNode.style.display=="none")||(this.domNode.style.visibility=="hidden")){this.minimize();}}this.connect(this.focusNode,"onmousedown","bringToTop");this.connect(this.domNode,"onmousedown","bringToTop");this.resize(dojo.coords(this.domNode));this._started=true;},});}if(!dojo._hasResource["dijit.InlineEditBox"]){dojo._hasResource["dijit.InlineEditBox"]=true;dojo.provide("dijit.InlineEditBox");dojo.declare("dijit.InlineEditBox",dijit._Widget,{editing:false,autoSave:true,buttonSave:"",buttonCancel:"",renderAsHtml:false,editor:"dijit.form.TextBox",editorWrapper:"dijit._InlineEditor",editorParams:{},disabled:false,onChange:function(_b54){},onCancel:function(){},width:"100%",value:"",noValueIndicator:dojo.isIE<=6?"<span style='font-family: wingdings; text-decoration: underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&#x270d;&nbsp;&nbsp;&nbsp;&nbsp;</span>":"<span style='text-decoration: underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&#x270d;&nbsp;&nbsp;&nbsp;&nbsp;</span>",constructor:function(){this.editorParams={};},postMixInProperties:function(){this.inherited(arguments);this.displayNode=this.srcNodeRef;var _b55={ondijitclick:"_onClick",onmouseover:"_onMouseOver",onmouseout:"_onMouseOut",onfocus:"_onMouseOver",onblur:"_onMouseOut"};for(var name in _b55){this.connect(this.displayNode,name,_b55[name]);}dijit.setWaiRole(this.displayNode,"button");if(!this.displayNode.getAttribute("tabIndex")){this.displayNode.setAttribute("tabIndex",0);}if(!this.value&&!("value" in this.params)){this.value=dojo.trim(this.renderAsHtml?this.displayNode.innerHTML:(this.displayNode.innerText||this.displayNode.textContent||""));}if(!this.value){this.displayNode.innerHTML=this.noValueIndicator;}dojo.addClass(this.displayNode,"dijitInlineEditBoxDisplayMode");},setDisabled:function(_b56){dojo.deprecated("dijit.InlineEditBox.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_b56);},_setDisabledAttr:function(_b57){dijit.setWaiState(this.domNode,"disabled",_b57);if(_b57){this.displayNode.removeAttribute("tabIndex");}else{this.displayNode.setAttribute("tabIndex",0);}dojo.toggleClass(this.displayNode,"dijitInlineEditBoxDisplayModeDisabled",_b57);this._set("disabled",_b57);},_onMouseOver:function(){if(!this.disabled){dojo.addClass(this.displayNode,"dijitInlineEditBoxDisplayModeHover");}},_onMouseOut:function(){dojo.removeClass(this.displayNode,"dijitInlineEditBoxDisplayModeHover");},_onClick:function(e){if(this.disabled){return;}if(e){dojo.stopEvent(e);}this._onMouseOut();setTimeout(dojo.hitch(this,"edit"),0);},edit:function(){if(this.disabled||this.editing){return;}this.editing=true;this._savedPosition=dojo.style(this.displayNode,"position")||"static";this._savedOpacity=dojo.style(this.displayNode,"opacity")||"1";this._savedTabIndex=dojo.attr(this.displayNode,"tabIndex")||"0";if(this.wrapperWidget){var ew=this.wrapperWidget.editWidget;ew.set("displayedValue" in ew?"displayedValue":"value",this.value);}else{var _b58=dojo.create("span",null,this.domNode,"before");var ewc=typeof this.editorWrapper=="string"?dojo.getObject(this.editorWrapper):this.editorWrapper;this.wrapperWidget=new ewc({value:this.value,buttonSave:this.buttonSave,buttonCancel:this.buttonCancel,dir:this.dir,lang:this.lang,tabIndex:this._savedTabIndex,editor:this.editor,inlineEditBox:this,sourceStyle:dojo.getComputedStyle(this.displayNode),save:dojo.hitch(this,"save"),cancel:dojo.hitch(this,"cancel")},_b58);if(!this._started){this.startup();}}var ww=this.wrapperWidget;if(dojo.isIE){dijit.focus(dijit.getFocus());}dojo.style(this.displayNode,{position:"absolute",opacity:"0",display:"none"});dojo.style(ww.domNode,{position:this._savedPosition,visibility:"visible",opacity:"1"});dojo.attr(this.displayNode,"tabIndex","-1");setTimeout(dojo.hitch(this,function(){ww.focus();ww._resetValue=ww.getValue();}),0);},_onBlur:function(){this.inherited(arguments);if(!this.editing){}},destroy:function(){if(this.wrapperWidget&&!this.wrapperWidget._destroyed){this.wrapperWidget.destroy();delete this.wrapperWidget;}this.inherited(arguments);},_showText:function(_b59){var ww=this.wrapperWidget;dojo.style(ww.domNode,{position:"absolute",visibility:"hidden",opacity:"0"});dojo.style(this.displayNode,{position:this._savedPosition,opacity:this._savedOpacity,display:""});dojo.attr(this.displayNode,"tabIndex",this._savedTabIndex);if(_b59){dijit.focus(this.displayNode);}},save:function(_b5a){if(this.disabled||!this.editing){return;}this.editing=false;var ww=this.wrapperWidget;var _b5b=ww.getValue();this.set("value",_b5b);this._showText(_b5a);},setValue:function(val){dojo.deprecated("dijit.InlineEditBox.setValue() is deprecated.  Use set('value', ...) instead.","","2.0");return this.set("value",val);},_setValueAttr:function(val){val=dojo.trim(val);var _b5c=this.renderAsHtml?val:val.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/\n/g,"<br>");this.displayNode.innerHTML=_b5c||this.noValueIndicator;this._set("value",val);if(this._started){setTimeout(dojo.hitch(this,"onChange",val),0);}},getValue:function(){dojo.deprecated("dijit.InlineEditBox.getValue() is deprecated.  Use get('value') instead.","","2.0");return this.get("value");},cancel:function(_b5d){if(this.disabled||!this.editing){return;}this.editing=false;setTimeout(dojo.hitch(this,"onCancel"),0);this._showText(_b5d);}});dojo.declare("dijit._InlineEditor",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("dijit","templates/InlineEditBox.html","<span data-dojo-attach-point=\"editNode\" role=\"presentation\" style=\"position: absolute; visibility:hidden\" class=\"dijitReset dijitInline\"\n\tdata-dojo-attach-event=\"onkeypress: _onKeyPress\"\n\t><span data-dojo-attach-point=\"editorPlaceholder\"></span\n\t><span data-dojo-attach-point=\"buttonContainer\"\n\t\t><button data-dojo-type=\"dijit.form.Button\" data-dojo-props=\"label: '${buttonSave}', 'class': 'saveButton'\"\n\t\t\tdata-dojo-attach-point=\"saveButton\" data-dojo-attach-event=\"onClick:save\"></button\n\t\t><button data-dojo-type=\"dijit.form.Button\"  data-dojo-props=\"label: '${buttonCancel}', 'class': 'cancelButton'\"\n\t\t\tdata-dojo-attach-point=\"cancelButton\" data-dojo-attach-event=\"onClick:cancel\"></button\n\t></span\n></span>\n"),widgetsInTemplate:true,postMixInProperties:function(){this.inherited(arguments);this.messages=dojo.i18n.getLocalization("dijit","common",this.lang);dojo.forEach(["buttonSave","buttonCancel"],function(prop){if(!this[prop]){this[prop]=this.messages[prop];}},this);},buildRendering:function(){this.inherited(arguments);var cls=typeof this.editor=="string"?dojo.getObject(this.editor):this.editor;var _b5e=this.sourceStyle,_b5f="line-height:"+_b5e.lineHeight+";",_b60=dojo.getComputedStyle(this.domNode);dojo.forEach(["Weight","Family","Size","Style"],function(prop){var _b61=_b5e["font"+prop],_b62=_b60["font"+prop];if(_b62!=_b61){_b5f+="font-"+prop+":"+_b5e["font"+prop]+";";}},this);dojo.forEach(["marginTop","marginBottom","marginLeft","marginRight"],function(prop){this.domNode.style[prop]=_b5e[prop];},this);var _b63=this.inlineEditBox.width;if(_b63=="100%"){_b5f+="width:100%;";this.domNode.style.display="block";}else{_b5f+="width:"+(_b63+(Number(_b63)==_b63?"px":""))+";";}var _b64=dojo.delegate(this.inlineEditBox.editorParams,{style:_b5f,dir:this.dir,lang:this.lang});_b64["displayedValue" in cls.prototype?"displayedValue":"value"]=this.value;this.editWidget=new cls(_b64,this.editorPlaceholder);if(this.inlineEditBox.autoSave){dojo.destroy(this.buttonContainer);}},postCreate:function(){this.inherited(arguments);var ew=this.editWidget;if(this.inlineEditBox.autoSave){this.connect(ew,"onChange","_onChange");this.connect(ew,"onKeyPress","_onKeyPress");}else{if("intermediateChanges" in ew){ew.set("intermediateChanges",true);this.connect(ew,"onChange","_onIntermediateChange");this.saveButton.set("disabled",true);}}},_onIntermediateChange:function(val){this.saveButton.set("disabled",(this.getValue()==this._resetValue)||!this.enableSave());},destroy:function(){this.editWidget.destroy(true);this.inherited(arguments);},getValue:function(){var ew=this.editWidget;return String(ew.get("displayedValue" in ew?"displayedValue":"value"));},_onKeyPress:function(e){if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){if(e.altKey||e.ctrlKey){return;}if(e.charOrCode==dojo.keys.ESCAPE){dojo.stopEvent(e);this.cancel(true);}else{if(e.charOrCode==dojo.keys.ENTER&&e.target.tagName=="INPUT"){dojo.stopEvent(e);this._onChange();}}}},_onBlur:function(){this.inherited(arguments);if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){if(this.getValue()==this._resetValue){this.cancel(false);}else{if(this.enableSave()){this.save(false);}}}},_onChange:function(){if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing&&this.enableSave()){dojo.style(this.inlineEditBox.displayNode,{display:""});dijit.focus(this.inlineEditBox.displayNode);}},enableSave:function(){return (this.editWidget.isValid?this.editWidget.isValid():true);},focus:function(){this.editWidget.focus();setTimeout(dojo.hitch(this,function(){if(this.editWidget.focusNode&&this.editWidget.focusNode.tagName=="INPUT"){dijit.selectInputText(this.editWidget.focusNode);}}),0);}});}if(!dojo._hasResource["dojox.timing._base"]){dojo._hasResource["dojox.timing._base"]=true;dojo.provide("dojox.timing._base");dojo.experimental("dojox.timing");dojox.timing.Timer=function(_b65){this.timer=null;this.isRunning=false;this.interval=_b65;this.onStart=null;this.onStop=null;};dojo.extend(dojox.timing.Timer,{onTick:function(){},setInterval:function(_b66){if(this.isRunning){window.clearInterval(this.timer);}this.interval=_b66;if(this.isRunning){this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);}},start:function(){if(typeof this.onStart=="function"){this.onStart();}this.isRunning=true;this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);},stop:function(){if(typeof this.onStop=="function"){this.onStop();}this.isRunning=false;window.clearInterval(this.timer);}});}if(!dojo._hasResource["dojox.timing"]){dojo._hasResource["dojox.timing"]=true;dojo.provide("dojox.timing");}if(!dojo._hasResource["plugins.dojox.Timer"]){dojo._hasResource["plugins.dojox.Timer"]=true;dojo.provide("plugins.dojox.Timer");dojo.declare("plugins.dojox.Timer",null,{interval:3000,polling:false,completed:false,onStart:null,poll:null,onEnd:null,attenuate:false,currentInterval:false,stepInterval:2000,maxInterval:10000,tick:1,constructor:function(args){console.log("plugins.dojox.Timer.constructor     plugins.dojox.Timer.constructor");if(args==null){return;}if(args.interval!=null){this.interval=args.interval;}if(args.attenuate!=null){this.attenuate=args.attenuate;}if(args.stepInterval!=null){this.stepInterval=args.stepInterval;}if(args.maxInterval!=null){this.maxInterval=args.maxInterval;}this.poll=args.poll||function(){console.log("plugins.dojox.Timer.constructor    poll function is empty");};this.onStart=args.onStart||function(){console.log("plugins.dojox.Timer.constructor    onStart function is empty");};this.onEnd=args.onEnd||function(){console.log("plugins.dojox.Timer.constructor    onEnd function is empty");};this.currentInterval=this.interval;this.setTimer();},setTimer:function(){if(this.timer!=null){return;}if(this.checkParent&&!this.parentWidget){console.log("plugins.dojox.Timer.setTimer    no parentWidget. Doing this.destroy()");this.destroy();}this.timer=new dojox.timing.Timer;this.setInterval(this.interval);var _b67=this;this.timer.onTick=function(){console.log("plugins.dojox.Timer.setTimer     ONTICK this.timer.interval: "+this.interval);if(_b67.completed==true){console.log("plugins.dojox.Timer.setTimer     Stopping timer because thisObject.completed: "+_b67.completed);_b67.stop();return;}setTimeout(function(){try{_b67.completed=_b67.poll(_b67);console.log("plugins.dojox.Timer.setTimer     Returned thisObject.completed: "+_b67.completed);if(_b67.completed==true){console.log("plugins.dojox.Timer.setTimer     Stopping timer because thisObject.completed: "+_b67.completed);_b67.stop();return;}}catch(error){console.log("plugins.dojox.Timer.setTimer     ERROR doing thisObject.poll(thisObject):"+dojo.toJson(error));}if(_b67.attenuate==true&&_b67.tick!=1){_b67.currentInterval+=_b67.stepInterval;if(_b67.currentInterval>_b67.maxInterval){_b67.currentInterval=_b67.maxInterval;}console.log("plugins.dojox.Timer.setPoll    new thisObject.currentInterval: "+_b67.currentInterval);_b67.timer.setInterval(_b67.currentInterval);}else{_b67.tick++;}},100);};},setInterval:function(_b68){if(_b68==null){return;}this.timer.setInterval(_b68);},setOnEnd:function(_b69){this.onEnd=_b69||function(){console.log("plugins.dojox.Timer.setOnEnd    onEnd function is empty");};},setPoll:function(poll){console.log("plugins.dojox.Timer.setPoll    poll: "+poll);this.poll=poll||function(){console.log("plugins.dojox.Timer.setPoll    poll function is empty");};},start:function(){console.log("plugins.dojox.Timer.start()");this.completed=false;this.onStart(this);this.timer.start();this.polling=true;},stop:function(){console.log("plugins.dojox.Timer.stop()");this.timer.stop();this.polling=false;console.log("plugins.dojox.Timer.stop    this.polling: "+this.polling);this.onEnd(this);}});}if(!dojo._hasResource["dojox.fx._base"]){dojo._hasResource["dojox.fx._base"]=true;dojo.provide("dojox.fx._base");dojo.mixin(dojox.fx,{anim:dojo.anim,animateProperty:dojo.animateProperty,fadeTo:dojo._fade,fadeIn:dojo.fadeIn,fadeOut:dojo.fadeOut,combine:dojo.fx.combine,chain:dojo.fx.chain,slideTo:dojo.fx.slideTo,wipeIn:dojo.fx.wipeIn,wipeOut:dojo.fx.wipeOut});dojox.fx.sizeTo=function(args){var node=args.node=dojo.byId(args.node),abs="absolute";var _b6a=args.method||"chain";if(!args.duration){args.duration=500;}if(_b6a=="chain"){args.duration=Math.floor(args.duration/2);}var top,_b6b,left,_b6c,_b6d,_b6e=null;var init=(function(n){return function(){var cs=dojo.getComputedStyle(n),pos=cs.position,w=cs.width,h=cs.height;top=(pos==abs?n.offsetTop:parseInt(cs.top)||0);left=(pos==abs?n.offsetLeft:parseInt(cs.left)||0);_b6d=(w=="auto"?0:parseInt(w));_b6e=(h=="auto"?0:parseInt(h));_b6c=left-Math.floor((args.width-_b6d)/2);_b6b=top-Math.floor((args.height-_b6e)/2);if(pos!=abs&&pos!="relative"){var ret=dojo.coords(n,true);top=ret.y;left=ret.x;n.style.position=abs;n.style.top=top+"px";n.style.left=left+"px";}};})(node);var _b6f=dojo.animateProperty(dojo.mixin({properties:{height:function(){init();return {end:args.height||0,start:_b6e};},top:function(){return {start:top,end:_b6b};}}},args));var _b70=dojo.animateProperty(dojo.mixin({properties:{width:function(){return {start:_b6d,end:args.width||0};},left:function(){return {start:left,end:_b6c};}}},args));var anim=dojo.fx[(args.method=="combine"?"combine":"chain")]([_b6f,_b70]);return anim;};dojox.fx.slideBy=function(args){var node=args.node=dojo.byId(args.node),top,left;var init=(function(n){return function(){var cs=dojo.getComputedStyle(n);var pos=cs.position;top=(pos=="absolute"?n.offsetTop:parseInt(cs.top)||0);left=(pos=="absolute"?n.offsetLeft:parseInt(cs.left)||0);if(pos!="absolute"&&pos!="relative"){var ret=dojo.coords(n,true);top=ret.y;left=ret.x;n.style.position="absolute";n.style.top=top+"px";n.style.left=left+"px";}};})(node);init();var _b71=dojo.animateProperty(dojo.mixin({properties:{top:top+(args.top||0),left:left+(args.left||0)}},args));dojo.connect(_b71,"beforeBegin",_b71,init);return _b71;};dojox.fx.crossFade=function(args){var _b72=args.nodes[0]=dojo.byId(args.nodes[0]),op1=dojo.style(_b72,"opacity"),_b73=args.nodes[1]=dojo.byId(args.nodes[1]),op2=dojo.style(_b73,"opacity");var _b74=dojo.fx.combine([dojo[(op1==0?"fadeIn":"fadeOut")](dojo.mixin({node:_b72},args)),dojo[(op1==0?"fadeOut":"fadeIn")](dojo.mixin({node:_b73},args))]);return _b74;};dojox.fx.highlight=function(args){var node=args.node=dojo.byId(args.node);args.duration=args.duration||400;var _b75=args.color||"#ffff99",_b76=dojo.style(node,"backgroundColor");if(_b76=="rgba(0, 0, 0, 0)"){_b76="transparent";}var anim=dojo.animateProperty(dojo.mixin({properties:{backgroundColor:{start:_b75,end:_b76}}},args));if(_b76=="transparent"){dojo.connect(anim,"onEnd",anim,function(){node.style.backgroundColor=_b76;});}return anim;};dojox.fx.wipeTo=function(args){args.node=dojo.byId(args.node);var node=args.node,s=node.style;var dir=(args.width?"width":"height"),_b77=args[dir],_b78={};_b78[dir]={start:function(){s.overflow="hidden";if(s.visibility=="hidden"||s.display=="none"){s[dir]="1px";s.display="";s.visibility="";return 1;}else{var now=dojo.style(node,dir);return Math.max(now,1);}},end:_b77};var anim=dojo.animateProperty(dojo.mixin({properties:_b78},args));return anim;};}if(!dojo._hasResource["dojox.fx"]){dojo._hasResource["dojox.fx"]=true;dojo.provide("dojox.fx");}if(!dojo._hasResource["dojox.widget.DialogSimple"]){dojo._hasResource["dojox.widget.DialogSimple"]=true;dojo.provide("dojox.widget.DialogSimple");dojo.declare("dojox.widget.DialogSimple",[dojox.layout.ContentPane,dijit._DialogBase],{});}if(!dojo._hasResource["dojox.widget.Dialog"]){dojo._hasResource["dojox.widget.Dialog"]=true;dojo.provide("dojox.widget.Dialog");dojo.experimental("dojox.widget.Dialog");dojo.declare("dojox.widget.Dialog",dojox.widget.DialogSimple,{templateString:dojo.cache("dojox.widget","Dialog/Dialog.html","<div class=\"dojoxDialog\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"${id}_title\">\n\t<div dojoAttachPoint=\"titleBar\" class=\"dojoxDialogTitleBar\">\n\t\t<span dojoAttachPoint=\"titleNode\" class=\"dojoxDialogTitle\" id=\"${id}_title\">${title}</span>\n\t</div>\n\t<div dojoAttachPoint=\"dojoxDialogWrapper\">\n\t\t<div dojoAttachPoint=\"containerNode\" class=\"dojoxDialogPaneContent\"></div>\n\t</div>\n\t<div dojoAttachPoint=\"closeButtonNode\" class=\"dojoxDialogCloseIcon\" dojoAttachEvent=\"onclick: onCancel\">\n\t\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\">x</span>\n\t</div>\n</div>\n"),sizeToViewport:false,viewportPadding:35,dimensions:null,easing:null,sizeDuration:dijit._defaultDuration,sizeMethod:"chain",showTitle:false,draggable:false,modal:false,constructor:function(_b79,node){this.easing=_b79.easing||dojo._defaultEasing;this.dimensions=_b79.dimensions||[300,300];},_setup:function(){this.inherited(arguments);if(!this._alreadyInitialized){this._navIn=dojo.fadeIn({node:this.closeButtonNode});this._navOut=dojo.fadeOut({node:this.closeButtonNode});if(!this.showTitle){dojo.addClass(this.domNode,"dojoxDialogNoTitle");}}},layout:function(e){this._setSize();this.inherited(arguments);},_setSize:function(){this._vp=dojo.window.getBox();var tc=this.containerNode,_b7a=this.sizeToViewport;return this._displaysize={w:_b7a?tc.scrollWidth:this.dimensions[0],h:_b7a?tc.scrollHeight:this.dimensions[1]};},show:function(){if(this.open){return;}this._setSize();dojo.style(this.closeButtonNode,"opacity",0);dojo.style(this.domNode,{overflow:"hidden",opacity:0,width:"1px",height:"1px"});dojo.style(this.containerNode,{opacity:0,overflow:"hidden"});this.inherited(arguments);if(this.modal){this._modalconnects.push(dojo.connect(dojo.body(),"onkeypress",function(e){if(e.charOrCode==dojo.keys.ESCAPE){dojo.stopEvent(e);}}));}else{this._modalconnects.push(dojo.connect(dijit._underlay.domNode,"onclick",this,"onCancel"));}this._modalconnects.push(dojo.connect(this.domNode,"onmouseenter",this,"_handleNav"));this._modalconnects.push(dojo.connect(this.domNode,"onmouseleave",this,"_handleNav"));},_handleNav:function(e){var _b7b="_navOut",_b7c="_navIn",_b7d=(e.type=="mouseout"?_b7c:_b7b),_b7e=(e.type=="mouseout"?_b7b:_b7c);this[_b7d].stop();this[_b7e].play();},_position:function(){if(!this._started){return;}if(this._sizing){this._sizing.stop();this.disconnect(this._sizingConnect);delete this._sizing;}this.inherited(arguments);if(!this.open){dojo.style(this.containerNode,"opacity",0);}var pad=this.viewportPadding*2;var _b7f={node:this.domNode,duration:this.sizeDuration||dijit._defaultDuration,easing:this.easing,method:this.sizeMethod};var ds=this._displaysize||this._setSize();_b7f["width"]=ds.w=(ds.w+pad>=this._vp.w||this.sizeToViewport)?this._vp.w-pad:ds.w;_b7f["height"]=ds.h=(ds.h+pad>=this._vp.h||this.sizeToViewport)?this._vp.h-pad:ds.h;this._sizing=dojox.fx.sizeTo(_b7f);this._sizingConnect=this.connect(this._sizing,"onEnd","_showContent");this._sizing.play();},_showContent:function(e){var _b80=this.containerNode;dojo.style(this.domNode,{overflow:"visible",opacity:1});dojo.style(this.closeButtonNode,"opacity",1);dojo.style(_b80,{height:this._displaysize.h-this.titleNode.offsetHeight+"px",width:this._displaysize.w+"px",overflow:"auto"});dojo.anim(_b80,{opacity:1});}});}if(!dojo._hasResource["dojo.fx.easing"]){dojo._hasResource["dojo.fx.easing"]=true;dojo.provide("dojo.fx.easing");dojo.getObject("fx.easing",true,dojo);dojo.fx.easing={linear:function(n){return n;},quadIn:function(n){return Math.pow(n,2);},quadOut:function(n){return n*(n-2)*-1;},quadInOut:function(n){n=n*2;if(n<1){return Math.pow(n,2)/2;}return -1*((--n)*(n-2)-1)/2;},cubicIn:function(n){return Math.pow(n,3);},cubicOut:function(n){return Math.pow(n-1,3)+1;},cubicInOut:function(n){n=n*2;if(n<1){return Math.pow(n,3)/2;}n-=2;return (Math.pow(n,3)+2)/2;},quartIn:function(n){return Math.pow(n,4);},quartOut:function(n){return -1*(Math.pow(n-1,4)-1);},quartInOut:function(n){n=n*2;if(n<1){return Math.pow(n,4)/2;}n-=2;return -1/2*(Math.pow(n,4)-2);},quintIn:function(n){return Math.pow(n,5);},quintOut:function(n){return Math.pow(n-1,5)+1;},quintInOut:function(n){n=n*2;if(n<1){return Math.pow(n,5)/2;}n-=2;return (Math.pow(n,5)+2)/2;},sineIn:function(n){return -1*Math.cos(n*(Math.PI/2))+1;},sineOut:function(n){return Math.sin(n*(Math.PI/2));},sineInOut:function(n){return -1*(Math.cos(Math.PI*n)-1)/2;},expoIn:function(n){return (n==0)?0:Math.pow(2,10*(n-1));},expoOut:function(n){return (n==1)?1:(-1*Math.pow(2,-10*n)+1);},expoInOut:function(n){if(n==0){return 0;}if(n==1){return 1;}n=n*2;if(n<1){return Math.pow(2,10*(n-1))/2;}--n;return (-1*Math.pow(2,-10*n)+2)/2;},circIn:function(n){return -1*(Math.sqrt(1-Math.pow(n,2))-1);},circOut:function(n){n=n-1;return Math.sqrt(1-Math.pow(n,2));},circInOut:function(n){n=n*2;if(n<1){return -1/2*(Math.sqrt(1-Math.pow(n,2))-1);}n-=2;return 1/2*(Math.sqrt(1-Math.pow(n,2))+1);},backIn:function(n){var s=1.70158;return Math.pow(n,2)*((s+1)*n-s);},backOut:function(n){n=n-1;var s=1.70158;return Math.pow(n,2)*((s+1)*n+s)+1;},backInOut:function(n){var s=1.70158*1.525;n=n*2;if(n<1){return (Math.pow(n,2)*((s+1)*n-s))/2;}n-=2;return (Math.pow(n,2)*((s+1)*n+s)+2)/2;},elasticIn:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;n=n-1;return -1*Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p);},elasticOut:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;return Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p)+1;},elasticInOut:function(n){if(n==0){return 0;}n=n*2;if(n==2){return 1;}var p=0.3*1.5;var s=p/4;if(n<1){n-=1;return -0.5*(Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p));}n-=1;return 0.5*(Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p))+1;},bounceIn:function(n){return (1-dojo.fx.easing.bounceOut(1-n));},bounceOut:function(n){var s=7.5625;var p=2.75;var l;if(n<(1/p)){l=s*Math.pow(n,2);}else{if(n<(2/p)){n-=(1.5/p);l=s*Math.pow(n,2)+0.75;}else{if(n<(2.5/p)){n-=(2.25/p);l=s*Math.pow(n,2)+0.9375;}else{n-=(2.625/p);l=s*Math.pow(n,2)+0.984375;}}}return l;},bounceInOut:function(n){if(n<0.5){return dojo.fx.easing.bounceIn(n*2)/2;}return (dojo.fx.easing.bounceOut(n*2-1)/2)+0.5;}};}if(!dojo._hasResource["dojox.timing.Sequence"]){dojo._hasResource["dojox.timing.Sequence"]=true;dojo.provide("dojox.timing.Sequence");dojo.experimental("dojox.timing.Sequence");dojo.declare("dojox.timing.Sequence",null,{_goOnPause:0,_running:false,constructor:function(){this._defsResolved=[];},go:function(defs,_b81){this._running=true;dojo.forEach(defs,function(cur){if(cur.repeat>1){var _b82=cur.repeat;for(var j=0;j<_b82;j++){cur.repeat=1;this._defsResolved.push(cur);}}else{this._defsResolved.push(cur);}},this);var last=defs[defs.length-1];if(_b81){this._defsResolved.push({func:_b81});}this._defsResolved.push({func:[this.stop,this]});this._curId=0;this._go();},_go:function(){if(!this._running){return;}var cur=this._defsResolved[this._curId];this._curId+=1;function _b83(func){var ret=null;if(dojo.isArray(func)){if(func.length>2){ret=func[0].apply(func[1],func.slice(2));}else{ret=func[0].apply(func[1]);}}else{ret=func();}return ret;};if(this._curId>=this._defsResolved.length){_b83(cur.func);return;}if(cur.pauseAfter){if(_b83(cur.func)!==false){setTimeout(dojo.hitch(this,"_go"),cur.pauseAfter);}else{this._goOnPause=cur.pauseAfter;}}else{if(cur.pauseBefore){var x=dojo.hitch(this,function(){if(_b83(cur.func)!==false){this._go();}});setTimeout(x,cur.pauseBefore);}else{if(_b83(cur.func)!==false){this._go();}}}},goOn:function(){if(this._goOnPause){setTimeout(dojo.hitch(this,"_go"),this._goOnPause);this._goOnPause=0;}else{this._go();}},stop:function(){this._running=false;}});}if(!dojo._hasResource["plugins.files.Dialog"]){dojo._hasResource["plugins.files.Dialog"]=true;dojo.provide("plugins.files.Dialog");dojo.declare("plugins.files.Dialog",[plugins.core.Common],{loginMessageId:"loginMessage",loginLauncherId:"loginLauncher",message:"",parentFunction:null,args:null,dialogWidget:null,cssFiles:[dojo.moduleUrl("plugins","files/css/dialog.css"),dojo.moduleUrl("dojox","widget/Dialog/Dialog.css")],constructor:function(args){this.args=args;this.message=args.message;this.parentFunction=args.parentFunction;this.url=args.url;this.query=args.query;this.launchdialogWindow();},launchdialogWindow:function(){var _b84=this;var _b85=document.createElement("table");_b85.className="dialogTable";var tr1=document.createElement("tr");var td1=document.createElement("td");var _b86=document.createTextNode(this.message);td1.setAttribute("colspan",2);td1.appendChild(_b86);tr1.appendChild(td1);var tr2=document.createElement("tr");var _b87=new dijit.form.Button();_b87.setLabel("Yes");_b87.domNode.setAttribute("class","dialogButton");_b87.onClick=function(e){_b84.query+="&modifier=overwrite";_b84.parentFunction(_b84.url,_b84.query);_b84.fadeOut("yes");};var _b88=document.createElement("td");_b88.setAttribute("align","center");_b88.setAttribute("colspan",2);_b88.appendChild(_b87.domNode);var _b89=new dijit.form.Button();_b89.setLabel("No");_b89.domNode.setAttribute("class","dialogButton");var _b84=this;var noTd=document.createElement("td");noTd.setAttribute("align","center");noTd.setAttribute("colspan",2);noTd.appendChild(_b89.domNode);tr2.setAttribute("class","centeredRow");tr2.appendChild(_b88);tr2.appendChild(noTd);_b85.appendChild(tr1);_b85.appendChild(tr2);document.body.appendChild(_b85);var _b8a=new dojox.widget.Dialog({id:"loginDialog",dimensions:[250,200],draggable:true,sizeDuration:200,sizeMethod:"combine",viewportPadding:"125",showTitle:"true",title:"Confirmation"},"progDialog");_b8a.attr("class","centered");this.dialogWidget=_b8a;_b8a.setContent(_b85);_b8a.startup();_b8a.show();},fadeOut:function(){dojo.fadeOut({node:"loginDialog",duration:700}).play();setTimeout("dijit.byId('loginDialog').destroy()",700);}});}if(!dojo._hasResource["plugins.dijit.Confirm"]){dojo._hasResource["plugins.dijit.Confirm"]=true;dojo.provide("plugins.dijit.Confirm");dojo.declare("plugins.dijit.Confirm",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\" cellpadding=\"0px\"\n        height=\"300px\" width=\"100%\" >\n        <tr>\n            <td>\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    class=\"confirmDialog\"\n                    closeText=\"false\"\n                    title=\"${title}\"\n                >\n                    \n                    <table\n                        cellpadding=\"0\"\n                        cellspacing=\"0\"\n                        width=\"100%\"\n                        >\n                        <tr class=\"message\" align=\"center\">\n                            <td\n                                align=\"center\"\n                                dojoAttachPoint=\"messageNode\"\n                                colspan=\"2\">${message}</td>\n                        </tr>\n                        \n                        <tr>\n                            <td align=\"center\" class=\"yesButton\">\n                                <button\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Yes\"\n                                    dojoAttachEvent=\"onClick:doYes\"\n                                    >\n                                </button>\n                            </td>\n\n                            <td align=\"center\" class=\"noButton\">\n                                <div\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"No\"\n                                    dojoAttachEvent=\"onClick:doNo\"\n                                    >\n                                </div>\n                            </td>\n                        </tr>\n                    </table>\n\n                </div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins")+"/dijit/css/confirmdialog.css"],widgetsInTemplate:true,parentWidget:null,application:null,title:null,message:null,constructor:function(args){this.title=args.title;this.message=args.message;this.parentWidget=args.parentWidget;this.yesCallback=args.yesCallback;this.noCallback=args.noCallback;this.loadCSS();},getApplication:function(){return this.application;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDialogue();dojo.addClass(this.dialog.containerNode,"confirmDialog");dojo.addClass(this.dialog.titleNode,"confirmDialog");dojo.addClass(this.dialog.closeButtonNode,"confirmDialog");},show:function(){this.dialog.show();},hide:function(){this.dialog.hide();},doYes:function(type){this.yesCallback();this.dialog.hide();},doNo:function(){this.noCallback();this.dialog.hide();},load:function(args){if(args.title==null){args.title="Input dialogue";}this.dialog.titleNode.innerHTML=args.title;this.dialog.messageNode.innerHTML=args.message;this.dialog.yesCallback=args.yesCallback;this.dialog.noCallback=args.noCallback;this.show();},setDialogue:function(){document.body.appendChild(this.dialog.domNode);}});}if(!dojo._hasResource["plugins.files._GroupDragPane"]){dojo._hasResource["plugins.files._GroupDragPane"]=true;dojo.provide("plugins.files._GroupDragPane");dojo.declare("plugins.files._GroupDragPane",[dojox.widget._RollingListPane],{templateString:"<div><div dojoAttachPoint=\"containerNode\"></div>"+"<div dojoAttachPoint=\"menuContainer\">"+"<div dojoAttachPoint=\"menuNode\"></div>"+"</div></div>",_dragSource:null,_copyBox:null,debug:false,polling:false,loading:false,core:null,constructor:function(args){this.inherited(arguments);this.core=args.core;this.path=args.path;this.parentPath=args.parentPath;},startup:function(){this.inherited(arguments);if(this.loading){return;}this.loading=true;this.setSequence();this.setStandby();},_doQuery:function(){this.isLoaded=false;this._setContentAndScroll(this.onFetchStart());this.store.fetch({query:this.path,onComplete:function(_b8b){this.items=_b8b;this.onItems();},onError:function(e){this._onError("Fetch",e);},scope:this});},onLoad:function(data){this.inherited(arguments);this.loading=false;},_onLoadHandler:function(data){this.isLoaded=true;try{this.onLoad(data);}catch(e){}this.core.folders.roundRobin();},_loadCheck:function(_b8c){var _b8d=this._isShown();if((this.store||this.items)&&(_b8c||(this.refreshOnShow&&_b8d)||(!this.isLoaded&&_b8d))){this.query=this.path;this._doQuery();}},_setContent:function(cont){if(!this._dragSource){}},createMenu:function(type){if(type=="workflow"){if(this.workflowMenu){return this.workflowMenu.menu;}}else{if(type=="folder"){if(this.folderMenu){return this.folderMenu.menu;}}else{if(this.fileMenu){return this.fileMenu.menu;}}}},addItem:function(name,type,_b8e,_b8f){this.removeEmptyItem();var item=new Object;item.name=name;item.type=[type];item.directory=true;item.parentPath=this.path;item.path=name;item.children=[];this.items.push(item);var _b90=dojo.clone(item);Agua.setFileCache(_b8e,_b8f,_b90);var _b91=this.parentWidget._getMenuItemForItem(item,this);this._dragSource.insertNodes(false,[_b91]);var _b92=this._dragSource.getAllNodes();var node=_b92[_b92.length-1];node.setAttribute("dndType","file");dojo.addClass(node,"directory");node.item=item;node.item._S=_b91.store;var _b93=this.createMenu(type);_b93.bindDomNode(node);dojo.connect(node,"onclick",this,"onclickHandler");},renameItem:function(_b94,_b95){var _b96=_b94.item.name;_b94.innerHTML=_b95;for(i=0;i<this.items.length;i++){var _b97=this.items[i];if(_b97.name==_b96){_b97.name=_b95;_b97.path=_b95;if(_b97.children.length){for(var i=0;i<_b97.children.length;i++){var _b98=_b97.children[i].parentPath;var re=new RegExp(_b96+"$");_b98=_b98.replace(re,_b95);_b97.children[i].parentPath=_b98;}}break;}}},deleteItem:function(_b99){for(i=0;i<this.items.length;i++){var _b9a=this.items[i];if(_b9a.name==_b99.item.name){this.items.splice(i,1);break;}}dojo.destroy(_b99);if(!this.items.length){this.addEmptyItem();this.onItems();}var _b9b=this.parentWidget;var _b9c=_b9b.getChildren();var _b9d=_b9c.length;for(var i=0;i<_b9c.length;i++){if(_b9c[i]==this){_b9d=i;break;}}if(_b9d==_b9c.length){return;}_b9b._removeAfter(_b9d);},removeEmptyItem:function(){var _b9e=this._dragSource.getAllNodes();var _b9f=dojo.clone(this._dragSource.getAllNodes());if(_b9e[0].item.name!="<EMPTY>"){return;}this.items.splice(0,1);dojo.destroy(_b9e[0]);},addEmptyItem:function(){if(this.items.length){return;}var item=new Object;item.name="<EMPTY>";item.parentPath=this.path;this.items.push(item);},inItems:function(_ba0){if(_ba0==null){return;}var _ba1=this._dragSource.getAllNodes();for(var i=0;i<_ba1.length;i++){if(_ba0==_ba1[i].innerHTML){return true;}}return false;},onItems:function(){var _ba2=this;for(var i=0;i<this.items.length;i++){this.items[i].path=this.items[i].name;}var _ba3,_ba4=false;this._dragSource=this._getDragSource({path:this.path,parentPath:this.parentPath});this._dragSource.store=this.store;if(!this.items.length){this.addEmptyItem();}var _ba5,_ba6;if(this.items.length){dojo.forEach(this.items,function(item){_ba5=this.parentWidget._getMenuItemForItem(item,this);if(_ba5){this._dragSource.insertNodes(false,[_ba5]);var _ba7=this._dragSource.getAllNodes();var _ba8=_ba7[_ba7.length-1];if(item.children){for(var i=0;i<item.children.length;i++){item.children[i]._S=item._S;var _ba9;var _baa="";if(item.parentPath){_baa=item.parentPath;}if(item.path){if(_baa){_baa+="/"+item.path;}else{_baa=item.path;}}if(_baa){item.children[i].parentPath=_baa;}}item.directory=true;}_ba8.item=item;dojo.hasClass(_ba8,"dojoxRollingListItemSelected");var _bab=_ba8.innerHTML;var _bac=this.getIndexInParent();var _bad;if(_bac==0){_bad="workflow";}else{if(item.directory==false||item.directory=="false"){_bad="file";}else{_bad="folder";}}var _bae=_ba2.createMenu(_bad);if(_bae!=null){_bae.bindDomNode(_ba8);}_ba8.setAttribute("dndType",_bad);dojo.connect(_ba8,"onclick",this,"onclickHandler");var _baf=this._dragSource;this._dragSource.onDropExternal=function(_bb0,_bb1,copy){_ba2.onDropExternal(_bb0,_bb1,copy,_baf,item,_ba8);};}},this);}var _bb2=this._dragSource.getAllNodes();for(var i=0;i<_bb2.length;i++){var node=_bb2[i];dojo.addClass(node,"fileDrag");if(!node.item.directory||node.item.directory=="false"){dojo.addClass(node,"file");dojo.addClass(node,"fileClosed");}else{dojo.addClass(node,"directory");dojo.addClass(node,"directoryClosed");}var _bb3=node.innerHTML;var _bb4=this.getIndexInParent();var _bb5;if(_bb4==0){_bb5="workflow";}else{_bb5="file";}node.setAttribute("dndType",_bb5);}this.containerNode.innerHTML="";this.containerNode.appendChild(this.menuNode);this.parentWidget.scrollIntoView(this);this.inherited(arguments);},onDropExternal:function(_bb6,_bb7,copy,_bb8,item,_bb9){this.lastNode=_bb9;this._dragSource=_bb8;var _bba=this.store.putData.location;var file=_bb7[0].item.parentPath+"/"+_bb7[0].item.path;var _bbb=this.path;if(_bba&&!_bbb.match(/^\//)){_bbb=_bba+"/"+this.path;}this.checkFilePresent(file,_bbb);},checkFilePresent:function(file,_bbc){if(this.inItems(file)){thisObject.confirmOverwrite(file,_bbc);}else{this.prepareCopy(file,_bbc);this.copyFile();this.delayedPollCopy();}},prepareCopy:function(file,_bbd){var _bbe=this.store.putData;_bbe.mode="copyFile";_bbe.sessionId=Agua.cookie("sessionId");_bbe.username=Agua.cookie("username");_bbe.file=file;_bbe.destination=_bbd;this.putData=_bbe;},confirmOverwrite:function(file,_bbf){var _bc0=this;var _bc1=function(){_bc0.prepareCopy(file,_bbf);_bc0.copyFile();_bc0.delayedPollCopy();};var _bc2=function(){};var _bc3="Delete file: "+file+"?";var _bc4="File already exists<br>Do you want to overwrite it?<br><span style='color: #222;'>Click 'Yes' to delete or 'No' to cancel</span>";if(this.confirm!=null){this.confirm.destroy();}this.confirm=new plugins.dijit.Confirm({parentWidget:this,title:_bc3,message:_bc4,yesCallback:_bc1,noCallback:_bc2});this.confirm.show();},copyFile:function(){var _bc5=this.putData;var url=Agua.cgiUrl+"folders.cgi?";this.standby.show();var _bc6=this;dojo.xhrPut({url:url,handleAs:"json-comment-optional",sync:false,putData:dojo.toJson(_bc5),handle:function(_bc7){if(!_bc7||!_bc7.error){_bc6.pollCopy();}else{if(_bc7.error){_bc6.standby.hide();Agua.toastMessage({message:_bc7.error,type:"error"});}}}});},delayedPollCopy:function(_bc8){if(!_bc8){_bc8=6000;}var _bc9=[{func:[this.showMessage,this,"_GroupDragPane.delayedPollCopy"],pauseAfter:_bc8},{func:this.pollCopy}];this.sequence.go(_bc9,function(){});},showMessage:function(_bca){},pollCopy:function(){if(!this.putData){if(this.standby){this.standby.hide();}return;}this.putData.modifier="status";var url=Agua.cgiUrl+"folders.cgi?";var _bcb=this;var _bcc=false;dojo.xhrPut({url:url,handleAs:"json-comment-optional",sync:false,putData:dojo.toJson(this.putData),handle:function(_bcd){if(_bcd.status=="completed"){_bcb.polling=false;_bcb.standby.hide();Agua.setFileCache(_bcb.putData.username,_bcb.putData.destination,null);var _bce=new Object;_bce.mode="fileSystem";_bce.sessionId=Agua.cookie("sessionId");_bce.username=_bcb.putData.username;_bce.url=Agua.cgiUrl+"folders.cgi?";_bce.path=_bce.destination;_bcb.parentWidget.store.putData=_bce;_bcb.url=_bce.url;_bcb.putData=_bce;_bcb.reloadPane();}else{if(_bcd.error){_bcb.polling=false;_bcb.standby.hide();}else{_bcb.delayedPollCopy();}}}});},setSequence:function(){this.sequence=new dojox.timing.Sequence({});},setStandby:function(){var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.parentWidget.domNode,onClick:"reload",text:"Copying",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);return this.standby;},reloadPane:function(){var item=this.lastNode.item;var _bcf=item.children;if(!_bcf){_bcf=item.items;}item=this.itemParent(item);var _bd0=this.parentWidget._getPaneForItem(item,this._dragSource,_bcf);this.query=_bd0.store.query;if(_bd0){var _bd1=this.getIndexInParent();this.parentWidget.addChild(_bd0,this.getIndexInParent());}},itemParent:function(item){item.directory=true;if(item.parentPath.match(/^.+\/([^\/]+)$/)){item.path=item.parentPath.match(/^(.+?)\/([^\/]+)$/)[2];item.parentPath=item.parentPath.match(/^(.+?)\/([^\/]+)$/)[1];}else{if(item.parentPath.match(/\/*[^\/]+$/)){item.path=item.parentPath;item.parentPath="";}}item.name=item.path;return item;},onclickHandler:function(e){var item=e.target.item;var _bd2=item.children||item.items;var _bd3=this.parentWidget._getPaneForItem(item,this,_bd2);this.query=_bd3.store.query;if(_bd3){this.parentWidget.addChild(_bd3,this.getIndexInParent()+1);}else{this.parentWidget(this);this.parentWidget._onItemClick(null,this,selectMenuItem.item,selectMenuItem.children);}},focus:function(_bd4){if(this._dragSource){if(this._pendingFocus){this.disconnect(this._pendingFocus);}delete this._pendingFocus;var _bd5=this._dragSource.focusedChild;if(!_bd5){var _bd6=dojo.query(".dojoxRollingListItemSelected",this.domNode)[0];if(_bd6){_bd5=dijit.byNode(_bd6);}}if(!_bd5){_bd5=this._dragSource.getAllNodes()[0]||this._dragSource;}this._focusByNode=false;if(_bd5.focusNode){if(!this.parentWidget._savedFocus||_bd4){try{_bd5.focusNode.focus();}catch(e){}}window.setTimeout(function(){try{dijit.scrollIntoView(_bd5.focusNode);}catch(e){}},1);}else{if(_bd5.focus){if(!this.parentWidget._savedFocus||_bd4){_bd5.focus();}}else{this._focusByNode=true;}}this.inherited(arguments);}else{if(!this._pendingFocus){this._pendingFocus=this.connect(this,"onItems","focus");}else{}}},_getDragSource:function(){var _bd7="dojo.dnd.Source";var id=dijit.getUniqueId(_bd7.replace(/\./g,"_"));this.menuNode.id=id;var _bd8=this.getIndexInParent();var _bd9;if(_bd8==0){_bd9="workflow";}else{_bd9="file";}var _bda=new dojo.dnd.Source(id,{accept:[_bd9],copyOnly:true});this.menuNode.setAttribute("class","fileDrag");if(this.path){_bda.path=this.path;}if(this.parentPath){_bda.parentPath=this.parentPath;}if(!_bda._started){_bda.startup();}return _bda;},getPreviousPane:function(){var _bdb=this.parentWidget;var _bdc=0;var _bdd=_bdb.getChildren();for(var i=0;i<_bdd.length;i++){if(_bdd[i]==this){_bdc=i;break;}}if(_bdc==0){return null;}return _bdd[_bdc-1];}});}if(!dojo._hasResource["plugins.files._FileInfoPane"]){dojo._hasResource["plugins.files._FileInfoPane"]=true;dojo.provide("plugins.files._FileInfoPane");dojo.declare("plugins.files._FileInfoPane",[dojox.widget._RollingListPane],{templateString:"",templateString:"<div class=\"dojoxFileInfoPane\">\n\t<table>\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoNameLabel\">Filename </td>\n\t\t\t\t<td colspan=\"3\" align=\"left\" class=\"dojoxFileInfoName\" dojoAttachPoint=\"nameNode\"></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoSizeLabel\">Size (bytes) </td>\n\t\t\t\t<td align=\"left\" class=\"dojoxFileInfoSize\" dojoAttachPoint=\"sizeNode\"></td>\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoBytesLabel\">Sample (bytes) </td>\n\t\t\t\t<td align=\"left\" class=\"dojoxFileInfoBytes\" dojoAttachPoint=\"bytesNode\"></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n<hr>\t\n\t<table>\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td align=\"left\" class=\"dojoxFileInfoSample\" dojoAttachPoint=\"sampleNode\"></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n\n\t\n",postMixInProperties:function(){this.inherited(arguments);},onItems:function(){var _bde=this.store,item=this.items[0];if(!item){this._onError("Load",new Error("No item defined"));}else{this.nameNode.innerHTML=_bde.getValue(item,"name");this.sampleNode.innerHTML=_bde.getValue(item,"sample");this.sizeNode.innerHTML=_bde.getValue(item,"size");this.bytesNode.innerHTML=_bde.getValue(item,"bytes");this.parentWidget.scrollIntoView(this);this.inherited(arguments);}},_setContentAndScroll:function(cont,_bdf){return;this._setContent(cont,_bdf);this.parentWidget.scrollIntoView(this);},});}if(!dojo._hasResource["plugins.files.FileDrag"]){dojo._hasResource["plugins.files.FileDrag"]=true;dojo.provide("plugins.files.FileDrag");dojo.declare("plugins.files.FileDrag",[plugins.core.Common,dojox.widget.RollingList],{cssFiles:[dojo.moduleUrl("dojox")+"widget/Dialog/Dialog.css",dojo.moduleUrl("dojox")+"widget/RollingList/RollingList.css",dojo.moduleUrl("plugins.files")+"/FileDrag/FileDrag.css"],templateString:"<div class=\"dojoxRollingList ${className}\"\n\t><div class=\"dojoxRollingListContainer\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onkeypress:_onKey\"\n\t></div\n\t><div class=\"dojoxRollingListButtons\" dojoAttachPoint=\"buttonsNode\"\n        ><button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"okButton\"\n\t\t\t\tdojoAttachEvent=\"onClick:_onExecute\">${okButtonLabel}</button\n        ><button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"cancelButton\"\n\t\t\t\tdojoAttachEvent=\"onClick:_onCancel\">${cancelButtonLabel}</button\n\t></div\n></div>\n",className:"dojoxFileDrag",pathSeparator:"",topDir:"",parentAttr:"parentDir",pathAttr:"path",path:"",core:null,constructor:function(args){this.inherited(arguments);this.core=args.core;this.path=args.path;},addChild:function(_be0,_be1){this.inherited(arguments);},_itemsMatch:function(_be2,_be3){return true;},selectChild:function(_be4){dojo.forEach(this.getChildren(),function(_be5,_be6){});},reload:function(){this._removeAfter(0);this._started=false;this.load();},startup:function(){this.domNode.setAttribute("style","height: auto !important; width: auto !important; overflow-y: scroll !important; overflow-x: hidden !important; border: none !important;");this.buttonsNode.setAttribute("style","display: none !important");this.loadCSS(this.cssFiles);if(this._started){return;}this.inherited(arguments);var conn,_be7=this.getChildren()[0];var _be8=dojo.hitch(this,function(){if(conn){this.disconnect(conn);}delete conn;var item=_be7.items[0];if(item){var _be9=this.store;var _bea=_be9.getValue(item,this.parentAttr);var path=_be9.getValue(item,this.pathAttr);this.pathSeparator=this.pathSeparator||_be9.pathSeparator;if(!this.pathSeparator){this.pathSeparator=path.substring(_bea.length,_bea.length+1);}if(!this.topDir){this.topDir=_bea;if(!this.topDir){return;}if(this.topDir.lastIndexOf(this.pathSeparator)!=(this.topDir.length-1)){this.topDir+=this.pathSeparator;}}}});if(!this.pathSeparator||!this.topDir){if(!_be7.items){conn=this.connect(_be7,"onItems",_be8);}else{_be8();}}},_removeAfter:function(idx){if(typeof idx!="number"){idx=this.getIndexOfChild(idx);}var _beb=this.getChildren().length;dojo.forEach(this.getChildren(),function(c,i){if(i>idx){this.removeChild(c);c.destroy();}},this);var _bec=this.getChildren(),_bed=_bec[_bec.length-1];var _bee=null;while(_bed&&!_bee){var val=_bed._getSelected?_bed._getSelected():null;if(val){_bee=val.item;}_bed=_bed.parentPane;}if(!this._setInProgress){this._setValue(_bee);}},addChild:function(_bef,_bf0){this._removeAfter(_bf0-1);this.inherited(arguments);if(!_bef._started){_bef.startup();}this.layout();if(!this._savedFocus){_bef.focus();}},removeChild:function(_bf1){},getChildItems:function(item){var ret=this.inherited(arguments);if(!ret&&this.store.getValue(item,"directory")){ret=[];}return ret;},_getMenuItemForItem:function(item,_bf2){var _bf3;_bf3=this.getMenuItemForItem(item,_bf2,null);_bf3.store=this.store;_bf3.item=item;return _bf3;},getMenuItemForItem:function(item,_bf4,_bf5){if(item=="<EMPTY>"){var _bf6={data:"EMPTY",type:["file"]};return _bf6;}var _bf7=this.parentWidget.domNode.childNodes;var _bf8="workflow";if(_bf7.length>1){_bf8="file";}var _bf6={data:item.name,type:[_bf8]};return _bf6;},_getPaneForItem:function(item,_bf9,_bfa){var pane=this.getPaneForItem(item,_bf9,_bfa);var _bfb=this.getPreviousParentPath();if(!_bfb){_bfb=this.store.path;}if(item&&item.name){if(_bfb){_bfb+="/";}_bfb+=item.name;}pane.store=new plugins.dojox.data.FileStore({url:this.store.url,putData:this.store.putData,pathAsQueryParam:true,path:_bfb,parentPath:_bfb,core:this.core});pane.store.path=this.path;this.store.path=this.path;if(item){pane.store.path=item.parentPath;if(pane.store.path==""){pane.store.path=item.name;}this.store.path+="/"+item.name;pane.path=item.parentPath+"/"+item.name;pane.store.path=item.parentPath+"/"+item.name;}else{pane.path=this.path;}pane.store.parentPath=this.path;pane.parentWidget=this;pane.parentPane=_bf9||null;if(!item){pane.query=this.query;pane.queryOptions=this.queryOptions;}else{if(_bfa){pane.items=_bfa;}else{pane.items=[item];}}return pane;},getPaneForItem:function(item,_bfc,_bfd){var _bfe=null;var path="";var _bff="";var _c00=this.getChildren();if(_c00){for(var i=0;i<_c00.length;i++){}}if(_c00&&_c00.length>0){_bff=_c00[_c00.length-1].store.path;}var path=_bff;if(item&&item.path){path+="/"+item.path;}if(item){}if(!item||(this.store.isItem(item)&&_c00)||this.store.getValue(item,"directory")){this.core.filedrag=this;_bfe=new plugins.files._GroupDragPane({parentPath:_bff,path:path,fileMenu:this.fileMenu,workflowMenu:this.workflowMenu,folderMenu:this.folderMenu,core:this.core});}else{_bfe=new plugins.files._FileInfoPane({});dojo.removeClass(_bfe.domNode,"dijitContentPane");}return _bfe;},getPreviousParentPath:function(){var _c01="";var _c02=this.getChildren();if(_c02){for(var i=0;i<_c02.length;i++){}}if(_c02&&_c02.length>0){_c01=_c02[_c02.length-1].store.path;}return _c01;},_setPathValueAttr:function(path){if(!path){this.set("value",null);return;}if(path.lastIndexOf(this.pathSeparator)==(path.length-1)){path=path.substring(0,path.length-1);}this.store.fetchItemByIdentity({identity:path,onItem:dojo.hitch(this,"attr","value"),scope:this});},_getPathValueAttr:function(val){if(!val){val=this.value;}if(val&&this.store.isItem(val)){return this.store.getValue(val,this.pathAttr);}else{return "";}},onFetchStart:function(){return this.loadingMessage;},onFetchError:function(_c03){return this.errorMessage;}});}if(!dojo._hasResource["plugins.menu.Menu"]){dojo._hasResource["plugins.menu.Menu"]=true;dojo.provide("plugins.menu.Menu");dojo.declare("plugins.menu.Menu",[dijit.Menu],{enabled:true,_openMyself:function(args){console.log("Menu._openMyself    plugins.menu.Menu._openMyself(args)");if(this.enabled==false){return;}this.currentTarget=args.target;if(this.currentTarget){console.log("plugins.menu.Menu._openMyself    Setting add class 'dojoDndItemOver' to this.currentTarget: "+this.currentTarget);console.dir({currentTarget:this.currentTarget});dojo.addClass(this.currentTarget,"dojoDndItemOver");var _c04=dojo.attr(this.currentTarget,"class");console.log("plugins.menu.Menu._openMyself    this.currentTarget classes: "+_c04);}var _c05=args.target,_c06=args.iframe,_c07=args.coords;if(_c07){if(_c06){var od=_c05.ownerDocument,ifc=dojo.position(_c06,true),win=this._iframeContentWindow(_c06),_c08=dojo.withGlobal(win,"_docScroll",dojo);var cs=dojo.getComputedStyle(_c06),tp=dojo._toPixelValue,left=(dojo.isIE&&dojo.isQuirks?0:tp(_c06,cs.paddingLeft))+(dojo.isIE&&dojo.isQuirks?tp(_c06,cs.borderLeftWidth):0),top=(dojo.isIE&&dojo.isQuirks?0:tp(_c06,cs.paddingTop))+(dojo.isIE&&dojo.isQuirks?tp(_c06,cs.borderTopWidth):0);_c07.x+=ifc.x+left-_c08.x;_c07.y+=ifc.y+top-_c08.y;}}else{_c07=dojo.position(_c05,true);_c07.x+=10;_c07.y+=10;}var self=this;var _c09=dijit.getFocus(this);function _c0a(){if(self.refocus){dijit.focus(_c09);}dijit.popup.close(self);};dijit.popup.open({popup:this,x:_c07.x,y:_c07.y,onExecute:_c0a,onCancel:_c0a,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){console.log("plugins.menu.Menu._onBlur");this.inherited("_onBlur",arguments);dijit.popup.close(this);};}});}if(!dojo._hasResource["plugins.dijit.InputDialog"]){dojo._hasResource["plugins.dijit.InputDialog"]=true;dojo.provide("plugins.dijit.InputDialog");dojo.declare("plugins.dijit.InputDialog",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\"\n        height=\"300px\" width=\"100%\" style=\"padding: 0; margin: 0;\"\n        class=\"inputDialog\">\n        <tr>\n            <td align=\"center\">\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    closeText=\"false\"\n                    title=\"${title}\"\n                    style=\"margin-right: auto; margin-left: auto; text-align: center;\"\n                    >\n                    \n                    <table\n                        cellpadding=\"0\"\n                        cellspacing=\"0\"\n                        class=\"inputDialog\"\n                        width=\"100%\"\n                        >\n\n                        <tr class=\"message\" align=\"center\">\n                            <td\n                                align=\"center\"\n                                dojoAttachPoint=\"messageNode\"\n                                colspan=\"2\">${message}</td>\n                        </tr>\n\n                        <tr class=\"input\" align=\"center\" dojoAttachPoint=\"inputContainer\">\n                            <td align=\"center\" colspan=\"2\" >\n                                <input type=\"text\" align=\"center\"\n                                dojoAttachPoint=\"inputNode\"\n                                value=\"\"></input>\n                            </td>\n                        </tr>\n                        \n\n                        <tr\n                            dojoAttachPoint=\"checkboxContainer\"\n                            class=\"hidden\">\n\n                            <td colspan=\"2\">\n                                <table>\n                                    <tr>\n                                        <td class=\"leftColumn\"\n                                            dojoAttachPoint=\"checkboxMessageNode\"\n                                            class=\"hidden\"\n                                        >\n                                        </td>\n                                        <td class=\"rightColumn\">\n                                            <input\n                                                dojoAttachPoint=\"checkbox\"  \n                                                style=\"visibility: hidden\"\n                                                type=\"checkbox\"\n                                                class=\"hidden\"\n                                        >\n                                        </td>\n                                    </tr>\n                                </table>\n                            </td>\n\n                        </tr>\n                        \n\n                        <tr>\n                            <td align=\"center\" class=\"enterButton\">\n                                <button\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Enter\"\n                                    dojoAttachEvent=\"onClick:doEnter\"\n                                    >\n                                </button>\n                            </td>\n\n                            <td align=\"center\" class=\"cancelButton\">\n                                <div\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Cancel\"\n                                    dojoAttachEvent=\"onClick:doCancel\"\n                                    >\n                                </div>\n                            </td>\n                        </tr>\n                        \n                        \n                    </table>\n\n                </div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","dijit/css/inputdialog.css")],widgetsInTemplate:true,parentWidget:null,application:null,message:null,constructor:function(args){this.setEnterLabel(args.enterLabel);this.setCancelLabel(args.cancelLabel);this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDialogue();this.showInputbox(this.inputMessage);this.showCheckbox(this.checkboxMessage);this.setNamespaceClass("inputDialog");},setNamespaceClass:function(_c0b){dojo.addClass(this.dialog.containerNode,_c0b);dojo.addClass(this.dialog.titleNode,_c0b);dojo.addClass(this.dialog.closeButtonNode,_c0b);},show:function(){this.dialog.show();this.enterButton.focus();},hide:function(){this.dialog.hide();},doEnter:function(type){var _c0c=this.inputNode.value;var _c0d=this.checkbox.checked;if(_c0d==true){_c0d=1;}else{_c0d=0;}this.dialog.enterCallback(_c0c,_c0d);this.inputNode.value="";this.dialog.hide();},doCancel:function(){this.dialog.cancelCallback();this.dialog.hide();},setDialogue:function(){document.body.appendChild(this.dialog.domNode);this.dialog.parentWidget=this;this._fadeOutDeferred=function(){};},load:function(args){if(args.title==null){args.title="";}this.dialog.titleNode.innerHTML=args.title;this.messageNode.innerHTML=args.message;this.dialog.enterCallback=args.enterCallback;this.dialog.cancelCallback=args.cancelCallback;this.showCheckbox(args.checkboxMessage);this.setEnterLabel(args.enterLabel);this.setCancelLabel(args.cancelLabel);this.show();},showInputbox:function(_c0e){if(_c0e==null){dojo.destroy(this.inputContainer);}else{this.inputNode.style.visibility="visible";this.checkbox.style.visibility="visible";this.inputNode.innerHTML=_c0e;var _c0f=this;this.inputNode.onkeypress=function(evt){var key=evt.which;if(key==13){evt.stopPropagation();_c0f.doEnter();}};}},showCheckbox:function(_c10){if(_c10==null){dojo.addClass(this.checkboxMessageNode,"hidden");dojo.addClass(this.checkbox,"hidden");}else{dojo.removeClass(this.checkboxMessageNode,"hidden");dojo.removeClass(this.checkbox,"hidden");this.inputNode.innerHTML=_c10;}},setEnterLabel:function(_c11){if(_c11!=null&&this.enterButton!=null){this.enterButton.set("label",_c11);}},setCancelLabel:function(_c12){if(_c12!=null&&this.cancelButton!=null){this.cancelButton.set("label",_c12);}}});}if(!dojo._hasResource["plugins.dijit.InteractiveDialog"]){dojo._hasResource["plugins.dijit.InteractiveDialog"]=true;dojo.provide("plugins.dijit.InteractiveDialog");dojo.declare("plugins.dijit.InteractiveDialog",[plugins.dijit.InputDialog],{show:function(){this.dialog.show();},hide:function(){this.dialog.hide();},doEnter:function(type){console.log("InteractiveDialog.doEnter    plugins.dijit.InteractiveDialog.doEnter()");console.log("InteractiveDialog.doEnter    Doing this.dialog.hide()");this.dialog.hide();var _c13="";if(this.inputNode!=null){_c13=this.inputNode.value;}var _c14=false;if(this.checkbox!=null){_c14=this.checkbox.checked;}if(_c14==true){_c14=1;}else{_c14=0;}console.log("InteractiveDialog.doEnter    input: "+_c13);console.log("InteractiveDialog.doEnter    checked: "+_c14);this.dialog.enterCallback(_c13,_c14,this);},doCancel:function(){console.log("InteractiveDialog.doCancel    plugins.dijit.InteractiveDialog.doCancel()");this.dialog.hide();this.dialog.cancelCallback();},close:function(){this.dialog.hide();this.inputNode.value="";}});}if(!dojo._hasResource["plugins.dijit.ConfirmDialog"]){dojo._hasResource["plugins.dijit.ConfirmDialog"]=true;dojo.provide("plugins.dijit.ConfirmDialog");dojo.declare("plugins.dijit.ConfirmDialog",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\" cellpadding=\"0px\"\n        height=\"300px\" width=\"100%\" >\n        <tr>\n            <td>\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    class=\"confirmDialog\"\n                    closeText=\"false\"\n                    title=\"${title}\"\n                >\n                    \n                    <table\n                        cellpadding=\"0\"\n                        cellspacing=\"0\"\n                        width=\"100%\"\n                        >\n                        <tr class=\"message\" align=\"center\">\n                            <td\n                                align=\"center\"\n                                dojoAttachPoint=\"messageNode\"\n                                colspan=\"2\">${message}</td>\n                        </tr>\n                        \n                        <tr>\n                            <td align=\"center\" class=\"yesButton\">\n                                <button\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Yes\"\n                                    dojoAttachEvent=\"onClick:doYes\"\n                                    >\n                                </button>\n                            </td>\n\n                            <td align=\"center\" class=\"noButton\">\n                                <div\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"No\"\n                                    dojoAttachEvent=\"onClick:doNo\"\n                                    >\n                                </div>\n                            </td>\n                        </tr>\n                    </table>\n\n                </div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins.dijit")+"/css/confirmdialog.css"],widgetsInTemplate:true,parentWidget:null,application:null,title:null,message:null,constructor:function(args){this.title=args.title;this.message=args.message;this.parentWidget=args.parentWidget;this.yesCallback=args.yesCallback;this.noCallback=args.noCallback;this.loadCSS();},getApplication:function(){return this.application;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDialogue();dojo.addClass(this.dialog.containerNode,"confirmDialog");dojo.addClass(this.dialog.titleNode,"confirmDialog");dojo.addClass(this.dialog.closeButtonNode,"confirmDialog");this.dialog.closeButtonNode.setAttribute("display","none");this.dialog.closeButtonNode.setAttribute("visibility","hidden");},show:function(){this.dialog.show();},hide:function(){this.dialog.hide();},doYes:function(type){this.dialog.yesCallback();this.dialog.hide();},doNo:function(){this.dialog.noCallback();this.dialog.hide();},load:function(args){if(args.title==null){args.title="";}this.dialog.titleNode.innerHTML=args.title;this.messageNode.innerHTML=args.message;this.dialog.yesCallback=args.yesCallback;this.dialog.noCallback=args.noCallback;this.show();},setDialogue:function(){document.body.appendChild(this.dialog.domNode);}});}if(!dojo._hasResource["dojox.form.uploader.Base"]){dojo._hasResource["dojox.form.uploader.Base"]=true;dojo.provide("dojox.form.uploader.Base");dojo.declare("dojox.form.uploader.Base",[dijit._Widget,dijit._Templated],{getForm:function(){if(!this.form){var n=this.domNode;while(n&&n.tagName&&n!==document.body){if(n.tagName.toLowerCase()=="form"){this.form=n;break;}n=n.parentNode;}}return this.form;},getUrl:function(){if(this.uploadUrl){this.url=this.uploadUrl;}if(this.url){return this.url;}if(this.getForm()){this.url=this.form.action;}return this.url;},connectForm:function(){this.url=this.getUrl();if(!this._fcon&&!!this.getForm()){this._fcon=true;this.connect(this.form,"onsubmit",function(evt){dojo.stopEvent(evt);this.submit(dojo.formToObject(this.form));});}},supports:function(what){if(!this._hascache){this._hascache={testDiv:dojo.create("div"),testInput:dojo.create("input",{type:"file"}),xhr:!!window.XMLHttpRequest?new XMLHttpRequest():{}};dojo.style(this._hascache.testDiv,"opacity",0.7);}switch(what){case "FormData":return !!window.FormData;case "sendAsBinary":return !!this._hascache.xhr.sendAsBinary;case "opacity":return dojo.style(this._hascache.testDiv,"opacity")==0.7;case "multiple":if(this.force=="flash"||this.force=="iframe"){return false;}var res=dojo.attr(this._hascache.testInput,"multiple");return res===true||res===false;}return false;},getMimeType:function(){return "application/octet-stream";},getFileType:function(name){return name.substring(name.lastIndexOf(".")+1).toUpperCase();},convertBytes:function(_c15){var kb=Math.round(_c15/1024*100000)/100000;var mb=Math.round(_c15/1048576*100000)/100000;var gb=Math.round(_c15/1073741824*100000)/100000;var _c16=_c15;if(kb>1){_c16=kb.toFixed(1)+" kb";}if(mb>1){_c16=mb.toFixed(1)+" mb";}if(gb>1){_c16=gb.toFixed(1)+" gb";}return {kb:kb,mb:mb,gb:gb,bytes:_c15,value:_c16};}});}if(!dojo._hasResource["dojox.form.Uploader"]){dojo._hasResource["dojox.form.Uploader"]=true;dojo.provide("dojox.form.Uploader");dojo.experimental("dojox.form.Uploader");dojo.declare("dojox.form.Uploader",[dojox.form.uploader.Base],{uploadOnSelect:false,tabIndex:0,multiple:false,label:"Upload...",url:"",name:"uploadedfile",flashFieldName:"",uploadType:"form",_nameIndex:0,widgetsInTemplate:true,templateString:"<div class=\"dojoxFileInput\"><div dojoType=\"dijit.form.Button\" dojoAttachPoint=\"button\">${label}</div></div>",postMixInProperties:function(){this._inputs=[];this._getButtonStyle(this.srcNodeRef);this.inherited(arguments);},postCreate:function(){var _c17=false;var _c18=this.domNode.parentNode;var _c19=this._getNodePosition(this.domNode);if(!this.btnSize.w||!this.btnSize.h){dojo.body().appendChild(this.domNode);this._getButtonStyle(this.domNode);_c17=true;}this._setButtonStyle();if(_c17){dojo.place(this.domNode,_c19.node,_c19.pos);}this.inherited(arguments);},onChange:function(_c1a){},onBegin:function(_c1b){},onProgress:function(_c1c){},onComplete:function(_c1d){console.log("dojox.form.Uploader.onComplete()");this.reset();},onCancel:function(){},onAbort:function(){},onError:function(_c1e){},upload:function(_c1f){},submit:function(form){},reset:function(){this._disconnectButton();this._inputs=[];this._nameIndex=0;this._createInput();},getFileList:function(){var _c20=[];if(this.supports("multiple")){dojo.forEach(this.inputNode.files,function(f,i){_c20.push({index:i,name:f.name,size:f.size,type:f.type});},this);}else{dojo.forEach(this._inputs,function(n,i){_c20.push({index:i,name:n.value.substring(n.value.lastIndexOf("\\")+1),size:0,type:n.value.substring(n.value.lastIndexOf(".")+1)});},this);}return _c20;},_getValueAttr:function(){return this.getFileList();},_setValueAttr:function(_c21){},_getDisabledAttr:function(){return this._disabled;},_setDisabledAttr:function(_c22){if(this._disabled==_c22){return;}this.button.set("disabled",_c22);dojo.style(this.inputNode,"display",_c22?"none":"block");},_getNodePosition:function(node){if(node.previousSibling){return {node:node.previousSibling,pos:"after"};}return {node:node.nextSibling,pos:"before"};},_getButtonStyle:function(node){if(!node){this.btnSize={w:200,h:25};}else{this.btnSize=dojo.marginBox(node);}},_setButtonStyle:function(){var _c23=true;if(!this.domNode.parentNode||!this.domNode.parentNode.tagName){document.body.appendChild(this.domNode);_c23=false;}dojo.style(this.domNode,{width:this.btnSize.w+"px",height:(this.btnSize.h+4)+"px",overflow:"hidden",position:"relative"});this.inputNodeFontSize=Math.max(2,Math.max(Math.ceil(this.btnSize.w/60),Math.ceil(this.btnSize.h/15)));this._createInput();dojo.style(this.button.domNode,{margin:"0px",display:"block",verticalAlign:"top"});dojo.style(this.button.domNode.firstChild,{margin:"0px",display:"block"});if(!_c23){document.body.removeChild(this.domNode);}},_createInput:function(){if(this._inputs.length){dojo.style(this.inputNode,{top:"500px"});this._disconnectButton();this._nameIndex++;}var name;if(this.supports("multiple")){name=this.name+"s[]";}else{name=this.name+(this.multiple?this._nameIndex:"");}this.inputNode=dojo.create("input",{type:"file",name:name,className:"dojoxInputNode"},this.domNode,"first");if(this.supports("multiple")&&this.multiple){dojo.attr(this.inputNode,"multiple",true);}this._inputs.push(this.inputNode);dojo.style(this.inputNode,{fontSize:this.inputNodeFontSize+"em"});var size=dojo.marginBox(this.inputNode);dojo.style(this.inputNode,{position:"absolute",top:"-2px",left:"-"+(size.w-this.btnSize.w-2)+"px",opacity:0});this._connectButton();},_connectButton:function(){this._cons=[];var cs=dojo.hitch(this,function(nm){this._cons.push(dojo.connect(this.inputNode,nm,this,function(evt){this.button._cssMouseEvent({type:nm});}));});cs("mouseover");cs("mouseout");cs("mousedown");this._cons.push(dojo.connect(this.inputNode,"change",this,function(evt){this.onChange(this.getFileList(evt));if(!this.supports("multiple")&&this.multiple){this._createInput();}}));this.button.set("tabIndex",-1);if(this.tabIndex>-1){this.inputNode.tabIndex=this.tabIndex;var _c24=dojo.style(this.button.domNode.firstChild,"border");this._cons.push(dojo.connect(this.inputNode,"focus",this,function(){dojo.style(this.button.domNode.firstChild,"border","1px dashed #ccc");}));this._cons.push(dojo.connect(this.inputNode,"blur",this,function(){dojo.style(this.button.domNode.firstChild,"border",_c24);}));}},_disconnectButton:function(){console.log("dojox.form.Uploaders._disconnectButton    this._cons:");console.dir({this_cons:this._cons});}});(function(){dojox.form.UploaderOrg=dojox.form.Uploader;var _c25=[dojox.form.UploaderOrg];dojox.form.addUploaderPlugin=function(plug){console.log("dojox.form.Uploader.addUploaderPlugin    XXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXX plug: "+plug);_c25.push(plug);dojo.declare("dojox.form.Uploader",_c25,{});};})();}if(!dojo._hasResource["dojox.form.uploader.FileList"]){dojo._hasResource["dojox.form.uploader.FileList"]=true;dojo.provide("dojox.form.uploader.FileList");dojo.declare("dojox.form.uploader.FileList",[dojox.form.uploader.Base],{uploaderId:"",uploader:null,headerIndex:"#",headerType:"Type",headerFilename:"File Name",headerFilesize:"Size",_upCheckCnt:0,rowAmt:0,templateString:"<div class=\"dojoxUploaderFileList\">"+"<div dojoAttachPoint=\"progressNode\" class=\"dojoxUploaderFileListProgress\"><div dojoAttachPoint=\"percentBarNode\" class=\"dojoxUploaderFileListProgressBar\"></div><div dojoAttachPoint=\"percentTextNode\" class=\"dojoxUploaderFileListPercentText\">0%</div></div>"+"<table class=\"dojoxUploaderFileListTable\">"+"<tr class=\"dojoxUploaderFileListHeader\"><th class=\"dojoxUploaderIndex\">${headerIndex}</th><th class=\"dojoxUploaderIcon\">${headerType}</th><th class=\"dojoxUploaderFileName\">${headerFilename}</th><th class=\"dojoxUploaderFileSize\">${headerFilesize}</th></tr>"+"<tr ><td colSpan=\"4\" class=\"dojoxUploaderFileListContainer\" dojoAttachPoint=\"containerNode\">"+"<table class=\"dojoxUploaderFileListContent\" dojoAttachPoint=\"listNode\"></table>"+"</td><tr>"+"</table>"+"<div>",postCreate:function(){this.setUploader();this.hideProgress();},reset:function(){console.log("dojox.form.uploader.FileList.reset()");for(var i=0;i<this.rowAmt;i++){this.listNode.deleteRow(0);}this.rowAmt=0;},setUploader:function(){if(!this.uploaderId&&!this.uploader){}else{if(this.uploaderId&&!this.uploader){this.uploader=dijit.byId(this.uploaderId);}else{if(this._upCheckCnt>4){return;}}}if(this.uploader){this.connect(this.uploader,"onChange","_onUploaderChange");this.connect(this.uploader,"reset","reset");this.connect(this.uploader,"onBegin",function(){this.showProgress(true);});this.connect(this.uploader,"onProgress","_progress");this.connect(this.uploader,"onComplete",function(){setTimeout(dojo.hitch(this,function(){this.hideProgress(true);}),1250);});}else{this._upCheckCnt++;setTimeout(dojo.hitch(this,"setUploader"),250);}},hideProgress:function(_c26){var o=_c26?{ani:true,endDisp:"none",beg:15,end:0}:{endDisp:"none",ani:false};this._hideShowProgress(o);},showProgress:function(_c27){var o=_c27?{ani:true,endDisp:"block",beg:0,end:15}:{endDisp:"block",ani:false};this._hideShowProgress(o);},_progress:function(_c28){this.percentTextNode.innerHTML=_c28.percent;dojo.style(this.percentBarNode,"width",_c28.percent);},_hideShowProgress:function(o){var node=this.progressNode;var _c29=function(){dojo.style(node,"display",o.endDisp);};if(o.ani){dojo.style(node,"display","block");dojo.animateProperty({node:node,properties:{height:{start:o.beg,end:o.end,units:"px"}},onEnd:_c29}).play();}else{_c29();}},_onUploaderChange:function(_c2a){dojo.forEach(_c2a,function(f,i){this._addRow(i+1,this.getFileType(f.name),f.name,f.size);},this);},_addRow:function(_c2b,type,name,size){var c,r=this.listNode.insertRow(-1);c=r.insertCell(-1);dojo.addClass(c,"dojoxUploaderIndex");c.innerHTML=_c2b;c=r.insertCell(-1);dojo.addClass(c,"dojoxUploaderIcon");c.innerHTML=type;c=r.insertCell(-1);dojo.addClass(c,"dojoxUploaderFileName");c.innerHTML=name;c=r.insertCell(-1);dojo.addClass(c,"dojoxUploaderSize");c.innerHTML=this.convertBytes(size).value;this.rowAmt++;}});}if(!dojo._hasResource["dojox.form.uploader.plugins.HTML5"]){dojo._hasResource["dojox.form.uploader.plugins.HTML5"]=true;dojo.provide("dojox.form.uploader.plugins.HTML5");dojo.declare("dojox.form.uploader.plugins.HTML5",[],{errMsg:"Error uploading files. Try checking permissions",uploadType:"html5",postCreate:function(){this.connectForm();this.inherited(arguments);if(this.uploadOnSelect){this.connect(this,"onChange","upload");}},upload:function(_c2c){this.onBegin(this.getFileList());if(this.supports("FormData")){this.uploadWithFormData(_c2c);}else{if(this.supports("sendAsBinary")){this.sendAsBinary(_c2c);}}},submit:function(form){form=!!form?form.tagName?form:this.getForm():this.getForm();var data=dojo.formToObject(form);this.upload(data);},sendAsBinary:function(data){if(!this.getUrl()){}var _c2d="---------------------------"+(new Date).getTime();var xhr=this.createXhr();xhr.setRequestHeader("Content-Type","multipart/form-data; boundary="+_c2d);var msg=this._buildRequestBody(data,_c2d);if(!msg){this.onError(this.errMsg);}else{xhr.sendAsBinary(msg);}},uploadWithFormData:function(data){if(!this.getUrl()){}var fd=new FormData();dojo.forEach(this.inputNode.files,function(f,i){fd.append(this.name+"s[]",f);},this);if(data){for(var nm in data){fd.append(nm,data[nm]);}}var xhr=this.createXhr();xhr.send(fd);},_xhrProgress:function(evt){if(evt.lengthComputable){var o={bytesLoaded:evt.loaded,bytesTotal:evt.total,type:evt.type,timeStamp:evt.timeStamp};if(evt.type=="load"){o.percent="100%",o.decimal=1;}else{o.decimal=evt.loaded/evt.total;o.percent=Math.ceil((evt.loaded/evt.total)*100)+"%";}this.onProgress(o);}},createXhr:function(){var xhr=new XMLHttpRequest();var _c2e;xhr.upload.addEventListener("progress",dojo.hitch(this,"_xhrProgress"),false);xhr.addEventListener("load",dojo.hitch(this,"_xhrProgress"),false);xhr.addEventListener("error",dojo.hitch(this,function(evt){this.onError(evt);clearInterval(_c2e);}),false);xhr.addEventListener("abort",dojo.hitch(this,function(evt){this.onAbort(evt);clearInterval(_c2e);}),false);xhr.onreadystatechange=dojo.hitch(this,function(){if(xhr.readyState===4){console.info("dojox.form.uploader.plugins.HTML5    COMPLETE");clearInterval(_c2e);this.onComplete({});}});xhr.open("POST",this.getUrl());_c2e=setInterval(dojo.hitch(this,function(){try{if(typeof (xhr.statusText)){}}catch(e){clearInterval(_c2e);}}),250);return xhr;},_buildRequestBody:function(data,_c2f){var EOL="\r\n";var part="";_c2f="--"+_c2f;var _c30=[];dojo.forEach(this.inputNode.files,function(f,i){var _c31=this.name+"s[]";var _c32=this.inputNode.files[i].fileName;var _c33;try{_c33=this.inputNode.files[i].getAsBinary()+EOL;part+=_c2f+EOL;part+="Content-Disposition: form-data; ";part+="name=\""+_c31+"\"; ";part+="filename=\""+_c32+"\""+EOL;part+="Content-Type: "+this.getMimeType()+EOL+EOL;part+=_c33;}catch(e){_c30.push({index:i,name:_c32});}},this);if(_c30.length){if(_c30.length>=this.inputNode.files.length){this.onError({message:this.errMsg,filesInError:_c30});part=false;}}if(!part){return false;}if(data){for(var nm in data){part+=_c2f+EOL;part+="Content-Disposition: form-data; ";part+="name=\""+nm+"\""+EOL+EOL;part+=data[nm]+EOL;}}part+=_c2f+"--"+EOL;return part;}});dojox.form.addUploaderPlugin(dojox.form.uploader.plugins.HTML5);}if(!dojo._hasResource["plugins.form.Uploader"]){dojo._hasResource["plugins.form.Uploader"]=true;dojo.provide("plugins.form.Uploader");dojo.declare("plugins.form.Uploader",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div id=\"attachPoint\" ></div>\n\n    <table\n        cellspacing=\"0px\"\n        height=\"300px\"\n        width=\"600px\"\n        style=\"padding: 0; margin: 0;\"\n\t\tclass=\"pageTable\"\n\t>\n        <tr>\n            <td align=\"center\">\n\t\t\t<td id=\"colForm\">\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    closeText=\"true\"\n                    title=\"File Upload\"\n                    class=\"uploader\"\n\t\t\t\t\tdraggable=\"true\"\n                    style=\"margin-right: auto; margin-left: auto; text-align: center;\"\n\t\t\t\t>\n\n\t\t\t\t<form\n\t\t\t\t\tmethod=\"post\"\n\t\t\t\t\taction=\"../../../../../../cgi-bin/agua/upload.cgi\"\n\t\t\t\t\tenctype=\"multipart/form-data\" >\n\n\t\t\t\t\t<fieldset>\n\t\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tdojoType=\"dojox.form.Uploader\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"uploader\"\n\t\t\t\t\t\t\tclass=\"browseButton\"\n\t\t\t\t\t\t\tname=\"uploadedfile\"\n\t\t\t\t\t\t\tselectMultipleFiles=\"true\"\n\t\t\t\t\t\t\tmultiple=\"true\"\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\ttitle=\"Click to Select Files\"\n\t\t\t\t\t\t\tid=\"${uploaderId}\">\n\n<!--\t\t\t\t\t\t<div class=\"destination\">\n\t\t\t\t\t\t\tDestination\n\t\t\t\t\t\t\t<div dojoAttachPoint=\"destination\"></div>\n\t\t\t\t\t\t</div>\n\n-->\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tdojoAttachPoint=\"path\"\n\t\t\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\t\t\tname=\"path\"\n\t\t\t\t\t\t\tvalue=\"\" />\n\t\t\t\t\t\t\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"username\"\n\t\t\t\t\t\t\tname=\"username\"\n\t\t\t\t\t\t\tvalue=\"${username}\" />\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\t\t\tname=\"sessionId\"\n\t\t\t\t\t\t\tvalue=\"${sessionId}\" />\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\tdojoAttachEvent=\"onClick:clear\"\n\t\t\t\t\t\t\tlabel=\"Clear\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tlabel=\"Submit\"\n\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\" />\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoType=\"dojox.form.uploader.FileList\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"fileList\"\n\t\t\t\t\t\t\tuploaderId=\"${uploaderId}\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n\t\t\t\t</form>\n\t\t\t\t\n\t\t\t</td>\n\t\t\t\n\t\t\t<td\n\t\t\t\tdojoAttachPoint=\"images\"\n\t\t\t>\n\t\t\t</td>\n\t\t</tr>\n\t</table>\n\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,cssFiles:[dojo.moduleUrl("plugins","form/css/uploader.css"),dojo.moduleUrl("dojox","form/resources/UploaderFileList.css"),dojo.moduleUrl("dijit","themes/dijit.css"),],constructor:function(args){console.log("Uploader.constructor    args: ");console.dir({args:args});if(args!=null){this.url=args.url;this.parentWidget=args.parentWidget;this.username=args.username;this.sessionId=args.sessionId;this.path=args.path;}this.loadCSS(this.cssFiles);},postCreate:function(){console.log("Uploader.postCreate    plugins.form.Uploader.postCreate()");this.startup();},startup:function(){console.log("Uploader.startup    plugins.form.Uploader.startup()");this.inherited(arguments);this.setUploader();},clear:function(){console.log("Uploader.clear    this.fileList:");console.dir({fileList:this.fileList});this.fileList.reset();},setUploader:function(){console.log("Uploader.setUploader    plugins.form.Uploader.setUploader()");console.log("Uploader.setUploader    this.dialog: "+this.dialog);this.handleUpload(this.uploader,this.images);console.log("Uploader.setUploader    this.dialog: "+this.dialog);var _c34=this;dojo.connect(this.uploader,"onComplete",this,"onComplete");this.uploader.onComplete=function(_c35){console.log("Uploader.onComplete    dojox.form.plugins.Uploader.onComplete(data)");console.log("Uploader.onComplete    customEvent: ");console.dir({customEvent:_c35});_c34.onComplete(_c35);};this.uploader.createXhr=function(){console.log("Uploader.setUploader    OVERRIDE plugins.dojox.form.Uploader.HTML5.createXhr()");var xhr=new XMLHttpRequest();var _c36;xhr.upload.addEventListener("progress",dojo.hitch(this,"_xhrProgress"),false);xhr.addEventListener("load",dojo.hitch(this,"_xhrProgress"),false);xhr.addEventListener("error",dojo.hitch(this,function(evt){this.onError(evt);clearInterval(_c36);}),false);xhr.addEventListener("abort",dojo.hitch(this,function(evt){this.onAbort(evt);clearInterval(_c36);}),false);xhr.onreadystatechange=dojo.hitch(this,function(){if(xhr.readyState===4){console.info("plugins.dojox.form.uploader.plugins.HTML5    COMPLETE");clearInterval(_c36);this.onComplete({});}});xhr.open("POST",this.getUrl());_c36=setInterval(dojo.hitch(this,function(){try{if(typeof (xhr.statusText)){}}catch(e){clearInterval(_c36);}}),250);return xhr;};},handleUpload:function(upl,node){dojo.connect(upl,"onComplete",function(_c37){console.log("Uploader.handleUpload    INSIDE dojo.connect");dojo.forEach(_c37,function(file){console.log("display:",file);var div=dojo.create("div",{className:"thumb"});var span=dojo.create("span",{className:"thumbbk"},div);var img=dojo.create("img",{src:file.file},span);node.appendChild(div);});});},onComplete:function(_c38){console.log("Uploader.onComplete    form.Uploader.onComplete(customEvent)");console.info("Uploader.onComplete    FILL ME IN");},fixInputNode:function(){var _c39=this.uploader._inputs[0];console.log("Uploader.setInputNode     inputnode: "+_c39);console.dir(_c39);var _c3a=dojo.attr(_c39,"style");console.log("Uploader.setInputNode     style: "+dojo.toJson(_c3a));_c3a+=" left: 0px !important;";dojo.attr(_c39,"style",_c3a);},setPath:function(_c3b){console.log("Uploader.setPath     plugins.form.Uploader.setPath(value)");console.log("Uploader.setPath     value: "+_c3b);if(_c3b==null){return;}this.path.value=_c3b;this.dialog.set("title","Upload to: "+_c3b);},getPath:function(){return this.path.innerHTML;},show:function(){this.dialog.show();},hide:function(){this.dialog.hide();}});}if(!dojo._hasResource["dojo.io.iframe"]){dojo._hasResource["dojo.io.iframe"]=true;dojo.provide("dojo.io.iframe");dojo.getObject("io",true,dojo);dojo.io.iframe={create:function(_c3c,_c3d,uri){if(window[_c3c]){return window[_c3c];}if(window.frames[_c3c]){return window.frames[_c3c];}var _c3e=null;var turi=uri;if(!turi){if(dojo.config["useXDomain"]&&!dojo.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}turi=(dojo.config["dojoBlankHtmlUrl"]||dojo.moduleUrl("dojo","resources/blank.html"));}var _c3e=dojo.place("<iframe id=\""+_c3c+"\" name=\""+_c3c+"\" src=\""+turi+"\" onload=\""+_c3d+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",dojo.body());window[_c3c]=_c3e;return _c3e;},setSrc:function(_c3f,src,_c40){try{if(!_c40){if(dojo.isWebKit){_c3f.location=src;}else{frames[_c3f.name].location=src;}}else{var idoc;if(dojo.isIE||dojo.isWebKit){idoc=_c3f.contentWindow.document;}else{idoc=_c3f.contentWindow;}if(!idoc){_c3f.location=src;return;}else{idoc.location.replace(src);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_c41){var doc=_c41.contentDocument||(((_c41.name)&&(_c41.document)&&(dojo.doc.getElementsByTagName("iframe")[_c41.name].contentWindow)&&(dojo.doc.getElementsByTagName("iframe")[_c41.name].contentWindow.document)))||((_c41.name)&&(dojo.doc.frames[_c41.name])&&(dojo.doc.frames[_c41.name].document))||null;return doc;},send:function(args){if(!this["_frame"]){this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");}var dfd=dojo._ioSetArgs(args,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _c42=null;try{var _c43=dfd.ioArgs;var dii=dojo.io.iframe;var ifd=dii.doc(dii._frame);var _c44=_c43.handleAs;_c42=ifd;if(_c44!="html"){if(_c44=="xml"){if(dojo.isIE<9||(dojo.isIE&&dojo.isQuirks)){dojo.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _c45=(dii._frame.contentWindow.document).documentElement.innerText;_c45=_c45.replace(/>\s+</g,"><");_c45=dojo.trim(_c45);var _c46={responseText:_c45};_c42=dojo._contentHandlers["xml"](_c46);}}else{_c42=ifd.getElementsByTagName("textarea")[0].value;if(_c44=="json"){_c42=dojo.fromJson(_c42);}else{if(_c44=="javascript"){_c42=dojo.eval(_c42);}}}}}catch(e){_c42=e;}finally{_c43._callNext();}return _c42;},function(_c47,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _c47;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;dojo.io.iframe._currentDfd=null;dojo.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();dojo._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}do{var dfd=this._currentDfd=this._dfdQueue.shift();}while(dfd&&dfd.canceled&&this._dfdQueue.length);if(!dfd||dfd.canceled){this._currentDfd=null;return;}var _c48=dfd.ioArgs;var args=_c48.args;_c48._contentToClean=[];var fn=dojo.byId(args["form"]);var _c49=args["content"]||{};if(fn){if(_c49){var _c4a=function(name,_c4b){dojo.create("input",{type:"hidden",name:name,value:_c4b},fn);_c48._contentToClean.push(name);};for(var x in _c49){var val=_c49[x];if(dojo.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_c4a(x,val[i]);}}else{if(!fn[x]){_c4a(x,val);}else{fn[x].value=val;}}}}var _c4c=fn.getAttributeNode("action");var _c4d=fn.getAttributeNode("method");var _c4e=fn.getAttributeNode("target");if(args["url"]){_c48._originalAction=_c4c?_c4c.value:null;if(_c4c){_c4c.value=args.url;}else{fn.setAttribute("action",args.url);}}if(!_c4d||!_c4d.value){if(_c4d){_c4d.value=(args["method"])?args["method"]:"post";}else{fn.setAttribute("method",(args["method"])?args["method"]:"post");}}_c48._originalTarget=_c4e?_c4e.value:null;if(_c4e){_c4e.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;dojo._ioNotifyStart(dfd);fn.submit();}else{var _c4f=args.url+(args.url.indexOf("?")>-1?"&":"?")+_c48.query;dojo._ioNotifyStart(dfd);this.setSrc(this._frame,_c4f,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _c50=dfd.ioArgs;var args=_c50.args;var _c51=dojo.byId(args.form);if(_c51){var _c52=_c50._contentToClean;for(var i=0;i<_c52.length;i++){var key=_c52[i];for(var j=0;j<_c51.childNodes.length;j++){var _c53=_c51.childNodes[j];if(_c53.name==key){dojo.destroy(_c53);break;}}}if(_c50["_originalAction"]){_c51.setAttribute("action",_c50._originalAction);}if(_c50["_originalTarget"]){_c51.setAttribute("target",_c50._originalTarget);_c51.target=_c50._originalTarget;}}_c50._finished=true;}};}if(!dojo._hasResource["plugins.files.FileMenu"]){dojo._hasResource["plugins.files.FileMenu"]=true;dojo.provide("plugins.files.FileMenu");dojo.declare("plugins.files.FileMenu",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"filemenu\"\n    dojoType=\"plugins.menu.Menu\"\n    title=\"List of options for file-specific actions\"\n>\n\n    <div dojoType=\"dijit.MenuItem\"\n        label=\"File Menu\"\n        dojoAttachPoint=\"titleNode\"\n        class=\"title\"\n        disabled=\"false\"\n    >\n    </div>\n\n    <div\n        dojoAttachPoint=\"selectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:select\"\n        class=\"select\"\n        disabled=\"true\"\n    >\n        <U>S</U>elect\n    </div>\n    <div\n        dojoAttachPoint=\"addNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:add\"\n        class=\"add\"\n        disabled=\"true\"\n    >\n        <U>A</U>dd\n    </div>\n\n    <div\n        dojoAttachPoint=\"newFolderNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:newFolder\"\n        class=\"newFolder\"\n        >\n        <U>N</U>ew Folder\n    </div>\n\n    <div\n        dojoAttachPoint=\"renameNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:rename\"\n        class=\"rename\"\n        >\n        Rena<U>m</U>e\n\n    </div>\n\n<!--    <div dojoType=\"dijit.MenuSeparator\">\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"deleteNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:deleteFile\"\n        class=\"delete\"\n        >\n        De<U>l</U>ete\n    </div>\n\n<!--    <div dojoType=\"dijit.MenuSeparator\">\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"openWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:openWorkflow\"\n        class=\"openWorkflow\"\n        >        \n        <U>O</U>pen Workflow\n    </div>\n\n\n<!--    <div dojoType=\"dijit.MenuSeparator\">\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"uploadNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:upload\"\n        class=\"upload\"\n        style=\"height: 20px !important;\"\n        widgetsInTemplate=\"true\"\n        >\n\n        <U>U</U>pload file\n        <!--<div class=\"fileInputMask\"></div>-->\n        \n    </div>\n\n<!--    <div dojoType=\"dijit.MenuSeparator\">\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"downloadNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"download\"\n        dojoAttachEvent=\"onClick:download\"    \n        >\n        Do<U>w</U>nload file\n    </div>\n\n\n\n</div>\n",widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins","files/css/filemenu.css"),dojo.moduleUrl("dojox","form/resources/FileInput.css")],parentWidget:null,delay:6000,constructor:function(args){this.parentWidget=args.parentWidget;this.loadCSS();},postCreate:function(){this.setInputDialog();this.setInteractiveDialog();this.setConfirmDialog();this.setTitle("File Menu");this.setMenu();this.startup();},startup:function(){console.group("FileMenu    "+this.id+"    startup");this.inherited(arguments);this.setUploader();this.disableMenuItem("select");this.disableMenuItem("add");this.menu._started=false;this.menu.startup();dojo.connect(this.menu.domNode,"oncontextmenu",function(_c54){_c54.stopPropagation();});Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateWorkflows");console.groupEnd("FileMenu    "+this.id+"    startup");},updateProjects:function(args){this.parentWidget.updateProjects();},updateClusters:function(args){this.setClusterCombo();},select:function(_c55){var _c56=this.getPath();if(!_c56==null){return;}var _c57=this.menu.currentTarget.innerHTML;var _c58;if(_c57!=null&&_c56!=null){_c58=_c56+"/"+_c57;}else{if(_c56!=null){_c58=_c56;}else{if(_c57!=null){_c58=_c57;}}}var _c59=this.parameterWidget.core.parameters.application;_c59.value=_c58;this.parameterWidget.changeValue(this.parameterWidget.valueNode,this.parameterWidget.valueNode.innerHTML,_c58,this.type);var _c5a=true;this.parameterWidget.core.io.chainOutputs(_c59,true);var _c5b=this.parameterWidget.core.parameters.stageRow;var node=_c5b.domNode;node.application=_c5b.application;node.parentWidget=_c5b;this.parameterWidget.core.stages.loadParametersPane(node);this.hide();},add:function(){var _c5c=this.getPath();if(_c5c==null){return;}var _c5d=this.menu.currentTarget.innerHTML;var _c5e;if(_c5d!=null&&_c5c!=null){_c5e=_c5c+"/"+_c5d;}else{if(_c5c!=null){_c5e=_c5c;}else{if(_c5d!=null){_c5e=_c5d;}}}this.parameterWidget.addValue(this.parameterWidget.valueNode,this.parameterWidget.valueNode.innerHTML,_c5e,this.type);this.hide();},upload:function(_c5f){dojo.stopEvent(_c5f);var item=this.menu.currentTarget.item;var path=item.parentPath;if(!path){return;}this.uploader.setPath(path);this.uploader.show();var _c60=path.match("([^/]+)$")[1];var _c61=dijit.getEnclosingWidget(this.menu.currentTarget.offsetParent);this.callback=dojo.hitch(this,"reloadPane",_c61,_c60);},onComplete:function(){this.callback();},reloadPane:function(_c62,_c63){var _c64=_c62.parentWidget;var _c65=0;var _c66=_c62.items;for(var i=0;i<_c66.length;i++){if(_c66[i].name==_c63){_c65=i;break;}}var _c67={target:{item:_c66[_c65]}};_c64.store.putData.query=_c62.path;_c64.store.putData.mode="fileSystem";_c62.onclickHandler(_c67);},setUploader:function(){var _c68=dijit.getUniqueId("plugins.form.UploadDialog");var _c69=Agua.cookie("username");var _c6a=Agua.cookie("sessionId");this.uploader=new plugins.form.Uploader({uploaderId:_c68,username:_c69,sessionId:_c6a,url:Agua.cgiUrl+"upload.cgi"});dojo.connect(this.uploader,"onComplete",this,"onComplete");},setMenu:function(){this.disableRightClick();this.setShortKeys();this.menu.onCancel=function(_c6b){};},disableRightClick:function(){dojo.connect(this.menu.domNode,"contextmenu",function(_c6c){_c6c.preventDefault();_c6c.stopPropagation();return false;});},setShortKeys:function(){dojo.connect(this.menu,"onKeyPress",dojo.hitch(this,function(_c6d){var key=_c6d.charOrCode;if(this.altOn==true){switch(key){case "n":this.newFolder();break;case "m":this.rename();break;case "l":this.deleteFile();break;case "o":this.openWorkflow();break;case "u":this.upload();break;case "w":this.download();break;}}_c6d.stopPropagation();}));dojo.connect(this.menu,"onKeyDown",dojo.hitch(this,function(_c6e){var _c6f=_c6e.keyCode;if(_c6f==18){this.altOn=true;}}));dojo.connect(this.menu,"onKeyUp",dojo.hitch(this,function(_c70){var _c71=_c70.keyCode;if(_c71==18){this.altOn=false;}}));},openWorkflow:function(){dojo.addClass(this.menu.currentTarget,"dojoDndItemOver");var item=this.menu.currentTarget.item;if(!item.parentPath.match(/^([^\/]+)\/([^\/]+)/)){return;}var _c72=item.parentPath.match(/^([^\/]+)\/[^\/]+/)[1];var _c73=item.parentPath.match(/^[^\/]+\/([^\/]+)/)[1];var _c74=Agua.controllers["workflow"];if(_c74==null){return;}_c74.createTab({project:_c72,workflow:_c73});},rename:function(){var _c75=this.getUserName();var _c76=this.getDragPane();var _c77=this.menu.currentTarget;var item=this.menu.currentTarget.item;var path=item.path;var _c78=item.path;var _c79=item.parentPath;var _c7a=this.interactiveDialog;var _c7b="Rename file '"+_c78+"'";var _c7c="Please enter new name";var _c7d=function(){};var _c7e=dojo.hitch(this,function(_c7f){if(_c7f==null){return;}_c7f=_c7f.replace(/\s+/,"");if(_c7f==""){return;}if(_c76.inItems(_c7f)){Agua.toastMessage({message:"FileName '"+_c7f+"' already exists "});_c7a.dialog.duration=1500;_c7a.messageNode.innerHTML="Workflow already exists";return;}var _c80=_c79+"/"+_c7f;var _c81=_c79+"/"+path;Agua.renameFileTree(_c75,_c81,_c80);_c76.renameItem(_c77,_c7f);Agua.renameFile(_c81,_c80);});this.loadInputDialog(_c7b,_c7c,_c7e,_c7d);},newFolder:function(){var _c82=this.getUserName();var _c83=this.getDragPane();var _c84="New Folder";var _c85="Please enter folder name";var _c86=function(){};var _c87=dojo.hitch(this,function(_c88){if(_c88==null){return;}_c88=_c88.replace(/\s+/,"");if(_c88==""){return;}if(_c83.inItems(_c88)){return;}var _c89=_c83.path+"/"+_c88;_c83.addItem(_c88,"folder",_c82,_c89);var url=Agua.cgiUrl+"folders.cgi?";var _c8a=_c83.path+"/"+_c88;var _c8b=new Object;_c8b.mode="newFolder";_c8b.sessionId=Agua.cookie("sessionId");_c8b.username=Agua.cookie("username");_c8b.folderpath=_c8a;var _c8c=this;dojo.xhrPut({url:url,putData:dojo.toJson(_c8b),handleAs:"json",sync:false,handle:function(_c8d){if(_c8d.error){Agua.error(_c8d.error);}else{if(_c8d.status){Agua.warning(_c8d.status);var _c8e=_c8c.menu.currentTarget.parentNode;_c8e.removeChild(_c8c.menu.currentTarget);}}}});});this.loadInputDialog(_c84,_c85,_c87,_c86);},deleteFile:function(){console.log("FileMenu.deleteFile     plugins.files.Workflow.deleteFile(event)");if(this.menu.currentTarget==null){return;}var _c8f=this.menu.currentTarget.item.name;var _c90=this.menu.currentTarget.item.directory;var type="file";if(_c90==true){type="folder";}var _c91=dijit.getEnclosingWidget(this.menu.currentTarget);_c91.standby.show();var _c92=function(){_c91.standby.hide();};var _c93=dojo.hitch(this,function(){var item=this.menu.currentTarget.item;var file=item.parentPath+"/"+item.path;var url=Agua.cgiUrl+"folders.cgi?";var _c94=new Object;_c94.mode="removeFile";_c94.sessionId=Agua.cookie("sessionId");_c94.username=Agua.cookie("username");_c94.file=file;var _c95=this;dojo.xhrPut({url:url,putData:dojo.toJson(_c94),handleAs:"json",sync:false,handle:function(_c96){if(_c96.error){_c91.standby.hide();Agua.error(_c96.error);}else{if(_c96.status){_c95.pollDelete(_c94,_c91);}}}});});var _c97="Delete "+type+":<br>"+_c8f;var _c98="All its data will be destroyed";this.loadConfirmDialog(_c97,_c98,_c93,_c92);},delayedPollDelete:function(_c99,_c9a){var _c9b=this.delay;var _c9c=[{func:[this.showMessage,this,"FileMenu.delayedPollDelete"],pauseAfter:_c9b},{func:[this.pollDelete,this,_c99,_c9a]}];this.sequence.go(_c9c,function(){});},pollDelete:function(_c9d,_c9e){_c9d.modifier="status";var url=Agua.cgiUrl+"folders.cgi?";var _c9f=this;dojo.xhrPut({url:url,handleAs:"json-comment-optional",sync:false,putData:dojo.toJson(_c9d),handle:function(_ca0){if(_ca0.status=="completed"){_c9f.handleDelete(_c9d,_c9e,_ca0);}else{if(_ca0.error){_c9f.standby.hide();}else{_c9f.delayedPollDelete(_c9d,_c9e);}}}});},handleDelete:function(_ca1,_ca2,_ca3){_ca2.standby.hide();var _ca4=_ca1.file;var _ca5=_ca4.match(/^(.+?)\/[^\/]+$/)[1];Agua.setFileCache(_ca1.username,_ca4,null);Agua.setFileCache(_ca1.username,_ca5,null);var path=_ca2.path;var _ca5=path.match(/([^\/]+)$/)[1];var _ca6=_ca2.getPreviousPane();this.reloadPane(_ca6,_ca5);},download:function(){var item=this.menu.currentTarget.item;if(!item.parentPath.match(/^([^\/]+)\/([^\/]+)/)){return;}var _ca7=item.parentPath.match(/^([^\/]+)\/[^\/]+/)[1];var _ca8=item.parentPath.match(/^[^\/]+\/([^\/]+)/)[1];var _ca9=item.parentPath;if(item.path!=null&&item.path!=""){_ca9+="/"+item.path;}var url=item._S.url;var _caa;if(url.match(/owner=([^&]+)/)){_caa=url.match(/owner=([^&]+)/)[1];}var _cab="?mode=downloadFile";if(_caa!=null){_cab+="&username="+_caa;_cab+="&requestor="+Agua.cookie("username");}else{_cab+="&username="+Agua.cookie("username");}_cab+="&sessionId="+Agua.cookie("sessionId");_cab+="&filepath="+_ca9;var _cac=Agua.cgiUrl+"download.cgi";var args={method:"GET",url:_cac+_cab,handleAs:"json",timeout:10000,load:this.handleDownload};var _cad=dojo.io.iframe.send(args);},handleDownload:function(_cae,_caf){if(_cae.message=="ifd.getElementsByTagName(\"textarea\")[0] is undefined"){Agua.toastMessage({message:"Download failed: File is not present",type:"error"});}},openFileDownload:function(_cb0){var _cb1="?username="+Agua.cookie("username");_cb1+="&sessionId="+Agua.cookie("sessionId");_cb1+="&filepath="+_cb0;var url=Agua.cgiUrl+"download.cgi";var args={method:"GET",url:url+_cb1,handleAs:"html",timeout:10000};dojo.io.iframe.send(args);},setConfirmDialog:function(){var _cb2=function(){};var _cb3=function(){};var _cb4="Dialog title";var _cb5="Dialog message";this.confirmDialog=new plugins.dijit.ConfirmDialog({title:_cb4,message:_cb5,parentWidget:this,yesCallback:_cb2,noCallback:_cb3});},loadConfirmDialog:function(_cb6,_cb7,_cb8,_cb9){this.confirmDialog.load({title:_cb6,message:_cb7,yesCallback:_cb8,noCallback:_cb9});},setInputDialog:function(){var _cba=function(){};var _cbb=function(){};var _cbc="";var _cbd="";this.inputDialog=new plugins.dijit.InputDialog({title:_cbc,message:_cbd,inputMessage:"",parentWidget:this,enterCallback:_cba,cancelCallback:_cbb});},loadInputDialog:function(_cbe,_cbf,_cc0,_cc1){this.inputDialog.load({title:_cbe,message:_cbf,enterCallback:_cc0,cancelCallback:_cc1});},setInteractiveDialog:function(){var _cc2=function(){};var _cc3=function(){};var _cc4="";var _cc5="";this.interactiveDialog=new plugins.dijit.InteractiveDialog({title:_cc4,message:_cc5,inputMessage:"",parentWidget:this,enterCallback:_cc2,cancelCallback:_cc3});},loadInteractiveDialog:function(_cc6,_cc7,_cc8,_cc9,_cca){this.interactiveDialog.load({title:_cc6,message:_cc7,checkboxMessage:_cca,enterCallback:_cc8,cancelCallback:_cc9});},bind:function(node){if(node==null){return this.menu.bindDomNode(node);}},getPath:function(){var _ccb=dijit.getEnclosingWidget(this.menu.currentTarget);if(_ccb==null||!_ccb){return;}return _ccb.path;},hide:function(){this.parentWidget.hide();},setTitle:function(_ccc){this.titleNode.containerNode.innerHTML=_ccc;},show:function(){dojo.addClass(this.menu.currentTarget,"dojoDndItemOver");dojo.style(this.containerNode,{opacity:1,overflow:"visible"});},disableMenuItem:function(name){if(this[name+"Node"]){this[name+"Node"].disabled=true;}var item=this[name+"Node"];dojo.addClass(item.domNode,"dijitMenuItemDisabled");},enableMenuItem:function(name){if(this[name+"Node"]){this[name+"Node"].disabled=false;}var item=this[name+"Node"];dojo.removeClass(item.domNode,"dijitMenuItemDisabled");},disable:function(){this.menu.enabled=false;},enable:function(){this.menu.enabled=true;},setShortKeys:function(){dojo.connect(this.menu,"onKeyPress",dojo.hitch(this,function(_ccd){var key=_ccd.charOrCode;if(this.altOn==true){switch(key){case "s":this.select();break;case "a":this.add();break;case "n":this.newFolder();break;case "m":this.rename();break;case "l":this.deleteFile();break;case "o":this.openWorkflow();break;case "u":this.upload();break;case "w":this.download();break;case "r":this.refresh();break;}}_ccd.stopPropagation();}));dojo.connect(this.menu,"onKeyDown",dojo.hitch(this,function(_cce){var _ccf=_cce.keyCode;if(_ccf==18){this.altOn=true;}}));dojo.connect(this.menu,"onKeyUp",dojo.hitch(this,function(_cd0){var _cd1=_cd0.keyCode;if(_cd1==18){this.altOn=false;}}));},refresh:function(_cd2){},getFilesWidget:function(){if(this.menu.currentTarget==null){return null;}var item=this.menu.currentTarget.item;var _cd3=dijit.getEnclosingWidget(this.menu.currentTarget);var _cd4=_cd3.parentWidget.parentWidget;return _cd4;},getProjectName:function(){if(this.menu.currentTarget==null){return null;}var item=this.menu.currentTarget.item;var _cd5=dijit.getEnclosingWidget(this.menu.currentTarget);var _cd6=_cd5.path;return _cd6;},getStandby:function(){if(this.standby){return this.standby;}var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({onClick:"reload",text:"",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);return this.standby;},getFileDrag:function(){var _cd7=this.getDragPane();return _cd7.parentWidget;},getDragPane:function(){return dijit.getEnclosingWidget(this.menu.currentTarget);},getUserName:function(){var _cd8=this.getFileDrag();return _cd8.owner;},selectTarget:function(args){var _cd9=this.getDragPane();_cd9._dragSource._addItemClass(this.menu.currentTarget,"Selected");},deselectTarget:function(args){var _cda=this.getDragPane();_cda._dragSource._removeItemClass(this.menu.currentTarget,"Selected");}});}if(!dojo._hasResource["plugins.files.FolderMenu"]){dojo._hasResource["plugins.files.FolderMenu"]=true;dojo.provide("plugins.files.FolderMenu");dojo.declare("plugins.files.FolderMenu",[plugins.files.FileMenu],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"filemenu\"\n    dojoType=\"plugins.menu.Menu\"\n    title=\"List of options for folder-specific actions\"\n>\n\n    <div dojoType=\"dijit.MenuItem\"\n        label=\"Folder Menu\"\n        dojoAttachPoint=\"titleNode\"\n        class=\"title\"\n        disabled=\"false\"\n    >\n    </div>\n\n\n    <div\n        dojoAttachPoint=\"refreshNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"refresh\"\n        dojoAttachEvent=\"onClick:refresh\"    \n        >\n        <U>R</U>efresh\n    </div>\n\n    <div\n        dojoAttachPoint=\"selectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:select\"\n        class=\"select\"\n        disabled=\"true\"\n    >\n        <U>S</U>elect\n    </div>\n    <div\n        dojoAttachPoint=\"addNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:add\"\n        class=\"add\"\n        disabled=\"true\"\n    >\n        <U>A</U>dd\n    </div>\n\n    <div\n        dojoAttachPoint=\"newFolderNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:newFolder\"\n        class=\"newFolder\"\n        >\n        <U>N</U>ew Folder\n    </div>\n\n    <div\n        dojoAttachPoint=\"renameNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:rename\"\n        class=\"rename\"\n        >\n        Rena<U>m</U>e\n\n    </div>\n\n    <div\n        dojoAttachPoint=\"deleteNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:deleteFile\"\n        class=\"delete\"\n        >\n        De<U>l</U>ete\n    </div>\n\n    <div\n        dojoAttachPoint=\"openWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:openWorkflow\"\n        class=\"openWorkflow\"\n        >        \n        <U>O</U>pen Workflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"uploadNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:upload\"\n        class=\"upload\"\n        style=\"height: 20px !important;\"\n        widgetsInTemplate=\"true\"\n        >\n        <U>U</U>pload file\n    </div>\n\n\n</div>\n",constructor:function(args){this.loadCSS();},postCreate:function(){this.setTitle("Folder Menu");this.setInputDialog();this.setConfirmDialog();this.setMenu();this.setUploader();this.startup();},refresh:function(_cdb){var _cdc=this.menu.currentTarget.innerHTML;var _cdd=dijit.getEnclosingWidget(this.menu.currentTarget.offsetParent);var _cde=_cdd.path+"/"+_cdc;var _cdf=_cdd.parentWidget;var _ce0=_cdf.owner;_cdf.store.putData.mode="fileSystem";Agua.setFileCache(_ce0,_cde,null);this.reloadPane(_cdd,_cdc);}});}if(!dojo._hasResource["plugins.dijit.SelectiveDialog"]){dojo._hasResource["plugins.dijit.SelectiveDialog"]=true;dojo.provide("plugins.dijit.SelectiveDialog");dojo.declare("plugins.dijit.SelectiveDialog",[plugins.dijit.InteractiveDialog],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\"\n        height=\"300px\" width=\"100%\" style=\"padding: 0; margin: 0;\"\n        class=\"selectiveDialog\">\n        <tr>\n            <td align=\"center\">\n                \n<div\n    dojoAttachPoint=\"dialog\"\n    dojoType=\"dijit.Dialog\"\n    closeText=\"false\"\n    class=\"title\"\n    title=\"${title}\"\n    style=\"margin-right: auto; margin-left: auto; text-align: center;\"\n    >\n\n    <table\n        cellpadding=\"0\"\n        cellspacing=\"0\"\n        class=\"selectiveDialog\"\n        width=\"100%\"\n        >\n\n        <tr class=\"message\" align=\"center\">\n            <td\n                align=\"center\"\n                dojoAttachPoint=\"messageNode\"\n                colspan=\"2\">${message}</td>\n        </tr>\n\n        <tr width=\"100%\">\n            <td\n                width=\"100%\"\n                align=\"right\"\n                class=\"leftColumn\"\n                dojoAttachPoint=\"comboMessageNode\">\n            </td>\n            <td align=\"center\" width=\"100%\">\n                <select\n                    dojoAttachPoint=\"combo\"\n                    class=\"combo\"\n                    autocomplete=\"false\"\n                >\n                </select>\n            </td>\n        </tr>\n        \n        <tr align=\"center\" dojoAttachPoint=\"inputContainer\">\n            <td class=\"leftColumn\"\n                dojoAttachPoint=\"inputMessageNode\">\n            </td>\n            <td class=\"input\" align=\"center\">\n                <input\n                    type=\"text\"\n                    class=\"inputNode\"\n                    dojoAttachPoint=\"inputNode\"\n                value=\"\"></input>\n            </td>\n        </tr>\n        \n\n         <tr\n            dojoAttachPoint=\"checkboxContainer\"\n            class=\"hidden\">\n\n            <td colspan=\"2\">\n                <table>\n                    <tr>\n                        <td class=\"leftColumn\"\n                            dojoAttachPoint=\"checkboxMessageNode\"\n                            style=\"visibility: visible\">\n                        </td>\n                        <td class=\"rightColumn\">\n                            <input\n                                dojoAttachPoint=\"checkbox\"  \n                                style=\"visibility: visible\"\n                                type=\"checkbox\"\n                                class=\"checkbox\"\n                        >\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n\n         <tr>\n            <td align=\"center\" class=\"enterButton\">\n                <button\n                    dojoAttachPoint=\"enterButton\"\n                    dojoType=\"dijit.form.Button\"\n                    type=\"button\"\n                    label=\"Enter\"\n                    dojoAttachEvent=\"onClick:doEnter\"\n                    >\n                </button>\n            </td>\n\n            <td align=\"center\" class=\"cancelButton\">\n                <div\n                    dojoAttachPoint=\"cancelButton\"\n                    dojoType=\"dijit.form.Button\"\n                    type=\"button\"\n                    label=\"Cancel\"\n                    dojoAttachEvent=\"onClick:doCancel\"\n                    >\n                </div>\n            </td>\n        </tr>\n    </table>\n</div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins.dijit")+"/css/selectivedialog.css"],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.showComboMessage(this.comboMessage);this.setDialogue();this.setListeners();this.setNamespaceClass("selectiveDialog");},setListeners:function(){var _ce1=this;dojo.connect(this.combo,"onkeypress",function(_ce2){var key=_ce2.charOrCode;console.log("SelectiveDialog.set    this.combo onKeyPress FIRED");_ce2.stopPropagation();if(key==13){_ce1.doEnter();}if(key==dojo.keys.ESCAPE){_ce1.doCancel();}});},setCombo:function(){while(this.combo.length){this.combo.options[this.combo.length-1]=null;}for(var i=0;i<this.comboValues.length;i++){var _ce3=document.createElement("OPTION");_ce3.text=this.comboValues[i];_ce3.value=this.comboValues[i];this.combo.options.add(_ce3);}},showComboMessage:function(_ce4){if(_ce4==null){dojo.attr(this.combo.parentNode,"colspan",2);dojo.destroy(this.comboMessageNode);}},load:function(args){this.title=args.title||"";this.message=args.message;this.comboValues=args.comboValues;this.parentWidget=args.parentWidget;this.enterCallback=args.enterCallback;this.cancelCallback=args.cancelCallback;this.dialog.titleNode.innerHTML=args.title;this.messageNode.innerHTML=args.message;this.inputMessageNode.innerHTML=args.inputMessage||"";this.comboMessageNode.innerHTML=args.comboMessage||"";this.checkboxMessageNode.innerHTML=args.checkboxMessage||"";this.dialog.enterCallback=args.enterCallback;this.dialog.cancelCallback=args.cancelCallback;this.showCheckbox(args.checkboxMessage);this.setEnterLabel(args.enterLabel);this.setCancelLabel(args.cancelLabel);this.setCombo();this.show();},doEnter:function(type){var _ce5="";if(this.inputNode!=null){_ce5=this.inputNode.value;}var _ce6;if(this.checkbox.checked==true){_ce6=1;}else{_ce6=0;}var _ce7=this.combo.value;this.dialog.enterCallback(_ce5,_ce7,_ce6,this);}});}if(!dojo._hasResource["plugins.files.WorkflowMenu"]){dojo._hasResource["plugins.files.WorkflowMenu"]=true;dojo.provide("plugins.files.WorkflowMenu");dojo.declare("plugins.files.WorkflowMenu",[plugins.files.FileMenu],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"workflowmenu\"\n    dojoType=\"plugins.menu.Menu\">\n\n    <div dojoType=\"dijit.MenuItem\"\n        label=\"Workflow Menu\"\n        dojoAttachPoint=\"titleNode\"\n        class=\"title\"\n        disabled=\"false\">\n    </div>\n\n    <div\n        dojoAttachPoint=\"refreshNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"refresh\"\n        dojoAttachEvent=\"onClick:refresh\"    \n        >\n        <U>R</U>efresh\n    </div>\n\n\n    <div\n        dojoAttachPoint=\"selectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:select\"\n        class=\"select\"\n        >\n        <U>S</U>elect\n    </div>\n    <div\n        dojoAttachPoint=\"addNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:add\"\n        class=\"add\"\n        >\n        <U>A</U>dd\n    </div>\n\n    <div\n        dojoAttachPoint=\"newProjectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:newProject\"\n        class=\"newProject\"\n        >\n        New <U>P</U>roject\n    </div>\n\n    <div\n        dojoAttachPoint=\"newWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:newWorkflow\"\n        class=\"newWorkflow\"\n        >\n        New <U>W</U>orkflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"copyWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:copyWorkflow\"\n        class=\"copyWorkflow\"\n        disabled=\"false\"\n        >\n        <U>C</U>opy Workflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"renameWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"renameWorkflow\"\n        dojoAttachEvent=\"onClick:renameWorkflow\"    \n        >\n        <U>R</U>ename Workflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"openWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:openWorkflow\"\n        class=\"openWorkflow\"\n        >\n        <U>O</U>pen Workflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"deleteProjectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:deleteProject\"\n        class=\"deleteProject\"\n        >\n        <U>D</U>elete Project\n    </div>\n\n    <div\n        dojoAttachPoint=\"deleteWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:deleteWorkflow\"\n        class=\"deleteWorkflow\"\n        >\n        De<U>l</U>ete Workflow\n    </div>\n\n\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","files/css/workflowmenu.css")],constructor:function(){this.loadCSS();},postCreate:function(){this.setInputDialog();this.setInteractiveDialog();this.setConfirmDialog();this.setTitle("Workflow Menu");this.setMenu();this.startup();},startup:function(){this.inherited(arguments);this.setMenu();this.disableMenuItem("select");this.disableMenuItem("add");dojo.connect(this.menu,"_openMyself",this,"selectTarget");dojo.connect(this.menu,"_markInactive",this,"deselectTarget");this.setSelectiveDialog();Agua.updater.subscribe(this,"updateProjects");},updateProjects:function(args){},setTitle:function(_ce8){},setShortKeys:function(){dojo.connect(this.menu,"onKeyPress",dojo.hitch(this,function(_ce9){var key=_ce9.charOrCode;if(this.altOn==true){switch(key){case "s":this.select();break;case "a":this.add();break;case "p":this.newProject();break;case "w":this.newWorkflow();break;case "r":this.renameWorkflow();break;case "d":this.deleteProject();break;case "l":this.deleteWorkflow();break;case "o":this.openWorkflow();break;case "c":this.copyWorkflow();break;}}_ce9.stopPropagation();}));dojo.connect(this.menu,"onKeyDown",dojo.hitch(this,function(_cea){var _ceb=_cea.keyCode;if(_ceb==18){this.altOn=true;}}));dojo.connect(this.menu,"onKeyUp",dojo.hitch(this,function(_cec){var _ced=_cec.keyCode;if(_ced==18){this.altOn=false;}}));},newProject:function(){var _cee=this.getUserName();var _cef=this.interactiveDialog;var _cf0=this.getFilesWidget();var _cf1=function(){};var _cf2=dojo.hitch(this,function(_cf3){if(_cf3==null){return;}if(_cf3==""){return;}_cf3=_cf3.replace(/\s+/g,"");var _cf4=new Object;_cf4.name=_cf3;if(Agua.isProject(_cf3)==true){_cef.messageNode.innerHTML="Project already exists";return;}var _cf5={username:_cee,owner:_cee,name:_cf3,title:_cf3};_cf0.addChild(_cf5);Agua.addProject(_cf4);});var _cf6="New Project";var _cf7="Please enter project name";this.loadInputDialog(_cf6,_cf7,_cf2,_cf1);},newWorkflow:function(){var _cf8=this.getProjectName();var _cf9=this.interactiveDialog;var _cfa=this.getUserName();var _cfb=this.getDragPane();var _cfc="New Workflow";var _cfd="Please enter workflow name";var _cfe=function(){};var _cff=dojo.hitch(this,function(_d00,_d01){_d00=_d00.replace(/\s+/,"");if(!_d00){return;}if(Agua.isWorkflow({project:_cf8,name:_d00})==true){_cf9.messageNode.innerHTML="Workflow already exists";return;}else{_cf9.messageNode.innerHTML="Creating workflow";_cf9.close();}var _d02=_cfb.path+"/"+_d00;Agua.addWorkflow({project:_cf8,name:_d00});_cfb.addItem(_d00,"workflow",_cfa,_d02);});this.loadInteractiveDialog(_cfc,_cfd,_cff,_cfe);},copyWorkflow:function(){var item=this.menu.currentTarget.item;var _d03=item.parentPath;var _d04=item.path;var _d05=function(){};var _d06=this;var _d07=dojo.hitch(this,function(_d08,_d09,_d0a,_d0b){var _d0c="Copy";var _d0d="Cancel";if(_d09==null||_d09==""){return;}_d09=_d09.replace(/\s+/,"");if(_d09==null||_d09==""){_d0b.messageNode.innerHTML="Please input name of new Workflow";return;}if(Agua.isWorkflow({project:_d08,name:_d09})==true){_d0b.messageNode.innerHTML="/"+_d09+"' already exists in '"+_d08+"'";return;}else{_d0b.messageNode.innerHTML="Creating workflow";_d0b.close();}_d06._copyWorkflow(_d03,_d04,_d09,_d08,_d0a);});this.selectiveDialog.load({title:"Copy Workflow",message:"Source: '"+_d03+":"+_d04+"'",comboValues:Agua.getProjectNames(),inputMessage:"Workflow name",comboMessage:"Project",checkboxMessage:"Copy files",parentWidget:this,enterCallback:_d07,cancelCallback:_d05,enterLabel:"Copy",cancelLabel:"Cancel"});},_copyWorkflow:function(_d0e,_d0f,_d10,_d11,_d12){var _d13=Agua.cookie("username");Agua.copyWorkflow(_d13,_d0e,_d0f,_d13,_d10,_d11,_d12);},renameWorkflow:function(){var _d14=this.getFilesWidget();if(_d14==null){return;}var _d15=this.getDragPane();var _d16=this.getUserName();var _d17=this.menu.currentTarget;var _d18=this.getProjectName();var _d19=this.getWorkflowName();var _d1a=this.getWorkflowNumber();var _d1b=new Object;_d1b.project=_d18;_d1b.name=_d19;_d1b.number=_d1a;var _d1c="Rename workflow '"+_d19+"'";var _d1d="Please enter new name";var _d1e=function(){};var _d1f=dojo.hitch(this,function(_d20){if(_d20==null){return;}_d20=_d20.replace(/\s+/,"");if(_d20==""){return;}if(Agua.isWorkflow({project:_d18,name:_d20})){return;}var _d21=_d18+"/"+_d19;var _d22=_d18+"/"+_d20;Agua.renameFileTree(_d16,_d21,_d22);_d15.renameItem(_d17,_d20);Agua.renameWorkflow(_d1b,_d20);Agua.updater.update("updateProjects",{originator:this.parentWidget,reload:false});});this.loadInputDialog(_d1c,_d1d,_d1f,_d1e);},openWorkflow:function(){dojo.addClass(this.menu.currentTarget,"dojoDndItemOver");var _d23=this.getFilesWidget();if(_d23==null){return;}var _d24=this.getProjectName();var _d25=this.getWorkflowName();var _d26=Agua.controllers["workflow"];if(Agua.controllers["workflow"]){Agua.controllers["workflow"].createTab({project:_d24,workflow:_d25});}},deleteWorkflow:function(){var _d27=this.getProjectName();var _d28=this.getWorkflowName();var _d29=this.getWorkflowNumber();var _d2a=new Object;_d2a.project=_d27;_d2a.name=_d28;_d2a.number=_d29;var _d2b=function(){};var _d2c=dojo.hitch(this,function(){if(Agua.isWorkflow({project:_d27,name:_d28})==false){return;}var _d2d=this.menu.currentTarget;this.removeItemFileCache(_d2d);var _d2e=dijit.getEnclosingWidget(this.menu.currentTarget);_d2e.deleteItem(_d2d);Agua.removeWorkflow(_d2a);});var _d2f="Delete workflow '"+_d28+"'?";var _d30="All files and data will be destroyed";this.loadConfirmDialog(_d2f,_d30,_d2c,_d2b);},removeItemFileCache:function(_d31){var _d32=_d31.item.parentPath+"/"+_d31.item.path;var _d33=this.getUserName();Agua.removeFileTree(_d33,_d32);},deleteProject:function(){var _d34=this.getFilesWidget();var _d35=this.getFileDrag();if(_d34==null){return;}var _d36=this.getProjectName();var _d37=function(){};var _d38=dojo.hitch(this,function(){if(!Agua.isProject(_d36)){return;}Agua.removeProject({name:_d36});setTimeout(function(_d39){_d34.removeChild(_d35);},1000,this);});var _d3a="Delete project '"+_d36+"'?";var _d3b="All workflows and data will be destroyed";this.loadConfirmDialog(_d3a,_d3b,_d38,_d37);},refresh:function(_d3c){var _d3d=this.menu.currentTarget.innerHTML;var _d3e=dijit.getEnclosingWidget(this.menu.currentTarget.offsetParent);var _d3f=_d3e.path+"/"+_d3d;var _d40=_d3e.parentWidget;var _d41=_d40.owner;_d40.store.putData.mode="fileSystem";Agua.setFileCache(_d41,_d3f,null);this.reloadPane(_d3e,_d3d);},getWorkflowName:function(){var item=this.menu.currentTarget.item;var _d42=item.path;_d42=_d42.replace(/\s+/g,"");return _d42;},getWorkflowNumber:function(){var _d43=this.menu.currentTarget.item.path;var _d44=this.getDragPane();for(var i=0;i<_d44.items.length;i++){if(_d44.items[i].name==_d43){return (i+1);}}return null;},setSelectiveDialog:function(){var _d45=function(){};var _d46=function(){};var _d47="";var _d48="";this.selectiveDialog=new plugins.dijit.SelectiveDialog({title:_d47,message:_d48,inputMessage:"",checkboxMessage:"",parentWidget:this,enterCallback:_d45,cancelCallback:_d46});},loadSelectiveDialog:function(_d49,_d4a,_d4b,_d4c,_d4d,_d4e,_d4f,_d50){this.selectiveDialog.load({title:_d49,message:_d4a,comboValues:_d4b,inputMessage:_d4c,comboMessage:_d4d,checkboxMessage:_d4e,parentWidget:this,enterCallback:_d4f,cancelCallback:_d50});},getStandby:function(){if(this.standby){return this.standby;}var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({onClick:"reload",text:"",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);return this.standby;},getFileDrag:function(){var _d51=this.getDragPane();return _d51.parentWidget;},getDragPane:function(){return dijit.getEnclosingWidget(this.menu.currentTarget);},getUserName:function(){var _d52=this.getFileDrag();return _d52.owner;},selectTarget:function(args){var _d53=this.getDragPane();_d53._dragSource._addItemClass(this.menu.currentTarget,"Selected");},deselectTarget:function(args){var _d54=this.getDragPane();_d54._dragSource._removeItemClass(this.menu.currentTarget,"Selected");}});}if(!dojo._hasResource["plugins.dojox.data.FileStore"]){dojo._hasResource["plugins.dojox.data.FileStore"]=true;dojo.provide("plugins.dojox.data.FileStore");dojo.declare("plugins.dojox.data.FileStore",[dojox.data.FileStore],{path:"",putData:null,constructor:function(args){this.inherited(arguments);if(!args){return;}this.core=args.core;this.path=args.path;this.putData=args.putData;this.parentPath=args.parentPath;this.processResultCallback=dojo.hitch(this,"_processResult");},_assertIsItem:function(item){if(!this.isItem(item)){}},_assertIsAttribute:function(_d55){if(typeof _d55!=="string"){throw new Error("dojox.data.FileStore: a function was passed an attribute argument that was not an attribute name string");}},loadItem:function(_d56){var item=_d56.item;var self=this;var _d57=_d56.scope||dojo.global;var _d58={};if(this.options.length>0){_d58.options=dojo.toJson(this.options);}if(this.pathAsQueryParam){_d58.path=item.parentPath+this.pathSeparator+item.name;}var _d59={url:this.pathAsQueryParam?this.url:this.url+"/"+item.parentPath+"/"+item.name,handleAs:"json-comment-optional",content:_d58,preventCache:this.urlPreventCache,failOk:this.failOk};var _d5a=dojo.xhrGet(_d59);_d5a.addErrback(function(_d5b){if(_d56.onError){_d56.onError.call(_d57,_d5b);}});_d5a.addCallback(function(data){delete item.parentPath;delete item._loaded;dojo.mixin(item,data);self._processItem(item);if(_d56.onItem){_d56.onItem.call(_d57,item);}});},isItem:function(item){if(item&&item[this._storeRef]===this){return true;}return false;},close:function(_d5c){},fetch:function(_d5d){_d5d=_d5d||{};if(!_d5d.store){_d5d.store=this;}var self=this;var _d5e=_d5d.scope||dojo.global;var _d5f={};if(_d5d.query){_d5f.query=_d5d.query;}var _d60=this.putData;if(_d5d.query){_d60.query=_d5d.query;}var _d61=this.processResultCallback;Agua.getFileSystem(_d60,_d61,_d5d);},fetchItemByIdentity:function(_d62){var path=_d62.identity;var self=this;var _d63=_d62.scope||dojo.global;var _d64={};if(this.options.length>0){_d64.options=dojo.toJson(this.options);}if(this.pathAsQueryParam){_d64.path=path;}var _d65={url:this.pathAsQueryParam?this.url:this.url+"/"+path,handleAs:"json-comment-optional",content:_d64,preventCache:this.urlPreventCache,failOk:this.failOk};var _d66=dojo.xhrGet(_d65);_d66.addErrback(function(_d67){if(_d62.onError){_d62.onError.call(_d63,_d67);}});_d66.addCallback(function(data){var item=self._processItem(data);if(_d62.onItem){_d62.onItem.call(_d63,item);}});},_processResult:function(data,_d68){if(!_d68){return;}var _d69=_d68.scope||dojo.global;try{if(data.pathSeparator){this.pathSeparator=data.pathSeparator;}if(_d68.onBegin){_d68.onBegin.call(_d69,data.total,_d68);}var _d6a=this._processItemArray(data.items);if(_d68.onItem){var i;for(i=0;i<_d6a.length;i++){_d68.onItem.call(_d69,_d6a[i],_d68);}_d6a=null;}if(_d68.onComplete){_d68.onComplete.call(_d69,_d6a,_d68);}}catch(e){if(_d68.onError){_d68.onError.call(_d69,e,_d68);}else{}}},_processItemArray:function(_d6b){if(!_d6b){return [];}var i;for(i=0;i<_d6b.length;i++){this._processItem(_d6b[i]);}return _d6b;},_processItem:function(item){if(!item){return null;}item[this._storeRef]=this;if(item.children&&item.directory){if(dojo.isArray(item.children)){var _d6c=item.children;var i;for(i=0;i<_d6c.length;i++){var name=_d6c[i];if(dojo.isObject(name)){_d6c[i]=this._processItem(name);}else{_d6c[i]={name:name,_loaded:false,parentPath:item.path};_d6c[i][this._storeRef]=this;}}}else{delete item.children;}}return item;}});}if(!dojo._hasResource["plugins.dijit.layout.BorderContainer"]){dojo._hasResource["plugins.dijit.layout.BorderContainer"]=true;dojo.provide("plugins.dijit.layout.BorderContainer");dojo.declare("plugins.dijit.layout.BorderContainer",[dijit.layout.BorderContainer],{layout:function(_d6d,_d6e,type){for(var _d6f in this._splitters){this._computeSplitterThickness(_d6f);}this._layoutChildren(_d6d,_d6e,type);},_layoutChildren:function(_d70,_d71,type){if(_d71!=null){if(type=="hide"){if(/left|right|center/.test(_d70)&&_d71.minWidth){dojo.style(_d71,"width",_d71.minWidth+"px");dojo.marginBox(_d71).w=_d71.minWidth;_d71.style.width=_d71.minWidth+"px";}else{if(/top|bottom/.test(_d70)&&_d71.minHeight){_d71.style.height=_d71.minHeight+"px";}}}else{if(type=="show"){if(/left|right|center/.test(_d70)&&_d71.width){_d71.style.width=_d71.width+"px";}else{if(/top|bottom/.test(_d70)&&_d71.height){dojo.style(_d71,"width",_d71.width+"px");dojo.marginBox(_d71).w=_d71.width;}}}}}var _d72=(this.design=="sidebar");var _d73=0,_d74=0,_d75=0,_d76=0,_d77=0;var _d78={},_d79={},_d7a={},_d7b={},_d7c=(this._center&&this._center.style)||{};var _d7d=/left|right|center/.test(_d70);var _d7e=!_d70||(!_d7d&&!_d72);var _d7f=!_d70||(_d7d&&_d72);_d7e=!_d70;if(this._top){_d78=_d7f&&this._top.style;_d73=dojo.marginBox(this._top).h;}if(this._left){_d79=_d7e&&this._left.style;_d75=dojo.marginBox(this._left).w;}if(this._center){_d76=dojo.marginBox(this._center).w;}if(this._right){_d7a=_d7e&&this._right.style;_d77=dojo.marginBox(this._right).w;}if(this._bottom){_d7b=_d7f&&this._bottom.style;_d74=dojo.marginBox(this._bottom).h;}if(_d7c){}var _d80=this._splitters;var _d81=_d80.top,_d82=_d80.bottom,_d83=_d80.left,_d84=_d80.right,_d85=_d80.center;var _d86=this._splitterThickness;var _d87=_d86.top||0,_d88=_d86.left||0,_d89=_d86.right||0,_d8a=_d86.bottom||0,_d8b=_d86.center||0;if(_d88>50||_d89>50){setTimeout(dojo.hitch(this,function(){this._splitterThickness={};for(var _d8c in this._splitters){this._computeSplitterThickness(_d8c);}this._layoutChildren();}),50);return false;}var pe=this.pe;var _d8d=this._borderBox.w-pe.l-pe.r;var _d8e;if(_d71!=null){if(this._center==_d71.domNode){_d8e=_d76;_d77=_d8d-(_d75+_d88+_d76+_d8b);if(type=="hide"){dojo.removeClass(this._right,"dojoxExpandoClosed");dojo.style(dijit.byNode(this._right).cwrapper,"visibility","visible");dojo.style(dijit.byNode(this._right).cwrapper,"opacity","1");dijit.byNode(this._right)._showing=true;}if(dojo.hasClass(this._left,"dojoxExpandoClosed")){_d75=_d75-2;}}else{if(this._right==_d71.domNode){_d8e=_d8d-(_d75+_d88+_d77+_d89);if(type=="hide"){dojo.removeClass(this._center,"dojoxExpandoClosed");dojo.style(dijit.byNode(this._center).cwrapper,"visibility","visible");dojo.style(dijit.byNode(this._center).cwrapper,"opacity","1");dijit.byNode(this._center)._showing=true;}if(dojo.hasClass(this._left,"dojoxExpandoClosed")){_d75=_d75-2;}}else{if(dojo.hasClass(this._right,"dojoxExpandoClosed")){_d8e=_d8d-(_d75+_d88+_d77+_d89);_d77=_d77-2;}else{_d8e=_d76;_d77=_d8d-(_d75+_d88+_d76+_d8b);}}}}else{_d8e=_d8d-(_d75+_d88+_d77+_d89);}if(_d7c){}var _d8f=_d72?_d8e:_d8d;var dim={top:{w:_d8f,h:_d73},bottom:{w:_d8f,h:_d74},left:{w:_d75,h:_d90},right:{w:_d77,h:_d90},center:{h:_d91,w:_d8e}};var _d92={left:(_d72?_d75+_d88:0)+pe.l+"px",center:(_d72?_d76+_d8b:0)+pe.l+"px",right:(_d72?_d77+_d89:0)+pe.r+"px"};if(_d81){dojo.mixin(_d81.style,_d92);_d81.style.top=_d73+pe.t+"px";}if(_d82){dojo.mixin(_d82.style,_d92);_d82.style.bottom=_d74+pe.b+"px";}_d92={top:(_d72?0:_d73+_d87)+pe.t+"px",bottom:(_d72?0:_d74+_d8a)+pe.b+"px"};if(_d83){dojo.mixin(_d83.style,_d92);_d83.style.left=_d75+pe.l+"px";}if(_d85){dojo.mixin(_d85.style,_d92);_d85.style.center=_d76+pe.r+"px";}if(_d84){dojo.mixin(_d84.style,_d92);_d84.style.right=_d77+pe.r+"px";}dojo.mixin(_d7c,{top:pe.t+_d73+_d87+"px",left:pe.l+_d75+_d88+"px",center:pe.l+_d76+_d8b+"px",right:pe.r+_d77+_d89+"px",bottom:pe.b+_d74+_d8a+"px"});var _d93={top:_d72?pe.t+"px":_d7c.top,bottom:_d72?pe.b+"px":_d7c.bottom};dojo.mixin(_d79,_d93);dojo.mixin(_d7a,_d93);_d79.left=pe.l+"px";_d7a.right=pe.r+"px";_d78.top=pe.t+"px";_d7b.bottom=pe.b+"px";if(_d72){_d78.left=_d7b.left=_d75+_d88+pe.l+"px";_d78.right=_d7b.right=_d77+_d89+pe.r+"px";}else{_d78.left=_d7b.left=pe.l+"px";_d78.right=_d7b.right=pe.r+"px";}var _d94=this._borderBox.h-pe.t-pe.b;var _d91=_d94-(_d73+_d87+_d74+_d8a);var _d90=_d72?_d94:_d91;var _d95=dojo.isIE||dojo.some(this.getChildren(),function(_d96){return _d96.domNode.tagName=="TEXTAREA"||_d96.domNode.tagName=="INPUT";});if(_d95){var _d97=function(_d98,_d99,_d9a){if(_d98){(_d98.resize?_d98.resize(_d99,_d9a):dojo.marginBox(_d98.domNode,_d99));}};if(_d83){_d83.style.height=_d90;}if(_d84){_d84.style.height=_d90;}_d97(this._leftWidget,{h:_d90},dim.left);_d97(this._rightWidget,{h:_d90},dim.right);if(_d81){_d81.style.width=_d8f;}if(_d82){_d82.style.width=_d8f;}_d97(this._topWidget,{w:_d8f},dim.top);_d97(this._bottomWidget,{w:_d8f},dim.bottom);_d97(this._centerWidget,{h:_d90},dim.center);}else{var _d9b={};if(_d70){_d9b[_d70]=_d9b.center=true;if(/left|right|center/.test(_d70)){_d9b.left=_d9b.right=true;}else{if(/top|bottom|center/.test(_d70)){_d9b.top=_d9b.bottom=true;}}}dojo.forEach(this.getChildren(),function(_d9c){if(_d9c.resize&&(!_d70||_d9c.region in _d9b)){_d9c.resize(null,dim[_d9c.region]);}},this);}}});}if(!dojo._hasResource["dojox.layout.ExpandoPane"]){dojo._hasResource["dojox.layout.ExpandoPane"]=true;dojo.provide("dojox.layout.ExpandoPane");dojo.experimental("dojox.layout.ExpandoPane");dojo.declare("dojox.layout.ExpandoPane",[dijit.layout.ContentPane,dijit._Templated,dijit._Contained,dijit._Container],{attributeMap:dojo.delegate(dijit.layout.ContentPane.prototype.attributeMap,{title:{node:"titleNode",type:"innerHTML"}}),templateString:dojo.cache("dojox.layout","resources/ExpandoPane.html","<div class=\"dojoxExpandoPane\">\n\t<div dojoAttachPoint=\"titleWrapper\" class=\"dojoxExpandoTitle\">\n\t\t<div class=\"dojoxExpandoIcon\" dojoAttachPoint=\"iconNode\" dojoAttachEvent=\"onclick:toggle\"><span class=\"a11yNode\">X</span></div>\t\t\t\n\t\t<span class=\"dojoxExpandoTitleNode\" dojoAttachPoint=\"titleNode\">${title}</span>\n\t</div>\n\t<div class=\"dojoxExpandoWrapper\" dojoAttachPoint=\"cwrapper\" dojoAttachEvent=\"ondblclick:_trap\">\n\t\t<div class=\"dojoxExpandoContent\" dojoAttachPoint=\"containerNode\"></div>\n\t</div>\n</div>\n"),easeOut:"dojo._DefaultEasing",easeIn:"dojo._DefaultEasing",duration:420,startExpanded:true,previewOpacity:0.75,previewOnDblClick:false,baseClass:"dijitExpandoPane",postCreate:function(){this.inherited(arguments);this._animConnects=[];this._isHorizontal=true;if(dojo.isString(this.easeOut)){this.easeOut=dojo.getObject(this.easeOut);}if(dojo.isString(this.easeIn)){this.easeIn=dojo.getObject(this.easeIn);}var _d9d="",rtl=!this.isLeftToRight();if(this.region){switch(this.region){case "trailing":case "right":_d9d=rtl?"Left":"Right";break;case "leading":case "left":_d9d=rtl?"Right":"Left";break;case "top":_d9d="Top";break;case "bottom":_d9d="Bottom";break;}dojo.addClass(this.domNode,"dojoxExpando"+_d9d);dojo.addClass(this.iconNode,"dojoxExpandoIcon"+_d9d);this._isHorizontal=/top|bottom/.test(this.region);}dojo.style(this.domNode,{overflow:"hidden",padding:0});this.connect(this.domNode,"ondblclick",this.previewOnDblClick?"preview":"toggle");if(this.previewOnDblClick){this.connect(this.getParent(),"_layoutChildren",dojo.hitch(this,function(){this._isonlypreview=false;}));}},_startupSizes:function(){this._container=this.getParent();this._closedSize=this._titleHeight=dojo.marginBox(this.titleWrapper).h;if(this.splitter){var myid=this.id;dijit.registry.filter(function(w){return w&&w.child&&w.child.id==myid;}).forEach(dojo.hitch(this,function(w){this.connect(w,"_stopDrag","_afterResize");}));}this._currentSize=dojo.contentBox(this.domNode);this._showSize=this._currentSize[(this._isHorizontal?"h":"w")];this._setupAnims();if(this.startExpanded){this._showing=true;}else{this._showing=false;this._hideWrapper();this._hideAnim.gotoPercent(99,true);}this._hasSizes=true;},_afterResize:function(e){var tmp=this._currentSize;this._currentSize=dojo.marginBox(this.domNode);var n=this._currentSize[(this._isHorizontal?"h":"w")];if(n>this._titleHeight){if(!this._showing){this._showing=!this._showing;this._showEnd();}this._showSize=n;this._setupAnims();}else{this._showSize=tmp[(this._isHorizontal?"h":"w")];this._showing=false;this._hideWrapper();this._hideAnim.gotoPercent(89,true);}},_setupAnims:function(){dojo.forEach(this._animConnects,dojo.disconnect);var _d9e={node:this.domNode,duration:this.duration},_d9f=this._isHorizontal,_da0={},_da1={},_da2=_d9f?"height":"width";_da0[_da2]={end:this._showSize};_da1[_da2]={end:this._closedSize};this._showAnim=dojo.animateProperty(dojo.mixin(_d9e,{easing:this.easeIn,properties:_da0}));this._hideAnim=dojo.animateProperty(dojo.mixin(_d9e,{easing:this.easeOut,properties:_da1}));this._animConnects=[dojo.connect(this._showAnim,"onEnd",this,"_showEnd"),dojo.connect(this._hideAnim,"onEnd",this,"_hideEnd")];},preview:function(){if(!this._showing){this._isonlypreview=!this._isonlypreview;}this.toggle();},toggle:function(){if(this._showing){this._hideWrapper();this._showAnim&&this._showAnim.stop();this._hideAnim.play();}else{this._hideAnim&&this._hideAnim.stop();this._showAnim.play();}this._showing=!this._showing;},_hideWrapper:function(){dojo.addClass(this.domNode,"dojoxExpandoClosed");dojo.style(this.cwrapper,{visibility:"hidden",opacity:"0",overflow:"hidden"});},_showEnd:function(){dojo.style(this.cwrapper,{opacity:0,visibility:"visible"});dojo.anim(this.cwrapper,{opacity:this._isonlypreview?this.previewOpacity:1},227);dojo.removeClass(this.domNode,"dojoxExpandoClosed");if(!this._isonlypreview){setTimeout(dojo.hitch(this._container,"layout"),15);}else{this._previewShowing=true;this.resize();}},_hideEnd:function(){if(!this._isonlypreview){setTimeout(dojo.hitch(this._container,"layout"),25);}else{this._previewShowing=false;}this._isonlypreview=false;},resize:function(_da3){if(!this._hasSizes){this._startupSizes(_da3);}var _da4=dojo.marginBox(this.domNode);this._contentBox={w:_da3&&"w" in _da3?_da3.w:_da4.w,h:(_da3&&"h" in _da3?_da3.h:_da4.h)-this._titleHeight};dojo.style(this.containerNode,"height",this._contentBox.h+"px");if(_da3){dojo.marginBox(this.domNode,_da3);}this._layoutChildren();},_trap:function(e){dojo.stopEvent(e);}});}if(!dojo._hasResource["plugins.dojox.layout.ExpandoPane"]){dojo._hasResource["plugins.dojox.layout.ExpandoPane"]=true;dojo.provide("plugins.dojox.layout.ExpandoPane");dojo.declare("plugins.dojox.layout.ExpandoPane",[dojox.layout.ExpandoPane],{width:null,minWidth:15,height:null,minHeight:15,expand:false,resize:function(node,_da5){if(_da5){}var size=dojo.marginBox(this.domNode);var h=size.h-this._titleHeight;dojo.style(this.containerNode,"height",h+"px");if(_da5&&_da5.w){dojo.style(this.domNode,"width",_da5.w+"px");}},_showEnd:function(){dojo.style(this.cwrapper,{opacity:0,visibility:"visible"});dojo.fadeIn({node:this.cwrapper,duration:227}).play(1);dojo.removeClass(this.domNode,"dojoxExpandoClosed");if(this.region){switch(this.region){case "left":case "center":case "right":this.domNode.style.width=this.width+"px";break;case "top":case "bottom":this.domNode.style.height=this.height+"px";break;}}setTimeout(dojo.hitch(this._container,"layout",this.region,this,"show"),15);},_hideEnd:function(){if(this.region){switch(this.region){case "left":case "center":case "right":dojo.style(this.domNode,"width",this.minWidth+"px");break;case "top":case "bottom":dojo.style(this.domNode,"width",this.minHeight+"px");break;}}setTimeout(dojo.hitch(this._container,"layout",this.region,this,"hide"),15);}});}if(!dojo._hasResource["plugins.files.TitlePane"]){dojo._hasResource["plugins.files.TitlePane"]=true;dojo.provide("plugins.files.TitlePane");dojo.declare("plugins.files.TitlePane",[dijit.TitlePane,plugins.core.Common],{className:"filesTitlePane",title:"",open:true,duration:dijit.defaultDuration,baseClass:"filesTitlePane",templateString:null,templateString:"<div dojoAttachPoint=\"containerNode\">\r\n\r\n\t\t<div dojoAttachEvent=\"onclick:toggle,onkeypress: _onTitleKey,onfocus:_handleFocus,onblur:_handleFocus\" tabindex=\"0\"\r\n\t\t\twaiRole=\"button\"\r\n\t\t\tclass=\"dijitTitlePaneTitle\" dojoAttachPoint=\"titleBarNode,focusNode\">\r\n\t\r\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"arrowNode\" class=\"filesArrowNode\" waiRole=\"presentation\">\r\n\t\t\t\t<span dojoAttachPoint=\"arrowNodeInner\" class=\"dijitArrowNodeInner\"></span>\r\n\t\t\t\t<img src=\"${_blankGif}\" dojoAttachPoint=\"refresh\" class=\"refreshTitlePane\" dojoAttachEvent=\"onclick:reload\">\r\n\t\r\n\t\t\t<span dojoAttachPoint=\"titleNode\" class=\"dijitTitlePaneTextNode\">\r\n\t\t\t\t\r\n\t\t\t\t<table cellspacing=\"0\" cellpadding=\"0\" dojoAttachPoint='header' class='header'>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td dojoAttachPoint=\"ownerNode\" class='owner' title='Owner'></td>\r\n\t\t\t\t\t\t<td dojoAttachPoint=\"nameNode\" class='name'></td>\r\n\t\t\t\t\t\t<td dojoAttachPoint=\"locationNode\" class='location'></td>\r\n\t\t\t\t\t\t<td dojoAttachPoint=\"descriptionNode\" class='description' title='Description'></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t\t\r\n\t\t\t</span>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div class=\"dijitTitlePaneContentOuter\" dojoAttachPoint=\"hideNode\">\r\n\t\t\t<div class=\"dijitReset\" dojoAttachPoint=\"wipeNode\">\r\n\t\t\t\t<div class=\"dijitTitlePaneContentInner\" dojoAttachPoint=\"containerNode\" waiRole=\"region\" tabindex=\"-1\">\r\n\t\t\t\t\t<!-- nested divs because wipeIn()/wipeOut() doesn't work right on node w/padding etc.  Put padding on inner div. -->\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n</div>\r\n",cssFiles:[dojo.moduleUrl("plugins")+"/files/css/titlepane.css"],reloadCallback:null,core:null,directory:"",name:"",owner:"",location:"",description:"",size:"normal",type:"",attributeMap:dojo.delegate(dijit.layout.ContentPane.prototype.attributeMap,{title:{node:"titleNode",type:"innerHTML"},number:{node:"numberNode",type:"innerHTML"},tooltip:{node:"focusNode",type:"attribute",attribute:"title"},id:""}),constructor:function(args){this.title=args.title||"";this.size=args.size||"";this.name=args.name||"";this.owner=args.owner||"";this.location=args.location||"";this.description=args.description||"";this.core=args.core;},postCreate:function(){this.loadCSS(this.cssFiles);if(this.owner){this.ownerNode.innerHTML=this.owner;}if(this.name){this.nameNode.innerHTML=this.name;}if(this.location){this.locationNode.innerHTML=this.location;}if(this.description){this.descriptionNode.innerHTML=this.description;}var _da6="Type of filesystem";if(!this.name){this.nameNode.setAttribute("title",_da6);}if(this.size=="large"){this.arrowNode.setAttribute("class","largeFilesArrowNode");}if(this.size=="larger"){this.arrowNode.setAttribute("class","largerFilesArrowNode");}console.log("TitlePane.postCreate    BEFORE this.inherited(arguments)");this.inherited(arguments);console.log("TitlePane.postCreate    AFTER this.inherited(arguments)");},reload:function(_da7){_da7.stopPropagation();if(this.reloadCallback!=null){this.reloadCallback();return;}this.clear();var _da8=this.master;var _da9=this.core[_da8].createFileDrag(this.directory);this.containerNode.appendChild(_da9.domNode);},clear:function(){while(this.containerNode.firstChild){var _daa=dijit.getEnclosingWidget(this.containerNode.firstChild);_daa.destroy();}},_handleFocus:function(e){dojo[(e.type=="focus"?"addClass":"removeClass")](this.focusNode,this.baseClass+"Focused");},destroyRecursive:function(){this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout.LayoutContainer"]){dojo._hasResource["dijit.layout.LayoutContainer"]=true;dojo.provide("dijit.layout.LayoutContainer");dojo.declare("dijit.layout.LayoutContainer",dijit.layout._LayoutWidget,{baseClass:"dijitLayoutContainer",constructor:function(){dojo.deprecated("dijit.layout.LayoutContainer is deprecated","use BorderContainer instead",2);},layout:function(){dijit.layout.layoutChildren(this.domNode,this._contentBox,this.getChildren());},addChild:function(_dab,_dac){this.inherited(arguments);if(this._started){dijit.layout.layoutChildren(this.domNode,this._contentBox,this.getChildren());}},removeChild:function(_dad){this.inherited(arguments);if(this._started){dijit.layout.layoutChildren(this.domNode,this._contentBox,this.getChildren());}}});dojo.extend(dijit._Widget,{layoutAlign:"none"});}if(!dojo._hasResource["plugins.folders.Files"]){dojo._hasResource["plugins.folders.Files"]=true;dojo.provide("plugins.folders.Files");if(1){}dojo.declare("plugins.folders.Files",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainNode\">\n\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"titlePane\"\n\t\t\tdojoType=\"plugins.files.TitlePane\"\n\t\t\tparentWidget=\"this\"\n\t\t\tsize=\"large\"\n\t\t\ttitle=\"${title}\"\n\t\t\topen=\"${open}\"\n\t\t\twidth=\"200\">\n\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"rowsNode\"\n\t\t\t\tclass=\"directories\"\n\t\t\t\t>\n\t\t\t</div>\n\t\n\t\t</div>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,project:null,sleep:300,loadingPanes:null,fileDrags:null,cssFiles:[dojo.moduleUrl("plugins","folders/css/dialog.css"),dojo.moduleUrl("plugins","files/FileDrag/FileDrag.css"),dojo.moduleUrl("dojox","widget/Dialog/Dialog.css")],title:"Workflow",core:null,open:true,self:null,url:null,constructor:function(args){if(args.open){this.open=args.open;}if(this.open==null){this.open=false;}this.core=args.core;this.attachNode=args.attachNode;if(args.cssFiles!=null){this.cssFiles=args.cssFiles;}this.loadCSS(this.cssFiles);},postCreate:function(){this.titlePane.reloadCallback=dojo.hitch(this,"reload");this.startup();},startup:function(){console.group("Files    "+this.id+"    startup");console.log("Files.startup    BEFORE this.inherited(arguments)");this.inherited(arguments);console.log("Files.startup    AFTER this.inherited(arguments)");console.log("Files.startup    this.mainNode: "+this.mainNode);console.log("Files.startup    this.attachNode: "+this.attachNode);console.log("Files.startup    this.attachNode.addChild: "+this.attachNode.addChild);console.log("Files.startup    this.attachNode.appendChild: "+this.attachNode.appendChild);if(this.attachNode.addChild!=null){var _dae=new dijit.layout.LayoutContainer({title:"Files"},this.mainNode);console.log("Files.startup    projectFilesContainer: "+_dae);_dae.id="projectFilesContainer";this.attachNode.addChild(_dae);}else{this.attachNode.appendChild(this.mainNode);}console.log("Files.startup    AFTER this.attachNode.appendChild(this.mainNode)");this.fileDrags=[];this.load();console.groupEnd("Files    "+this.id+"    startup");},reload:function(){this.clear();this.load();},getDirectories:function(){var _daf=Agua.getProjects();return _daf;},clear:function(){while(this.rowsNode.firstChild){this.rowsNode.removeChild(this.rowsNode.firstChild);}},load:function(){console.group("Files    "+this.id+"    load");var _db0=this.getDirectories();if(_db0==null){return;}console.log("Files.load\t   directories.length: "+_db0.length);console.log("Files.load\t   directories: ");console.dir({directories:_db0});this.titlePanes=new Array;for(var i=0;i<_db0.length;i++){var _db1=dojo.clone(_db0[i]);var _db2=this.setTitlePane(_db1);this.titlePanes.push(_db2);}console.groupEnd("Files    "+this.id+"    load");},setTitlePane:function(_db3){if(!_db3.owner){_db3.owner=_db3.username;}_db3.description=_db3.description||"";_db3.open=this.open;_db3.title=this.title;var _db4=document.createElement("div");this.rowsNode.appendChild(_db4);this.core[this.self]=this;var _db5=new plugins.files.TitlePane({owner:_db3.owner,type:_db3.type,name:_db3.name,location:_db3.location,description:_db3.description,open:_db3.open,directory:_db3,core:this.core,master:this.self},_db4);return _db5;},createFileDrag:function(_db6){var _db7=this.createStore(_db6);this.core[this.self]=this;var _db8=new plugins.files.FileDrag({style:"height: auto; width: 100%; minHeight: 50px;",store:_db7,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,parentWidget:this,owner:_db6.owner,path:_db6.name,description:_db6.description||""});this.fileDrags.push(_db8);_db8.startup();return _db8;},addChild:function(_db9){var _dba=this.setTitlePane(_db9);this.titlePanes.push(_dba);var name=_db9.name;var _dbb=_db9.owner;var _dbc={"name":name,"path":name,"total":"0","items":[]};Agua.setFileCache(_dbb,name,_dbc);var _dbd={stopPropagation:function(){}};_dba.reload(_dbd);},removeChild:function(_dbe){if(!this.fileDrags){return false;}for(var i=0;i<this.fileDrags.length;i++){if(this.fileDrags[i]==_dbe){this.fileDrags.splice(i,1);_dbe.destroyRecursive();var _dbf=this.titlePanes.splice(i,1);var _dc0=_dbf[0];_dc0.destroyRecursive();return true;}}return false;},getPutData:function(_dc1){var _dc2=new Object;_dc2.mode="fileSystem";_dc2.username=Agua.cookie("username");_dc2.sessionId=Agua.cookie("sessionId");_dc2.url=this.url;_dc2.path=_dc1.name;return _dc2;},createStore:function(_dc3){var url=this.url;var _dc4=this.getPutData(_dc3);var _dc5=new plugins.dojox.data.FileStore({url:url,putData:_dc4,pathAsQueryParam:true,parentPath:this.parentPath,path:_dc3.name});_dc5.preamble=function(){this.store.path=this.arguments[0].path;};return _dc5;},openLocation:function(_dc6,_dc7){console.log("Files.openLocation    location: "+_dc6);console.log("Files.openLocation    username: "+_dc7);var _dc8=_dc6.split(/\//);var _dc9=_dc8[0];var _dca=this.getFileDragByProject(_dc9);console.log("Files.openLocation    fileDrag: ");console.dir({fileDrag:_dca});if(!_dca){return;}var _dcb=_dca.getChildren();console.dir({dragPanes:_dcb});if(!_dcb){_dca.startup();}_dcb=_dca.getChildren();console.log("Files.openLocation    dragPanes.length: "+_dcb.length);if(_dc8.length<2){return;}console.log("Files.openLocation    Doing this.folderRoundRobin("+_dc6+", 1)");this.folderRoundRobin(_dc6,1);},folderRoundRobin:function(_dcc,_dcd){console.log("Files.folderRoundRobin    location: "+_dcc);console.log("Files.folderRoundRobin    index: "+_dcd);console.log("Files.folderRoundRobin    caller: "+this.folderRoundRobin.caller.nom);var _dce=_dcc.split(/\//);console.log("Files.folderRoundRobin    folders.length: "+_dce.length);var _dcf=_dce[0];var _dd0=this.getFileDragByProject(_dcf);console.dir({fileDrag:_dd0});var _dd1=_dd0.getChildren();console.log("Files.folderRoundRobin    dragPanes.length: "+_dd1.length);if(_dcd>1){console.log("Files.folderRoundRobin    Removing connection for previous dragPane");var _dd2=_dd1[_dcd-1];if(_dd2._connection){dojo.disconnect(_dd2._connection);}}var _dd3=dojo.hitch(this,"connectRoundRobin",_dd0,_dcc,_dcd+1);var _dd4;if(_dd1.length<_dcd+1){if((_dcd+1)<=_dce.length){this.openFolder(_dd1[_dcd-1],_dce[_dcd],_dd3);}}else{var _dd5=_dd1[_dcd];console.log("Files.folderRoundRobin    dragPane "+_dcd+": "+_dd5);var path=_dd5.path;console.log("Files.folderRoundRobin    Doing folder "+_dcd+" path: "+path);var _dd6=this.folderPathByIndex(_dce,_dcd);console.log("Files.folderRoundRobin    Doing folder "+_dcd+" folderPath: "+_dd6);if(_dd6!=path){this.openFolder(_dd1[_dcd-1],_dce[_dcd],_dd3);}}},openFolder:function(_dd7,name,_dd8){_dd7._dragSource._removeSelection();var _dd9=this.getItemIndexByName(_dd7,name);if(_dd9<0){return;}var _dda=_dd7._dragSource.getAllNodes();dojo.addClass(_dda[_dd9],"dojoDndItemAnchor");var item=_dda[_dd9].item;var _ddb={target:{item:item}};if(this._connection){dojo.disconnect(this._connection);}delete this._connection;this._connection=dojo.connect(_dd7.parentWidget,"addChild",dojo.hitch(this,_dd8));_dd7.onclickHandler(_ddb);},testCallback:function(_ddc,_ddd,_dde){},connectRoundRobin:function(_ddf,_de0,_de1){var _de2=_ddf.getChildren();var _de3=_de2[_de2.length-1];_de3._connection=dojo.connect(_de3,"onLoad",dojo.hitch(this,"folderRoundRobin",_de0,_de1));},getFileDragByProject:function(_de4){for(var i=0;i<this.fileDrags.length;i++){var _de5=this.fileDrags[i];if(_de5.path==_de4){return _de5;}}return null;},refreshFileDrags:function(){var _de6=Agua.getProjects();var _de7=dojo.query(".dojoxFileDrag");this.fileDrags=[];for(var i=0;i<_de7.length;i++){this.fileDrags.push(dijit.byNode(_de7[i]));}},getItemIndexByName:function(_de8,name){var _de9=_de8._dragSource.getAllNodes();for(var i=0;i<_de9.length;i++){if(_de9[i].item.name==name){return i;}}return -1;},folderPathByIndex:function(_dea,_deb){if(_deb>_dea.length-1){return;}var path="";for(var i=0;i<_deb+1;i++){if(i>0){path+="/";}path+=_dea[i];}return path;}});}if(!dojo._hasResource["plugins.folders.ProjectFiles"]){dojo._hasResource["plugins.folders.ProjectFiles"]=true;dojo.provide("plugins.folders.ProjectFiles");if(1){}dojo.declare("plugins.folders.ProjectFiles",[plugins.folders.Files],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainNode\">\n\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"titlePane\"\n\t\t\tdojoType=\"plugins.files.TitlePane\"\n\t\t\tparentWidget=\"this\"\n\t\t\tsize=\"large\"\n\t\t\ttitle=\"${title}\"\n\t\t\topen=\"${open}\"\n\t\t\twidth=\"200\">\n\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"rowsNode\"\n\t\t\t\tclass=\"directories\"\n\t\t\t\t>\n\t\t\t</div>\n\t\n\t\t</div>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,project:null,sleep:300,loadingPanes:null,fileDrags:null,cssFiles:[dojo.moduleUrl("plugins","folders/css/dialog.css"),dojo.moduleUrl("dojox","widget/Dialog/Dialog.css")],title:"Workflow",open:true,self:"projectfiles"});}if(!dojo._hasResource["plugins.folders.SourceFiles"]){dojo._hasResource["plugins.folders.SourceFiles"]=true;dojo.provide("plugins.folders.SourceFiles");dojo.declare("plugins.folders.SourceFiles",[plugins.folders.Files],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainNode\">\n\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"titlePane\"\n\t\t\tdojoType=\"plugins.files.TitlePane\"\n\t\t\tparentWidget=\"this\"\n\t\t\tsize=\"large\"\n\t\t\ttitle=\"${title}\"\n\t\t\topen=\"${open}\"\n\t\t\twidth=\"200\">\n\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"rowsNode\"\n\t\t\t\tclass=\"directories\"\n\t\t\t\t>\n\t\t\t</div>\n\t\n\t\t</div>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,core:null,project:null,sleep:250,open:false,self:"sourcefiles",constructor:function(args){this.paneId=args.paneId;this.project=args.project;this.core=args.core;this.attachNode=args.attachNode;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);},load:function(){this.inherited(arguments);},getDirectories:function(){return Agua.getSources();},createFileDrag:function(_dec){var _ded=this.createSourceStore(_dec);this.core[this.self]=this;var _dee=new plugins.files.FileDrag({style:"height: auto; width: 100%; minHeight: 50px;",store:_ded,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,parentWidget:this,owner:_dec.owner,path:"",description:_dec.description||""});this.fileDrags.push(_dee);_dee.startup();return _dee;},createSourceStore:function(_def){var url=this.url;var _df0=this.getSourcePutData(_def);var _df1=new plugins.dojox.data.FileStore({url:url,putData:_df0,pathAsQueryParam:true,parentPath:this.parentPath,path:_def.name});return _df1;},getSourcePutData:function(_df2){var _df3=new Object;_df3.mode="fileSystem";_df3.username=Agua.cookie("username");_df3.sessionId=Agua.cookie("sessionId");_df3.location=_df2.location;_df3.url=Agua.cgiUrl+"folders.cgi?";return _df3;}});}if(!dojo._hasResource["plugins.folders.SharedProjectFiles"]){dojo._hasResource["plugins.folders.SharedProjectFiles"]=true;dojo.provide("plugins.folders.SharedProjectFiles");dojo.declare("plugins.folders.SharedProjectFiles",[plugins.folders.Files],{open:true,self:"sharedprojectfiles",load:function(){console.group("sharedProjectFiles    "+this.id+"    load");this.titlePanes=new Array;var _df4=Agua.getSharedUsernames();for(var j=0;j<_df4.length;j++){if(_df4[j]=="agua"){continue;}var _df5=Agua.getSharedProjectsByUsername(_df4[j]);for(var i=0;i<_df5.length;i++){var _df6=dojo.clone(_df5[i]);_df6.open=this.open;this.titlePanes.push(this.setTitlePane(_df6));}}console.groupEnd("sharedProjectFiles    "+this.id+"    load");},createFileDrag:function(_df7){console.log("SharedProjectFiles.createFileDrag    directory: ");console.dir({directory:_df7});var _df8=this.createStore(_df7);var _df9=new plugins.files.FileDrag({style:"height: auto; width: 100%; minHeight: 50px;",store:_df8,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,owner:_df7.owner,parentWidget:this,core:this.core});_df9.path=_df7.name;_df9.startup();return _df9;},getPutData:function(_dfa){console.log("folders.SharedProjectFiles    directory:");console.dir({directory:_dfa});var _dfb=new Object;_dfb.mode="fileSystem";_dfb.sessionId=Agua.cookie("sessionId");_dfb.url=Agua.cgiUrl+"folders.cgi?";_dfb.requestor=Agua.cookie("username");_dfb.username=_dfa.owner;_dfb.groupname=_dfa.groupname;return _dfb;}});}if(!dojo._hasResource["plugins.folders.SharedSourceFiles"]){dojo._hasResource["plugins.folders.SharedSourceFiles"]=true;dojo.provide("plugins.folders.SharedSourceFiles");dojo.declare("plugins.folders.SharedSourceFiles",[plugins.folders.Files],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainNode\">\n\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"titlePane\"\n\t\t\tdojoType=\"plugins.files.TitlePane\"\n\t\t\tparentWidget=\"this\"\n\t\t\tsize=\"large\"\n\t\t\ttitle=\"${title}\"\n\t\t\topen=\"${open}\"\n\t\t\twidth=\"200\">\n\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"rowsNode\"\n\t\t\t\tclass=\"directories\"\n\t\t\t\t>\n\t\t\t</div>\n\t\n\t\t</div>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,project:null,sleep:250,title:"Shared Sources",open:true,titlePanes:null,self:"sourcefiles",constructor:function(args){this.paneId=args.paneId;this.project=args.project;this.core=args.core;this.attachNode=args.attachNode;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);},load:function(){var _dfc=Agua.getSharedUsernames();if(!_dfc){return;}this.titlePanes=new Array;for(var j=0;j<_dfc.length;j++){if(_dfc[j]=="agua"){continue;}var _dfd=Agua.getSharedSourcesByUsername(_dfc[j]);if(!_dfd){continue;}for(var i=0;i<_dfd.length;i++){var _dfe=dojo.clone(_dfd[i]);_dfe.open=this.open;this.titlePanes.push(this.setTitlePane(_dfe));}}},getDirectories:function(){return Agua.getSharedSources();},createFileDrag:function(_dff){var _e00=this.createStore(_dff);var _e01=new plugins.files.FileDrag({style:"height: auto; width: 100%; minHeight: 50px;",store:_e00,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,owner:_dff.owner,parentWidget:this,core:this.core});_e01.path=_dff.location;this.fileDrags.push(_e01);_e01.startup();return _e01;},getPutData:function(_e02){var _e03=new Object;_e03.mode="fileSystem";_e03.requestor=Agua.cookie("username");_e03.sessionId=Agua.cookie("sessionId");_e03.location=_e02.location;_e03.url=Agua.cgiUrl+"folders.cgi?";_e03.username=_e02.owner;_e03.owner=_e02.owner;_e03.location=_e02.location;_e03.groupname=_e02.groupname;return _e03;}});}if(!dojo._hasResource["plugins.files.FileManager"]){dojo._hasResource["plugins.files.FileManager"]=true;dojo.provide("plugins.files.FileManager");if(1){}dojo.declare("plugins.files.FileManager",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"folders\"\n\t\ticonClass=\"dijitEditorIcon dijitEditorIconProject\"\n\t\tminWidth=\"1000\"\n\t\tstyle=\"position: relative; min-width: auto !important; width: 100% !important; height: auto !important; padding: 0px; background: #FFF; overflow-y: scroll\"\n\t\tclosable=\"true\"\n\t\tscrollbar=\"true\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t>\n\t\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"projectsNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sourcesNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sharedProjectsNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sharedSourcesNode\"\n\t\t\t>\n\t\t</div>\n\n    </div>\n\n</div>\n",widgetsInTemplate:true,sourceId:"",workflowObject:null,dialogId:null,cssFiles:[dojo.moduleUrl("plugins","files/css/filemanager.css"),dojo.moduleUrl("dojox","layout/resources/FloatingPane.css")],callback:null,core:null,dialog:null,atomic:{},preamble:function(){this.callback=arguments[0].callback;},constructor:function(args){console.log("XXXXXX FileManager.constructor\targs:");console.dir({args:args});this.loadCSS();this.setMenus();this.core=new Object;this.core.folders=this;},postCreate:function(){this.startup();},startup:function(){console.log("FileManager.startup\tplugins.files.FileManager.startup()");console.log("FileManager.startup\tBEFORE this.inherited(arguments)");this.inherited(arguments);console.log("FileManager.startup\tAFTER this.inherited(arguments)");console.log("startup, this.core: ");console.log(this.core);this.createDialog();console.log("FileManager.startup\tAFTER this.createDialog()");this.setAtomic();this.setNodes();this.loadPanes();this.atomic.dialog.startup();Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateSources");},updateProjects:function(args){console.log("FileManager.updateProjects    Cluster.updateProjects()");console.log("FileManager.updateProjects    this: "+this);console.log("FileManager.updateProjects    Calling this.loadPanes()");this.loadProjects();},updateWorkflows:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.loadWorkflows;},updateSources:function(args){console.log("FileManager.updateSources    Cluster.updateSources()");console.log("FileManager.updateSources    this: "+this);console.log("FileManager.updateSources    Calling this.loadSourceTab()");this.loadSources();},setMenus:function(){this.fileMenu=new plugins.files.FileMenu({parentWidget:this});this.folderMenu=new plugins.files.FolderMenu({parentWidget:this});this.workflowMenu=new plugins.files.WorkflowMenu({parentWidget:this});},createDialog:function(){console.log("FileManager.createDialog    plugins.files.FileManager.createDialog()");var _e04=dojo.dnd.getUniqueId();this.dialogId=_e04;var node=dojo.create("div");document.body.appendChild(node);this.atomic.dialog=new plugins.dojox.layout.FloatingPane({id:_e04,draggable:true,showTitle:true,title:"File Manager",region:"bottom",dockable:"true",duration:"10",height:"500px",width:"900px",resizable:"true",maxable:"false",closable:"false",dockClass:"filesDockNode"},node);dojo.style(this.atomic.dialog.domNode,"display","none");dojo.style(this.atomic.dialog.domNode,"visibility","hidden");this.atomic.dialog.startup();dojo.connect(this.atomic.dialog,"_onShow",this.atomic.dialog,"maximize");console.log("FileManager.createDialog    AFTER create dialog");console.log("FileManager.createDialog    Doing set class 'folders dijitDialog'");dojo.attr(dojo.byId(_e04),"class","folders dijitDialog");console.log("FileManager.createDialog    Doing set style.top");this.atomic.dialog.domNode.style.top="100px";console.log("FileManager.createDialog    Doing add class 'folders'");dojo.addClass(this.atomic.dialog.domNode,"folders");console.log("FileManager.createDialog     Doing this.atomic.dialog.content = this.mainTab.containerNode");console.log("FileManager.createDialog     this.mainTab.containerNode: "+this.mainTab.containerNode);dojo.connect(this.atomic.dialog,"minimize",this,"disableMenuSelect");dojo.connect(this.atomic.dialog,"minimize",this,"disableMenuAdd");this.atomic.dialog.containerNode.appendChild(this.mainTab.containerNode);},setAtomic:function(){this.atomic.nodes=new Object;this.atomic.widgets=new Object;},setRefreshButtons:function(){console.log("FileManager.setRefreshButtons    FileManager.setRefreshButtons()");var _e05=[{titleNode:this.projectsTitle.focusNode,title:"Refresh Projects",onclick:"loadProjects"},{titleNode:this.sharedProjectsTitle.focusNode,title:"Refresh Shared Projects",onclick:"loadSharedProjects"},{titleNode:this.sourcesTitle.focusNode,title:"Refresh Sources",onclick:"loadSources"},{titleNode:this.sharedSourcesTitle.focusNode,title:"Refresh Shared Sources",onclick:"loadSharedSources"}];var _e06=this;dojo.forEach(_e05,dojo.hitch(_e06,function(_e07){console.log("FileManager.setRefreshButtons    FileManager.setRefreshButtons(command)");console.log("FileManager.setRefreshButtons    command: ");console.dir(_e07);var node=document.createElement("div");_e07.titleNode.appendChild(node);dojo.attr(node,"title",_e07.title);dojo.addClass(node,"refreshButton");dojo.connect(node,"onclick",this,_e07.onclick);}));},setNodes:function(){console.log("FileManager.setNodes    workflow.FileManager.setNodes()");var _e08=document.createElement("div");dojo.addClass(_e08,"folders");this.paneNode=_e08;var _e09=["projects","sharedProjects","sources","sharedSources"];var _e0a=this;dojo.forEach(_e09,function(_e0b){console.log("FileManager.setNodes    thisObject["+_e0b+"Node]: "+_e0a[_e0b+"Node"]);_e0a.atomic.nodes[_e0b]=_e0a[_e0b+"Node"];_e0a.atomic.widgets[_e0b]=new Array;});},loadPanes:function(){console.log("FileManager.loadPanes\t   plugins.files.FileManager.loadPanes()");this.titlePanes=[];this.titlePanes=this.concatArrays(this.titlePanes,this.loadProjects());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSources());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSharedProjects());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSharedSources());console.log("Folders.loadPanes    this.titlePanes.length: "+this.titlePanes.length);this.roundRobin();},loadProjects:function(){this.remove("projectsNode",this.projectFiles);this.projectFiles=new plugins.folders.ProjectFiles({open:false,title:"Projects",type:"Project",attachNode:this.projectsNode,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core});return this.projectFiles.titlePanes;},loadSources:function(){while(this.sourcesNode.firstChild){this.sourcesNode.removeChild(this.sourcesNode.firstChild);}this.sourceFiles=new plugins.folders.SourceFiles({open:false,title:"Sources",type:"Source",attachNode:this.sourcesNode,project:this.project,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core});return this.sourceFiles.titlePanes;},loadSharedProjects:function(){this.sharedProjectFiles=new plugins.folders.SharedProjectFiles({open:false,title:"Shared Projects",type:"Shared Project",attachNode:this.sharedProjectsNode,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core});return this.sharedProjectFiles.titlePanes;},loadSharedSources:function(){this.sharedSourceFiles=new plugins.folders.SharedSourceFiles({open:false,title:"SharedSources",type:"Shared Source",attachNode:this.sharedSourcesNode,project:this.project,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core});return this.sharedSourceFiles.titlePanes;},roundRobin:function(){console.group("FileManager-"+this.id+"    roundRobin");console.log("FileManager.roundRobin    caller: "+this.roundRobin.caller.nom);console.log("FileManager.roundRobin    this.titlePanes.length: "+this.titlePanes.length);if(!this.titlePanes||this.titlePanes.length<1){return;}var _e0c=this.titlePanes.splice(0,1);var _e0d=_e0c[0];console.log("FileManager.roundRobin    titlePane.name:"+_e0d.name);console.dir({titlePane:_e0d});var _e0e={stopPropagation:function(){console.log("FileManager.roundRobin    fakeEvent.stopPropagation()");}};_e0d.reload(_e0e);},remove:function(_e0f,_e10){console.log("FileManager.remove     nodeName: "+_e0f);console.log("FileManager.remove     widget: "+_e10);while(this[_e0f].firstChild){this[_e0f].removeChild(this[_e0f].firstChild);}if(_e10){_e10.destroy();}},hide:function(){console.log("FileManager.hide    Doing this.atomic.dialog.minimize()");this.atomic.dialog.minimize();},show:function(_e11){console.log("FileManager.show    parameterWidget:");console.dir({parameterWidget:_e11});this.parameterWidget=_e11;this.fileMenu.parameterWidget=_e11;this.folderMenu.parameterWidget=_e11;this.workflowMenu.parameterWidget=_e11;this.atomic.dialog.show();var _e12=this.parameterWidget.project;var _e13=this.parameterWidget.workflow;console.log("FileManager.show    project: "+_e12);console.log("FileManager.show    workflow: "+_e13);this.openProjectLocation(_e12,_e13);},openProjectLocation:function(_e14,_e15){var _e16=_e14;if(_e15){_e16+="/"+_e15;}var _e17=Agua.cookie("username");var _e18=this.projectFiles;console.log("projectFiles: ");console.dir({projectFiles:_e18});_e18.openLocation(_e16,_e17);},openProject:function(_e19,_e1a){console.log("FileManager.show\tproject: "+_e19);console.log("FileManager.show\tworkflow: "+_e1a);var _e1b=this.atomic.nodes.projects;for(var i=0;i<_e1b.length;i++){var _e1c=this.projectTitlePanes[i];if(_e1c.title==_e19){console.log("FileManager.show\ttitlePane fo project '"+_e19+"': "+_e1c);_e1c.open=false;_e1c.toggle();console.log("FileManager.show    AFTER titlePane.toggle()");console.log("FileManager.show    titlePane.fileSelector: "+_e1c.fileSelector);if(_e1a!=null&&_e1a){_e1c.fileSelector.selectChild(_e1a);}console.log("FileManager.show    AFTER titlePane.fileSelector.selectChild("+_e1a+")");}}},openWorkflow:function(_e1d,_e1e){},enableMenus:function(){console.log("FileManager.enableMenus     plugins.files.FileManager.enableMenus()");this.fileMenu.enable();this.folderMenu.enable();this.workflowMenu.enable();},enableMenuSelect:function(){console.log("FileManager.enableMenuSelect     plugins.files.FileManager.enableMenuSelect()");this.fileMenu.enableMenuItem("select");this.folderMenu.enableMenuItem("select");this.workflowMenu.enableMenuItem("select");},enableMenuAdd:function(){console.log("FileManager.enableMenuAdd     plugins.files.FileManager.enableMenuAdd()");this.fileMenu.enableMenuItem("add");this.folderMenu.enableMenuItem("add");this.workflowMenu.enableMenuItem("add");},disableMenus:function(){console.log("FileManager.disableMenus     plugins.files.FileManager.disableMenus()");this.fileMenu.disable();this.folderMenu.disable();this.workflowMenu.disable();},disableMenuSelect:function(){this.fileMenu.disableMenuItem("select");this.folderMenu.disableMenuItem("select");this.workflowMenu.disableMenuItem("select");},disableMenuAdd:function(){this.fileMenu.disableMenuItem("add");this.folderMenu.disableMenuItem("add");this.workflowMenu.disableMenuItem("add");},concatArrays:function(_e1f,_e20){for(var i=0;i<_e20.length;i++){_e1f.push(_e20[i]);}return _e1f;}});}if(!dojo._hasResource["plugins.files.Controller"]){dojo._hasResource["plugins.files.Controller"]=true;dojo.provide("plugins.files.Controller");dojo.declare("plugins.files.Controller",[plugins.core.Common],{name:"plugins.files.Controller",version:"0.01",url:"",description:"Load the floating pane File Manager",dependencies:[{name:"plugins.core.Agua",version:0.01}],templateString:"<div dojoAttachPoint=\"containerNode\" class=\"workflow\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"workflowIcon\"\n        type=\"button\"\n        label=\"Workflow\"\n        ></button>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"workflow/css/controller.css",dojo.moduleUrl("plugins")+"workflow/css/workflow.css"],tabPanes:[],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);},createFileManager:function(){},postLoad:function(){console.log("plugins.files.Controller.postLoad    DOING new plugins.files.FileManager");Agua.fileManager=new plugins.files.FileManager({paneId:"fileManager"+this.paneId,tabsNodeId:"tabs"});}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.folders.Folders"]){dojo._hasResource["plugins.folders.Folders"]=true;dojo.provide("plugins.folders.Folders");if(1){}dojo.declare("plugins.folders.Folders",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- PROJECT TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"folders\"\n\t\ticonClass=\"foldersIcon\"\n\t\tminWidth=\"1000\"\n\t\tstyle=\"position: relative; min-width: 1140px !important; width: 100% !important; min-height: 770px !important; height: 100% !important; padding: 0px; background: #FFF; overflow-y: scroll\"\n\t\tclosable=\"true\"\n\t\tscrollbar=\"true\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Folders\" >\n\t\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"projectsNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sourcesNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sharedProjectsNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sharedSourcesNode\"\n\t\t\t>\n\t\t</div>\n\n\t</div>\n\t<!-- END OF PROJECT TAB -->\n\n<!--</div>-->\n",widgetsInTemplate:true,parentWidget:null,core:null,project:null,polling:false,textBreakWidth:22,cssFiles:[dojo.moduleUrl("plugins")+"folders/css/folders.css"],projectFiles:null,sourceFiles:null,sharedProjectFiles:null,sharedSourceFiles:null,callback:null,url:null,constructor:function(args){console.log("Folders.constructor    args:");console.dir({args:args});if(!args){return;}this.callback=args.callback;this.project=args.project;this.attachWidget=Agua.tabs;this.core=new Object;this.core.folders=this;if(Agua.cgiUrl){this.url=Agua.cgiUrl+"/folders.cgi";}this.loadCSS();},postCreate:function(){this.startup();},startup:function(){if(!this.attachWidget){return;}this.inherited(arguments);if(this.attachWidget.addChild){this.attachWidget.addChild(this.mainTab);this.attachWidget.selectChild(this.mainTab);}if(this.attachWidget.appendChild){this.attachWidget.appendChild(this.mainTab.domNode);}this.setMenus();Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateWorkflows");Agua.updater.subscribe(this,"updateSources");this.loadPanes();},updateProjects:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.loadProjects;},updateWorkflows:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.loadWorkflows;},updateSources:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.loadSources;},setMenus:function(){this.fileMenu=new plugins.files.FileMenu({parentWidget:this});this.folderMenu=new plugins.files.FolderMenu({parentWidget:this});this.workflowMenu=new plugins.files.WorkflowMenu({parentWidget:this});dojo.connect(this.folderMenu.menu.domNode,"oncontextmenu",function(_e21){_e21.stopPropagation();});dojo.connect(this.workflowMenu.menu,"oncontextmenu",function(_e22){_e22.stopPropagation();});},loadPanes:function(){this.titlePanes=[];this.titlePanes=this.concatArrays(this.titlePanes,this.loadProjects());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSources());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSharedProjects());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSharedSources());this.roundRobin();},concatArrays:function(_e23,_e24){for(var i=0;i<_e24.length;i++){_e23.push(_e24[i]);}return _e23;},roundRobin:function(){if(!this.titlePanes||this.titlePanes.length<1){console.log("Folders.roundRobin    Doing this.callback if defined: "+this.callback);if(this.callback){this.callback();}return;}var _e25=this.titlePanes.splice(0,1);var _e26=_e25[0];var _e27={stopPropagation:function(){}};_e26.reload(_e27);},loadProjects:function(){this.remove("projectsNode",this.projectFiles);this.projectFiles=new plugins.folders.ProjectFiles({open:true,title:"Projects",type:"Project",attachNode:this.projectsNode,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,url:this.url});return this.projectFiles.titlePanes;},loadSources:function(){while(this.sourcesNode.firstChild){this.sourcesNode.removeChild(this.sourcesNode.firstChild);}this.sourceFiles=new plugins.folders.SourceFiles({open:true,title:"Sources",type:"Source",attachNode:this.sourcesNode,project:this.project,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,url:this.url});return this.sourceFiles.titlePanes;},loadSharedProjects:function(){this.sharedProjectFiles=new plugins.folders.SharedProjectFiles({open:false,title:"Shared Projects",type:"Shared Project",attachNode:this.sharedProjectsNode,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,url:this.url});return this.sharedProjectFiles.titlePanes;},loadSharedSources:function(){this.sharedSourceFiles=new plugins.folders.SharedSourceFiles({open:false,title:"SharedSources",type:"Shared Source",attachNode:this.sharedSourcesNode,project:this.project,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,url:this.url});return this.sharedSourceFiles.titlePanes;},remove:function(_e28,_e29){while(this[_e28].firstChild){this[_e28].removeChild(this[_e28].firstChild);}if(_e29!=null){_e29.destroy();}},destroyRecursive:function(){console.log("Folders.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.folders.Controller"]){dojo._hasResource["plugins.folders.Controller"]=true;dojo.provide("plugins.folders.Controller");dojo.declare("plugins.folders.Controller",[plugins.core.PluginController],{paneId:null,templateString:"<div dojoAttachPoint=\"containerNode\" class=\"folders\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"foldersButton\"\n        iconClass=\"foldersIcon\"\n        type=\"button\"\n        label=\"Folders\"\n        ></button>\n</div>\n        \n",cssFiles:[dojo.moduleUrl("plugins")+"/folders/css/controller.css"],tabClass:"plugins.folders.Folders",});dojo.addOnLoad(function(){});}if(!dojo._hasResource["dojox.io.windowName"]){dojo._hasResource["dojox.io.windowName"]=true;dojo.provide("dojox.io.windowName");dojox.io.windowName={send:function(_e2a,args){args.url+=(args.url.match(/\?/)?"&":"?")+"windowname="+(args.authElement?"auth":true);var _e2b=args.authElement;var _e2c=function(_e2d){try{var _e2e=dfd.ioArgs.frame.contentWindow.document;_e2e.write(" ");_e2e.close();}catch(e){}(_e2b||dojo.body()).removeChild(dfd.ioArgs.outerFrame);return _e2d;};var dfd=dojo._ioSetArgs(args,_e2c,_e2c,_e2c);if(args.timeout){setTimeout(function(){if(dfd.fired==-1){dfd.callback(new Error("Timeout"));}},args.timeout);}var self=dojox.io.windowName;if(dojo.body()){self._send(dfd,_e2a,_e2b,args.onAuthLoad);}else{dojo.addOnLoad(function(){self._send(dfd,_e2a,_e2b,args.onAuthLoad);});}return dfd;},_send:function(dfd,_e2f,_e30,_e31){var _e32=dfd.ioArgs;var _e33=dojox.io.windowName._frameNum++;var _e34=(dojo.config.dojoBlankHtmlUrl||dojo.config.dojoCallbackUrl||dojo.moduleUrl("dojo","resources/blank.html"))+"#"+_e33;var _e35=new dojo._Url(window.location,_e34);var doc=dojo.doc;var _e36=_e30||dojo.body();function _e37(_e38){_e38.style.width="100%";_e38.style.height="100%";_e38.style.border="0px";};if(dojo.isMoz&&![].reduce){var _e39=doc.createElement("iframe");_e37(_e39);if(!_e30){_e39.style.display="none";}_e36.appendChild(_e39);var _e3a=_e39.contentWindow;doc=_e3a.document;doc.write("<html><body margin='0px'><iframe style='width:100%;height:100%;border:0px' name='protectedFrame'></iframe></body></html>");doc.close();var _e3b=_e3a[0];_e3a.__defineGetter__(0,function(){});_e3a.__defineGetter__("protectedFrame",function(){});doc=_e3b.document;doc.write("<html><body margin='0px'></body></html>");doc.close();_e36=doc.body;}var _e3c;if(dojo.isIE){var div=doc.createElement("div");div.innerHTML="<iframe name=\""+_e35+"\" onload=\"dojox.io.windowName["+_e33+"]()\">";_e3c=div.firstChild;}else{_e3c=doc.createElement("iframe");}_e32.frame=_e3c;_e37(_e3c);_e32.outerFrame=_e39=_e39||_e3c;if(!_e30){_e39.style.display="none";}var _e3d=0;function _e3e(){var data=_e3c.contentWindow.name;if(typeof data=="string"){if(data!=_e35){_e3d=2;dfd.ioArgs.hash=_e3c.contentWindow.location.hash;dfd.callback(data);}}};dojox.io.windowName[_e33]=_e3c.onload=function(){try{if(!dojo.isMoz&&_e3c.contentWindow.location=="about:blank"){return;}}catch(e){}if(!_e3d){_e3d=1;if(_e30){if(_e31){_e31();}}else{_e3c.contentWindow.location=_e34;}}try{if(_e3d<2){_e3e();}}catch(e){}};_e3c.name=_e35;if(_e2f.match(/GET/i)){dojo._ioAddQueryToUrl(_e32);_e3c.src=_e32.url;_e36.appendChild(_e3c);if(_e3c.contentWindow){_e3c.contentWindow.location.replace(_e32.url);}}else{if(_e2f.match(/POST/i)){_e36.appendChild(_e3c);var form=dojo.doc.createElement("form");dojo.body().appendChild(form);var _e3f=dojo.queryToObject(_e32.query);for(var i in _e3f){var _e40=_e3f[i];_e40=_e40 instanceof Array?_e40:[_e40];for(var j=0;j<_e40.length;j++){var _e41=doc.createElement("input");_e41.type="hidden";_e41.name=i;_e41.value=_e40[j];form.appendChild(_e41);}}form.method="POST";form.action=_e32.url;form.target=_e35;form.submit();form.parentNode.removeChild(form);}else{throw new Error("Method "+_e2f+" not supported with the windowName transport");}}if(_e3c.contentWindow){_e3c.contentWindow.name=_e35;}},_frameNum:0};}if(!dojo._hasResource["dojox.fx.easing"]){dojo._hasResource["dojox.fx.easing"]=true;dojo.provide("dojox.fx.easing");dojo.deprecated("dojox.fx.easing","Upgraded to Core, use dojo.fx.easing instead","2.0");dojox.fx.easing=dojo.fx.easing;}if(!dojo._hasResource["plugins.home.Home"]){dojo._hasResource["plugins.home.Home"]=true;dojo.provide("plugins.home.Home");if(1){}dojo.declare("plugins.home.Home",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"home\"\n\t\ticonClass=\"homeIcon\"\n\t\tstyle=\"min-width: 1000px !important; width: 100% !important; height:inherit !important; padding: 0px; background: #FFF;\"\n\t\ttitle=\"Home\"\n\t\tclosable=\"true\"\n\t\tdojoType=\"dijit.layout.BorderContainer\"\n\t\t>\n\n\t\t<div\n\t\t\tclass=\"homeContainer\"\n\t\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\t\tregion=\"top\">\n\t\t\t\n\t\t\t<table width=\"100%\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<table class=\"navigationTable\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\tUse\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class=\"leftArrow\">\n\t\t\t\t\t\t\t\t\tALT +\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\tand\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class=\"rightArrow\">\n\t\t\t\t\t\t\t\t\tALT +\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class=\"navigationInfo\">\n\t\t\t\t\t\t\t\t\tto Navigate\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t<td align=\"right\">\n\t\t\t\t\t\t<table class=\"packageTable\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=packageTitle>Package</td>\n\t\t\t\t\t\t\t\t<td class=packageTitle title=\"Current installed version\">Version</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"packageCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachEvent='onChange:showCurrentVersion'\n\t\t\t\t\t\t\t\t\t\tclass=\"packageCombo\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"currentVersion\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"currentVersion\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"checkVersion\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"checkVersion\"\n\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:showUpgrades\"\n\t\t\t\t\t\t>Check For Upgrades</button>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td width=\"400\">\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\n\t\t\t<div\n\t\t\t\tid=\"authTarget\"\n\t\t\t\tdojoAttachPoint=\"bottomPane\"\n\t\t\t\tclass=\"bottomPane\"\n\t\t\t\talt=\"Agua Home Page\"\n\t\t\t>\n\t\t\t</div>\n\t\t\n\t\t</div>\n\t\t\n\t\t<div\n\t\t\tclass=\"progressPane\"\n\t\t\tdojoAttachPoint=\"progressPane\"\n\t\t\tdojoType=\"plugins.dojox.layout.FloatingPane\"\n\t\t\tregion=\"top\"\n\t\t\tresizable=\"false\"\n\t\t\tmoveable=\"false\"\n\t\t\tdockable=\"true\"\n\t\t\tmaxable=\"false\"\n\t\t\tclosable=\"false\"\n\t\t\tduration=\"1500\"\n\t\t\theight=\"500px\"\n\t\t\twidth=\"900px\"\n\t\t\ttitle=\"Upgrade Log\"\n\t\t\tdockClass=\"homeDockNode\"\n\t\t\t> \n\t\t</div>\n\t</div>\n\t\t\t\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","home/css/home.css"),dojo.moduleUrl("dojox","layout/resources/ResizeHandle.css"),dojo.moduleUrl("dojox","layout/resources/FloatingPane.css"),dojo.moduleUrl("dojox","widget/Dialog/Dialog.css")],widgetsInTemplate:true,paneWidgets:null,url:"http://www.aguadev.org/confluence/display/home/Home",progressPane:null,timerInterval:30000,constructor:function(args){this.loadCSS();},postCreate:function(){console.log("Home.postCreate    plugins.home.Home.postCreate()");this.startup();},startup:function(){console.log("Home.startup    plugins.home.Home.startup()");this.inherited(arguments);Agua.tabs.addChild(this.mainTab);Agua.tabs.selectChild(this.mainTab);this.loadPane();this.disableUpgrade();this.setPackageCombo();this.setSelectiveDialog();this.setSimpleDialog();this.setTimer();this.setProgressPane();Agua.updater.subscribe(this,"updatePackages");dojo.connect(window,"onresize",dojo.hitch(this,"resizeProgress"));},updatePackages:function(args){console.log("Home.updatePackages    Home.updatePackages(args)");console.dir({args:args});if(args&&!args.reload){return;}if(args.originator&&args.originator==this){return;}console.log("Home.updatePackages    Calling setPackageCombo()");this.setPackageCombo();},disableUpgrade:function(){var _e42=Agua.getPackages();console.log("plugins.home.Home.disableUpgrade    packages: ");console.dir({packages:_e42});if(_e42==null||_e42.length==0){console.log("plugins.home.Home.disableUpgrade    version is empty. Returning");dojo.removeClass(this.checkVersion,"checkVersion");dojo.addClass(this.checkVersion,"hidden");dojo.addClass(this.packageCombo,"hidden");}},loadPane:function(){var url=this.url;console.log("Home.loadPane    url: "+url);var auth=true;var _e43=this.bottomPane;if(this.bottomPane.id==null){this.bottomPane.id=this.id+"_windowName";}this.windowDeferred=dojox.io.windowName.send("GET",{url:url,handleAs:"text",authElement:_e43,onAuthLoad:auth&&function(){_e43.style.display="block";console.log("Changed authTarget style.display to 'block'");}});this.windowDeferred.addBoth(function(_e44){console.dir({result:_e44});auth&&(_e43.style.display="none");alert(_e44);});},setPackageCombo:function(_e45){console.log("Home.setPackageCombo    packageName: "+_e45);var _e46=Agua.getPackages();console.log("Home.setPackageCombo    BEFORE FILTER packages: ");console.dir({packages:_e46});var _e47=Agua.cookie("username");_e46=this.filterByKeyValues(_e46,["username"],[_e47]);console.log("Home.setPackageCombo    AFTER FILTER packages by username: "+_e47);console.dir({packages:_e46});var _e48=this.hashArrayKeyToArray(_e46,"package");console.log("Home.setPackageCombo    packageNames: "+dojo.toJson(_e48));if(!_e48){console.log("Home.setPackageCombo    packageNames not defined. Returning.");return;}_e48=_e48.sort();var data={identifier:"name",items:[]};for(var i in _e48){data.items[i]={name:_e48[i]};}var _e49=new dojo.data.ItemFileReadStore({data:data});this.packageCombo.store=_e49;if(!_e45){_e45=_e48[_e48.length-1];}console.log("Home.setPackageCombo    SETTING value packageName: "+_e45);this.packageCombo.set("value",_e45);},setSelectiveDialog:function(){var _e4a=function(){};var _e4b=function(){};console.log("Stages.setSelectiveDialog    plugins.files.Stages.setSelectiveDialog()");this.selectiveDialog=new plugins.dijit.SelectiveDialog({title:"",message:"",enterLabel:"Upgrade",cancelLabel:"Cancel",parentWidget:this,enterCallback:_e4a,cancelCallback:_e4b});dojo.addClass(this.selectiveDialog.dialog.domNode,"home");dojo.addClass(this.selectiveDialog.dialog.domNode,"progressPane");dojo.addClass(this.selectiveDialog.dialog.domNode,"home progressPane dojoxDialog dijitDialog");},setSimpleDialog:function(){this.simpleDialog=new dijit.Dialog({});dojo.addClass(this.simpleDialog.domNode,"simpleDialog dijitDialog");dojo.addClass(this.simpleDialog.containerNode,"simpleDialog dijitDialogPaneContent");},setTimer:function(){console.log("Home.setTimer    this.timerInterval: "+this.timerInterval);this.timer=new dojox.timing.Timer;console.log("Home.setTimer    Created this.timer: "+this.timer);this.timer.setInterval(this.timerInterval);},setProgressPane:function(){console.log("plugins.home.Home.setProgressPane");console.dir({progressPane:this.progressPane});dojo.attr(this.progressPane.domNode,"class","home progressPane dojoxDialog dijitDialog");var _e4c=this;this.progressPane.close=dojo.hitch(this,function(){console.log("plugins.home.Home.setProgressPane    this.progressPane.close");this.progressPane.minimize();this.timer.stop();dojo.attr(this.timer,"isRunning",false);});this.progressPane.onDownloadError=dojo.hitch(this,function(){console.log("Home.setProgressPane    this.progressPane.onLoadError");});dojo.connect(this.progressPane,"_onShow",this,"_onShow");},showCurrentVersion:function(){console.log("Home.showCurrentVersion    plugins.home.Home.showCurrentVersion()");var _e4d=this.packageCombo.get("value");console.log("Home.showCurrentVersion    packageName: "+_e4d);var _e4e=this.getPackageObject(_e4d);console.log("Home.showCurrentVersion    AFTER packageObject: "+dojo.toJson(_e4e));this.currentVersion.innerHTML=_e4e.version;},showUpgrades:function(){console.log("Home.showUpgrades    plugins.home.Home.showUpgrades()");var _e4f=this.packageCombo.get("value");console.log("Home.showUpgrades    packageName: "+_e4f);var _e50=this.getPackageObject(_e4f);console.log("Home.showUpgrades    AFTER packageObject: "+dojo.toJson(_e50));if(!_e50.current){console.log("Home.showUpgrades    packageObject.current not defined. Returning");return;}if(_e50.current.length==0){this.showLatestInstalled(_e4f,_e50.version);}else{this.loadSelectiveDialog(_e50);}},loadSelectiveDialog:function(_e51){console.log("Home.loadSelectiveDialog    plugins.files.Home.loadSelectiveDialog(packageObject)");console.log("Home.loadSelectiveDialog    packageObject: "+dojo.toJson(_e51));var _e52=this;var _e53=function(){console.log("Home.loadSelectiveDialog    cancelCallback()");};var _e54=dojo.hitch(this,function(_e55,_e56,_e57,_e58){console.log("Home.loadSelectiveDialog    Doing enterCallback(input, selected, checked, dialogWidget)");console.log("Home.loadSelectiveDialog    input: "+_e55);console.log("Home.loadSelectiveDialog    selected: "+_e56);console.log("Home.loadSelectiveDialog    checked: "+_e57);console.log("Home.loadSelectiveDialog    dialogWidget: "+_e58);setTimeout(function(){_e58.close();},100);_e52.runUpgrade(_e56,_e51);});this.selectiveDialog.load({title:"Current "+_e51["package"]+" version: "+_e51.version,message:"Select upgrade version",comboValues:_e51.current,comboMessage:"Agua version",parentWidget:this,enterCallback:_e54,cancelCallback:_e53,enterLabel:"Upgrade",cancelLabel:"Cancel"});},runUpgrade:function(_e59,_e5a){console.log("Home.runUpgrade    selectedVersion: "+_e59);console.log("Home.runUpgrade    packageObject: "+dojo.toJson(_e5a));console.log("plugins.home.Home.runUpgrade    Doing this.getStandby()");var _e5b=this.getStandby();console.log("plugins.home.Home.runUpgrade    standby: "+_e5b);_e5b.show();var _e5c=this;setTimeout(function(){_e5c.upgrade(_e59,_e5a);},500);},upgrade:function(_e5d,_e5e){_e5e.random=Math.floor(Math.random()*1000000000000);console.log("Home.upgrade    packageObject: "+dojo.toJson(_e5e));var url=Agua.cgiUrl+"workflow.cgi";var _e5f=new Object;_e5f.username=Agua.cookie("username");_e5f.sessionId=Agua.cookie("sessionId");_e5f["package"]=_e5e["package"];_e5f.repository=_e5e["package"];_e5f.version=_e5d;_e5f.privacy=_e5e.privacy;_e5f.owner=_e5e.owner;_e5f.installdir=_e5e.installdir;_e5f.mode="upgrade";_e5f.random=_e5e.random;console.log("packageObject"+dojo.toJson(_e5e));var _e60=this;var _e61=dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:dojo.toJson(_e5f),load:function(_e62,_e63){if(_e62.error!=null){Agua.error("Home.runUpgrade    Error: "+_e62.error);_e60.progressPane.hide();_e60.progressPane.set("innerHTML","");_e60.stopProgress();}else{console.log("Home.runUpgrade    OK");var _e64=this.setLogFile(_e5e);var _e65=_e5e["package"];console.log("Home.upgrade    logfile: "+_e64);console.log("Home.upgrade    packageName: "+_e65);console.log("Home.upgrade    thisObject: "+_e60);console.log("Home.upgrade    thisObject.progressPane: "+_e60.progressPane);var _e66=_e60(_e5e,version);console.log("Home.upgrade    title: "+_e66);_e60.progressPane.set("title",_e66);_e60.progressPane.set("href",_e64);_e60.progressPane.show();_e60.updatePackage(_e5e);}},error:function(_e67,_e68){console.log("plugins.home.Home.runUpgrade    Error with JSON Post, response: "+dojo.toJson(_e67));}});this.showProgress(_e5e,_e5d);this.standby.hide();},updatePackage:function(_e69){Agua.removePackage(_e69);Agua.addPackage(_e69);this.showCurrentVersion();if(!this.timer){return;}this.timer.stop();dojo.attr(this.timer,"isRunning",false);},onClose:function(){console.log("Home.onClose    Home.onClose()");console.log("Home.onClose    ");},showProgress:function(_e6a,_e6b){console.log("Home.showProgress    packageObject: ");console.dir({packageObject:_e6a});console.log("Home.showProgress    version: "+_e6b);var _e6c=this.setLogFile(_e6a);console.log("Home.showProgress    logfile: "+_e6c);var _e6d=this.setTitle(_e6a,_e6b);console.log("Home.showProgress    title: "+_e6d);this.progressPane.set("title",_e6d);this.progressPane.set("href",_e6c);this.progressPane.show();this.resizeProgress();this.pollProgress(_e6c,_e6b,_e6a);dojo.connect(this.progressPane,"close",dojo.hitch(this,"stopProgress"));dojo.connect(this.progressPane,"minimize",dojo.hitch(this,"stopProgress"));dojo.connect(this.progressPane,"resize",dojo.hitch(this,"startProgress"));},setLogFile:function(_e6e){return "log/"+_e6e["package"]+"-upgradelog."+_e6e.random+".html";},setTitle:function(_e6f,_e70){var _e71=_e6f["package"];var _e72=_e71+" "+_e70+" upgrade log";return _e72;},stopProgress:function(){console.log("Home.stopProgress    Home.stopProgress()");console.dir({timer:this.timer});if(this.timer==null){return;}if(dojo.attr(this.timer,"isRunning")==false){return;}console.log("Home.stopProgress    Doing this.timer.stop()");dojo.attr(this.timer,"isRunning",false);this.timer.stop();this.timer.interval=999999999999;this.timer.onTick=function(){console.log("Home.stopProgress    timer.onTick()");};console.log("Home.stopProgress    Doing window.clearInterval(this.timer.timer)");window.clearInterval(this.timer.timer);},startProgress:function(){this.timer.interval=this.timerInterval;console.log("Home.startProgress    timer:");console.dir({timer:this.timer});if(dojo.attr(this.timer,"isRunning")==true){return;}console.log("Home.startProgress    Doing this.timer.start()");dojo.attr(this.timer,"isRunning",true);this.timer.start();this.resizeProgress();},resizeProgress:function(){if(!this.progressPane){return;}var node=this.progressPane.domNode;var _e73=dojo.window.getBox();var _e74=dojo._getBorderBox(node);l=Math.floor(_e73.l+(_e73.w-_e74.w)/2);t=Math.floor(_e73.t+(_e73.h-_e74.h)/2);var _e75={left:l+"px",top:t+"px"};dojo.style(node,_e75);},pollProgress:function(url,_e76,_e77){console.log("Home.pollProgress    Home.pollProgress(url, version)");console.log("Home.pollProgress    url: "+url);console.log("Home.pollProgress    version: "+_e76);this.packageObject=_e77;var _e78=this;this.timer.onTick=function(){console.log("Home.pollProgress    timer onTick: "+new Date().toTimeString());_e78.progressPane.set("href","");_e78.progressPane.set("href",url);_e78.progressPane.show();};this.timer.start();dojo.attr(this.timer,"isRunning",true);},reportedVersion:function(){console.log("Home.reportedVersion    plugins.home.Home.reportedVersion");var _e79=this.progressPane.containerNode.innerHTML;var _e7a;var _e7b=_e79.match(/Completed installation, version:\s*(\S+)/);if(_e7b){_e7a=_e7b[1];}console.log("Home.reportedVersion    version: "+_e7a);return _e7a;},_onShow:function(){console.log("Home.setProgressPane    this.progressPane._onShow");var _e7c=this;setTimeout(function(){var _e7d=_e7c.progressPane.containerNode.innerHTML;console.dir({report:_e7d});var _e7e=_e7c.reportedVersion();if(_e7e){console.log("Home._onShow    reportedVersion is defined: "+_e7e+". Stopping timer");_e7c.stopProgress();_e7c.packageObject.version=_e7e;_e7c.setVersion(_e7c.packageObject);Agua.updater.update("updatePackages",{originator:_e7c});}},2000);},setVersion:function(_e7f){console.log("Home.setVersion    packagObject: "+dojo.toJson(_e7f,true));Agua.removePackage(_e7f);Agua.addPackage(_e7f);this.setPackageCombo(_e7f["package"]);this.showCurrentVersion();},getStandby:function(){console.log("Stages.getStandby    Stages.getStandby()");if(this.standby==null){var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.bottomPane,onClick:"reload",text:"Running upgrade",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);}console.log("Stages.getStandby    this.standby: "+this.standby);return this.standby;},newWindow:function(){console.log("plugins.home.Home.newWindow    Home.newWindow()");var url=window.location;window.open(location,"_blank","toolbar=1,location=0,directories=0,status=0,menubar=1,scrollbars=1,resizable=1,navigation=0");},parseVersion:function(_e80){var _e81={};if(!_e80.match(/^(\d+)\.(\d+)\.(\d+)(-)?(\S+)?$/)){return;}else{_e81.major=parseInt(_e80.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[1]);_e81.minor=parseInt(_e80.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[2]);_e81.patch=parseInt(_e80.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[3]);_e81.release=_e80.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[4];_e81.build=_e80.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[5];if(_e81.release){_e81.release=_e81.release.replace(/^-/,"");}if(_e81.build){_e81.build=_e81.build.replace(/^\+/,"");}}return _e81;},returnValue:function(_e82){return _e82;},compareStringNumber:function(a,b){if(!a.match(/^(\D+)(\d+)$/)&&!b.match(/^(\D+)(\d+)$/)){var _e83=a.toLowerCase().localeCompare(b.toLowerCase());return _e83;}else{var _e84=this.splitStringNumber(a);var _e85=this.splitStringNumber(b);if(_e84.string!=_e85.string){var _e83=a.toLowerCase().localeCompare(b.toLowerCase());this.returnValue(_e83);}else{if(!_e84.number&&!_e85.number){this.returnValue(0);}else{if(_e84.number&&!_e85.number){this.returnValue(1);}else{if(_e85.number&&!_e84.number){this.returnValue(-1);}else{if(parseInt(_e84.number)>parseInt(_e85.number)){return 1;}else{if(parseInt(_e85.number)>parseInt(_e84.number)){return -1;}else{this.returnValue(0);}}}}}}}return null;},splitStringNumber:function(_e86){var _e87=new Object;_e87.string=_e86.match(/^(\D+)/)[1];if(_e86.match(/^(\D+)(\d+)$/)){_e87.number=_e86.match(/^(\D+)(\d+)$/)[2];}return _e87;},destroyRecursive:function(){console.log("Home.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}},showLatestInstalled:function(_e88,_e89){console.dir({simpleDialog:this.simpleDialog});this.simpleDialog.titleNode.innerHTML="Latest version of "+_e88+" is installed (version "+_e89+")";this.simpleDialog.show();},getPackageObject:function(_e8a){var _e8b=Agua.getPackages();console.dir({packages:_e8b});for(var i=0;i<_e8b.length;i++){if(_e8b[i]["package"]==_e8a){return _e8b[i];break;}}return;},laterVersions:function(_e8c){for(var i=0;i<_e8c.length;i++){var _e8d=_e8c[i].version;var _e8e=_e8c[i].current;for(var k=0;k<_e8e.length;k++){console.log("laterVersions    versionarray["+k+"]: "+_e8e[k]);if(_e8e[k]==_e8d){_e8e.splice(k,1);break;}else{_e8e.splice(k,1);k--;}}}return _e8c;},sortVersions:function(_e8f){console.log("Home.sortVersions    versions: "+dojo.toJson(_e8f));var _e90=this;var _e91=function(a,b){var _e92=_e90.parseVersion(a);var _e93=_e90.parseVersion(b);if(_e92.major>_e93.major){return _e90.returnValue(1);}else{if(_e93.major>_e92.major){return _e90.returnValue(-1);}}if(_e92.minor>_e93.minor){return _e90.returnValue(1);}else{if(_e93.minor>_e92.minor){return _e90.returnValue(-1);}}if(_e92.patch>_e93.patch){return _e90.returnValue(1);}else{if(_e93.patch>_e92.patch){return _e90.returnValue(-1);}}if(!_e92.release&&!_e93.release&&!_e92.build&&!_e93.build){return _e90.returnValue(0);}if(_e92.release&&!_e93.release){return _e90.returnValue(1);}if(_e93.release&&!_e92.release){return _e90.returnValue(-1);}if(_e92.release&&_e93.release){return _e90.compareStringNumber(_e92.release,_e93.release);}if(_e92.build&&!_e93.build){return _e90.returnValue(1);}if(_e93.build&&!_e92.build){return _e90.returnValue(-1);}if(_e92.build&&_e93.build){return _e90.compareStringNumber(_e92.build,_e93.build);}return _e90.returnValue(0);};_e8f=_e8f.sort(_e91);return _e8f;}});}if(!dojo._hasResource["plugins.home.Controller"]){dojo._hasResource["plugins.home.Controller"]=true;dojo.provide("plugins.home.Controller");dojo.declare("plugins.home.Controller",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"homeIcon\"\n        type=\"button\"\n        label=\"Home\"\n    >\n    </button>\n\n</div>\n        \n",widgetsInTemplate:true,cssFiles:["plugins/home/css/controller.css"],tabPanes:[],constructor:function(args){console.log("Controller.constructor     plugins.home.Controller.constructor");this.loadCSS();},postCreate:function(){console.log("Controller.postCreate    plugins.home.Controller.postCreate()");this.startup();},startup:function(){console.log("Controller.startup    plugins.home.Controller.startup()");this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _e94=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(args){console.log("Controller.createTab    plugins.home.Controller.createTab");if(args==null){args=new Object;}args.attachWidget=Agua.tabs;var _e95=new plugins.home.Home(args);this.tabPanes.push(_e95);this._supportingWidgets.push(_e95);return _e95;}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["dijit.dijit"]){dojo._hasResource["dijit.dijit"]=true;dojo.provide("dijit.dijit");}if(!dojo._hasResource["dijit.form.HorizontalSlider"]){dojo._hasResource["dijit.form.HorizontalSlider"]=true;dojo.provide("dijit.form.HorizontalSlider");dojo.declare("dijit.form.HorizontalSlider",[dijit.form._FormValueWidget,dijit._Container],{templateString:dojo.cache("dijit.form","templates/HorizontalSlider.html","<table class=\"dijit dijitReset dijitSlider dijitSliderH\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"topDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><div class=\"dijitReset dijitSliderBarContainerH\" role=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableH\"\n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleH\" dojoAttachEvent=\"onmousedown:_onHandleClick\" role=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"containerNode,bottomDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n"),value:0,showButtons:true,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:true,slideDuration:dijit.defaultDuration,widgetsInTemplate:true,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{id:""}),baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_startingPixelCount:"l",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyUp:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey||e.metaKey){return;}this._setValueAttr(this.value,true);},_onKeyPress:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey||e.metaKey){return;}switch(e.charOrCode){case dojo.keys.HOME:this._setValueAttr(this.minimum,false);break;case dojo.keys.END:this._setValueAttr(this.maximum,false);break;case ((this._descending||this.isLeftToRight())?dojo.keys.RIGHT_ARROW:dojo.keys.LEFT_ARROW):case (this._descending===false?dojo.keys.DOWN_ARROW:dojo.keys.UP_ARROW):case (this._descending===false?dojo.keys.PAGE_DOWN:dojo.keys.PAGE_UP):this.increment(e);break;case ((this._descending||this.isLeftToRight())?dojo.keys.LEFT_ARROW:dojo.keys.RIGHT_ARROW):case (this._descending===false?dojo.keys.UP_ARROW:dojo.keys.DOWN_ARROW):case (this._descending===false?dojo.keys.PAGE_UP:dojo.keys.PAGE_DOWN):this.decrement(e);break;default:return;}dojo.stopEvent(e);},_onHandleClick:function(e){if(this.disabled||this.readOnly){return;}if(!dojo.isIE){dijit.focus(this.sliderHandle);}dojo.stopEvent(e);},_isReversed:function(){return !this.isLeftToRight();},_onBarClick:function(e){if(this.disabled||this.readOnly||!this.clickSelect){return;}dijit.focus(this.sliderHandle);dojo.stopEvent(e);var _e96=dojo.position(this.sliderBarContainer,true);var _e97=e[this._mousePixelCoord]-_e96[this._startingPixelCoord];this._setPixelValue(this._isReversed()?(_e96[this._pixelCount]-_e97):_e97,_e96[this._pixelCount],true);this._movable.onMouseDown(e);},_setPixelValue:function(_e98,_e99,_e9a){if(this.disabled||this.readOnly){return;}_e98=_e98<0?0:_e99<_e98?_e99:_e98;var _e9b=this.discreteValues;if(_e9b<=1||_e9b==Infinity){_e9b=_e99;}_e9b--;var _e9c=_e99/_e9b;var _e9d=Math.round(_e98/_e9c);this._setValueAttr((this.maximum-this.minimum)*_e9d/_e9b+this.minimum,_e9a);},_setValueAttr:function(_e9e,_e9f){this._set("value",_e9e);this.valueNode.value=_e9e;dijit.setWaiState(this.focusNode,"valuenow",_e9e);this.inherited(arguments);var _ea0=(_e9e-this.minimum)/(this.maximum-this.minimum);var _ea1=(this._descending===false)?this.remainingBar:this.progressBar;var _ea2=(this._descending===false)?this.progressBar:this.remainingBar;if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}if(_e9f&&this.slideDuration>0&&_ea1.style[this._progressPixelSize]){var _ea3=this;var _ea4={};var _ea5=parseFloat(_ea1.style[this._progressPixelSize]);var _ea6=this.slideDuration*(_ea0-_ea5/100);if(_ea6==0){return;}if(_ea6<0){_ea6=0-_ea6;}_ea4[this._progressPixelSize]={start:_ea5,end:_ea0*100,units:"%"};this._inProgressAnim=dojo.animateProperty({node:_ea1,duration:_ea6,onAnimate:function(v){_ea2.style[_ea3._progressPixelSize]=(100-parseFloat(v[_ea3._progressPixelSize]))+"%";},onEnd:function(){delete _ea3._inProgressAnim;},properties:_ea4});this._inProgressAnim.play();}else{_ea1.style[this._progressPixelSize]=(_ea0*100)+"%";_ea2.style[this._progressPixelSize]=((1-_ea0)*100)+"%";}},_bumpValue:function(_ea7,_ea8){if(this.disabled||this.readOnly){return;}var s=dojo.getComputedStyle(this.sliderBarContainer);var c=dojo._getContentBox(this.sliderBarContainer,s);var _ea9=this.discreteValues;if(_ea9<=1||_ea9==Infinity){_ea9=c[this._pixelCount];}_ea9--;var _eaa=(this.value-this.minimum)*_ea9/(this.maximum-this.minimum)+_ea7;if(_eaa<0){_eaa=0;}if(_eaa>_ea9){_eaa=_ea9;}_eaa=_eaa*(this.maximum-this.minimum)/_ea9+this.minimum;this._setValueAttr(_eaa,_ea8);},_onClkBumper:function(val){if(this.disabled||this.readOnly||!this.clickSelect){return;}this._setValueAttr(val,true);},_onClkIncBumper:function(){this._onClkBumper(this._descending===false?this.minimum:this.maximum);},_onClkDecBumper:function(){this._onClkBumper(this._descending===false?this.maximum:this.minimum);},decrement:function(e){this._bumpValue(e.charOrCode==dojo.keys.PAGE_DOWN?-this.pageIncrement:-1);},increment:function(e){this._bumpValue(e.charOrCode==dojo.keys.PAGE_UP?this.pageIncrement:1);},_mouseWheeled:function(evt){dojo.stopEvent(evt);var _eab=!dojo.isMozilla;var _eac=evt[(_eab?"wheelDelta":"detail")]*(_eab?1:-1);this._bumpValue(_eac<0?-1:1,true);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(_ead){if(this[_ead.container]!=this.containerNode){this[_ead.container].appendChild(_ead.domNode);}},this);this.inherited(arguments);},_typematicCallback:function(_eae,_eaf,e){if(_eae==-1){this._setValueAttr(this.value,true);}else{this[(_eaf==(this._descending?this.incrementButton:this.decrementButton))?"decrement":"increment"](e);}},buildRendering:function(){this.inherited(arguments);if(this.showButtons){this.incrementButton.style.display="";this.decrementButton.style.display="";}var _eb0=dojo.query("label[for=\""+this.id+"\"]");if(_eb0.length){_eb0[0].id=(this.id+"_label");dijit.setWaiState(this.focusNode,"labelledby",_eb0[0].id);}dijit.setWaiState(this.focusNode,"valuemin",this.minimum);dijit.setWaiState(this.focusNode,"valuemax",this.maximum);},postCreate:function(){this.inherited(arguments);if(this.showButtons){this._connects.push(dijit.typematic.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500));this._connects.push(dijit.typematic.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));}this.connect(this.domNode,!dojo.isMozilla?"onmousewheel":"DOMMouseScroll","_mouseWheeled");var _eb1=dojo.declare(dijit.form._SliderMover,{widget:this});this._movable=new dojo.dnd.Moveable(this.sliderHandle,{mover:_eb1});this._layoutHackIE7();},destroy:function(){this._movable.destroy();if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}this._supportingWidgets=dijit.findWidgets(this.domNode);this.inherited(arguments);}});dojo.declare("dijit.form._SliderMover",dojo.dnd.Mover,{onMouseMove:function(e){var _eb2=this.widget;var _eb3=_eb2._abspos;if(!_eb3){_eb3=_eb2._abspos=dojo.position(_eb2.sliderBarContainer,true);_eb2._setPixelValue_=dojo.hitch(_eb2,"_setPixelValue");_eb2._isReversed_=_eb2._isReversed();}var _eb4=e.touches?e.touches[0]:e,_eb5=_eb4[_eb2._mousePixelCoord]-_eb3[_eb2._startingPixelCoord];_eb2._setPixelValue_(_eb2._isReversed_?(_eb3[_eb2._pixelCount]-_eb5):_eb5,_eb3[_eb2._pixelCount],false);},destroy:function(e){dojo.dnd.Mover.prototype.destroy.apply(this,arguments);var _eb6=this.widget;_eb6._abspos=null;_eb6._setValueAttr(_eb6.value,true);}});}if(!dojo._hasResource["plugins.init.Init"]){dojo._hasResource["plugins.init.Init"]=true;dojo.provide("plugins.init.Init");dojo.declare("plugins.init.Init",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- init TAB -->\n\t<div\n\t\tdojoAttachPoint=\"initTab\"\n\t\tclass=\"init\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Settings\"\n\t\tstyle=\"text-align: center; max-height: auto !important; min-width: 100% !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table class=\"mainTable\">\n\t\t\t<tr class=\"aguaIconBackground\">\n\t\t\t\t<td align=\"center\" class=\"aguaIcon\"></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td class=\"title\"> Input user information and 'Save' to load data and user volumes </div>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr align=\"center\" width=\"100%\">\n\t\t\t\t<td width=\"100%\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"initTable\"\n\t\t\t\t\t\tclass=\"initTable\"\n\t\t\t\t\t\tstyle=\"height: 800px; \"\n\t\t\t\t\t>\n\t\t\t\t\t\t<table width=\"840px\" align=\"center\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"progressButton\"\n\t\t\t\t\t\t\t\t\tclass=\"progressButton\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:openProgressLog\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tProgress Log\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"saveButton\"\n\t\t\t\t\t\t\t\t\tclass=\"saveButton\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:save\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\" align=\"center\">\n\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"sublabel\">Admin User</td>\n\t\t\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"adminUser\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"adminuser\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"admin\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '[a-z]{5,20}'\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Lowercase letters (5-20)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Lowercase letters (5-20)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trequired=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"sublabel\">Admin Password</td>\n\t\t\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoType=\"plugins.dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"sublabel\">Confirm Password</td>\n\t\t\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoType=\"plugins.dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t</td>\t\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tData Volume\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\t\t\t\tclass=\"dataVolumeContainer\"\n\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\ttitle=\"REQUIRED: Input snapshot ID (to copy) or volume ID (to mount).\nDEFAULT    : Data snapshot for the current version of Agua\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"dataVolume\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"datavolume\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"13\" \n\t\t\t\t\t\t\t\t\t\tvalue=\"snap-6341b301\"\n\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '^(snap|vol)\\-[A-F0-9a-f]{8}'\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Required format: 'snap-abcdef09' or 'vol-abcdef09'\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Enter snapshot or volume ID\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\tclass=\"dataVolumeSizeContainer\"\n\t\t\t\t\t\t\t\t\ttitle=\"Size of data volume (10-1000 GB)\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"dataVolumeSize\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"datavolumesize\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\t\t\tname=\"elevation\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"200\"\n\t\t\t\t\t\t\t\t\t\tconstraints=\"{min:200,max:1000,places:0}\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Valid range: 200-1000 GB\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Valid range: 200-1000 GB\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t<td align=\"left\"\n\t\t\t\t\t\t\t\t\tclass=\"dataVolumeSliderContainer\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"datavolumeslider\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.HorizontalSlider\" \n\t\t\t\t\t\t\t\t\t\tvalue=\"200\"\n\t\t\t\t\t\t\t\t\t\tmaximum=\"1000\"\n\t\t\t\t\t\t\t\t\t\tminimum=\"200\"\n\t\t\t\t\t\t\t\t\t\tpageIncrement=\"10\"\n\t\t\t\t\t\t\t\t\t\tshowButtons=\"true\"\n\t\t\t\t\t\t\t\t\t\tintermediateChanges=\"true\"\n\t\t\t\t\t\t\t\t\t\tslideDuration=\"200\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">\n\t\t\t\t\t\t\t\t\tUser Volume\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\t\t\t\tclass=\"userVolumeContainer\"\n\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\ttitle=\"OPTIONAL: Input snapshot ID (to copy) or volume ID (to mount).\nDEFAULT    : Create a new, empty volume\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggleUserVolume\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"userVolume\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"uservolume\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"13\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '(snap|vol)\\-[A-F0-9a-f]{8}'\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Required format: 'snap-abcdef09' or 'vol-abcdef09'\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Required format: 'snap-abcdef09' or 'vol-abcdef09'\"\n\t\t\t\t\t\t\t\t\t\trequired=\"false\"\n\t\t\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\tclass=\"userVolumeSizeContainer\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"userVolumeSize\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"uservolumesize\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\t\t\tname=\"elevation\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"100\"\n\t\t\t\t\t\t\t\t\t\tconstraints=\"{min:10,max:1000,places:0}\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Valid range: 10-1000 GB\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Valid range: 10-1000 GB\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t<td align=\"left\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"uservolumeslider\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.HorizontalSlider\" \n\t\t\t\t\t\t\t\t\t\tvalue=\"10\"\n\t\t\t\t\t\t\t\t\t\tmaximum=\"1000\"\n\t\t\t\t\t\t\t\t\t\tminimum=\"10\"\n\t\t\t\t\t\t\t\t\t\tpageIncrement=\"10\"\n\t\t\t\t\t\t\t\t\t\tshowButtons=\"true\"\n\t\t\t\t\t\t\t\t\t\tintermediateChanges=\"true\"\n\t\t\t\t\t\t\t\t\t\tslideDuration=\"200\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t\tclass=\"userVolumeSlider\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">\n\t\t\t\t\t\t\t\t\tAmazon User ID\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"amazonUserId\"\n\t\t\t\t\t\t\t\t\t\tsize=\"200\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"amazonuserid\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\tregExp=\"^\\d{12}$\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"12\" \n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Enter your 12-digit Amazon User ID (numbers only)\" \n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Invalid User ID (Must be 12-digits, numbers only).\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\"\n\t\t\t\t\t\t\t\t\t>AWS Access Key ID\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"awsAccessKeyId\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"awsaccesskeyid\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t\t\t\t\t\t\tuppercase=\"true\"\n\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '[A-Z0-9]{16,24}'\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"20 characters: capital letters or numbers\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"20 characters: capital letters or numbers\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">Secret Access Key\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"awssecretaccesskey\"\n\t\t\t\t\t\t\t\t\t\tclass=\"secretAccessKey\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"40\"\n\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '.{35,45}'\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"40 characters\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"40 characters\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">EC2 Private Key</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"-----BEGIN PRIVATE KEY---- ... -----END PRIVATE KEY-----\" \n\t\t\t\t\t\t\t\t\t\tdojoType=\"plugins.form.ValidationTextarea\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ec2privatekey\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ec2privatekey\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-size: 10px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\t\trows=\"14\"\n\t\t\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">EC2 Public Certificate</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tdojoType=\"plugins.form.ValidationTextarea\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"-----BEGIN CERTIFICATE----- ... -----END CERTIFICATE-----\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ec2publiccert\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ec2publiccert\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-size: 10px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\t\trows=\"14\"\n\t\t\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</table>\n\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END init TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:["plugins/init/css/init.css"],parentWidget:null,defaultDataVolume:null,constructor:function(args){this.loadCSS();this.defaultDataVolume=args.dataVolume;console.log("Init.constructor    this.defaultDataVolume: "+this.defaultDataVolume);},postCreate:function(){console.log("Controller.postCreate    plugins.init.Controller.postCreate()");this.startup();},startup:function(){console.log("Init.startup    plugins.init.GroupInit.startup()");this.inherited(arguments);console.log("Init.startup    this.defaultDataVolume: "+this.defaultDataVolume);this.datavolume.set("value",this.defaultDataVolume);dijit.Tooltip.defaultPosition=["above","below"];console.log("Init.startup    BEFORE appendChild(this.initTab.domNode)");dojo.byId("attachPoint").appendChild(this.initTab.domNode);console.log("Init.startup    AFTER appendChild(this.initTab.domNode)");this.disableProgressButton();dojo.connect(this.saveButton,"onClick",dojo.hitch(this,"save"));this.setDataVolumeSlider();this.setUserVolumeSlider();this.setPasswordMatcher();this.setToaster();},save:function(_eb7){console.log("Init.save    event: "+_eb7);if(this.saving==true){console.log("Init.save    this.saving: "+this.saving+". Returning.");return;}this.saving=true;var _eb8=["confirmPassword","amazonuserid","datavolume","uservolume","datavolumesize","uservolumesize","awsaccesskeyid","awssecretaccesskey","ec2publiccert","ec2privatekey"];var _eb9=true;for(var i=0;i<_eb8.length;i++){var _eba=_eb8[i];console.log("Init.save    parameter: "+_eba);console.log("Init.save    this["+_eba+"]: ");console.dir({this_parameter:this[_eba]});var _ebb=this[_eba].isValid(this[_eba].textbox.value);console.log("Init.save    this["+_eba+"] valid: "+_ebb);if(_ebb){console.log("Init.save    VALID!!");this[_eba].state="Incomplete";this[_eba]._setStateClass();}else{console.log("Init.save    NOT VALID. Setting 'Error' state");this[_eba].state="Error";this[_eba]._setStateClass();_eb9=false;}if(_eba=="confirmPassword"){if(_ebb){console.log("Init.save    DOING _setStateClass 'Incomplete' for 'password'");this["password"].state="Incomplete";this["password"]._setStateClass();}else{console.log("Init.save    DOING _setStateClass 'Error' for 'password'");this["password"].state="Error";this["password"]._setStateClass();}}}if(!_ebb){console.log("Init.save    One or more inputs not valid. Returning");this.saving=false;return;}var _ebc=this.uservolume.value;if(_ebc.match(/New volume/)){_ebc="";}var aws=new Object;aws.username=this.adminuser.value;aws.password=this.password.value;aws.amazonuserid=this.cleanEdges(this.amazonuserid.value);aws.datavolume=this.datavolume.value;aws.uservolume=_ebc;aws.datavolumesize=this.datavolumesize.value;aws.uservolumesize=this.uservolumesize.value;aws.ec2publiccert=this.cleanEdges(this.ec2publiccert.value);aws.ec2privatekey=this.cleanEdges(this.ec2privatekey.value);aws.awsaccesskeyid=this.cleanEdges(this.awsaccesskeyid.value);aws.awssecretaccesskey=this.cleanEdges(this.awssecretaccesskey.value);var url=this.cgiUrl+"/init.cgi?";console.log("Init.saveStore     url: "+url);var _ebd=new Object;_ebd.username="agua";_ebd.mode="init";_ebd.data=aws;console.log("Init.save    query: "+dojo.toJson(_ebd));console.dir({query:_ebd});var _ebe=this;dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_ebd),load:function(_ebf,_ec0){console.log("Init.save    response:");console.dir({response:_ebf});_ebe.handleSave(_ebf);},error:function(_ec1,_ec2){console.log("Init.save    Error with JSON Post, response: ");console.dir({response:_ec1});}});this.saving=false;},handleSave:function(_ec3){console.log("Init.handleSave    response: ");console.dir({response:_ec3});if(!_ec3){this.toast({error:"No response from server. If problem persists, restart instance"});return;}this.enableProgressButton();this.toast(_ec3);},openProgressLog:function(){if(dojo.hasClass(this.progressButton,"disabled")){console.log("Init.openProgressLog    DISABLED. returning");return;}window.open("log/initlog.html","_blank","toolbar=1,location=0,directories=0,status=0,menubar=1,scrollbars=1,resizable=1,navigation=0");},disableProgressButton:function(){dojo.addClass(this.progressButton,"disabled");},enableProgressButton:function(){dojo.removeClass(this.progressButton,"disabled");},setTable:function(){console.log("Init.setTable     plugins.init.GroupInit.setTable()");while(this.initTable.firstChild){this.initTable.removeChild(this.initTable.firstChild);}},setDataVolumeSlider:function(){console.log("Init.setDataVolumeSlider     plugins.init.Init.setDataVolumeSlider()");var _ec4=this;dojo.connect(this.datavolumeslider,"onMouseUp",dojo.hitch(this,function(e){console.log("Init.setDataVolumeSlider    onMouseUp fired");var size=parseInt(this.datavolumeslider.getValue());console.log("Init.setDataVolumeSlider    size: "+size);_ec4.datavolumesize.set("value",size);}));},setUserVolumeSlider:function(){console.log("Init.setUserVolumeSlider     plugins.init.Init.setUserVolumeSlider()");var _ec5=this;dojo.connect(this.uservolumeslider,"onMouseUp",dojo.hitch(this,function(e){console.log("Init.setUserVolumeSlider    onMouseUp fired");var size=parseInt(this.uservolumeslider.getValue());console.log("Init.setUserVolumeSlider    size: "+size);_ec5.uservolumesize.set("value",size);}));},setPasswordMatcher:function(){console.log("Init.setPasswordMatcher    this.confirmPassword: "+this.confirmPassword);this.confirmPassword.parentWidget=this;this.password.parentWidget=this;this.password.target=this.confirmPassword;this.confirmPassword.source=this.password;},passwordsMatch:function(){console.log("Settings.confirmPassword    plugins.admin.GroupSettings.confirmPassword()");var _ec6=this.password.textbox.value;console.log("Settings.confirmPassword    password: "+_ec6);var _ec7=this.confirmPassword.textbox.value;console.log("Settings.confirmPassword    confirmPassword: "+_ec7);if(!_ec6){return false;}return _ec6==_ec7;},setAdminPassword:function(){var _ec8=9;var _ec9=this.createRandomHexString(_ec8);console.log("Init.setAdminPassword    password: "+_ec9);},createRandomHexString:function(_eca){var _ecb="";for(var i=0;i<_eca;i++){var _ecc=parseInt(Math.random()*16);var hex=this.decimalToHex(_ecc);if(hex==10){hex=0;}_ecb+=hex;}return _ecb;},decimalToHex:function(_ecd){return Number(_ecd).toString(16);},cleanEdges:function(_ece){if(_ece==null){return null;}_ece=_ece.replace(/^\s+/,"");_ece=_ece.replace(/\s+$/,"");return _ece;},toggleUserVolume:function(_ecf){console.log("Init.toggleUserVolume    this.userVolumeToggled: "+this.userVolumeToggled);if(this.userVolumeToggled){return;}this.userVolumeToggled=true;this.uservolume.set("disabled",false);dojo.addClass(this.uservolume.textbox,"enabled");this.uservolume.textbox.value="";},toggleDataVolume:function(_ed0){console.log("Init.toggleUserVolume    this.dataVolumeToggled: "+this.dataVolumeToggled);if(this.dataVolumeToggled){return;}this.dataVolumeToggled=true;this.datavolume.set("disabled",false);dojo.addClass(this.datavolume.textbox,"enabled");}});}if(!dojo._hasResource["dijit.ProgressBar"]){dojo._hasResource["dijit.ProgressBar"]=true;dojo.provide("dijit.ProgressBar");dojo.declare("dijit.ProgressBar",[dijit._Widget,dijit._Templated],{progress:"0",value:"",maximum:100,places:0,indeterminate:false,label:"",name:"",templateString:dojo.cache("dijit","templates/ProgressBar.html","<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  dojoAttachPoint=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&nbsp;</span\n\t></div\n\t><div dojoAttachPoint=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img dojoAttachPoint=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n"),_indeterminateHighContrastImagePath:dojo.moduleUrl("dijit","themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);if(!("value" in this.params)){this.value=this.indeterminate?Infinity:this.progress;}},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update();},update:function(_ed1){dojo.mixin(this,_ed1||{});var tip=this.internalProgress,ap=this.domNode;var _ed2=1;if(this.indeterminate){dijit.removeWaiState(ap,"valuenow");dijit.removeWaiState(ap,"valuemin");dijit.removeWaiState(ap,"valuemax");}else{if(String(this.progress).indexOf("%")!=-1){_ed2=Math.min(parseFloat(this.progress)/100,1);this.progress=_ed2*this.maximum;}else{this.progress=Math.min(this.progress,this.maximum);_ed2=this.progress/this.maximum;}dijit.setWaiState(ap,"describedby",this.labelNode.id);dijit.setWaiState(ap,"valuenow",this.progress);dijit.setWaiState(ap,"valuemin",0);dijit.setWaiState(ap,"valuemax",this.maximum);}this.labelNode.innerHTML=this.report(_ed2);dojo.toggleClass(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);tip.style.width=(_ed2*100)+"%";this.onChange();},_setValueAttr:function(v){this._set("value",v);if(v==Infinity){this.update({indeterminate:true});}else{this.update({indeterminate:false,progress:v});}},_setLabelAttr:function(_ed3){this._set("label",_ed3);this.update();},_setIndeterminateAttr:function(_ed4){this.indeterminate=_ed4;this.update();},report:function(_ed5){return this.label?this.label:(this.indeterminate?"&nbsp;":dojo.number.format(_ed5,{type:"percent",places:this.places,locale:this.lang}));},onChange:function(){}});}if(!dojo._hasResource["plugins.login.LoginStatus"]){dojo._hasResource["plugins.login.LoginStatus"]=true;dojo.provide("plugins.login.LoginStatus");dojo.declare("plugins.login.LoginStatus",[dijit._Widget,dijit._Templated],{templateString:"<span dojoAttachPoint=\"containerNode\" >\n\n    <table class=\"loginStatus\">\n        <tr>\n            <td>\n                <div\n                    dojoAttachPoint=\"launcher\"\n                    class=\"launcher\"\n                    >\n                    \n                </div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <div\n                    dojoAttachPoint=\"username\"\n                    class=\"username\"\n                    >\n                </div>\n            </td>\n        </tr>\n    </table>\n    \n\n</span>\n",widgetsInTemplate:true,constructor:function(){console.log("LoginStatus.constructor    plugins.login.LoginStatus.constructor()");this.loadCSS();},postMixInProperties:function(){console.log("LoginStatus.postMixInProperties    plugins.login.LoginStatus.postMixInProperties()");},postCreate:function(){console.log("LoginStatus.postCreate    plugins.login.LoginStatus.postCreate()");this.startup();},startup:function(){console.log("LoginStatus.startup    plugins.login.LoginStatus.startup()");this.inherited(arguments);},loadCSS:function(){console.log("LoginStatus.loadCSS    plugins.login.LoginStatus.loadCSS()");var _ed6=[dojo.moduleUrl("plugins")+"login/css/loginstatus.css",dojo.moduleUrl("plugins")+"login/css/login.css"];for(var i in _ed6){var _ed7=_ed6[i];console.log("LoginStatus.loadCSS    cssFile: "+_ed7);var _ed8=document.createElement("link");_ed8.type="text/css";_ed8.rel="stylesheet";_ed8.href=_ed7;_ed8.media="screen";document.getElementsByTagName("head")[0].appendChild(_ed8);}}});}if(!dojo._hasResource["plugins.login.Login"]){dojo._hasResource["plugins.login.Login"]=true;dojo.provide("plugins.login.Login");dojo.declare("plugins.login.Login",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\" class=\"login\">\n\n    <div\n        dojoAttachPoint=\"loginDialogue\"\n        class=\"loginDialogue\"\n        label=\"Login\"\n        class=\"login\"\n        modal=\"true\"\n        dojoType=\"dojox.widget.Dialog\"\n        style=\"overflow: visible; position: absolute; top: 240px; left: 248px; opacity: 1; width: 300px; height: 300px; align: center;\"\n        title=\"Agua Login\"\n        >\n        \n        <table align=\"center\" width=\"100%\">\n\n            <tr align=\"center\" width=\"100%\">\n                <td colspan=\"2\" class=\"loginIcon\"></td>\n            </tr>\n\n            <tr\n                dojoAttachPoint=\"nameRow\"\n                align=\"center\">\n                <td align=\"right\">Username</td>\n                <td align=\"left\">\n                    <div\n                        dojoAttachPoint=\"username\"\n                        class=\"username\"\n                        value=\"\"\n                        dojoType=\"dijit.form.TextBox\"\n                        style=\"width: 100px\"\n                        value=\"testuser\"\n                        >testuser\n                    </div>\n                </td>\n            </tr>\n            <tr\n                dojoAttachPoint=\"passwordRow\"\n                align=\"center\">\n                <td align=\"right\">Password</td>\n                <td align=\"left\">\n                    <div\n                        dojoAttachPoint=\"password\"\n                        class=\"password\"\n                        value=\"\"\n                        type=\"password\"\n                        dojoType=\"dijit.form.TextBox\"\n                        style=\"width: 100px\"\n                        value=\"testuser\"\n                        >testuser\n                    </div>\n                </td>\n            </tr>\n            <tr\n                dojoAttachPoint=\"buttonRow\"\n                class=\"loginCenteredRow\">\n                <td align=\"center\" colspan=\"2\">\n                    <div\n                        dojoAttachPoint=\"loginButton\"\n                        dojoAttachEvent=\"onclick:login\"\n                        class=\"loginButton\"\n                        >Login</div>\n                </td>\n            </tr>\n            <tr class=\"loginCenteredRow\">\n                <td align=\"center\" colspan=\"2\">\n                    <div\n                        dojoAttachPoint=\"message\"\n                        colspan=\"2\">\n                    </div>\n                </td>\n            </tr>\n            <tr class=\"loginCenteredRow\">\n                <td align=\"center\" colspan=\"2\">\n                    <div\n                        dojoAttachPoint=\"progressBar\"\n                        class=\"progressBar\"\n                        dojoType=\"dijit.ProgressBar\"\n                        colspan=\"2\">\n                    </div>\n                </td>\n            </tr>\n        </table>\n    \n    </div>\n</div>\n",widgetsInTemplate:true,loginMessage:"",cssFiles:[dojo.moduleUrl("plugins")+"login/css/login.css",dojo.moduleUrl("dojox")+"widget/Dialog/Dialog.css",dojo.moduleUrl("dijit")+"themes/claro/claro.css"],logging:false,constructor:function(){console.log("Login.constructor    plugins.login.Login.constructor()");this.loadCSS();this.statusBar=new plugins.login.LoginStatus();this.statusBar.launcher.innerHTML="Log In";var _ed9=dojo.connect(this.statusBar.launcher,"onclick",this,"show");this.statusBar.launcher.listener=_ed9;document.getElementById("loginHolder").appendChild(this.statusBar.containerNode);},postCreate:function(){console.log("Login.postCreate    plugins.workflow.Login.postCreate()");this.startup();},startup:function(){console.log("Login.startup    plugins.workflow.Login.startup()");this.inherited(arguments);dojo.addClass(this.domNode,"login");this.setDialogListeners();this.setProgressBar();var data=this.debug();if(data){this.handleLogin(data,data.username);return;}this.show();},debug:function(){var url=window.location.href;console.log("Login.debug    url: "+url);if(!url.match(/(.+?)\?([^\?]+),([^,]+)/)){console.log("Login.debug    Not debugging. Setting this.debugFlag to FALSE and returning");return false;}console.log("Login.debug    Debugging");var _eda=url.match(/(.+?)\?([^\?]+?),([^,]+)/)[2];var _edb=url.match(/(.+?)\?([^\?]+?),([^,]+)/)[3];var _edc;if(url.match(/(.+?)\?([^\?]+),([^,]+?),([^,]+)$/)){_edc=url.match(/(.+?)\?([^\?]+),([^,]+),([^,]+)$/)[4];}console.log("Login.debug    plugins: "+dojo.toJson(_edc));if(_edc!=null){var _edd=_edc.split(/\./);console.log("Login.debug    array: "+dojo.toJson(_edd));var _ede=new Array;for(var i=0;i<_edd.length;i++){_ede[i]="plugins.";_ede[i]+=_edd[i];_ede[i]+=".Controller";}Agua.pluginsList=_ede;}console.log("Login.debug    this.pluginsList: "+dojo.toJson(Agua.pluginsList));var data={};data.username=_eda;data.sessionId=_edb;return data;},setDialogListeners:function(){var _edf=this;dojo.connect(this.username,"onKeyPress",function(_ee0){var key=_ee0.charOrCode;_ee0.stopPropagation();if(key==13){_edf.password.focus();}});var _edf=this;dojo.connect(this.password,"onKeyPress",function(_ee1){var key=_ee1.charOrCode;_ee1.stopPropagation();if(key==13){_edf.login();}if(key==dojo.keys.ESCAPE){dojo.fadeOut({node:"loginDialogue",duration:500}).play();_edf.loginDialogue.hide();}});},setProgressBar:function(){this.hideProgressBar();},show:function(){console.log("Login.show    plugins.login.Login.show()");dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");dojo.addClass(this.loginDialogue.domNode,"login");dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");if(this.loginDialogue==null){console.log("Login.show    this.loginDialogue == null. Returning.");return;}this.showInputs();this.message.innerHTML=this.loginMessage;console.log("Login.show    DOING this.loginDialogue.show()");this.loginDialogue.show();},hide:function(){console.log("Login.hide     plugins.login.Login.hide()");console.log("Login.hide    Doing dojo.style(this.domNode, opacity, 0)");dojo.style(this.domNode,"opacity",0);console.log("Login.hide    HIDE DIALOGUE");this.loginDialogue.hide();console.log("Login.hide    RESETTING CSS to default");dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");dojo.removeClass(this.message,"loading");console.log("Login.hide    RESETTING this.message to default");this.message.innerHTML="Loaded";},login:function(){console.log("Login.login     this.logging: "+this.logging);if(this.logging){console.log("Login.login     Returning.");return;}console.log("Login.login    Setting this.logging to TRUE");this.logging=true;var _ee2=this.username.get("value");var _ee3=this.password.get("value");if(_ee3==null||_ee3==""){return;}this.setLoginStyle();Agua.cookie("sessionId",null);Agua.cookie("username",null);var _ee4=new Object;_ee4.username=_ee2;_ee4.password=_ee3;_ee4.mode="submitLogin";console.log("Login.login     query: "+dojo.toJson(_ee4));var url=Agua.cgiUrl+"workflow.cgi";console.log("Login.login     url: "+url);console.log("Login.login    BEFORE xhrPut");console.log("Login.login    Agua.cookie('username'): "+Agua.cookie("username"));console.log("Login.login    Agua.cookie('sessionId'): "+Agua.cookie("sessionId"));var _ee5=this;var _ee6=dojo.xhrPut({url:url,contentType:"json",handleAs:"json",sync:true,putData:dojo.toJson(_ee4),preventCache:true,handle:function(_ee7){if(_ee7.error){console.log("Login.login    Error. Setting this.logging to FALSE");_ee5.logging=false;dojo.addClass(_ee5.message,"error");_ee5.message.innerHTML="Invalid username and password";_ee5.showInputs();}else{_ee5.handleLogin(_ee7,_ee2);}},error:function(_ee8,_ee9){console.log("Login.login    Response is NULL. Setting this.logging to FALSE");_ee5.logging=false;}});console.log("Login.login    After xhrPut");},setLoginStyle:function(){this.hideInputs();dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");this.message.innerHTML="Authenticating...";console.log("Login.setLoginStyle    Doing progress bar removeClass 'inactive'");console.dir({login:this});console.dir({progressBar:this.progressBar});},showProgressBar:function(){console.log("Login.showProgess    Doing progress bar removeClass 'inactive'");dojo.removeClass(this.progressBar.domNode,"inactive");this.message.innerHTML="Loading Agua...";},hideProgressBar:function(){console.log("Login.hideProgess    Doing progress bar addClass 'inactive'");dojo.addClass(this.progressBar.domNode,"inactive");},showInputs:function(){console.log("Login.showInputs    DOING dojo.addClass(this.xxxRow, 'hidden')");dojo.removeClass(this.nameRow,"hidden");dojo.removeClass(this.passwordRow,"hidden");dojo.removeClass(this.buttonRow,"hidden");dojo.removeClass(this.message,"loading");},hideInputs:function(){console.log("Login.hideInputs    DOING dojo.removeClass(this.xxxRow, 'hidden')");dojo.addClass(this.nameRow,"hidden");dojo.addClass(this.passwordRow,"hidden");dojo.addClass(this.buttonRow,"hidden");},setLogoutStyle:function(){console.log("Logout.setLogoutStyle    Getting ");this.message.innerHTML=this.loginMessage;dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");this.statusBar.username.innerHTML="Logged out";this.statusBar.launcher.innerHTML="Log In";},setLoading:function(){dojo.addClass(this.message,"loading");this.message.innerHTML="Loading Agua";},handleLogin:function(data,_eea){console.log("Login.handleLogin     xhrPut data Json: "+dojo.toJson(data));this.showProgressBar();this.password.set("value","");if(data.error!=null){console.log("Login.handleLogin    Login error: "+data.error);console.log("Login.handleLogin    DOING this.showInputs()");this.showInputs();dojo.addClass(this.message,"error");this.message.innerHTML=data.error;}else{console.log("Login.handleLogin    Successful login");console.log("Login.handleLogin    data: "+dojo.toJson(data));Agua.cookie("sessionId",data.sessionId);Agua.cookie("username",_eea);console.log("Login.handleLogin    username: "+_eea);console.log("Login.handleLogin    sessionId: "+data.sessionId);dojo.removeClass(this.message,"error");dojo.addClass(this.message,"accepted");this.message.innerHTML="Accepted";var _eeb;setTimeout(function(_eec){console.log("Login.handleLogin    setTimeout    Setting message to 'Loading Agua'");_eec.setLoading();},1000,this);this.statusBar.username.innerHTML="<span class='label'></span> "+_eea;this.statusBar.launcher.innerHTML="Log Out";dojo.disconnect(this.statusBar.launcher.listener);var _eed=dojo.connect(this.statusBar.launcher,"onclick",this,"logout");this.statusBar.launcher.listener=_eed;console.log("Login.handleLogin    DOING setTimeout( Agua.startPlugins(), 100)");setTimeout(function(_eee){Agua.startPlugins();_eee.hideProgressBar();},100,this);console.log("Login.login    Setting this.logging to FALSE");this.logging=false;setTimeout(function(_eef){dojo.fadeOut({node:_eef.loginDialogue.domNode,duration:10}).play();_eef.hide();_eef.logging=false;},100,this);}},logout:function(e){Agua.cookie("sessionId",null);Agua.cookie("username",null);this.setLogoutStyle();dojo.disconnect(this.statusBar.launcher.listener);var _ef0=dojo.connect(this.statusBar.launcher,"onclick",this,"show");this.statusBar.launcher.listener=_ef0;Agua.logout();}});}if(!dojo._hasResource["plugins.login.Controller"]){dojo._hasResource["plugins.login.Controller"]=true;dojo.provide("plugins.login.Controller");dojo.declare("plugins.login.Controller",[],{login:null,constructor:function(args){console.log("Controller.constructor     plugins.login.Controller.constructor");this.loadCSS();},loadCSS:function(){console.log("Controller.loadCSS    Loading CSS FILES");var _ef1=[dojo.moduleUrl("plugins")+"login/css/login.css"];for(var i in _ef1){var _ef2=_ef1[i];var _ef3=document.createElement("link");_ef3.type="text/css";_ef3.rel="stylesheet";_ef3.href=_ef2;_ef3.media="screen";document.getElementsByTagName("head")[0].appendChild(_ef3);}}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.sharing.AccessRow"]){dojo._hasResource["plugins.sharing.AccessRow"]=true;dojo.provide("plugins.sharing.AccessRow");dojo.declare("plugins.sharing.AccessRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<table>\n    \n    <tr dojoAttachPoint=\"row\">\n        <td \n            colspan=\"1\"\n            dojoAttachPoint=\"groupname\"\n            class=\"narrowColumn\"\n            title=\"Special file groupnames, e.g., FASTA, FASTQ\"\n        >${groupname}</td>\n        <td \n            colspan=\"1\"\n            dojoAttachPoint=\"groupwrite\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"Special file groupwrites, e.g., FASTA, FASTQ\"\n            value=\"groupwrite\"\n        ></td>\n        <td\n            colspan=\"1\"\n            dojoAttachPoint=\"groupcopy\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"User can groupcopy data and workflows in this group\"\n            value=\"groupcopy\"\n        ></td>\n        <td\n            colspan=\"1\"\n            dojoAttachPoint=\"groupview\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"User can groupview data and workflows in this group\"\n            value=\"groupview\"\n        ></td>\n        <td \n            colspan=\"1\"\n            dojoAttachPoint=\"worldwrite\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"Special file worldwrites, e.g., FASTA, FASTQ\"\n            value=\"worldwrite\"\n        ></td>\n        <td\n            colspan=\"1\"\n            dojoAttachPoint=\"worldcopy\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"User can worldcopy data and workflows in this group\"\n            value=\"worldcopy\"\n        ></td>\n        <td\n            colspan=\"1\"\n            dojoAttachPoint=\"worldview\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"User can worldview data and workflows in this group\"\n            value=\"worldview\"\n        ></td>\n    </tr>\n\n</table>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,args:null,constructor:function(args){this.args=args;},postCreate:function(){this.rights=this.parentWidget.rights;this.startup();},startup:function(){this.inherited(arguments);for(var _ef4 in this.rights){var _ef5=this.rights[_ef4];if(this.args[_ef5]==1){dojo.addClass(this[_ef5],"allowed");}else{dojo.addClass(this[_ef5],"denied");}}},toggle:function(_ef6){var _ef7=dojo.attr(_ef6.target,"value");_ef6.stopPropagation();var _ef8="group";if(_ef7.match(/^world/)){_ef8="world";}var _ef9;if(_ef7.match(/^group/)){_ef9=_ef7.replace(/^group/,"");}if(_ef7.match(/^world/)){_ef9=_ef7.replace(/^world/,"");}var _efa="allowed";var _efb="denied";if(dojo.hasClass(this[_ef7],"allowed")){_efa="denied";_efb="allowed";}this.descendingOwnership(_ef8,_ef9,_efa,_efb);if(_ef8=="world"&&_efa=="allowed"){var _efc=false;this.descendingOwnership("group",_ef9,_efa,_efb,_efc);}},descendingOwnership:function(_efd,_efe,_eff,_f00,_f01){if(_f01==null){_f01=true;}if(_efe=="write"){this.setClasses(_efd,"write",_eff,_f00);this.setClasses(_efd,"copy",_eff,_f00);this.setClasses(_efd,"view",_eff,_f00);}if(_efe=="copy"){this.setClasses(_efd,"view",_eff,_f00);this.setClasses(_efd,"copy",_eff,_f00);if(_eff=="denied"){this.setClasses(_efd,"write",_eff,_f00);}else{if(_f01==true){this.setClasses(_efd,"write",_f00,_eff);}}}if(_efe=="view"){this.setClasses(_efd,"view",_eff,_f00);if(_eff=="denied"&&_f01==true){this.setClasses(_efd,"write",_eff,_f00);this.setClasses(_efd,"copy",_eff,_f00);}else{if(_f01==true){this.setClasses(_efd,"write",_f00,_eff);this.setClasses(_efd,"copy",_f00,_eff);}}}},setClasses:function(_f02,_f03,_f04,_f05){dojo.addClass(this[_f02+_f03],_f04);dojo.removeClass(this[_f02+_f03],_f05);}});}if(!dojo._hasResource["plugins.sharing.Access"]){dojo._hasResource["plugins.sharing.Access"]=true;dojo.provide("plugins.sharing.Access");dojo.declare("plugins.sharing.Access",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- access TAB -->\n\t<div\n\t\tdojoAttachPoint=\"accessTab\"\n\t\tclass=\"access\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Access\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\t\t\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"7\" class=\"tabTitle\" align=\"center\"> Access </td>\n\t\t\t</tr>\n\t\t</table>\n\t\t<table class=\"saveButtonTable\">\n\t\t\t<tr>\n\t\t\t\t<td \n\t\t\t\t\tcolspan=\"11\"\n\t\t\t\t\talign=\"center\"\n\t\t\t\t\tclass=\"saveButton\"\n\t\t\t\t\tdojoAttachPoint=\"saveButton\"\n\t\t\t\t\tdojoAttachEvent=\"onclick:saveAccess\"\n\t\t\t\t>\n\t\t\t\t\tSave\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t\t<div\n\t\t\tclass=\"dragSource\"\n\t\t\tstyle=\"height: 600px; width: 96%;\"\n\t\t>\n\t\t\t<table class=\"permissionsTable\"\n\t\t\t\t   dojoAttachPoint='table'>\n\t\t\t\t<tr class=\"header\">\n\t\t\t\t\t<td >Group</td>\n\t\t\t\t\t<td colspan=\"3\" class=\"headerBold\">Group</td>\n\t\t\t\t\t<td colspan=\"3\" class=\"headerBold\">World</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"subheader\">\n\t\t\t\t\t<td class=\"narrowColumn\" colspan=\"1\"> </td>\n\t\t\t\t\t<td class=\"narrowColumn\">Write</td>\n\t\t\t\t\t<td class=\"narrowColumn\">Copy</td>\n\t\t\t\t\t<td class=\"narrowColumn\">View</td>\n\t\t\t\t\t<td class=\"narrowColumn\">Write</td>\n\t\t\t\t\t<td class=\"narrowColumn\">Copy</td>\n\t\t\t\t\t<td class=\"narrowColumn\">View</td>\n\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t</table>\n\t\t</div>\t\t\n\n\t</div>\n\t<!-- END access TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"sharing/css/access.css"],parentWidget:null,accessRows:new Array,rights:["groupwrite","groupcopy","groupview","worldwrite","worldcopy","worldview"],constructor:function(args){this.parentWidget=args.parentWidget;this.tabContainer=args.tabContainer;this.loadCSS();},postMixInProperties:function(){},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.accessTab);this.tabContainer.selectChild(this.accessTab);this.buildTable();Agua.updater.subscribe(this,"updateGroups");},updateGroups:function(args){this.buildTable();},buildTable:function(){var _f06=Agua.getAccess();if(this.table.childNodes){while(this.table.childNodes.length>2){this.table.removeChild(this.table.childNodes[2]);}}this.tableRows=[];for(var _f07=0;_f07<_f06.length;_f07++){_f06[_f07].parentWidget=this;var _f08=new plugins.sharing.AccessRow(_f06[_f07]);this.table.appendChild(_f08.row);this.tableRows.push(_f08);}},togglePermission:function(_f09){var _f0a=_f09.target.parentNode;var _f0b=_f09.target.getAttribute("class");if(_f0b.match("allowed")){dojo.removeClass(_f09.target,"allowed");dojo.addClass(_f09.target,"denied");}else{dojo.removeClass(_f09.target,"denied");dojo.addClass(_f09.target,"allowed");}},saveAccess:function(){var _f0c=new Array;for(var i=0;i<this.tableRows.length;i++){var data=new Object;data.owner=Agua.cookie("username");data.groupname=this.tableRows[i].args.groupname;for(var j=1;j<this.rights.length;j++){data[this.rights[j]]=0;if(dojo.hasClass(this.tableRows[i][this.rights[j]],"allowed")){data[this.rights[j]]=1;}}_f0c.push(data);}var url=Agua.cgiUrl+"sharing.cgi";var _f0d=new Object;_f0d.username=Agua.cookie("username");_f0d.sessionId=Agua.cookie("sessionId");_f0d.mode="saveAccess";_f0d.data=_f0c;dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_f0d),handle:function(_f0e,_f0f){Agua.toast(_f0e);}});}});}if(!dojo._hasResource["plugins.sharing.Sharing"]){dojo._hasResource["plugins.sharing.Sharing"]=true;dojo.provide("plugins.sharing.Sharing");dojo.declare("plugins.sharing.Sharing",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- ADMIN TAB -->\n\t<div\n        dojoAttachPoint=\"mainTab\"\n        class=\"sharing\"\n\t\ticonClass=\"sharingIcon\"\n        style=\"min-width: 1140px !important; width: 100% !important; height:100% !important; max-height: auto !important; padding: 0px; background: #FFF;\"\n        dojoType=\"dijit.layout.BorderContainer\"\n\t\tclosable=\"true\"\t\t\n        title=\"Sharing\"\n        >\n        \n        <!-- LEFT PANE -->\n        <div\n            dojoAttachPoint=\"leftPane\"\n            class=\"leftPane\"\n\t\t\tlayoutAlign=\"left\" \n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; width: 390px; height: 100% !important; max-height: auto !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- LEFT TAB CONTAINER-->\n            <div dojoAttachPoint=\"leftTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF LEFT TAB CONTAINER-->\n\t\t\t\n        </div>\n        <!-- END OF LEFT PANE -->\n\n        <!-- MIDDLE PANE -->\n        <div\n            dojoAttachPoint=\"middlePane\"\n\t\t\tlayoutAlign=\"middle\" \n\t\t\tclass=\"middlePane\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 390px !important; height: 100% !important; max-height: auto !important; width: 390px; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- MIDDLE TAB CONTAINER-->\n            <div\n                dojoAttachPoint=\"middleTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n\n        </div>\n        <!-- END OF MIDDLE PANE -->\n\n\n        <!-- RIGHT PANE -->\n        <div\n            dojoAttachPoint=\"rightPane\" \n            class=\"rightPane\"\n\t\t\tlayoutAlign=\"right\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 780px !important; height: 100% !important; max-height: auto !important; width: 370px !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- RIGHT TAB CONTAINER-->\n            <div dojoAttachPoint=\"rightTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible; width: 370px !important; \"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF RIGHT TAB CONTAINER-->\n\n        </div>\n        <!-- END OF RIGHT PANE -->\n\n\t</div>\n\t<!-- END OF ADMIN TAB -->\n\n</div>\n",widgetsInTemplate:true,paneWidgets:null,core:new Object,cssFiles:[dojo.moduleUrl("plugins","sharing/css/sharing.css")],modules:{"Apps":"plugins.sharing.Apps","GroupProjects":"plugins.sharing.GroupProjects","Settings":"plugins.sharing.Settings","Clusters":"plugins.sharing.Clusters","Amis":"plugins.sharing.Amis","Parameters":"plugins.sharing.Parameters","Packages":"plugins.sharing.Packages","Groups":"plugins.sharing.Groups","Projects":"plugins.sharing.Projects","Access":"plugins.sharing.Access","GroupSources":"plugins.sharing.GroupSources","GroupUsers":"plugins.sharing.GroupUsers","Sources":"plugins.sharing.Sources","Users":"plugins.sharing.Users"},constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){Agua.addWidget("sharing",this);Agua.tabs.addChild(this.mainTab);Agua.tabs.selectChild(this.mainTab);this.paneWidgets=new Object;this.headings=Agua.getSharingHeadings();this.loadPanes();},reload:function(_f10){if(_f10=="all"){for(var _f11 in this.headings){for(var i in this.headings[_f11]){this.reloadWidget(this.headings[_f11][i]);}}}else{if(_f10=="leftPane"||_f10=="middlePane"||_f10=="rightPane"){for(var i in this.headings[_f10]){this.reloadWidget(this.headings[_f10][i]);}}else{try{this.reloadWidget(_f10);}catch(e){}}}},reloadWidget:function(_f12){delete this.paneWidgets[_f12];var _f13=this;this.paneWidgets[_f12]=new plugins.sharing[_f12]({parentWidget:_f13,tabContainer:_f13.leftTabContainer});},loadPanes:function(){var _f14=["left","middle","right"];for(var i=0;i<_f14.length;i++){this.loadPane(_f14[i]);}},loadPane:function(side){var pane=side+"Pane";var _f15=side+"TabContainer";if(this.headings==null||this.headings[pane]==null){return;}for(var i=0;i<this.headings[pane].length;i++){var _f16=this.headings[pane][i];console.log("Sharing.loadPane    dojo.require tabPaneName: "+_f16);var _f17=this.modules[_f16];console.log("Sharing.loadPane    BEFORE dojo.require moduleName: "+_f17);dojo["require"](_f17);console.log("Sharing.loadPane    AFTER dojo.require moduleName: "+_f17);var _f18=this;var _f19=new plugins["sharing"][_f16]({parentWidget:_f18,tabContainer:_f18[_f15]});if(this.paneWidgets[_f17]==null){this.paneWidgets[_f17]=new Array;}this.paneWidgets[_f17].push(_f19);}},destroyRecursive:function(){console.log("Sharing.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.sharing.Controller"]){dojo._hasResource["plugins.sharing.Controller"]=true;dojo.provide("plugins.sharing.Controller");var sharingController;dojo.declare("plugins.sharing.Controller",[dijit._Widget,dijit._Templated],{paneId:null,templateString:"<div dojoAttachPoint=\"containerNode\" class=\"sharing\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"sharingIcon\"\n        type=\"button\"\n        label=\"Sharing\"\n        ></button>\n</div>\n        \n",widgetsInTemplate:true,tabPanes:[],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _f1a=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(){var _f1b=new plugins.sharing.Sharing({});this.tabPanes.push(_f1b);this._supportingWidgets.push(_f1b);},createMenu:function(){var _f1c=new dijit.Menu({id:"sharing"+this.paneId+"dynamicMenuPopup"});_f1c.addChild(new dijit.MenuItem({label:"Application Menu",disabled:false}));_f1c.addChild(new dijit.MenuSeparator());var _f1d=new dijit.MenuItem({id:"sharing"+this.paneId+"remove",label:"Remove",disabled:false});_f1c.addChild(_f1d);dojo.connect(_f1d,"onClick",function(){var _f1e=_f1c.currentTarget.parentNode;_f1e.removeChild(_f1c.currentTarget);});_f1c.addChild(new dijit.MenuSeparator());var _f1f=new dijit.MenuItem({id:"sharing"+this.paneId+"run",label:"Run",disabled:false});_f1c.addChild(_f1f);dojo.connect(_f1f,"onClick",function(){var _f20=_f1c.currentTarget;var _f21=_f20.parentNode;});return _f1c;},loadCSS:function(){var _f22=["plugins/sharing/css/controller.css"];for(var i in _f22){var _f23=_f22[i];var _f24=document.createElement("link");_f24.type="text/css";_f24.rel="stylesheet";_f24.href=_f23;_f24.media="screen";document.getElementsByTagName("head")[0].appendChild(_f24);}}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.sharing.GroupProjectRow"]){dojo._hasResource["plugins.sharing.GroupProjectRow"]=true;dojo.provide("plugins.sharing.GroupProjectRow");dojo.declare("plugins.sharing.GroupProjectRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"0px\">\n        <tr width=\"100%\">\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >\n                ${name}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"description\"\n                class=\"description\"\n                style=\"display: none;\"\n                >${description}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);var _f25=this;dojo.connect(this.name,"onclick",function(_f26){_f25.toggle();_f26.stopPropagation();});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}}});}if(!dojo._hasResource["dijit.form.VerticalSlider"]){dojo._hasResource["dijit.form.VerticalSlider"]=true;dojo.provide("dijit.form.VerticalSlider");dojo.declare("dijit.form.VerticalSlider",dijit.form.HorizontalSlider,{templateString:dojo.cache("dijit.form","templates/VerticalSlider.html","<table class=\"dijit dijitReset dijitSlider dijitSliderV\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\n\t\t\t><div class=\"dijitSliderIncrementIconV\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div></center\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td dojoAttachPoint=\"leftDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV\"></td\n\t\t><td class=\"dijitReset dijitSliderDecorationC\" style=\"height:100%;\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><center class=\"dijitReset dijitSliderBarContainerV\" role=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV\" dojoAttachEvent=\"onmousedown:_onBarClick\"><!--#5629--></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV\" dojoAttachEvent=\"onmousedown:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableV\" style=\"vertical-align:top;\"\n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleV\" dojoAttachEvent=\"onmousedown:_onHandleClick\" role=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t></center\n\t\t></td\n\t\t><td dojoAttachPoint=\"containerNode,rightDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div></center\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\n\t\t\t><div class=\"dijitSliderDecrementIconV\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n></table>\n"),_mousePixelCoord:"pageY",_pixelCount:"h",_startingPixelCoord:"y",_startingPixelCount:"t",_handleOffsetCoord:"top",_progressPixelSize:"height",_descending:true,_isReversed:function(){return this._descending;}});}if(!dojo._hasResource["dijit.form.HorizontalRule"]){dojo._hasResource["dijit.form.HorizontalRule"]=true;dojo.provide("dijit.form.HorizontalRule");dojo.declare("dijit.form.HorizontalRule",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH\"></div>",count:3,container:"containerNode",ruleStyle:"",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkH\" style=\"left:",_positionSuffix:"%;",_suffix:"\"></div>",_genHTML:function(pos,ndx){return this._positionPrefix+pos+this._positionSuffix+this.ruleStyle+this._suffix;},_isHorizontal:true,buildRendering:function(){this.inherited(arguments);var _f27;if(this.count==1){_f27=this._genHTML(50,0);}else{var i;var _f28=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){_f27=this._genHTML(0,0);for(i=1;i<this.count-1;i++){_f27+=this._genHTML(_f28*i,i);}_f27+=this._genHTML(100,this.count-1);}else{_f27=this._genHTML(100,0);for(i=1;i<this.count-1;i++){_f27+=this._genHTML(100-_f28*i,i);}_f27+=this._genHTML(0,this.count-1);}}this.domNode.innerHTML=_f27;}});}if(!dojo._hasResource["dijit.form.VerticalRule"]){dojo._hasResource["dijit.form.VerticalRule"]=true;dojo.provide("dijit.form.VerticalRule");dojo.declare("dijit.form.VerticalRule",dijit.form.HorizontalRule,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerV\"></div>",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkV\" style=\"top:",_isHorizontal:false});}if(!dojo._hasResource["dijit.form.HorizontalRuleLabels"]){dojo._hasResource["dijit.form.HorizontalRuleLabels"]=true;dojo.provide("dijit.form.HorizontalRuleLabels");dojo.declare("dijit.form.HorizontalRuleLabels",dijit.form.HorizontalRule,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH\"></div>",labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerH\" style=\"left:",_labelPrefix:"\"><div class=\"dijitRuleLabel dijitRuleLabelH\">",_suffix:"</div></div>",_calcPosition:function(pos){return pos;},_genHTML:function(pos,ndx){return this._positionPrefix+this._calcPosition(pos)+this._positionSuffix+this.labelStyle+this._labelPrefix+this.labels[ndx]+this._suffix;},getLabels:function(){var _f29=this.labels;if(!_f29.length){_f29=dojo.query("> li",this.srcNodeRef).map(function(node){return String(node.innerHTML);});}this.srcNodeRef.innerHTML="";if(!_f29.length&&this.count>1){var _f2a=this.minimum;var inc=(this.maximum-_f2a)/(this.count-1);for(var i=0;i<this.count;i++){_f29.push((i<this.numericMargin||i>=(this.count-this.numericMargin))?"":dojo.number.format(_f2a,this.constraints));_f2a+=inc;}}return _f29;},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length;}});}if(!dojo._hasResource["dijit.form.VerticalRuleLabels"]){dojo._hasResource["dijit.form.VerticalRuleLabels"]=true;dojo.provide("dijit.form.VerticalRuleLabels");dojo.declare("dijit.form.VerticalRuleLabels",dijit.form.HorizontalRuleLabels,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerV dijitRuleLabelsContainer dijitRuleLabelsContainerV\"></div>",_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerV\" style=\"top:",_labelPrefix:"\"><span class=\"dijitRuleLabel dijitRuleLabelV\">",_calcPosition:function(pos){return 100-pos;},_isHorizontal:false});}if(!dojo._hasResource["dijit.form.Slider"]){dojo._hasResource["dijit.form.Slider"]=true;dojo.provide("dijit.form.Slider");dojo.deprecated("Call require() for HorizontalSlider / VerticalRule, explicitly rather than 'dijit.form.Slider' itself","","2.0");}if(!dojo._hasResource["plugins.sharing.GroupProjects"]){dojo._hasResource["plugins.sharing.GroupProjects"]=true;dojo.provide("plugins.sharing.GroupProjects");dojo.declare("plugins.sharing.GroupProjects",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- groupprojects TAB -->\n\t<div\n\t\tdojoAttachPoint=\"groupprojectsTab\"\n\t\tclass=\"groupprojects\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Group Projects\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Group Projects </td>\n\t\t\t</tr>\n\t\t\t<tr valign=\"top\">\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- GROUP COMBO -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Groups </div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tpopupClass=\"groupprojects groupCombo dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DROP TARGET CONTAINER -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Group Projects </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dropTargetContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dropTarget\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 615px; width: 180px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Projects </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceSlider\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.HorizontalSlider\" \n\t\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t\tmaximum=\"100\"\n\t\t\t\t\t\t\t\t\tminimum=\"0\"\n\t\t\t\t\t\t\t\t\tpageIncrement=\"100\"\n\t\t\t\t\t\t\t\t\tshowButtons=\"true\"\n\t\t\t\t\t\t\t\t\tintermediateChanges=\"true\"\n\t\t\t\t\t\t\t\t\tslideDuration=\"200\"\n\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DRAG SOURCE CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 553px; width: 150px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END groupprojects TAB -->\n\t\n</div> \n",widgetsInTemplate:true,addingSource:false,cssFiles:["plugins/sharing/css/groupprojects.css"],parentWidget:null,constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.groupprojectsTab);this.tabContainer.selectChild(this.groupprojectsTab);this.setGroupCombo();this.setDragSource();this.setDragSourceSlider();this.setDropTarget();this.setTrash();Agua.updater.subscribe(this,"updateGroups");Agua.updater.subscribe(this,"updateProjects");},updateGroups:function(args){this.reload();},updateProjects:function(args){this.reload();},reload:function(){this.setGroupCombo();this.setDragSource();this.setDropTarget();},setGroupCombo:function(){var _f2b=Agua.getGroupNames();var data={identifier:"name",items:[]};for(var i=0;i<_f2b.length;i++){data.items[i]={name:_f2b[i]};}var _f2c=new dojo.data.ItemFileWriteStore({data:data});this.groupCombo.popupClass="groupprojects groupCombo dijitReset dijitMenu";this.groupCombo.wrapperClass="groupprojects dijitPopup";this.groupCombo.itemHeight=30;this.groupCombo.store=_f2c;this.groupCombo.startup();var _f2d=_f2b[0];this.groupCombo.setValue(_f2d);var _f2e=this;dojo.connect(this.groupCombo,"onChange",function(_f2f){_f2e.setDropTarget();});},setDragSource:function(_f30){while(this.dragSourceContainer.firstChild){if(dijit.byNode(this.dragSourceContainer)&&dijit.byNode(this.dragSourceContainer).destroy){dijit.byNode(this.dragSourceContainer).destroy();}this.dragSourceContainer.removeChild(this.dragSourceContainer.firstChild);}if(_f30==null){_f30=0;}if(Agua.getProjects()==null||Agua.getProjects().length==0){return;}var _f31=Agua.getProjects();var _f32=this.maxDisplayedProjects;var _f33=(_f31.length-_f32)/100;_f33=_f33?_f33:1;var _f34=parseInt(_f30*_f33);var end=parseInt((_f30*_f33)+_f32);if(!end||end>_f31.length){end=_f31.length;}var _f35=new Array;for(var j=_f34;j<end;j++){var data=_f31[j];data.toString=function(){return this.name;};_f35.push({data:data,type:["draggableItem"]});}var _f36=new dojo.dnd.Source(this.dragSourceContainer,{copyOnly:true,selfAccept:false,accept:["none"]});_f36.insertNodes(false,_f35);var _f37=_f36.getAllNodes();for(var k=0;k<_f37.length;k++){var node=_f37[k];node.name=_f35[k].data.name;node.description=_f35[k].data.description;if(node.description==null){node.description="";}if(node.description==null){node.description="";}if(node.name!=null&&node.name!=""){var _f38={name:node.name,description:node.description};_f38.parentWidget=this;var _f39=new plugins.sharing.GroupProjectRow(_f38);node.innerHTML="";node.appendChild(_f39.domNode);}}var _f3a=this;_f36.creator=function(item,hint){var node=dojo.doc.createElement("div");node.name=item.name;node.description=item.description;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.innerHTML="<table> <tr><td> <img src='http://localhost/agua/plugins/sharing/images/users-18.png' <strong style='color: darkred'>"+node.name+"</strong></td></tr><tr><td> "+node.description+"</td></tr></table>";return {node:node,data:item,type:["text"]};};},setDragSourceSlider:function(){var _f3b=this;dojo.connect(this.dragSourceSlider,"onMouseUp",dojo.hitch(this,function(e){var _f3c=parseInt(this.dragSourceSlider.getValue());this.setDragSource(_f3c);}));},setDropTarget:function(){while(this.dropTargetContainer.firstChild){this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}var _f3d=this.groupCombo.getValue();var _f3e=Agua.getProjectsByGroup(_f3d);if(_f3e==null){return;}var _f3f=new Array;for(var j=0;j<_f3e.length;j++){var data=_f3e[j];data.toString=function(){return this.name;};var _f40=_f3e[j].description;_f3f.push({data:data,type:["draggableItem"],description:_f40});}var _f41=new dojo.dnd.Source(this.dropTargetContainer,{accept:["draggableItem"]});_f41.insertNodes(false,_f3f);var _f42=_f41.getAllNodes();for(var k=0;k<_f42.length;k++){var node=_f42[k];var _f43=_f3f[k].type;dojo.addClass(node,_f43);node.name=_f3f[k].data.name;node.description=_f3f[k].data.description;var _f44={name:node.name,description:node.description};_f44.parentWidget=this;var _f45=new plugins.sharing.GroupProjectRow(_f44);node.innerHTML="";node.appendChild(_f45.domNode);}var _f46=this;_f41.creator=function(item,hint){var name=item.projectname?item.projectname:item.name;var _f47=item.projectdesc?item.projectdesc:item.description;if(name==null||name==""){return;}if(_f47==null){_f47="";}var node=dojo.doc.createElement("div");node.name=name;node.description=_f47;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";var _f48={name:name,description:_f47};_f48.parentWidget=this;var _f49=new plugins.sharing.GroupProjectRow(_f48);node.innerHTML="";node.appendChild(_f49.domNode);if(hint!="avatar"){_f46.addToGroup(node.name,node.description,node.name);}return {node:node,data:item,type:["draggableItem"]};};dojo.connect(_f41,"onDndDrop",function(_f4a,_f4b,copy,_f4c){if(_f4a==this&&_f4c!=this){for(var i=0;i<_f4b.length;i++){var node=_f4b[i];_f46.removeFromGroup(node.name,node.description,node.location);}}else{}var _f4d=_f41.getAllNodes();if(_f4d==null||!_f4d){console.log("GroupProjects.setDropTarget dojo.connect onDndDrop    currentNodes is null or empty. Returning");return;}var _f4e=new Object;console.log("GroupProjects.setDropTarget dojo.connect onDndDrop    Checking for duplicate nodes");for(var i=0;i<_f4d.length;i++){var node=_f4d[i];if(!_f4e[node.name]){_f4e[node.name]=1;}else{try{console.log("GroupProjects.setDropTarget dojo.connect onDndDrop    Removing duplicate node: "+node.name);node.parentNode.removeChild(node);}catch(e){}}}});},addToGroup:function(name,_f4f,_f50){var _f51=new Object;_f51.username=Agua.cookie("username");_f51.name=name;_f51.description=_f4f;_f51.location=_f50;_f51.username=Agua.cookie("username");var _f52=this.groupCombo.getValue();var _f53=Agua.addProjectToGroup(_f52,_f51);if(_f53==false){return;}var data=new Object;data.name=name;data.description=_f4f;data.location=_f50;data.groupname=_f52;data.type="project";var url=Agua.cgiUrl+"sharing.cgi";var _f54=new Object;_f54.username=Agua.cookie("username");_f54.sessionId=Agua.cookie("sessionId");_f54.data=data;_f54.mode="addToGroup";var _f55=dojo.toJson(_f54).replace(/undefined/g,"\"\"");dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:_f55,timeout:15000,load:function(data){},error:function(_f56,_f57){return _f56;}});},removeFromGroup:function(name,_f58,_f59){var _f5a=this.groupCombo.getValue();var _f5b=new Object;_f5b.name=name;_f5b.description=_f58;_f5b.location=_f59;_f5b.username=Agua.cookie("username");if(Agua.removeProjectFromGroup(_f5a,_f5b)==false){return;}var data=new Object;data.name=String(name);data.description=_f58;data.location=_f59;data.groupname=_f5a;data.type="project";var url=Agua.cgiUrl+"sharing.cgi";var _f5c=new Object;_f5c.username=Agua.cookie("username");_f5c.sessionId=Agua.cookie("sessionId");_f5c.data=data;_f5c.mode="removeFromGroup";var _f5d=dojo.toJson(_f5c).replace(/undefined/g,"\"\"");dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:_f5d,timeout:15000,load:function(data){},error:function(_f5e,_f5f){return _f5e;}});},setTrash:function(){var _f60=new dojo.dnd.Source(this.trashContainer,{accept:["draggableItem"]});dojo.connect(_f60,"onDndDrop",function(_f61,_f62,copy,_f63){if(_f63==this){var _f64=_f60.getAllNodes();for(var i=0;i<_f64.length;i++){var node=_f64[i];try{node.parentNode.removeChild(node);}catch(e){}}}});}});}if(!dojo._hasResource["plugins.sharing.GroupRow"]){dojo._hasResource["plugins.sharing.GroupRow"]=true;dojo.provide("plugins.sharing.GroupRow");dojo.declare("plugins.sharing.GroupRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr>\n            <td\n                dojoAttachPoint=\"groupname\"\n                class=\"groupname\"\n                >\n                ${groupname}</td>\n        </tr>\n        <tr>\n            <td\n                dojoAttachPoint=\"description\"\n                class='description'\n                style=\"display: none;\" >${description}</td>\n        </tr>\n        <tr>\n            <td\n                dojoAttachPoint=\"notes\"\n                class='notes'\n                style=\"display: none;\">${notes}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _f65=this;dojo.connect(this.groupname,"onclick",function(_f66){_f65.toggle();_f66.stopPropagation();});dojo.connect(this.description,"onclick",function(_f67){_f65.parentWidget.editRow(_f65,_f67.target);});dojo.connect(this.notes,"onclick",function(_f68){_f65.parentWidget.editRow(_f65,_f68.target);});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}if(this.notes.style.display=="block"){this.notes.style.display="none";}else{this.notes.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.GroupSourceRow"]){dojo._hasResource["plugins.sharing.GroupSourceRow"]=true;dojo.provide("plugins.sharing.GroupSourceRow");dojo.declare("plugins.sharing.GroupSourceRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"0px\">\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >\n                ${name}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"description\"\n                class=\"description\"\n                style=\"display: none;\"\n                >${description}</td>\n        </tr>\n        <!--<tr>-->\n        <!--    <td-->\n        <!--        dojoAttachPoint=\"location\"-->\n        <!--        class='location'-->\n        <!--        style=\"display: block;\"-->\n        <!--        >${location}</td>-->\n        <!--</tr>-->\n\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){console.log("GroupSourceRow.constructor    args:");console.dir({args:args});this.parentWidget=args.parentWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);var _f69=this;dojo.connect(this.name,"onclick",function(_f6a){_f69.toggle();_f6a.stopPropagation();});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.GroupSources"]){dojo._hasResource["plugins.sharing.GroupSources"]=true;dojo.provide("plugins.sharing.GroupSources");dojo.declare("plugins.sharing.GroupSources",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"sourcesTab\"\n\t\tclass=\"groupsources\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Group Sources\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 370px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"370\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Group Sources </td>\n\t\t\t</tr>\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- GROUP COMBO -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Groups </div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tpopupClass=\"sources groupCombo dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DROP TARGET CONTAINER -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Group Sources </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dropTargetContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dropTarget\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 622px; width: 160px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DRAG SOURCE CONTAINER -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Sources </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 580px; width: 160px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n",widgetsInTemplate:true,addingSource:false,cssFiles:["plugins/sharing/css/groupsources.css"],parentWidget:null,constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("GroupSources.startup    plugins.sharing.GroupSources.start()");this.inherited(arguments);this.tabContainer.addChild(this.sourcesTab);this.setGroupCombo();this.setDragSource();this.createDropTarget();this.setDropTarget();this.setTrash();Agua.updater.subscribe(this,"updateGroups");Agua.updater.subscribe(this,"updateSources");},updateGroups:function(args){console.log("sharing.GroupSources.updateGroups    sharing.GroupSources.updateGroups(args)");console.log("sharing.GroupSources.updateGroups    args:");console.dir(args);this.reload();},updateSources:function(args){console.log("sharing.GroupSources.updateSources    sharing.GroupSources.updateSources(args)");console.log("sharing.GroupSources.updateSources    args:");console.dir(args);this.reload();},reload:function(){console.log("sharing.GroupSources.reload    sharing.GroupSources.reload()");this.setGroupCombo();this.setDragSource();this.setDropTarget();},setGroupCombo:function(){console.log("GroupSources.setGroupCombo     plugins.sharing.GroupSources.setGroupCombo()");var _f6b=Agua.getGroupNames();console.log("GroupSources.setGroupCombo     groupNames: "+dojo.toJson(_f6b));var data={identifier:"name",items:[]};for(var i=0;i<_f6b.length;i++){data.items[i]={name:_f6b[i]};}console.log("GroupSources.setGroupCombo     data: "+dojo.toJson(data));var _f6c=new dojo.data.ItemFileWriteStore({data:data});this.groupCombo.popupClass="groupsources groupCombo dijitReset dijitMenu";this.groupCombo.wrapperClass="groupsources dijitPopup";this.groupCombo.itemHeight=30;this.groupCombo.store=_f6c;this.groupCombo.startup();console.log("GroupSources.setGroupCombo::setCombo     AFTER this.groupCombo.startup()");var _f6d=_f6b[0];this.groupCombo.setValue(_f6d);console.log("GroupSources.setGroupCombo::setCombo     AFTER this.groupCombo.setValue(firstValue)");var _f6e=this;dojo.connect(this.groupCombo,"onChange",function(_f6f){_f6e.setDropTarget();});},setDragSource:function(){console.log("GroupSources.setDragSource     plugins.sharing.GroupSources.setDragSource()");while(this.dragSourceContainer.firstChild){if(dijit.byNode(this.dragSourceContainer)&&dijit.byNode(this.dragSourceContainer).destroy){dijit.byNode(this.dragSourceContainer).destroy();}this.dragSourceContainer.removeChild(this.dragSourceContainer.firstChild);}var _f70=new Array;var _f71=Agua.getSources();console.log("GroupSources.setDragSource     sourceArray: ");console.dir({sourceArray:_f71});if(_f71==null||!_f71){console.log("GroupSources.setDragSource     sourceArray is null or empty. Returning.");return;}for(var j=0;j<_f71.length;j++){var data=_f71[j];data.toString=function(){return this.name;};_f70.push({data:data,type:["draggableItem"]});}var _f72=new dojo.dnd.Source(this.dragSourceContainer,{copyOnly:true,selfAccept:false,accept:["none"]});_f72.insertNodes(false,_f70);var _f73=_f72.getAllNodes();for(var k=0;k<_f73.length;k++){var node=_f73[k];node.name=_f70[k].data.name;node.description=_f70[k].data.description;node.location=_f70[k].data.location;var _f74={name:node.name,location:node.location,description:node.description};_f74.parentWidget=this;var _f75=new plugins.sharing.GroupSourceRow(_f74);node.innerHTML="";node.appendChild(_f75.domNode);}var _f76=this;_f72.creator=function(item,hint){console.log("GroupSources.setDragSource dragSource.creator         item: "+dojo.toJson(item));var node=dojo.doc.createElement("div");node.name=item.name;node.description=item.description;node.location=item.location;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.innerHTML="<table> <tr><td><strong style='color: darkred'>"+item.name+"</strong></td></tr><tr><td> "+item.description+"</td></tr></table>";return {node:node,data:item,type:["text"]};};},createDropTarget:function(){this.dropTarget=new dojo.dnd.Source(this.dropTargetContainer,{accept:["draggableItem"]});var _f77=this;this.dropTarget.creator=function(item,hint){console.log("GroupSources.createDropTarget this.dropTarget.creator         item: ");console.dir({item:item});console.log("GroupSources.createDropTarget this.dropTarget.creator         hint: "+hint);var data=item;if(item.data){data=item.data;}var name=data.name;var _f78=data.description;var _f79=data.location;var node=dojo.doc.createElement("div");node.name=name;node.description=_f78;node.location=_f79;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";var _f7a={name:name,description:_f78,location:_f79};console.log("GroupUsers.createDropTarget    this.dropTarget.creator    source: ");console.dir({source:_f7a});_f7a.parentWidget=this;var _f7b=new plugins.sharing.GroupSourceRow(_f7a);node.innerHTML="";node.appendChild(_f7b.domNode);if(hint!="avatar"){_f77.addToGroup(node.name,node.description,node.location);}return {node:node,data:item,type:["draggableItem"]};};dojo.connect(this.dropTarget,"onDndDrop",function(_f7c,_f7d,copy,_f7e){console.log("GroupSources.createDropTarget dojo.connect onDndDrop    AFTER this.dropTarget.onDndDrop");if(_f7c==this){console.log("GroupSources.createDropTarget dojo.connect(onDndDrop)    Node has been moved to trash.");for(var i=0;i<_f7d.length;i++){var node=_f7d[i];_f77.removeFromGroup(node.name,node.description,node.location);}}var _f7f=_f77.dropTarget.getAllNodes();if(_f7f==null||!_f7f){console.log("GroupSources.createDropTarget dojo.connect onDndDrop    currentNodes is null or empty. Returning");return;}var _f80=new Object;for(var i=0;i<_f7f.length;i++){var node=_f7f[i];if(!_f80[node.name]){_f80[node.name]=1;}else{try{node.parentNode.removeChild(node);}catch(e){}}}});},setDropTarget:function(){console.log("GroupSources.setDropTarget     plugins.sharing.GroupSources.setDropTarget()");while(this.dropTargetContainer.firstChild){console.log("GroupSources.setDropTarget     REMOVING firstChild");this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}var _f81=this.groupCombo.getValue();var _f82=Agua.getSourcesByGroup(_f81);if(_f82==null){console.log("GroupSources.setDropTarget     sourceArray is null or empty. Returning.");return;}console.log("GroupSources.setDropTarget     sourceArray: "+dojo.toJson(_f82,true));if(_f82==null||_f82.length==0){return;}var _f83=new Array;for(var j=0;j<_f82.length;j++){var data=_f82[j];data.toString=function(){return this.name;};var _f84=_f82[j].description;_f83.push({data:data,type:["draggableItem"],description:_f84});}console.log("GroupSources.setDropTarget     dataArray: ");console.dir({dataArray:_f83});this.dropTarget.insertNodes(false,_f83);var _f85=this.dropTarget.getAllNodes();console.log("GroupSources.setDropTarget     allNodes.length: "+_f85.length);for(var k=0;k<_f85.length;k++){var node=_f85[k];var _f86=_f83[k].type;dojo.addClass(node,_f86);node.description=_f83[k].description;node.location=_f83[k].location;var name=_f83[k].data;node.name=name;node.name=_f83[k].data.name;node.description=_f83[k].data.description;node.location=_f83[k].data.location;var _f87={name:node.name,location:node.location,description:node.description};_f87.parentWidget=this;var _f88=new plugins.sharing.GroupSourceRow(_f87);node.innerHTML="";node.appendChild(_f88.domNode);}},addToGroup:function(name,_f89,_f8a){console.log("GroupSources.addToGroup    plugins.sharing.GroupSources.addToGroup(name, description, location)");console.log("GroupSources.addToGroup    name: "+name);var _f8b=new Object;_f8b.username=Agua.cookie("username");_f8b.name=name;_f8b.description=_f89;_f8b.location=_f8a;var _f8c=this.groupCombo.getValue();console.log("GroupSources.addToGroup     groupName: "+_f8c);if(Agua.addSourceToGroup(_f8c,_f8b)==false){console.log("GroupSources.addToGroup     Failed to add source to group: "+_f8b.name+". Returning.");return;}var data=new Object;data.name=name;data.description=_f89;data.location=_f8a;data.groupname=_f8c;data.type="source";var url=Agua.cgiUrl+"sharing.cgi";var _f8d=new Object;_f8d.username=Agua.cookie("username");_f8d.sessionId=Agua.cookie("sessionId");_f8d.data=data;_f8d.mode="addToGroup";var _f8e=dojo.toJson(_f8d).replace(/undefined/g,"\"\"");dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:_f8e,timeout:15000,load:function(data){console.log("SourceManager.addToGroup    JSON loaded okay");console.log("SourceManager.addToGroup    data: "+dojo.toJson(data));},error:function(_f8f,_f90){console.log("SourceManager.addToGroup    Error with JSON Post, response: "+_f8f+", ioArgs: "+_f90);return _f8f;}});},removeFromGroup:function(name,_f91,_f92){console.log("GroupSources.removeFromGroup    plugins.sharing.GroupSources.removeFromGroup(name, description, location)");console.log("GroupSources.removeFromGroup    name: "+name);var _f93=this.groupCombo.getValue();console.log("GroupSources.removeFromGroup     groupName: "+_f93);var _f94=new Object;_f94.name=name;_f94.description=_f91;_f94.location=_f92;if(Agua.removeSourceFromGroup(_f93,_f94)==false){console.log("GroupSources.removeFromGroup     Failed to remove source from group: "+_f94.name+". Returning.");return;}var data=new Object;data.name=String(name);data.description=_f91;data.location=_f92;data.groupname=_f93;data.type="source";var url=Agua.cgiUrl+"sharing.cgi";var _f95=new Object;_f95.username=Agua.cookie("username");_f95.sessionId=Agua.cookie("sessionId");_f95.data=data;_f95.mode="removeFromGroup";var _f96=dojo.toJson(_f95).replace(/undefined/g,"\"\"");dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:_f96,timeout:15000,load:function(data){console.log("SourceManager.removeFromGroup    JSON loaded okay");console.log("SourceManager.removeFromGroup    data: "+dojo.toJson(data));},error:function(_f97,_f98){console.log("SourceManager.removeFromGroup    Error with JSON Post, response: "+_f97+", ioArgs: "+_f98);return _f97;}});},setTrash:function(){console.log("GroupSources.setTrash     plugins.sharing.GroupSources.setTrash()");var _f99=new dojo.dnd.Source(this.trashContainer,{accept:["draggableItem"]});dojo.connect(_f99,"onDndDrop",function(_f9a,_f9b,copy,_f9c){console.log("GroupSources.setTrash    dojo.connect(onDndDrop)    Checking if target == this");console.log("GroupSources.setTrash    target:");console.dir({target:_f9c});console.log("GroupSources.setTrash    this:");if(_f9c==this){console.log("GroupSources.setTrash    dojo.connect(onDndDrop)    target == this. Removing dropped nodes");var _f9d=_f99.getAllNodes();for(var i=0;i<_f9d.length;i++){var node=_f9d[i];console.log("GroupSources.setTrash    dojo.connect(onDndDrop)    target == this. Removing dropped nodes");try{node.parentNode.removeChild(node);}catch(e){}}}});}});}if(!dojo._hasResource["plugins.sharing.GroupUserRow"]){dojo._hasResource["plugins.sharing.GroupUserRow"]=true;dojo.provide("plugins.sharing.GroupUserRow");dojo.declare("plugins.sharing.GroupUserRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"0px\">\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"username\"\n                class=\"username\"\n                width=\"100%\"\n                >\n                ${username}</td>\n        </tr>\n        <tr class=\"email\">\n            <td colspan=\"2\"\n                dojoAttachPoint=\"email\"\n                style=\"display: none;\"\n                width=\"100%\"\n                >\n                ${email}</td>\n        </tr>\n        <tr dojoAttachPoint=\"fullname\"\n            style=\"display: none\"\n            class=\"fullname\"\n            >\n            <td dojoAttachPoint=\"firstname\"\n                class=\"firstname\"\n                style=\"display: inline\"\n                width=\"100%\"\n                >${firstname}</td>\n            <td dojoAttachPoint=\"lastname\"\n                class=\"lastname\"\n                style=\"display: inline\"\n                width=\"100%\"\n                >${lastname}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"description\"\n                class=\"description\"\n                style=\"display: none;\"\n                width=\"100%\"\n                >${description}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);var _f9e=this;dojo.connect(this.username,"onclick",function(_f9f){_f9e.toggle();_f9f.stopPropagation();});},toggle:function(){if(this.email.style.display=="block"){this.email.style.display="none";}else{this.email.style.display="block";}if(this.fullname.style.display=="block"){this.fullname.style.display="none";}else{this.fullname.style.display="block";}if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.GroupUsers"]){dojo._hasResource["plugins.sharing.GroupUsers"]=true;dojo.provide("plugins.sharing.GroupUsers");dojo.declare("plugins.sharing.GroupUsers",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- groupusers TAB -->\n\t<div\n\t\tdojoAttachPoint=\"groupusersTab\"\n\t\tclass=\"groupusers\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Group Users\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 370px !important; padding: 0 !important;\"\n\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"370\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Group Users </td>\n\t\t\t</tr>\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- GROUP COMBO -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Groups </div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tpopupClass=\"groupusers groupCombo dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DROP TARGET CONTAINER -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Group Users </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dropTargetContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dropTarget\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 622px; width: 170px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Users </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceSlider\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.HorizontalSlider\" \n\t\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t\tmaximum=\"100\"\n\t\t\t\t\t\t\t\t\tminimum=\"0\"\n\t\t\t\t\t\t\t\t\tpageIncrement=\"100\"\n\t\t\t\t\t\t\t\t\tshowButtons=\"true\"\n\t\t\t\t\t\t\t\t\tintermediateChanges=\"true\"\n\t\t\t\t\t\t\t\t\tslideDuration=\"200\"\n\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DRAG SOURCE CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 560px; width: 150px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END groupusers TAB -->\n\t\n</div> \n",widgetsInTemplate:true,addingSource:false,cssFiles:["plugins/sharing/css/groupusers.css"],parentWidget:null,maxDisplayedUsers:24,constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.groupusersTab);this.tabContainer.selectChild(this.groupusersTab);this.setGroupCombo();this.setDragSource();this.setDragSourceSlider();this.setDropTarget();this.setTrash();Agua.updater.subscribe(this,"updateGroups");Agua.updater.subscribe(this,"updateUsers");},updateGroups:function(args){this.reload();},updateUsers:function(args){this.reload();},reload:function(){this.setGroupCombo();this.setDragSource();this.setDropTarget();},setGroupCombo:function(){var _fa0=Agua.getGroupNames();var data={identifier:"name",items:[]};for(var i=0;i<_fa0.length;i++){data.items[i]={name:_fa0[i]};}var _fa1=new dojo.data.ItemFileWriteStore({data:data});this.groupCombo.store=_fa1;this.groupCombo.startup();var _fa2=_fa0[0];this.groupCombo.setValue(_fa2);var _fa3=this;dojo.connect(this.groupCombo,"onChange",function(_fa4){_fa3.setDropTarget();});},setDragSource:function(_fa5){while(this.dragSourceContainer.firstChild){if(dijit.byNode(this.dragSourceContainer)&&dijit.byNode(this.dragSourceContainer).destroy){dijit.byNode(this.dragSourceContainer).destroy();}this.dragSourceContainer.removeChild(this.dragSourceContainer.firstChild);}if(_fa5==null){_fa5=0;}var _fa6=new Array;var _fa7=Agua.getUsers();if(_fa7==null||_fa7.length==0){return;}var _fa8=this.maxDisplayedUsers;var _fa9=(_fa7.length-_fa8)/100;_fa9=_fa9?_fa9:1;var _faa=parseInt(_fa5*_fa9);var end=parseInt((_fa5*_fa9)+_fa8);if(!end||end>_fa7.length){end=_fa7.length;}if(!_faa||_faa<0){_faa=0;}for(var j=_faa;j<end;j++){var data=_fa7[j];_fa6.push({data:data,type:["draggableUser"]});}var _fab=new dojo.dnd.Source(this.dragSourceContainer,{copyOnly:true,selfAccept:false,accept:["none"]});_fab.insertNodes(false,_fa6);var _fac=_fab.getAllNodes();for(var k=0;k<_fac.length;k++){var node=_fac[k];node.username=_fa6[k].data["username"]?_fa6[k].data["username"]:"";node.firstname=_fa6[k].data["firstname"]?_fa6[k].data["firstname"]:"";node.lastname=_fa6[k].data["lastname"]?_fa6[k].data["lastname"]:"";node.email=_fa6[k].data["email"]?_fa6[k].data["email"]:"";node.description=_fa6[k].data["description"]?_fa6[k].data["description"]:"";node.firstname=this.firstLetterUpperCase(node.firstname);node.lastname=this.firstLetterUpperCase(node.lastname);if(node.description==null){node.description="";}if(node.username!=null&&node.username!=""){var user={username:node.username,email:node.email,firstname:node.firstname,lastname:node.lastname,description:node.description};user.parentWidget=this;var _fad=new plugins.sharing.GroupUserRow(user);node.innerHTML="";node.appendChild(_fad.domNode);}}var _fae=this;_fab.creator=function(item,hint){var node=dojo.doc.createElement("div");node.username=item["username"];node.firstname=item["firstname"];node.lastname=item["lastname"];node.email=item["email"];node.description=item["description"];node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.innerHTML="<table> <tr><td><strong style='color: darkred'>"+item["username"]+"</strong></td></tr><tr><td> "+item["email"]+"</td></tr></table>";return {node:node,data:item,type:["text"]};};},setDragSourceSlider:function(){dojo.connect(this.dragSourceSlider,"onMouseUp",dojo.hitch(this,function(e){var _faf=parseInt(this.dragSourceSlider.getValue());this.setDragSource(_faf);}));},setDropTarget:function(){while(this.dropTargetContainer.firstChild){this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}var _fb0=this.groupCombo.get("value");var _fb1=Agua.getGroupUsers();_fb1=this.filterByKeyValues(_fb1,["groupname"],[_fb0]);_fb1=this.filterByKeyValues(_fb1,["groupname"],[_fb0]);if(_fb1==null){return;}var _fb2=new Array;for(var j=0;j<_fb1.length;j++){var data=_fb1[j];var _fb3=_fb1[j].description;_fb2.push({data:data,type:["draggableUser"],description:_fb3});}var _fb4=new dojo.dnd.Source(this.dropTargetContainer,{accept:["draggableUser"]});_fb4.insertNodes(false,_fb2);var _fb5=_fb4.getAllNodes();for(var k=0;k<_fb5.length;k++){var node=_fb5[k];var _fb6=_fb2[k].type;dojo.addClass(node,_fb6);node.username=_fb2[k].data.name;node.description=_fb2[k].data.description;node.email=_fb2[k].data.location;var user={username:node.username,email:node.email,firstname:"",lastname:"",description:node.description};user.parentWidget=this;var _fb7=new plugins.sharing.GroupUserRow(user);node.innerHTML="";node.appendChild(_fb7.domNode);}var _fb8=this;_fb4.creator=function(item,hint){var node=dojo.doc.createElement("div");node.name=item.username||item.name;node.username=item.username||item.name;node.description=item.description||"";node.email=item.email||item.location;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";var user={username:item.username||item.name,email:item.email||item.location,firstname:"",lastname:"",description:""};user.parentWidget=this;var _fb9=new plugins.sharing.GroupUserRow(user);node.innerHTML="";node.appendChild(_fb9.domNode);if(hint!="avatar"){_fb8.addToGroup(node.username,node.description,node.email);}return {node:node,data:item,type:["draggableUser"]};};dojo.connect(_fb4,"onDndDrop",function(_fba,_fbb,copy,_fbc){if(_fba==this&&_fbc!=this){for(var i=0;i<_fbb.length;i++){var node=_fbb[i];_fb8.removeFromGroup(node.username,node.description,node.email);}}else{}var _fbd=_fb4.getAllNodes();if(_fbd==null||!_fbd){return;}var _fbe=new Object;for(var i=0;i<_fbd.length;i++){var node=_fbd[i];if(!_fbe[node.username]){_fbe[node.username]=1;}else{try{node.parentNode.removeChild(node);}catch(e){}}}});},addToGroup:function(name,_fbf,_fc0){var _fc1=new Object;_fc1.username=Agua.cookie("username");_fc1.name=name;_fc1.description=_fbf;_fc1.location=_fc0;var _fc2=this.groupCombo.get("value");if(Agua.addUserToGroup(_fc2,_fc1)==false){return;}var data=new Object;data.name=name;data.description=_fbf||"";data.location=_fc0||"";data.groupname=_fc2||"";data.type="user";var url=Agua.cgiUrl+"sharing.cgi";var _fc3=new Object;_fc3.username=Agua.cookie("username");_fc3.sessionId=Agua.cookie("sessionId");_fc3.data=data;_fc3.mode="addToGroup";this.doPut({url:url,query:_fc3,sync:false,timeout:15000});},removeFromGroup:function(name,_fc4,_fc5){var _fc6=this.groupCombo.get("value");var _fc7=new Object;_fc7.name=name;_fc7.description=_fc4;_fc7.email=_fc5;if(Agua.removeUserFromGroup(_fc6,_fc7)==false){return;}var data=new Object;data.name=String(name)||"";data.description=_fc4||"";data.email=_fc5||"";data.groupname=_fc6||"";data.type="user";var url=Agua.cgiUrl+"sharing.cgi";var _fc8=new Object;_fc8.username=Agua.cookie("username");_fc8.sessionId=Agua.cookie("sessionId");_fc8.data=data;_fc8.mode="removeFromGroup";this.doPut({url:url,query:_fc8,sync:false,timeout:15000});},setTrash:function(){var _fc9=new dojo.dnd.Source(this.trashContainer,{accept:["draggableUser"]});dojo.connect(_fc9,"onDndDrop",function(_fca,_fcb,copy,_fcc){if(_fcc==this){var _fcd=_fc9.getAllNodes();for(var i=0;i<_fcd.length;i++){var node=_fcd[i];try{node.parentNode.removeChild(node);}catch(e){}}}});}});}if(!dojo._hasResource["plugins.sharing.Groups"]){dojo._hasResource["plugins.sharing.Groups"]=true;dojo.provide("plugins.sharing.Groups");dojo.declare("plugins.sharing.Groups",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"groupsTab\"\n\t\tclass=\"groups\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Groups\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n<table width=\"100%\">\n\t<tr valign=\"top\" width=\"100%\">\n\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Groups </td>\n\t</tr>\n\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td>\n\t\t\t<div class=\"label\"> New Group </div>\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"groupname\"\n\t\t\t\t\t\t\tclass=\"groupname\"\n\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t>Groupname</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"addGroupButton\"\n\t\t\t\t\t\t\tclass=\"addGroupButton\"\n\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\tlabel=\"Save\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\tclass=\"notes\"\n\t\t\t\t\t\t\tvalue=\"Notes\"\n\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t>Notes</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\t\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td width=\"95%\">\n\t\t\t<div class=\"label\">Groups</div>\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\tclass=\"dragSource\"\n\t\t\t\tstyle=\"height: 467px; width: 95%;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n\t<tr align=\"center\">\n\t\t<td align=\"center\">\n\n\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\tclass=\"trash\"\n\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n</table>\n\n\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingGroup:false,cssFiles:["plugins/sharing/css/groups.css"],parentWidget:null,formInputs:{groupname:"word",description:"phrase",notes:"phrase"},defaultInputs:{groupname:"Groupname",description:"Description",notes:"Notes"},requiredInputs:{groupname:1},invalidInputs:{groupname:"Groupname",description:"Description",notes:"Notes"},dataFields:["groupname"],avatarItems:["groupname","description"],rowClass:"plugins.sharing.GroupRow",constructor:function(args){this.parentWidget=args.parentWidget;this.groups=args.parentWidget.groups;-this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.groupsTab);this.tabContainer.selectChild(this.groupsTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updateGroups");this.setTrash(this.dataFields);},updateGroups:function(args){if(args==null||args.reload!=false){this.setDragSource();}},setForm:function(){dojo.connect(this.addGroupButton,"onClick",dojo.hitch(this,"saveInputs",null,null));this.setClearValues();this.chainInputs(["groupname","description","notes","addGroupButton"]);},getItemArray:function(){var _fce=Agua.getGroups();return this.sortHasharray(_fce,"groupname");},deleteItem:function(_fcf){Agua.removeGroup(_fcf);Agua.updater.update("updateGroups");},addItem:function(_fd0,_fd1){if(this.savingGroup==true){return;}this.savingGroup=true;Agua.addGroup(_fd0);this.savingGroup=false;Agua.updater.update("updateGroups");}});}if(!dojo._hasResource["plugins.sharing.ProjectRow"]){dojo._hasResource["plugins.sharing.ProjectRow"]=true;dojo.provide("plugins.sharing.ProjectRow");dojo.declare("plugins.sharing.ProjectRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr>\n            <td\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >${name}</td>\n        </tr>\n        <tr>\n            <td\n                dojoAttachPoint=\"description\"\n                class='description'\n                style=\"display: none;\" >${description}</td>\n        </tr>\n        <tr>\n            <td\n                dojoAttachPoint=\"notes\"\n                class='notes'\n                style=\"display: none;\">${notes}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _fd2=this;dojo.connect(this.name,"onclick",function(_fd3){_fd2.toggle();_fd3.stopPropagation();});dojo.connect(this.description,"onclick",function(_fd4){_fd2.parentWidget.editRow(_fd2,_fd4.target);});dojo.connect(this.notes,"onclick",function(_fd5){_fd2.parentWidget.editRow(_fd2,_fd5.target);});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}if(this.notes.style.display=="block"){this.notes.style.display="none";}else{this.notes.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.Projects"]){dojo._hasResource["plugins.sharing.Projects"]=true;dojo.provide("plugins.sharing.Projects");dojo.declare("plugins.sharing.Projects",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"projectsTab\"\n\t\tclass=\"projects\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Projects\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Projects </td>\n\t\t\t</tr>\n\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td>\n\t\t\t\t\t<div class=\"label\"> New Project </div>\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"name\"\n\t\t\t\t\t\t\t\t\tclass=\"name\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addProjectButton\"\n\t\t\t\t\t\t\t\t\tclass=\"addProjectButton\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\t\t\tlabel=\"Save\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\t\t\tclass=\"notes\"\n\t\t\t\t\t\t\t\t\tvalue=\"Notes\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Notes</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Projects </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\tstyle=\"height: 468px; width: 95%;\"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr align=\"center\">\n\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,adding:false,cssFiles:["plugins/sharing/css/projects.css"],parentWidget:null,formInputs:{name:"word",description:"phrase",notes:"word"},defaultInputs:{name:"Name",description:"Description",notes:"Notes"},requiredInputs:{name:1},invalidInputs:{name:"Name",description:"Description",notes:"Notes"},dataFields:["name"],avatarItems:["name","description"],rowClass:"plugins.sharing.ProjectRow",constructor:function(args){this.parentWidget=args.parentWidget;this.projects=args.parentWidget.projects;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.projectsTab);this.tabContainer.selectChild(this.projectsTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateWorkflows");this.setTrash(this.dataFields);},updateProjects:function(args){if(args==null||args.reload!=false){this.setDragSource();}},setForm:function(){dojo.connect(this.addProjectButton,"onClick",dojo.hitch(this,"saveInputs",null,null));this.setClearValues();this.chainInputs(["name","description","notes","addProjectButton"]);},getItemArray:function(){var _fd6=new Array;var _fd7=Agua.getProjects();return this.sortHasharray(_fd7,"name");},deleteItem:function(_fd8){if(!Agua.isProject(_fd8.name)){return;}Agua.removeProject(_fd8);Agua.updater.update("updateProjects");},addItem:function(_fd9,_fda){if(this.adding==true){return;}this.adding=true;if(_fda&&Agua.isProject(_fd9.name)){this.adding=false;return;}Agua.addProject(_fd9);this.adding=false;Agua.updater.update("updateProjects");}});}if(!dojo._hasResource["plugins.sharing.SourceRow"]){dojo._hasResource["plugins.sharing.SourceRow"]=true;dojo.provide("plugins.sharing.SourceRow");dojo.declare("plugins.sharing.SourceRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr>\n            <td\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >\n                ${name}</td>\n        </tr>\n        <tr>\n            <td dojoAttachPoint=\"description\" class='description' style=\"display: block;\" >${description}</td>\n        </tr>\n        <tr>\n            <td dojoAttachPoint=\"location\" class='location' style=\"display: block;\">${location}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _fdb=this;dojo.connect(this.name,"onclick",function(_fdc){_fdb.toggle();_fdc.stopPropagation();});dojo.connect(this.description,"onclick",function(_fdd){_fdb.parentWidget.editRow(_fdb,_fdd.target);_fdd.stopPropagation();});dojo.connect(this.location,"onclick",function(_fde){_fdb.parentWidget.editRow(_fdb,_fde.target);_fde.stopPropagation();});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}if(this.location.style.display=="block"){this.location.style.display="none";}else{this.location.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.Sources"]){dojo._hasResource["plugins.sharing.Sources"]=true;dojo.provide("plugins.sharing.Sources");dojo.declare("plugins.sharing.Sources",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"sourcesTab\"\n\t\tclass=\"sources\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Sources\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"370\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Sources </td>\n\t\t\t</tr>\n\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td>\n\t\t\t\t\t<div class=\"label\"> New Source </div>\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"name\"\n\t\t\t\t\t\t\t\t\tclass=\"name\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addSourceButton\"\n\t\t\t\t\t\t\t\t\tclass=\"addSourceButton\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\t\t\tlabel=\"Save\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"location\"\n\t\t\t\t\t\t\t\t\tclass=\"location\"\n\t\t\t\t\t\t\t\t\tvalue=\"Location\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Location</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Sources </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\tstyle=\"height: 468px; width: 95%;\"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr align=\"center\">\n\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingSource:false,cssFiles:["plugins/sharing/css/sources.css"],parentWidget:null,formInputs:{name:"phrase",description:"phrase",location:"word"},defaultInputs:{name:"Name",description:"Description",location:"Location"},requiredInputs:{name:1,location:1},invalidInputs:{name:"Name",description:"Description",location:"Location"},dataFields:["name","description","location"],avatarItems:["name","description","location"],rowClass:"plugins.sharing.SourceRow",constructor:function(args){this.parentWidget=args.parentWidget;this.sources=args.parentWidget.sources;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.sourcesTab);this.tabContainer.selectChild(this.sourcesTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updateSources");this.setTrash(this.dataFields);},updateSources:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.setDragSource();},setForm:function(){dojo.connect(this.addSourceButton,"onClick",dojo.hitch(this,"saveInputs",null,null));this.setClearValues();this.chainInputs(["name","description","location","addSourceButton"]);},getItemArray:function(){var _fdf=Agua.getSources();_fdf=this.sortHasharray(_fdf,"name");console.log("Sources.getItemArray    Returning itemArray: ");console.dir({itemArray:_fdf});return _fdf;},deleteItem:function(_fe0){_fe0.name=_fe0.name.replace(/\s+$/,"");_fe0.name=_fe0.name.replace(/^\s+/,"");var _fe1=Agua.removeSource(_fe0);Agua.updater.update("updateSources");},addItem:function(_fe2,_fe3){if(this.savingSource==true){return;}this.savingSource=true;Agua.addSource(_fe2);this.savingSource=false;Agua.updater.update("updateSources",_fe3);}});}if(!dojo._hasResource["plugins.sharing.UserRow"]){dojo._hasResource["plugins.sharing.UserRow"]=true;dojo.provide("plugins.sharing.UserRow");dojo.declare("plugins.sharing.UserRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr class=\"username\" width=\"100%\">\n            <td\n                width=\"100%\"\n                colspan=\"2\"\n                dojoAttachPoint=\"username\"\n                class=\"username\"\n            >${username}</td>\n        </tr>\n        <tr class='firstname' width=\"100%\">\n            <td \n                dojoAttachPoint=\"firstname\"\n                class='firstname'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${firstname}</td>\n        </tr>\n        <tr class='lastname' width=\"100%\">\n            <td \n                dojoAttachPoint=\"lastname\"\n                class='lastname'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${lastname}</td>\n        </tr>\n        <tr class=\"email\" width=\"100%\">\n            <td \n                dojoAttachPoint=\"email\"\n                class='email'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${email}</td>\n        </tr>\n        <tr class=\"password\" width=\"100%\">\n            <td \n                dojoAttachPoint=\"password\"\n                class='password'\n                style=\"display: none;\"\n                type=\"password\"\n                value=\"its-a-secret\"\n                width=\"100%\" colspan=\"2\"\n            >reset-password</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _fe4=this;dojo.connect(this.username,"onclick",function(_fe5){_fe4.toggle();_fe5.stopPropagation();});var _fe4=this;dojo.connect(this.firstname,"onclick",function(_fe6){_fe4.parentWidget.editRow(_fe4,_fe6.target);_fe6.stopPropagation();});dojo.connect(this.lastname,"onclick",function(_fe7){_fe4.parentWidget.editRow(_fe4,_fe7.target);_fe7.stopPropagation();});dojo.connect(this.email,"onclick",function(_fe8){_fe4.parentWidget.editRow(_fe4,_fe8.target);_fe8.stopPropagation();});dojo.connect(this.password,"onclick",function(_fe9){_fe4.clearValue(_fe9.target);_fe4.parentWidget.editRow(_fe4,_fe9.target);_fe9.stopPropagation();});},toggle:function(){if(this.firstname.style.display=="block"){this.firstname.style.display="none";}else{this.firstname.style.display="block";}if(this.lastname.style.display=="block"){this.lastname.style.display="none";}else{this.lastname.style.display="block";}if(this.email.style.display=="block"){this.email.style.display="none";}else{this.email.style.display="block";}if(this.password.style.display=="block"){this.password.style.display="none";}else{this.password.style.display="block";}},clearValue:function(_fea){if(_fea.clicked==true){return;}_fea.clicked=true;_fea.innerHTML="";_fea.focus();}});}if(!dojo._hasResource["plugins.sharing.Users"]){dojo._hasResource["plugins.sharing.Users"]=true;dojo.provide("plugins.sharing.Users");dojo.declare("plugins.sharing.Users",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- users TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"users\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Users\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 370px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"370\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Users </td>\n\t\t\t</tr>\n\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\n\t\t\t\t<td>\n\t\t\t\t\n\t\t\t\t\t<table>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t<div class=\"label\"> Create New User </div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tUsername\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"username\"\n\t\t\t\t\t\t\t\t\tclass=\"username\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\ttitle=\"Username\"\n\t\t\t\t\t\t\t\t\t>Username</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addUserButton\"\n\t\t\t\t\t\t\t\t\tclass=\"addUserButton\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\t\t\tlabel=\"Add\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tFirst name\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"firstname\"\n\t\t\t\t\t\t\t\t\tclass=\"firstname\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\ttitle=\"Firstname\"\n\t\t\t\t\t\t\t\t\t>Firstname</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tLast name\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"lastname\"\n\t\t\t\t\t\t\t\t\tclass=\"lastname\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\ttitle=\"Lastname\"\n\t\t\t\t\t\t\t\t\t>Lastname</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tEmail\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"email\"\n\t\t\t\t\t\t\t\t\tclass=\"email\"\n\t\t\t\t\t\t\t\t\tvalue=\"Email\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\ttitle=\"Email\"\n\t\t\t\t\t\t\t\t\t>Email</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tPassword\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"password\"\n\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\ttitle=\"Password\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Users </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\tstyle=\"height: 416px; width: 95%;\"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr align=\"center\">\n\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END users TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:["plugins/sharing/css/users.css"],parentWidget:null,formInputs:{username:"word",firstname:"phrase",lastname:"phrase",email:"phrase",password:"phrase"},defaultInputs:{username:"Username",firstname:"Firstname",lastname:"Lastname",email:"Email"},requiredInputs:{username:1,firstname:1,lastname:1,email:1},invalidInputs:{username:"Username",firstname:"Firstname",lastname:"Lastname",email:"Email"},dataFields:["username"],avatarItems:["username","email"],rowClass:"plugins.sharing.UserRow",constructor:function(args){this.parentWidget=args.parentWidget;this.users=args.parentWidget.users;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("Users.startup    plugins.sharing.Users.startup()");this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updateUsers");this.setTrash(this.dataFields);},updateUsers:function(args){if(args==null||args.reload!=false){console.log("Users.updateUsers    Doing this.setDragSource()");this.setDragSource();}},setForm:function(){dojo.connect(this.addUserButton,"onClick",dojo.hitch(this,"saveInputs",null,null));this.setClearValues();this.chainInputs(["username","firstname","lastname","email","password","addUserButton"]);},getItemArray:function(){var _feb=new Array;var _fec=Agua.getUsers();return this.sortHasharray(_fec,"username");},deleteItem:function(_fed){Agua.removeUser(_fed);Agua.updater.update("updateUsers");},addItem:function(_fee,_fef){console.log("Users.addItem    itemObject: ");console.dir({itemObject:_fee});_fee.originalName=this.jsonSafe(_fee.originalName,"toJson");_fee.username=this.jsonSafe(_fee.username,"toJson");_fee.firstname=this.jsonSafe(_fee.firstname,"toJson");_fee.email=this.jsonSafe(_fee.email,"toJson");_fee.password=this.jsonSafe(_fee.password,"toJson");if(this.saving==true){return;}this.saving=true;if(_fef==true&&Agua.isUser(_fee)){return;}Agua.addUser(_fee);this.saving=false;Agua.updater.update("updateUsers");}});}if(!dojo._hasResource["plugins.dojox.timing.Sequence"]){dojo._hasResource["plugins.dojox.timing.Sequence"]=true;dojo.provide("plugins.dojox.timing.Sequence");dojo.declare("plugins.dojox.timing.Sequence",[dojox.timing.Sequence],{clear:function(){this._defsResolved=[];}});}if(!dojo._hasResource["dijit.layout.SplitContainer"]){dojo._hasResource["dijit.layout.SplitContainer"]=true;dojo.provide("dijit.layout.SplitContainer");dojo.declare("dijit.layout.SplitContainer",dijit.layout._LayoutWidget,{constructor:function(){dojo.deprecated("dijit.layout.SplitContainer is deprecated","use BorderContainer with splitter instead",2);},activeSizing:false,sizerWidth:7,orientation:"horizontal",persist:true,baseClass:"dijitSplitContainer",postMixInProperties:function(){this.inherited("postMixInProperties",arguments);this.isHorizontal=(this.orientation=="horizontal");},postCreate:function(){this.inherited(arguments);this.sizers=[];if(dojo.isMozilla){this.domNode.style.overflow="-moz-scrollbars-none";}if(typeof this.sizerWidth=="object"){try{this.sizerWidth=parseInt(this.sizerWidth.toString());}catch(e){this.sizerWidth=7;}}var _ff0=dojo.doc.createElement("div");this.virtualSizer=_ff0;_ff0.style.position="relative";_ff0.style.zIndex=10;_ff0.className=this.isHorizontal?"dijitSplitContainerVirtualSizerH":"dijitSplitContainerVirtualSizerV";this.domNode.appendChild(_ff0);dojo.setSelectable(_ff0,false);},destroy:function(){delete this.virtualSizer;dojo.forEach(this._ownconnects,dojo.disconnect);this.inherited(arguments);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(_ff1,i,_ff2){this._setupChild(_ff1);if(i<_ff2.length-1){this._addSizer();}},this);if(this.persist){this._restoreState();}this.inherited(arguments);},_setupChild:function(_ff3){this.inherited(arguments);_ff3.domNode.style.position="absolute";dojo.addClass(_ff3.domNode,"dijitSplitPane");},_onSizerMouseDown:function(e){if(e.target.id){for(var i=0;i<this.sizers.length;i++){if(this.sizers[i].id==e.target.id){break;}}if(i<this.sizers.length){this.beginSizing(e,i);}}},_addSizer:function(_ff4){_ff4=_ff4===undefined?this.sizers.length:_ff4;var _ff5=dojo.doc.createElement("div");_ff5.id=dijit.getUniqueId("dijit_layout_SplitterContainer_Splitter");this.sizers.splice(_ff4,0,_ff5);this.domNode.appendChild(_ff5);_ff5.className=this.isHorizontal?"dijitSplitContainerSizerH":"dijitSplitContainerSizerV";var _ff6=dojo.doc.createElement("div");_ff6.className="thumb";_ff5.appendChild(_ff6);this.connect(_ff5,"onmousedown","_onSizerMouseDown");dojo.setSelectable(_ff5,false);},removeChild:function(_ff7){if(this.sizers.length){var i=dojo.indexOf(this.getChildren(),_ff7);if(i!=-1){if(i==this.sizers.length){i--;}dojo.destroy(this.sizers[i]);this.sizers.splice(i,1);}}this.inherited(arguments);if(this._started){this.layout();}},addChild:function(_ff8,_ff9){this.inherited(arguments);if(this._started){var _ffa=this.getChildren();if(_ffa.length>1){this._addSizer(_ff9);}this.layout();}},layout:function(){this.paneWidth=this._contentBox.w;this.paneHeight=this._contentBox.h;var _ffb=this.getChildren();if(!_ffb.length){return;}var _ffc=this.isHorizontal?this.paneWidth:this.paneHeight;if(_ffb.length>1){_ffc-=this.sizerWidth*(_ffb.length-1);}var _ffd=0;dojo.forEach(_ffb,function(_ffe){_ffd+=_ffe.sizeShare;});var _fff=_ffc/_ffd;var _1000=0;dojo.forEach(_ffb.slice(0,_ffb.length-1),function(child){var size=Math.round(_fff*child.sizeShare);child.sizeActual=size;_1000+=size;});_ffb[_ffb.length-1].sizeActual=_ffc-_1000;this._checkSizes();var pos=0;var size=_ffb[0].sizeActual;this._movePanel(_ffb[0],pos,size);_ffb[0].position=pos;pos+=size;if(!this.sizers){return;}dojo.some(_ffb.slice(1),function(child,i){if(!this.sizers[i]){return true;}this._moveSlider(this.sizers[i],pos,this.sizerWidth);this.sizers[i].position=pos;pos+=this.sizerWidth;size=child.sizeActual;this._movePanel(child,pos,size);child.position=pos;pos+=size;},this);},_movePanel:function(panel,pos,size){if(this.isHorizontal){panel.domNode.style.left=pos+"px";panel.domNode.style.top=0;var box={w:size,h:this.paneHeight};if(panel.resize){panel.resize(box);}else{dojo.marginBox(panel.domNode,box);}}else{panel.domNode.style.left=0;panel.domNode.style.top=pos+"px";var box={w:this.paneWidth,h:size};if(panel.resize){panel.resize(box);}else{dojo.marginBox(panel.domNode,box);}}},_moveSlider:function(_1001,pos,size){if(this.isHorizontal){_1001.style.left=pos+"px";_1001.style.top=0;dojo.marginBox(_1001,{w:size,h:this.paneHeight});}else{_1001.style.left=0;_1001.style.top=pos+"px";dojo.marginBox(_1001,{w:this.paneWidth,h:size});}},_growPane:function(_1002,pane){if(_1002>0){if(pane.sizeActual>pane.sizeMin){if((pane.sizeActual-pane.sizeMin)>_1002){pane.sizeActual=pane.sizeActual-_1002;_1002=0;}else{_1002-=pane.sizeActual-pane.sizeMin;pane.sizeActual=pane.sizeMin;}}}return _1002;},_checkSizes:function(){var _1003=0;var _1004=0;var _1005=this.getChildren();dojo.forEach(_1005,function(child){_1004+=child.sizeActual;_1003+=child.sizeMin;});if(_1003<=_1004){var _1006=0;dojo.forEach(_1005,function(child){if(child.sizeActual<child.sizeMin){_1006+=child.sizeMin-child.sizeActual;child.sizeActual=child.sizeMin;}});if(_1006>0){var list=this.isDraggingLeft?_1005.reverse():_1005;dojo.forEach(list,function(child){_1006=this._growPane(_1006,child);},this);}}else{dojo.forEach(_1005,function(child){child.sizeActual=Math.round(_1004*(child.sizeMin/_1003));});}},beginSizing:function(e,i){var _1007=this.getChildren();this.paneBefore=_1007[i];this.paneAfter=_1007[i+1];this.isSizing=true;this.sizingSplitter=this.sizers[i];if(!this.cover){this.cover=dojo.create("div",{style:{position:"absolute",zIndex:5,top:0,left:0,width:"100%",height:"100%"}},this.domNode);}else{this.cover.style.zIndex=5;}this.sizingSplitter.style.zIndex=6;this.originPos=dojo.position(_1007[0].domNode,true);if(this.isHorizontal){var _1008=e.layerX||e.offsetX||0;var _1009=e.pageX;this.originPos=this.originPos.x;}else{var _1008=e.layerY||e.offsetY||0;var _1009=e.pageY;this.originPos=this.originPos.y;}this.startPoint=this.lastPoint=_1009;this.screenToClientOffset=_1009-_1008;this.dragOffset=this.lastPoint-this.paneBefore.sizeActual-this.originPos-this.paneBefore.position;if(!this.activeSizing){this._showSizingLine();}this._ownconnects=[];this._ownconnects.push(dojo.connect(dojo.doc.documentElement,"onmousemove",this,"changeSizing"));this._ownconnects.push(dojo.connect(dojo.doc.documentElement,"onmouseup",this,"endSizing"));dojo.stopEvent(e);},changeSizing:function(e){if(!this.isSizing){return;}this.lastPoint=this.isHorizontal?e.pageX:e.pageY;this.movePoint();if(this.activeSizing){this._updateSize();}else{this._moveSizingLine();}dojo.stopEvent(e);},endSizing:function(e){if(!this.isSizing){return;}if(this.cover){this.cover.style.zIndex=-1;}if(!this.activeSizing){this._hideSizingLine();}this._updateSize();this.isSizing=false;if(this.persist){this._saveState(this);}dojo.forEach(this._ownconnects,dojo.disconnect);},movePoint:function(){var p=this.lastPoint-this.screenToClientOffset;var a=p-this.dragOffset;a=this.legaliseSplitPoint(a);p=a+this.dragOffset;this.lastPoint=p+this.screenToClientOffset;},legaliseSplitPoint:function(a){a+=this.sizingSplitter.position;this.isDraggingLeft=!!(a>0);if(!this.activeSizing){var min=this.paneBefore.position+this.paneBefore.sizeMin;if(a<min){a=min;}var max=this.paneAfter.position+(this.paneAfter.sizeActual-(this.sizerWidth+this.paneAfter.sizeMin));if(a>max){a=max;}}a-=this.sizingSplitter.position;this._checkSizes();return a;},_updateSize:function(){var pos=this.lastPoint-this.dragOffset-this.originPos;var _100a=this.paneBefore.position;var _100b=this.paneAfter.position+this.paneAfter.sizeActual;this.paneBefore.sizeActual=pos-_100a;this.paneAfter.position=pos+this.sizerWidth;this.paneAfter.sizeActual=_100b-this.paneAfter.position;dojo.forEach(this.getChildren(),function(child){child.sizeShare=child.sizeActual;});if(this._started){this.layout();}},_showSizingLine:function(){this._moveSizingLine();dojo.marginBox(this.virtualSizer,this.isHorizontal?{w:this.sizerWidth,h:this.paneHeight}:{w:this.paneWidth,h:this.sizerWidth});this.virtualSizer.style.display="block";},_hideSizingLine:function(){this.virtualSizer.style.display="none";},_moveSizingLine:function(){var pos=(this.lastPoint-this.startPoint)+this.sizingSplitter.position;dojo.style(this.virtualSizer,(this.isHorizontal?"left":"top"),pos+"px");},_getCookieName:function(i){return this.id+"_"+i;},_restoreState:function(){dojo.forEach(this.getChildren(),function(child,i){var _100c=this._getCookieName(i);var _100d=dojo.cookie(_100c);if(_100d){var pos=parseInt(_100d);if(typeof pos=="number"){child.sizeShare=pos;}}},this);},_saveState:function(){if(!this.persist){return;}dojo.forEach(this.getChildren(),function(child,i){dojo.cookie(this._getCookieName(i),child.sizeShare,{expires:365});},this);}});dojo.extend(dijit._Widget,{sizeMin:10,sizeShare:10});}if(!dojo._hasResource["plugins.view.jbrowse.js.Browser"]){dojo._hasResource["plugins.view.jbrowse.js.Browser"]=true;dojo.provide("plugins.view.jbrowse.js.Browser");dojo.declare("plugins.view.jbrowse.js.Browser",[dijit._Widget,dijit._Templated,plugins.core.Common],{templatePath:dojo.moduleUrl("","../plugins/view/templates/browser.html"),widgetsInTemplate:true,cssFiles:["dojo-1.6.1rc2/dojox/layout/resources/ExpandoPane.css"],constructor:function(args){this.loadCSS();this.viewObject=args.viewObject;this.parentWidget=args.parentWidget;this.projectName=args.projectName;this.viewName=args.viewName;this.speciesName=args.speciesName;this.buildName=args.buildName;this.location=args.location;this.locationObject=args.locationObject;this.params=args;this.refSeqs=args.refSeqs;this.trackData=args.trackData;this.deferredFunctions=[];this.tracks=args.tracks;this.trackList=args.trackList;this.dataRoot=args.dataRoot;this.dataRoot;if("dataRoot" in args){dataRoot=args.dataRoot;}else{dataRoot="";}this.attachWidget=args.attachWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.attachWidget.addChild(this.mainTab);this.attachWidget.selectChild(this.mainTab);this.mainTab.set("title",this.viewObject.project+"."+this.viewObject.view);this.topPane.titleNode.innerHTML=this.firstLetterUpperCase(this.viewObject.species)+" ("+this.viewObject.build+")";this.deferredFunctions=[];var _100e=this.refSeqs;var _100f=this.trackData;var _1010=this.dataRoot||"";this.names=new LazyTrie(_1010+"data/names/lazy-",_1010+"data/names/root.json");this.tracks=[];var brwsr=this;brwsr.isInitialized=false;brwsr.container=this.mainTab;brwsr.container.genomeBrowser=brwsr;var _1011=_100e.reduce(function(a,b){return a.end>b.end?a:b;}).end;var _1012=this.createNavBox(this.topPane,(2*(String(_1011).length+(((String(_1011).length/3)|0)/2)))+2,this.params);var _1013=this.topPane;var _1014=this.centerPane;brwsr.locationTrap=document.createElement("div");brwsr.locationTrap.className="locationTrap";this.topPane.domNode.appendChild(brwsr.locationTrap);brwsr.allRefs={};for(var i=0;i<_100e.length;i++){brwsr.allRefs[_100e[i].name]=_100e[i];}brwsr.refSeq=_100e[0];for(var i=0;i<_100e.length;i++){brwsr.chromList.options[i]=new Option(_100e[i].name,_100e[i].name);if(_100e[i].name.toUpperCase()==this.locationObject.name.toUpperCase()){brwsr.refSeq=brwsr.allRefs[_100e[i].name];brwsr.chromList.selectedIndex=i;}}dojo.connect(brwsr.chromList,"onchange",function(event){var _1015=brwsr.allRefs[brwsr.chromList.options[brwsr.chromList.selectedIndex].value];brwsr.navigateTo(_1015.name+":"+(((_1015.start+_1015.end)*0.4)|0)+" .. "+(((_1015.start+_1015.end)*0.6)|0));});var gv=new GenomeView(this.viewElem.containerNode,250,brwsr.refSeq,1/200,this);brwsr.view=gv;brwsr.viewElem=this.viewElem;this.viewElem.view=gv;dojo.connect(_1014,"resize",function(){gv.sizeInit();brwsr.view.locationTrapHeight=dojo.marginBox(_1012).h;gv.showVisibleBlocks();gv.showFine();gv.showCoarse();});brwsr.view.locationTrapHeight=dojo.marginBox(_1012).h;dojo.connect(gv,"onFineMove",brwsr,"onFineMove");dojo.connect(gv,"onCoarseMove",brwsr,"onCoarseMove");var _1016=brwsr.createTrackList(brwsr.container,this.params);brwsr.isInitialized=true;var _1017=dojo.fromJson(dojo.cookie(brwsr.container.id+"-location"))||{};if(this.params.location){brwsr.navigateTo(this.params.location);}else{if(_1017[brwsr.refSeq.name]){brwsr.navigateTo(brwsr.refSeq.name+":"+_1017[brwsr.refSeq.name]);}else{if(this.params.defaultLocation){brwsr.navigateTo(this.params.defaultLocation);}else{brwsr.navigateTo(brwsr.refSeq.name+":"+((((brwsr.refSeq.start+brwsr.refSeq.end)*0.4)|0)+" .. "+(((brwsr.refSeq.start+brwsr.refSeq.end)*0.6)|0)));}}}for(var i=0;i<brwsr.deferredFunctions.length;i++){brwsr.deferredFunctions[i]();}brwsr.deferredFunctions=[];},onFineMove:function(_1018,endbp){var _1019=this.view.ref.end-this.view.ref.start;var _101a=Math.round((((_1018-this.view.ref.start)/_1019)*this.view.overviewBox.w)+this.view.overviewBox.l);var _101b=Math.round((((endbp-this.view.ref.start)/_1019)*this.view.overviewBox.w)+this.view.overviewBox.l);var _101c;if(dojo.isIE){_101c="top: "+this.view.overviewBox.t+"px;"+"height: "+this.view.overviewBox.h+"px;"+"left: "+_101a+"px;"+"width: "+(_101b-_101a)+"px;"+"border-width: 0px";}else{_101c="top: "+this.view.overviewBox.t+"px;"+"height: "+this.view.overviewBox.h+"px;"+"left: "+this.view.overviewBox.l+"px;"+"width: "+(_101b-_101a)+"px;"+"border-width: "+"0px "+(this.view.overviewBox.w-_101b)+"px "+this.view.locationTrapHeight+"px "+_101a+"px;";}this.locationTrap.style.cssText=_101c;},createTrackList:function(_101d,_101e){var _101f=this.leftPane.containerNode;var _1020=this.leftPane;var _1021=document.createElement("div");_1021.className="container handles";_1021.style.cssText="width: 100%; height: 100%; overflow-x: hidden; overflow-y: auto; text-align: center";_1021.innerHTML="";_101f.appendChild(_1021);var brwsr=this;var _1022=function(){brwsr.view.showVisibleBlocks(true);};var _1023=function(node,url){node.ondblclick=function(event){window.open(url,"_blank");event.stopPropagation();};};var _1024=function(track,hint){var node=document.createElement("div");node.className="tracklist-label";node.innerHTML=track.key;for(var i=0;i<_101e.trackData.length;i++){if(_101e.trackData[i].label==track.label){if(_101e.trackData[i].urlInfo){_1023(node,_101e.trackData[i].urlInfo);}break;}}for(var i=0;i<_101e.trackData.length;i++){if(_101e.trackData[i].label==track.label){dojo.addClass(node,_101e.trackData[i].label+"-label");if(_101e.trackData[i].sourceType!=null){dojo.addClass(node,_101e.trackData[i].sourceType+"-label");}continue;}}if("avatar"!=hint){var _1025=document.createElement("div");_1025.className="tracklist-container";_1025.appendChild(node);node=_1025;}node.id=dojo.dnd.getUniqueId();return {node:node,data:track,type:["track"]};};this.listTracks=function(){var _1026=brwsr.viewDndWidget.getAllNodes();var array=[];for(var i=0;i<_1026.length;i++){array.push(_1026[i].track.name);}var _1027=array.join(",");return _1027;};this.trackListWidget=new dojo.dnd.Source(_1021,{creator:_1024,accept:["track"],withHandles:false});var _1028=function(track,hint){var node;if("avatar"==hint){return _1024(track,hint);}else{var _1029={refseq:brwsr.refSeq.name};var url=track.url.replace(/\{([^}]+)\}/g,function(match,group){return _1029[group];});var klass=eval(track.type);var _102a=brwsr.dataRoot;var _102b=new klass(track,url,brwsr.refSeq,{changeCallback:_1022,trackPadding:brwsr.view.trackPadding,parentWidget:brwsr.parentWidget,baseUrl:_102a,charWidth:brwsr.view.charWidth,seqHeight:brwsr.view.seqHeight});node=brwsr.view.addTrack(_102b);setTimeout(function(){brwsr.viewObject.tracklist=brwsr.listTracks();brwsr.parentWidget.updateViewTracklist(brwsr.viewObject);},100);}return {node:node,data:track,type:["track"]};};this.viewDndWidget=new dojo.dnd.Source(this.view.zoomContainer,{creator:_1028,accept:["track"],withHandles:true});dojo.subscribe("/dnd/drop",function(_102c,nodes,_102d){brwsr.onVisibleTracksChanged();if(_102c===brwsr.viewDndWidget){if(_102c.anchor==null){brwsr.parentWidget.handleTrackChange(brwsr.viewObject,nodes[0].track.name,"remove");}else{brwsr.viewObject.tracklist=brwsr.listTracks();brwsr.parentWidget.updateViewTracklist(brwsr.viewObject);}}});this.trackListWidget.insertNodes(false,_101e.trackData);var _102e=this.trackList;if(_101e.tracks){this.showTracks(_101e.tracks);}else{if(_102e){this.showTracks(_102e);}else{if(_101e.defaultTracks){this.showTracks(_101e.defaultTracks);}}}return _1021;},onVisibleTracksChanged:function(){this.view.updateTrackList();var _102f=dojo.map(this.view.tracks,function(track){return track.name;});this.view.showVisibleBlocks();},addTracks:function(_1030,_1031){if(!this.isInitialized){var brwsr=this;this.deferredFunctions.push(function(){brwsr.addTracks(_1030,show);});return;}this.tracks.concat(_1030);if(show||(show===undefined)){this.showTracks(dojo.map(_1030,function(t){return t.label;}).join(","));}},navigateTo:function(loc){if(!this.isInitialized){var brwsr=this;this.deferredFunctions.push(function(){brwsr.navigateTo(loc);});return;}loc=dojo.trim(loc);var _1032=String(loc).match(/^(((\S*)\s*:)?\s*(-?[0-9,.]*[0-9])\s*(\.\.|-|\s+))?\s*(-?[0-9,.]+)$/i);if(_1032){if(_1032[3]){var _1033;for(ref in this.allRefs){if((_1032[3].toUpperCase()==ref.toUpperCase())||("CHR"+_1032[3].toUpperCase()==ref.toUpperCase())||(_1032[3].toUpperCase()=="CHR"+ref.toUpperCase())){_1033=ref;}}if(_1033){if(_1033==this.refSeq.name){this.view.setLocation(this.refSeq,parseInt(_1032[4].replace(/[,.]/g,"")),parseInt(_1032[6].replace(/[,.]/g,"")));}else{var _1034=[];this.viewDndWidget.forInItems(function(obj,id,map){_1034.push(obj.data);});for(var i=0;i<this.chromList.options.length;i++){if(this.chromList.options[i].text==_1033){this.chromList.selectedIndex=i;}}this.refSeq=this.allRefs[_1033];this.view.setLocation(this.refSeq,parseInt(_1032[4].replace(/[,.]/g,"")),parseInt(_1032[6].replace(/[,.]/g,"")));this.viewDndWidget.insertNodes(false,_1034);this.onVisibleTracksChanged();}return;}}else{if(_1032[4]){this.view.setLocation(this.refSeq,parseInt(_1032[4].replace(/[,.]/g,"")),parseInt(_1032[6].replace(/[,.]/g,"")));return;}else{if(_1032[6]){this.view.centerAtBase(parseInt(_1032[6].replace(/[,.]/g,"")));return;}}}}var brwsr=this;this.names.exactMatch(loc,function(_1035){var _1036;for(var i=0;i<_1035.length;i++){if(_1035[i][1]==loc){_1036=_1035[i];}}if(!_1036){for(var i=0;i<_1035.length;i++){if(_1035[i][1].toLowerCase()==loc.toLowerCase()){_1036=_1035[i];}}}if(!_1036){_1036=_1035[0];}var _1037=_1036[3];var endbp=_1036[4];var flank=Math.round((endbp-_1037)*0.2);brwsr.navigateTo(_1036[2]+":"+(_1037-flank)+".."+(endbp+flank));brwsr.showTracks(brwsr.names.extra[_1035[0][0]]);});},showTracks:function(_1038){if(!this.isInitialized){var brwsr=this;this.deferredFunctions.push(function(){brwsr.showTracks(_1038);});return;}var _1039=_1038.split(",");var _103a=[];var brwsr=this;for(var n=0;n<_1039.length;n++){this.trackListWidget.forInItems(function(obj,id,map){if(_1039[n]==obj.data.label){brwsr.viewDndWidget.insertNodes(false,[obj.data]);_103a.push(id);}});}var _103b;for(var i=0;i<_103a.length;i++){this.trackListWidget.delItem(_103a[i]);_103b=dojo.byId(_103a[i]);_103b=dojo.byId(_103a[i]);_103b.parentNode.removeChild(_103b);}this.onVisibleTracksChanged();},visibleRegion:function(){return this.view.ref.name+":"+Math.round(this.view.minVisible())+".."+Math.round(this.view.maxVisible());},visibleTracks:function(){var _103c=dojo.map(this.view.tracks,function(track){return track.name;});return _103c.join(",");},onCoarseMove:function(_103d,endbp){if(!_103d||!endbp){return;}if(!this.isInitialized){return;}var _103e=this.view.ref.end-this.view.ref.start;var _103f=Math.round((((_103d-this.view.ref.start)/_103e)*this.view.overviewBox.w)+this.view.overviewBox.l);var _1040=Math.round((((endbp-this.view.ref.start)/_103e)*this.view.overviewBox.w)+this.view.overviewBox.l);this.view.locationThumb.style.cssText="height: "+(this.view.overviewBox.h-4)+"px; "+"left: "+_103f+"px; "+"width: "+(_1040-_103f)+"px;"+"z-index: 20";if(!this.isInitialized){return;}var _1041=Util.addCommas(Math.round(_103d))+" .. "+Util.addCommas(Math.round(endbp));this.locationBox.value=_1041;this.goButton.disabled=true;this.locationBox.blur();document.title=this.refSeq.name+":"+_1041;},createNavBox:function(_1042,_1043,_1044){var brwsr=this;var _1045=_1044.browserRoot?_1044.browserRoot:"";var _1046=this.navbox;if(_1044.bookmark){this.link=document.createElement("a");this.link.appendChild(document.createTextNode("Link"));this.link.href=window.location.href;dojo.connect(this,"onCoarseMove",function(){brwsr.link.href=_1044.bookmark(brwsr);});dojo.connect(this,"onVisibleTracksChanged",function(){brwsr.link.href=_1044.bookmark(brwsr);});this.link.style.cssText="float: right; clear";_1046.appendChild(this.link);}this.saveButton=document.createElement("button");this.saveButton.appendChild(document.createTextNode("Save Location"));dojo.addClass(this.saveButton,"saveButton");dojo.connect(this.saveButton,"click",function(event){console.log("Browser.createNavBox    Save Location Button click    brwsr.locationBox.value: "+brwsr.locationBox.value);brwsr.parentWidget.updateViewLocation(brwsr.viewObject,brwsr.locationBox.value,brwsr.chromList.value);dojo.stopEvent(event);});_1046.appendChild(this.saveButton);var _1047=document.createElement("input");_1047.type="image";_1047.src=_1045+"img/slide-left.png";_1047.id="moveLeft";_1047.className="icon nav";_1047.style.height="40px";dojo.connect(_1047,"click",function(event){dojo.stopEvent(event);brwsr.view.slide(0.9);});_1046.appendChild(_1047);var _1048=document.createElement("input");_1048.type="image";_1048.src=_1045+"img/slide-right.png";_1048.id="moveRight";_1048.className="icon nav";_1048.style.height="40px";dojo.connect(_1048,"click",function(event){dojo.stopEvent(event);brwsr.view.slide(-0.9);});_1046.appendChild(_1048);_1046.appendChild(document.createTextNode(""));var _1049=document.createElement("input");_1049.type="image";_1049.src=_1045+"img/zoom-out-2.png";_1049.id="bigZoomOut";_1049.className="icon nav";_1049.style.height="40px";_1046.appendChild(_1049);dojo.connect(_1049,"click",function(event){dojo.stopEvent(event);brwsr.view.zoomOut(undefined,undefined,2);});var _104a=document.createElement("input");_104a.type="image";_104a.src=_1045+"img/zoom-out-1.png";_104a.id="zoomOut";_104a.className="icon nav";_104a.style.height="40px";dojo.connect(_104a,"click",function(event){dojo.stopEvent(event);brwsr.view.zoomOut();});_1046.appendChild(_104a);var _104b=document.createElement("input");_104b.type="image";_104b.src=_1045+"img/zoom-in-1.png";_104b.id="zoomIn";_104b.className="icon nav";_104b.style.height="40px";dojo.connect(_104b,"click",function(event){dojo.stopEvent(event);brwsr.view.zoomIn();});_1046.appendChild(_104b);var _104c=document.createElement("input");_104c.type="image";_104c.src=_1045+"img/zoom-in-2.png";_104c.id="bigZoomIn";_104c.className="icon nav";_104c.style.height="40px";dojo.connect(_104c,"click",function(event){dojo.stopEvent(event);brwsr.view.zoomIn(undefined,undefined,2);});_1046.appendChild(_104c);_1046.appendChild(document.createTextNode(""));this.chromList=document.createElement("select");this.chromList.id="chrom";dojo.addClass(this.chromList,"chromList");_1046.appendChild(this.chromList);this.locationBox=document.createElement("input");this.locationBox.size=_1043;this.locationBox.type="text";this.locationBox.id="location";dojo.connect(this.locationBox,"keydown",function(event){if(event.keyCode==dojo.keys.ENTER){brwsr.navigateTo(brwsr.locationBox.value);brwsr.goButton.disabled=true;dojo.stopEvent(event);}else{brwsr.goButton.disabled=false;}});_1046.appendChild(this.locationBox);this.goButton=document.createElement("button");this.goButton.appendChild(document.createTextNode("Go"));this.goButton.disabled=true;dojo.connect(this.goButton,"click",function(event){brwsr.navigateTo(brwsr.locationBox.value);brwsr.goButton.disabled=true;dojo.stopEvent(event);});_1046.appendChild(this.goButton);dojo.addClass(this.goButton,"goButton");return _1046;}});}if(!dojo._hasResource["plugins.view.jbrowse.js.Util"]){dojo._hasResource["plugins.view.jbrowse.js.Util"]=true;dojo.provide("plugins.view.jbrowse.js.Util");dojo.declare("plugins.view.jbrowse.js.Util",null,{});var Util={};Util.is_ie=navigator.appVersion.indexOf("MSIE")>=0;Util.is_ie6=navigator.appVersion.indexOf("MSIE 6")>=0;Util.addCommas=function(nStr){nStr+="";x=nStr.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,"$1"+","+"$2");}return x1+x2;};Util.wheel=function(event){var delta=0;if(!event){event=window.event;}if(event.wheelDelta){delta=event.wheelDelta/120;if(window.opera){delta=-delta;}}else{if(event.detail){delta=-event.detail/3;}}return Math.round(delta);};Util.isRightButton=function(e){if(!e){var e=window.event;}if(e.which){return e.which==3;}else{if(e.button){return e.button==2;}}};Util.getViewportWidth=function(){var width=0;if(document.documentElement&&document.documentElement.clientWidth){width=document.documentElement.clientWidth;}else{if(document.body&&document.body.clientWidth){width=document.body.clientWidth;}else{if(window.innerWidth){width=window.innerWidth-18;}}}return width;};Util.getViewportHeight=function(){var _104d=0;if(document.documentElement&&document.documentElement.clientHeight){_104d=document.documentElement.clientHeight;}else{if(document.body&&document.body.clientHeight){_104d=document.body.clientHeight;}else{if(window.innerHeight){_104d=window.innerHeight-18;}}}return _104d;};Util.findNearest=function(_104e,num){var _104f=0;var min=Math.abs(num-_104e[0]);for(var i=0;i<_104e.length;i++){if(Math.abs(num-_104e[i])<min){_104f=i;min=Math.abs(num-_104e[i]);}}return _104f;};if(!Array.prototype.reduce){Array.prototype.reduce=function(fun){var len=this.length;if(typeof fun!="function"){throw new TypeError();}if(len==0&&arguments.length==1){throw new TypeError();}var i=0;if(arguments.length>=2){var rv=arguments[1];}else{do{if(i in this){rv=this[i++];break;}if(++i>=len){throw new TypeError();}}while(true);}for(;i<len;i++){if(i in this){rv=fun.call(null,rv,this[i],i,this);}}return rv;};}function Finisher(fun){this.fun=fun;this.count=0;};Finisher.prototype.inc=function(){this.count++;};Finisher.prototype.dec=function(){this.count--;this.finish();};Finisher.prototype.finish=function(){if(this.count<=0){this.fun();}};}if(!dojo._hasResource["plugins.view.jbrowse.js.NCList"]){dojo._hasResource["plugins.view.jbrowse.js.NCList"]=true;dojo.provide("plugins.view.jbrowse.js.NCList");dojo.declare("plugins.view.jbrowse.js.NCList",null,{});function NCList(){};NCList.prototype.importExisting=function(_1050,_1051,_1052,_1053,_1054){this.topList=_1050;this.sublistIndex=_1051;this.lazyIndex=_1052;this.baseURL=_1053;this.lazyUrlTemplate=_1054;};NCList.prototype.fill=function(_1055,_1056){this.sublistIndex=_1056;var _1057=_1055;_1057.sort(function(a,b){if(a[0]!=b[0]){return a[0]-b[0];}else{return b[1]-a[1];}});var _1058=new Array();var _1059=new Array();this.topList=_1059;_1059.push(_1057[0]);var _105a,_105b;for(var i=1,len=_1057.length;i<len;i++){_105a=_1057[i];if(_105a[1]<_1057[i-1][1]){_1058.push(_1059);_1059=new Array(_105a);_1057[i-1][_1056]=_1059;}else{while(true){if(0==_1058.length){_1059.push(_105a);break;}else{_105b=_1058[_1058.length-1];if(_105b[_105b.length-1][1]>_105a[1]){_1059.push(_105a);break;}else{_1059=_1058.pop();}}}}}};NCList.prototype.binarySearch=function(arr,item,_105c){var low=-1;var high=arr.length;var mid;while(high-low>1){mid=(low+high)>>>1;if(arr[mid][_105c]>item){high=mid;}else{low=mid;}}if(1==_105c){return high;}else{return low;}};NCList.prototype.iterHelper=function(arr,from,to,fun,_105d,inc,_105e,_105f,path){var len=arr.length;var i=this.binarySearch(arr,from,_105e);while((i<len)&&(i>=0)&&((inc*arr[i][_105f])<(inc*to))){if("object"==typeof arr[i][this.lazyIndex]){var ncl=this;if(arr[i][this.lazyIndex].state){if("loading"==arr[i][this.lazyIndex].state){_105d.inc();arr[i][this.lazyIndex].callbacks.push(function(_1060){return function(o){ncl.iterHelper(o,from,to,fun,_105d,inc,_105e,_105f,path.concat(_1060));_105d.dec();};}(i));}else{if("loaded"==arr[i][this.lazyIndex].state){}else{}}}else{arr[i][this.lazyIndex].state="loading";arr[i][this.lazyIndex].callbacks=[];_105d.inc();dojo.xhrGet({url:this.baseURL+this.lazyUrlTemplate.replace(/\{chunk\}/g,arr[i][this.lazyIndex].chunk),handleAs:"json",load:function(_1061,_1062,_1063,_1064){return function(o){_1062.state="loaded";_1061[_1063]=o;ncl.iterHelper(o,from,to,fun,_105d,inc,_105e,_105f,path.concat(_1064));for(var c=0;c<_1062.callbacks.length;c++){_1062.callbacks[c](o);}_105d.dec();};}(arr[i],arr[i][this.lazyIndex],this.sublistIndex,i),error:function(){_105d.dec();}});}}else{fun(arr[i],path.concat(i));}if(arr[i][this.sublistIndex]){this.iterHelper(arr[i][this.sublistIndex],from,to,fun,_105d,inc,_105e,_105f,path.concat(i));}i+=inc;}};NCList.prototype.iterate=function(from,to,fun,_1065){var inc=(from>to)?-1:1;var _1066=(from>to)?0:1;var _1067=(from>to)?1:0;var _1068=new Finisher(_1065);this.iterHelper(this.topList,from,to,fun,_1068,inc,_1066,_1067,[]);_1068.finish();};NCList.prototype.histogram=function(from,to,_1069,_106a){var _106b=new Array(_1069);var _106c=(to-from)/_1069;for(var i=0;i<_1069;i++){_106b[i]=0;}this.iterate(from,to,function(feat){var _106d=Math.max(0,((feat[0]-from)/_106c)|0);var _106e=Math.min(_1069,((feat[1]-from)/_106c)|0);for(var bin=_106d;bin<=_106e;bin++){_106b[bin]++;}},function(){_106a(_106b);});};}if(!dojo._hasResource["plugins.view.jbrowse.js.Layout"]){dojo._hasResource["plugins.view.jbrowse.js.Layout"]=true;dojo.provide("plugins.view.jbrowse.js.Layout");dojo.declare("plugins.view.jbrowse.js.Layout",null,{});function Contour(top){if(top===undefined){top=0;}this.spans=[{top:top,x:Infinity,height:0}];};Contour.prototype.getFit=function(x,_106f,_1070){var _1071,_1072;var above=0;if(_1070){for(;this.spans[above].top<_1070;above++){if(above>=(this.spans.length-1)){return {above:this.spans.length-1,count:0};}}}ABOVE:for(;above<this.spans.length;above++){_1071=this.spans[above].top+this.spans[above].height;for(var count=1;above+count<this.spans.length;count++){_1072=this.spans[above+count];if((_1071+_106f)<=_1072.top){return {above:above,count:count-1};}if(_1072.x>x){continue ABOVE;}if((_1072.x<=x)&&((_1071+_106f)<(_1072.top+_1072.height))){return {above:above,count:count-1};}}return {above:above,count:count-1};}return {above:above,count:0};};Contour.prototype.insertFit=function(fit,x,top,_1073){var _1074=this.spans[fit.above];if((Math.abs(_1074.x-x)<1)&&(Math.abs((_1074.top+_1074.height)-top)<1)){_1074.height=(top+_1073)-_1074.top;_1074.x=Math.max(_1074.x,x);this.spans.splice(fit.above+1,fit.count);}else{this.spans.splice(fit.above+1,fit.count,{top:top,x:x,height:_1073});}};Contour.prototype.unionWith=function(x,top,_1075){var _1076,_1077,_1078,_1079,_107a;var _107b=top+_1075;START:for(_1077=0;_1077<this.spans.length;_1077++){_1079=this.spans[_1077];_1076=_1079.top+_1079.height;if(_1079.top>top){_1078=_1077;break START;}if(_1076>top){if(_1079.x>=x){var _107c=_1076-top;top+=_107c;_1075-=_107c;if(top>=_107b){return;}continue;}else{for(_1078=_1077;_1078<this.spans.length;_1078++){_107a=this.spans[_1078];if(((_107a.top+_107a.height)>_107b)||_107a.x>x){break START;}}break START;}}}var _107d=this.spans[_1077-1];if((Math.abs(_107d.x-x)<1)&&(Math.abs((_107d.top+_107d.height)-top)<1)){_107d.height=(top+_1075)-_107d.top;_107d.x=Math.max(_107d.x,x);this.spans.splice(_1077,_1078-_1077);}else{this.spans.splice(_1077,_1078-_1077,{top:top,x:x,height:_1075});}};Contour.prototype.getNextTop=function(fit){return this.spans[fit.above].top+this.spans[fit.above].height;};function Layout(_107e,_107f){this.leftBound=_107e;this.rightBound=_107f;this.leftContour=new Contour();this.rightContour=new Contour();this.seen={};this.leftOverlaps=[];this.rightOverlaps=[];this.totalHeight=0;};Layout.prototype.addRect=function(id,left,right,_1080){if(this.seen[id]!==undefined){return this.seen[id];}var _1081=this.tryLeftFit(left,right,_1080,0);var _1082=this.tryRightFit(left,right,_1080,0);var top;if(_1081.top<_1082.top){top=_1081.top;this.leftContour.insertFit(_1081.fit,this.rightBound-left,top,_1080);this.rightContour.unionWith(right-this.leftBound,top,_1080);}else{top=_1082.top;this.rightContour.insertFit(_1082.fit,right-this.leftBound,top,_1080);this.leftContour.unionWith(this.rightBound-left,top,_1080);}var _1083={id:id,left:left,right:right,top:top,height:_1080};this.seen[id]=top;if(left<=this.leftBound){this.leftOverlaps.push(_1083);if(this.leftLayout){this.leftLayout.addExisting(_1083);}}if(right>=this.rightBound){this.rightOverlaps.push(_1083);if(this.rightLayout){this.rightLayout.addExisting(_1083);}}this.seen[id]=top;this.totalHeight=Math.max(this.totalHeight,top+_1080);return top;};Layout.prototype.tryLeftFit=function(left,right,_1084,top){var fit,_1085;var _1086=top;while(true){fit=this.leftContour.getFit(this.rightBound-right,_1084,_1086);_1086=Math.max(this.leftContour.getNextTop(fit),_1086);if(this.rightLayout&&(right>=this.rightBound)){_1085=this.rightLayout.tryLeftFit(left,right,_1084,_1086);if(_1085.top>_1086){_1086=_1085.top;continue;}}break;}return {top:_1086,fit:fit};};Layout.prototype.tryRightFit=function(left,right,_1087,top){var fit,_1088;var _1089=top;while(true){fit=this.rightContour.getFit(left-this.leftBound,_1087,_1089);_1089=Math.max(this.rightContour.getNextTop(fit),_1089);if(this.leftLayout&&(left<=this.leftBound)){_1088=this.leftLayout.tryRightFit(left,right,_1087,_1089);if(_1088.top>_1089){_1089=_1088.top;continue;}}break;}return {top:_1089,fit:fit};};Layout.prototype.hasSeen=function(id){return (this.seen[id]!==undefined);};Layout.prototype.setLeftLayout=function(left){for(var i=0;i<this.leftOverlaps.length;i++){left.addExisting(this.leftOverlaps[i]);}this.leftLayout=left;};Layout.prototype.setRightLayout=function(right){for(var i=0;i<this.rightOverlaps.length;i++){right.addExisting(this.rightOverlaps[i]);}this.rightLayout=right;};Layout.prototype.cleanup=function(){this.leftLayout=undefined;this.rightLayout=undefined;};Layout.prototype.addExisting=function(_108a){if(this.seen[_108a.id]!==undefined){return;}this.seen[_108a.id]=_108a.top;this.totalHeight=Math.max(this.totalHeight,_108a.top+_108a.height);if(_108a.left<=this.leftBound){this.leftOverlaps.push(_108a);if(this.leftLayout){this.leftLayout.addExisting(_108a);}}if(_108a.right>=this.rightBound){this.rightOverlaps.push(_108a);if(this.rightLayout){this.rightLayout.addExisting(_108a);}}this.leftContour.unionWith(this.rightBound-_108a.left,_108a.top,_108a.height);this.rightContour.unionWith(_108a.right-this.leftBound,_108a.top,_108a.height);};}if(!dojo._hasResource["plugins.view.jbrowse.js.LazyArray"]){dojo._hasResource["plugins.view.jbrowse.js.LazyArray"]=true;dojo.provide("plugins.view.jbrowse.js.LazyArray");dojo.declare("plugins.view.jbrowse.js.LazyArray",null,{});function LazyArray(_108b,_108c){this.urlTemplate=_108b.urlTemplate;this.chunkSize=_108b.chunkSize;this.length=_108b.length;this.baseUrl=(_108c===undefined?"":_108c);this.chunks=[];this.toProcess={};};LazyArray.prototype.index=function(i,_108d,param){this.range(i,i,_108d,undefined,param);};LazyArray.prototype.range=function(start,end,_108e,_108f,param){start=Math.max(0,start);end=Math.min(end,this.length-1);var _1090=Math.floor(start/this.chunkSize);var _1091=Math.floor(end/this.chunkSize);if(_108f===undefined){_108f=function(){};}var _1092=new Finisher(_108f);for(var chunk=_1090;chunk<=_1091;chunk++){if(this.chunks[chunk]){this._processChunk(start,end,chunk,_108e,param);}else{var _1093={start:start,end:end,callback:_108e,param:param,finish:_1092};_1092.inc();if(this.toProcess[chunk]){this.toProcess[chunk].push(_1093);}else{this.toProcess[chunk]=[_1093];var url=this.urlTemplate.replace(/\{chunk\}/g,chunk);var _1094=this;dojo.xhrGet({url:this.baseUrl+url,handleAs:"json",load:this._makeLoadFun(chunk),error:function(){_1092.dec();}});}}}_1092.finish();};LazyArray.prototype._makeLoadFun=function(chunk){var _1095=this;return function(data){_1095.chunks[chunk]=data;var _1096=_1095.toProcess[chunk];delete _1095.toProcess[chunk];for(var i=0;i<_1096.length;i++){_1095._processChunk(_1096[i].start,_1096[i].end,chunk,_1096[i].callback,_1096[i].param);_1096[i].finish.dec();}};};LazyArray.prototype._processChunk=function(start,end,chunk,_1097,param){var _1098=chunk*this.chunkSize;var _1099=start-_1098;var _109a=end-_1098;_1099=Math.max(0,_1099);_109a=Math.min(_109a,this.chunkSize-1);for(var i=_1099;i<=_109a;i++){_1097(i+_1098,this.chunks[chunk][i],param);}};}if(!dojo._hasResource["plugins.view.jbrowse.js.LazyPatricia"]){dojo._hasResource["plugins.view.jbrowse.js.LazyPatricia"]=true;dojo.provide("plugins.view.jbrowse.js.LazyPatricia");dojo.declare("plugins.view.jbrowse.js.LazyPatricia",null,{});function LazyTrie(_109b,_109c){this.baseURL=_109b;var trie=this;dojo.xhrGet({url:_109c,handleAs:"json",load:function(o){if(!o){return;}trie.root=o;trie.extra=o[0];if(trie.deferred){trie.deferred.callee.apply(trie,trie.deferred);delete trie.deferred;}}});};LazyTrie.prototype.pathToPrefix=function(path){var node=this.root;var _109d="";loop:for(var i=0;i<path.length;i++){switch(typeof node[path[i]][0]){case "string":_109d+=node[path[i]][0];break;case "number":_109d+=node[path[i]][1];break loop;}node=node[path[i]];}return _109d;};LazyTrie.prototype.valuesFromPrefix=function(query,_109e){var trie=this;this.findNode(query,function(_109f,node){_109e(trie.valuesFromNode(node));});};LazyTrie.prototype.mappingsFromPrefix=function(query,_10a0){var trie=this;this.findNode(query,function(_10a1,node){_10a0(trie.mappingsFromNode(_10a1,node));});};LazyTrie.prototype.mappingsFromNode=function(_10a2,node){var _10a3=[];if(node[1]!==null){_10a3.push([_10a2,node[1]]);}for(var i=2;i<node.length;i++){if("string"==typeof node[i][0]){_10a3=_10a3.concat(this.mappingsFromNode(_10a2+node[i][0],node[i]));}}return _10a3;};LazyTrie.prototype.valuesFromNode=function(node){var _10a4=[];if(node[1]!==null){_10a4.push(node[1]);}for(var i=2;i<node.length;i++){_10a4=_10a4.concat(this.valuesFromNode(node[i]));}return _10a4;};LazyTrie.prototype.exactMatch=function(key,_10a5){var trie=this;this.findNode(key,function(_10a6,node){if((_10a6.toLowerCase()==key.toLowerCase())&&node[1]){_10a5(node[1]);}});};LazyTrie.prototype.findNode=function(query,_10a7){var trie=this;this.findPath(query,function(path){var node=trie.root;for(i=0;i<path.length;i++){node=node[path[i]];}var _10a8=trie.pathToPrefix(path);_10a7(_10a8,node);});};LazyTrie.prototype.findPath=function(query,_10a9){if(!this.root){this.deferred=arguments;return;}query=query.toLowerCase();var node=this.root;var _10aa=0;var _10ab;var path=[];while(true){_10ab=this.binarySearch(node,query.charAt(_10aa));if(_10ab<0){return;}path.push(_10ab);if("number"==typeof node[_10ab][0]){var trie=this;dojo.xhrGet({url:this.baseURL+this.pathToPrefix(path)+".json",handleAs:"json",load:function(o){node[_10ab]=o;trie.findPath(query,_10a9);}});return;}node=node[_10ab];if(query.substr(_10aa,node[0].length)!=node[0].substr(0,Math.min(node[0].length,query.length-_10aa))){return;}_10aa+=node[0].length;if(_10aa>=query.length){_10a9(path);return;}}};LazyTrie.prototype.binarySearch=function(a,_10ac){var low=2;var high=a.length-1;var mid,_10ad;while(low<=high){mid=(low+high)>>>1;switch(typeof a[mid][0]){case "string":_10ad=a[mid][0].charAt(0);break;case "number":_10ad=a[mid][1].charAt(0);break;}if(_10ad<_10ac){low=mid+1;}else{if(_10ad>_10ac){high=mid-1;}else{return mid;}}}return -(low+1);};}if(!dojo._hasResource["plugins.view.jbrowse.js.Track"]){dojo._hasResource["plugins.view.jbrowse.js.Track"]=true;dojo.provide("plugins.view.jbrowse.js.Track");dojo.declare("plugins.view.jbrowse.js.Track",null,{});function Track(name,key,_10ae,_10af){this.name=name;this.key=key;this.loaded=_10ae;this.changed=_10af;this.height=0;this.shown=true;this.empty=false;};Track.prototype.load=function(url){var _10b0=this;dojo.xhrGet({url:url,handleAs:"json",load:function(o){_10b0.loadSuccess(o);},error:function(o){_10b0.loadFail(o);}});};Track.prototype.loadFail=function(error){this.empty=true;this.setLoaded();};Track.prototype.setViewInfo=function(_10b1,_10b2,_10b3,_10b4,_10b5,_10b6,scale){var track=this;this.heightUpdate=function(_10b7,_10b8){if(!this.shown){_10b1(0);return;}if(_10b8!==undefined){track.blockHeights[_10b8]=_10b7;}track.height=Math.max(track.height,_10b7);if(!track.inShowRange){_10b1(Math.max(track.labelHeight,track.height));}};this.div=_10b3;this.label=_10b4;this.widthPct=_10b5;this.widthPx=_10b6;this.leftBlank=document.createElement("div");this.leftBlank.className="blank-block";this.rightBlank=document.createElement("div");this.rightBlank.className="blank-block";this.div.appendChild(this.rightBlank);this.div.appendChild(this.leftBlank);this.sizeInit(_10b2,_10b5);this.labelHTML="";this.labelHeight=0;};Track.prototype.hide=function(){if(this.shown){this.div.style.display="none";this.shown=false;}};Track.prototype.show=function(){if(!this.shown){this.div.style.display="block";this.shown=true;}};Track.prototype.initBlocks=function(){this.blocks=new Array(this.numBlocks);this.blockHeights=new Array(this.numBlocks);for(var i=0;i<this.numBlocks;i++){this.blockHeights[i]=0;}this.firstAttached=null;this.lastAttached=null;this._adjustBlanks();};Track.prototype.clear=function(){if(this.blocks){for(var i=0;i<this.numBlocks;i++){this._hideBlock(i);}}this.initBlocks();};Track.prototype.setLabel=function(_10b9){if(this.label===undefined){return;}if(this.labelHTML==_10b9){return;}this.labelHTML=_10b9;this.label.innerHTML=_10b9;this.labelHeight=this.label.offsetHeight;};Track.prototype.transfer=function(){};Track.prototype.startZoom=function(_10ba,_10bb,_10bc){};Track.prototype.endZoom=function(_10bd,_10be){};Track.prototype.showRange=function(first,last,_10bf,_10c0,scale,_10c1,_10c2){if(this.blocks===undefined){return 0;}if((this.labelHeight==0)&&this.label){this.labelHeight=this.label.offsetHeight;}this.inShowRange=true;this.height=this.labelHeight;var _10c3=(null==this.firstAttached?last+1:this.firstAttached);var _10c4=(null==this.lastAttached?first-1:this.lastAttached);var i,_10c5;var _10c6=0;for(i=_10c4;i>=first;i--){_10c5=_10bf+(_10c0*(i-first));this._showBlock(i,_10c5,_10c5+_10c0,scale,_10c1,_10c2);}for(i=_10c4+1;i<=last;i++){_10c5=_10bf+(_10c0*(i-first));this._showBlock(i,_10c5,_10c5+_10c0,scale,_10c1,_10c2);}var _10c7=this.blocks[first];for(i=_10c3;i<first;i++){this.transfer(this.blocks[i],_10c7,scale,_10c1,_10c2);this.cleanupBlock(this.blocks[i]);this._hideBlock(i);}_10c7=this.blocks[last];for(i=_10c4;i>last;i--){this.transfer(this.blocks[i],_10c7,scale,_10c1,_10c2);this.cleanupBlock(this.blocks[i]);this._hideBlock(i);}this.firstAttached=first;this.lastAttached=last;this._adjustBlanks();this.inShowRange=false;this.heightUpdate(this.height);};Track.prototype.cleanupBlock=function(){};Track.prototype._hideBlock=function(_10c8){if(this.blocks[_10c8]){this.div.removeChild(this.blocks[_10c8]);this.blocks[_10c8]=undefined;this.blockHeights[_10c8]=0;}};Track.prototype._adjustBlanks=function(){if((this.firstAttached===null)||(this.lastAttached===null)){this.leftBlank.style.left="0px";this.leftBlank.style.width="50%";this.rightBlank.style.left="50%";this.rightBlank.style.width="50%";}else{this.leftBlank.style.width=(this.firstAttached*this.widthPct)+"%";this.rightBlank.style.left=((this.lastAttached+1)*this.widthPct)+"%";this.rightBlank.style.width=((this.numBlocks-this.lastAttached-1)*this.widthPct)+"%";}};Track.prototype.hideAll=function(){if(null==this.firstAttached){return;}for(var i=this.firstAttached;i<=this.lastAttached;i++){this._hideBlock(i);}this.firstAttached=null;this.lastAttached=null;this._adjustBlanks();};Track.prototype.setLoaded=function(){this.loaded=true;this.hideAll();this.changed();};Track.prototype._loadingBlock=function(_10c9){_10c9.appendChild(document.createTextNode("Loading..."));_10c9.style.backgroundColor="#eee";return 50;};Track.prototype._showBlock=function(_10ca,_10cb,_10cc,scale,_10cd,_10ce){if(this.blocks[_10ca]){this.heightUpdate(this.blockHeights[_10ca],_10ca);return;}if(this.empty){this.heightUpdate(this.labelHeight,_10ca);return;}var _10cf=document.createElement("div");_10cf.className="block";_10cf.style.left=(_10ca*this.widthPct)+"%";_10cf.style.width=this.widthPct+"%";_10cf.startBase=_10cb;_10cf.endBase=_10cc;if(this.loaded){this.fillBlock(_10ca,_10cf,this.blocks[_10ca-1],this.blocks[_10ca+1],_10cb,_10cc,scale,this.widthPx,_10cd,_10ce);}else{this._loadingBlock(_10cf);}this.blocks[_10ca]=_10cf;this.div.appendChild(_10cf);};Track.prototype.moveBlocks=function(delta){var _10d0=new Array(this.numBlocks);var _10d1=new Array(this.numBlocks);var i;for(i=0;i<this.numBlocks;i++){_10d1[i]=0;}var _10d2;if((this.lastAttached+delta<0)||(this.firstAttached+delta>=this.numBlocks)){this.firstAttached=null;this.lastAttached=null;}else{this.firstAttached=Math.max(0,Math.min(this.numBlocks-1,this.firstAttached+delta));this.lastAttached=Math.max(0,Math.min(this.numBlocks-1,this.lastAttached+delta));if(delta<0){_10d2=this.blocks[this.firstAttached-delta];}else{_10d2=this.blocks[this.lastAttached-delta];}}for(i=0;i<this.blocks.length;i++){var _10d3=i+delta;if((_10d3<0)||(_10d3>=this.numBlocks)){if(_10d2&&this.blocks[i]){this.transfer(this.blocks[i],_10d2);}this._hideBlock(i);}else{_10d0[_10d3]=this.blocks[i];if(_10d0[_10d3]){_10d0[_10d3].style.left=((_10d3)*this.widthPct)+"%";}_10d1[_10d3]=this.blockHeights[i];}}this.blocks=_10d0;this.blockHeights=_10d1;this._adjustBlanks();};Track.prototype.sizeInit=function(_10d4,_10d5,_10d6){var i,_10d7;this.numBlocks=_10d4;this.widthPct=_10d5;if(_10d6){this.moveBlocks(-_10d6);}if(this.blocks&&(this.blocks.length>0)){var _10d8=this.blocks[_10d4-1];for(i=_10d4;i<this.blocks.length;i++){if(_10d8&&this.blocks[i]){this.transfer(this.blocks[i],_10d8);}this._hideBlock(i);}_10d7=this.blocks.length;this.blocks.length=_10d4;this.blockHeights.length=_10d4;for(i=_10d7;i<_10d4;i++){this.blocks[i]=undefined;this.blockHeights[i]=0;}this.lastAttached=Math.min(this.lastAttached,_10d4-1);if(this.firstAttached>this.lastAttached){this.firstAttached=null;this.lastAttached=null;}if(this.blocks.length!=_10d4){throw new Error("block number mismatch: should be "+_10d4+"; blocks.length: "+this.blocks.length);}for(i=0;i<_10d4;i++){if(this.blocks[i]){this.blocks[i].style.left=(i*_10d5)+"%";this.blocks[i].style.width=_10d5+"%";}}}else{this.initBlocks();}};}if(!dojo._hasResource["plugins.view.jbrowse.js.SequenceTrack"]){dojo._hasResource["plugins.view.jbrowse.js.SequenceTrack"]=true;dojo.provide("plugins.view.jbrowse.js.SequenceTrack");dojo.declare("plugins.view.jbrowse.js.SequenceTrack",null,{});function SequenceTrack(_10d9,url,_10da,_10db){Track.call(this,_10d9.label,_10d9.key,false,_10db.changeCallback);this.browserParams=_10db;this.trackMeta=_10d9;this.setLoaded();this.chunks=[];this.chunkSize=_10d9.args.chunkSize;this.baseUrl=(_10db.baseUrl?_10db.baseUrl:"")+url;};SequenceTrack.prototype=new Track("");SequenceTrack.prototype.startZoom=function(_10dc,_10dd,_10de){this.hide();this.heightUpdate(0);};SequenceTrack.prototype.endZoom=function(_10df,_10e0){if(_10df==this.browserParams.charWidth){this.show();}Track.prototype.clear.apply(this);};SequenceTrack.prototype.setViewInfo=function(_10e1,_10e2,_10e3,_10e4,_10e5,_10e6,scale){Track.prototype.setViewInfo.apply(this,[_10e1,_10e2,_10e3,_10e4,_10e5,_10e6,scale]);if(scale==this.browserParams.charWidth){this.show();}else{this.hide();}this.setLabel(this.key);};SequenceTrack.prototype.fillBlock=function(_10e7,block,_10e8,_10e9,_10ea,_10eb,scale,_10ec,_10ed,_10ee){if(this.shown){this.getRange(_10ea,_10eb,function(start,end,seq){var _10ef=document.createElement("div");_10ef.className="sequence";_10ef.appendChild(document.createTextNode(seq));_10ef.style.cssText="top: 0px;";block.appendChild(_10ef);});this.heightUpdate(this.browserParams.seqHeight,_10e7);}else{this.heightUpdate(0,_10e7);}};SequenceTrack.prototype.getRange=function(start,end,_10f0){var _10f1=Math.floor((start)/this.chunkSize);var _10f2=Math.floor((end-1)/this.chunkSize);var _10f3={start:start,end:end,callback:_10f0};var _10f4=this.chunkSize;var chunk;for(var i=_10f1;i<=_10f2;i++){chunk=this.chunks[i];if(chunk){if(chunk.loaded){_10f0(start,end,chunk.sequence.substring(start-(i*_10f4),end-(i*_10f4)));}else{chunk.callbacks.push(_10f3);}}else{chunk={loaded:false,num:i,callbacks:[_10f3]};this.chunks[i]=chunk;dojo.xhrGet({url:this.baseUrl+i+".txt",load:function(_10f5){var ci;chunk.sequence=_10f5;for(var c=0;c<chunk.callbacks.length;c++){ci=chunk.callbacks[c];ci.callback(ci.start,ci.end,_10f5.substring(ci.start-(chunk.num*_10f4),ci.end-(chunk.num*_10f4)));}chunk.callbacks=undefined;chunk.loaded=true;}});}}};}if(!dojo._hasResource["plugins.view.jbrowse.js.FeatureTrack"]){dojo._hasResource["plugins.view.jbrowse.js.FeatureTrack"]=true;dojo.provide("plugins.view.jbrowse.js.FeatureTrack");dojo.declare("plugins.view.jbrowse.js.FeatureTrack",null,{});function FeatureTrack(_10f6,url,_10f7,_10f8){Track.call(this,_10f6.label,_10f6.key,false,_10f8.changeCallback);this.fields={};this.features=new NCList();this.refSeq=_10f7;this.baseUrl=(_10f8.baseUrl?_10f8.baseUrl:"");this.url=url;this.parentWidget=_10f8.parentWidget;this.trackBaseUrl=this.baseUrl;this.numBins=25;this.histLabel=false;this.padding=5;this.trackPadding=_10f8.trackPadding;this.trackMeta=_10f6;this.load(this.baseUrl+url);var _10f9=this;};FeatureTrack.prototype=new Track("");FeatureTrack.prototype.loadSuccess=function(_10fa){var _10fb=new Date().getTime();this.count=_10fa.featureCount;this.fields={};for(var i=0;i<_10fa.headers.length;i++){this.fields[_10fa.headers[i]]=i;}this.subFields={};if(_10fa.subfeatureHeaders){for(var i=0;i<_10fa.subfeatureHeaders.length;i++){this.subFields[_10fa.subfeatureHeaders[i]]=i;}}this.features.importExisting(_10fa.featureNCList,_10fa.sublistIndex,_10fa.lazyIndex,this.trackBaseUrl,_10fa.lazyfeatureUrlTemplate);if(_10fa.subfeatureArray){this.subfeatureArray=new LazyArray(_10fa.subfeatureArray,this.trackBaseUrl);}this.histScale=4*(_10fa.featureCount/this.refSeq.length);this.labelScale=50*(_10fa.featureCount/this.refSeq.length);this.subfeatureScale=80*(_10fa.featureCount/this.refSeq.length);this.className=_10fa.className;this.subfeatureClasses=_10fa.subfeatureClasses;this.arrowheadClass=_10fa.arrowheadClass;this.urlTemplate=_10fa.urlTemplate;this.histogramMeta=_10fa.histogramMeta;for(var i=0;i<this.histogramMeta.length;i++){this.histogramMeta[i].lazyArray=new LazyArray(this.histogramMeta[i].arrayParams,this.trackBaseUrl);}this.histStats=_10fa.histStats;this.histBinBases=_10fa.histBinBases;if(_10fa.clientConfig){var cc=_10fa.clientConfig;var _10fc=_10fa.featureCount/this.refSeq.length;this.histScale=(cc.histScale?cc.histScale:4)*_10fc;this.labelScale=(cc.labelScale?cc.labelScale:50)*_10fc;this.subfeatureScale=(cc.subfeatureScale?cc.subfeatureScale:80)*_10fc;if(cc.featureCss){this.featureCss=cc.featureCss;}if(cc.histCss){this.histCss=cc.histCss;}if(cc.featureCallback){try{this.featureCallback=eval("("+cc.featureCallback+")");}catch(e){}}}var _10fd=this;var _10fe=this.fields;this.onFeatureClick=function(event){event=event||window.event;if(event.shiftKey){return;}var elem=(event.currentTarget||event.srcElement);if(!elem.feature){elem=elem.parentElement;}if(!elem.feature){return;}};this.setLoaded();};FeatureTrack.prototype.setViewInfo=function(_10ff,_1100,_1101,_1102,_1103,_1104,scale){Track.prototype.setViewInfo.apply(this,[_10ff,_1100,_1101,_1102,_1103,_1104,scale]);this.setLabel(this.key);};FeatureTrack.prototype.fillHist=function(_1105,block,_1106,_1107,_1108){var _1109=(_1107-_1106)/this.numBins;var _110a=2;var _110b=false;for(var i=0;i<this.histStats.length;i++){if(this.histStats[i].bases>=_1109){_110b=((this.histStats[i].mean/this.histStats[i].max)<0.01);_110a=100/(_110b?Math.log(this.histStats[i].max):this.histStats[i].max);break;}}var track=this;var _110c=function(hist){var _110d=0;for(var bin=0;bin<track.numBins;bin++){if(typeof hist[bin]=="number"&&isFinite(hist[bin])){_110d=Math.max(_110d,hist[bin]);}}var _110e;for(var bin=0;bin<track.numBins;bin++){if(!(typeof hist[bin]=="number"&&isFinite(hist[bin]))){continue;}_110e=document.createElement("div");_110e.className=track.className+"-hist";_110e.style.cssText="left: "+((bin/track.numBins)*100)+"%; "+"height: "+(_110a*(_110b?Math.log(hist[bin]):hist[bin]))+"px;"+"bottom: "+track.trackPadding+"px;"+"width: "+(((1/track.numBins)*100)-(100/_1108))+"%;"+(track.histCss?track.histCss:"");if(Util.is_ie6){_110e.appendChild(document.createComment());}block.appendChild(_110e);}track.heightUpdate(_110a*(_110b?Math.log(_110d):_110d),_1105);};var _110f=this.histogramMeta[0];for(var i=0;i<this.histogramMeta.length;i++){if(_1109>=this.histogramMeta[i].basesPerBin){_110f=this.histogramMeta[i];}}var _1110=_1109/_110f.basesPerBin;if((_1110>0.9)&&(Math.abs(_1110-Math.round(_1110))<0.0001)){var _1111=Math.floor(_1106/_110f.basesPerBin);_1110=Math.round(_1110);var _1112=[];for(var bin=0;bin<this.numBins;bin++){_1112[bin]=0;}_110f.lazyArray.range(_1111,_1111+(_1110*this.numBins),function(i,val){_1112[Math.floor((i-_1111)/_1110)]+=val;},function(){_110c(_1112);});}else{this.features.histogram(_1106,_1107,this.numBins,_110c);}};FeatureTrack.prototype.endZoom=function(_1113,_1114){if(_1113<this.histScale){this.setLabel(this.key+"<br>per "+Math.round(_1114/this.numBins)+"bp");}else{this.setLabel(this.key);}this.clear();};FeatureTrack.prototype.fillBlock=function(_1115,block,_1116,_1117,_1118,_1119,scale,_111a,_111b,_111c){if(scale<this.histScale){this.fillHist(_1115,block,_1118,_1119,_111a,_111b,_111c);}else{this.fillFeatures(_1115,block,_1116,_1117,_1118,_1119,scale,_111b,_111c);}};FeatureTrack.prototype.cleanupBlock=function(block){if(block&&block.featureLayout){block.featureLayout.cleanup();}};FeatureTrack.prototype.transfer=function(_111d,_111e,scale,_111f,_1120){if(!(_111d&&_111e)){return;}if(!_111d.featureLayout){return;}var _1121=_111e.startBase;var _1122=_111e.endBase;var _1123=_1122-_1121;var _1124;var _1125=(_111d.startBase<_111e.startBase)?_111d.featureLayout.rightOverlaps:_111d.featureLayout.leftOverlaps;for(var i=0;i<_1125.length;i++){_1124=_111d.featureNodes[_1125[i].id];if(_1124&&("label" in _1124)){_1124.label.parentNode.removeChild(_1124.label);}if(_1124&&_1124.feature){if((_1124.layoutEnd>_1121)&&(_1124.feature[this.fields["start"]]<_1122)){_111d.removeChild(_1124);delete _111d.featureNodes[_1125[i].id];var _1126=this.renderFeature(_1124.feature,_1125[i].id,_111e,scale,_111f,_1120);_111e.appendChild(_1126);}}}};FeatureTrack.prototype.fillFeatures=function(_1127,block,_1128,_1129,_112a,_112b,scale,_112c,_112d){var _112e=new Layout(_112a,_112b);block.featureLayout=_112e;block.featureNodes={};block.style.backgroundColor="#ddd";var _112f=false;if(_1128&&_1128.featureLayout){_1128.featureLayout.setRightLayout(_112e);_112e.setLeftLayout(_1128.featureLayout);}if(_1129&&_1129.featureLayout){_1129.featureLayout.setLeftLayout(_112e);_112e.setRightLayout(_1129.featureLayout);_112f=true;}if(!this.haveMeasurements){this.measureStyles();this.haveMeasurements=true;}var _1130=this;var _1131=function(_1132,path){var _1133=path.join(",");if(_112e.hasSeen(_1133)){return;}var _1134=_1130.renderFeature(_1132,_1133,block,scale,_112c,_112d);block.appendChild(_1134);};var _1135=_112f?_112b:_112a;var _1136=_112f?_112a:_112b;this.features.iterate(_1135,_1136,_1131,function(){block.style.backgroundColor="";_1130.heightUpdate(_112e.totalHeight,_1127);});};FeatureTrack.prototype.measureStyles=function(){var _1137=document.createElement("div");_1137.className="feature-label";_1137.style.height="auto";_1137.style.visibility="hidden";_1137.appendChild(document.createTextNode("1234567890"));document.body.appendChild(_1137);this.nameHeight=_1137.clientHeight;this.nameWidth=_1137.clientWidth/10;document.body.removeChild(_1137);var _1138;_1137=document.createElement("div");_1137.className=this.className+" plus-"+this.className+" plus-"+this.className+"1";if(this.featureCss){_1137.style.cssText=this.featureCss;}_1137.style.visibility="hidden";if(Util.is_ie6){_1137.appendChild(document.createComment("foo"));}document.body.appendChild(_1137);_1138=dojo.marginBox(_1137);this.glyphHeight=Math.round(_1138.h+2);this.padding+=_1138.w;document.body.removeChild(_1137);if(this.arrowheadClass){var ah=document.createElement("div");ah.className="plus-"+this.arrowheadClass;if(Util.is_ie6){ah.appendChild(document.createComment("foo"));}document.body.appendChild(ah);_1138=dojo.marginBox(ah);this.plusArrowWidth=_1138.w;ah.className="minus-"+this.arrowheadClass;_1138=dojo.marginBox(ah);this.minusArrowWidth=_1138.w;document.body.removeChild(ah);}};FeatureTrack.prototype.renderFeature=function(_1139,_113a,block,scale,_113b,_113c){var _113d=this.fields;var _113e=_1139[_113d["end"]];var _113f=_1139[_113d["start"]];if(this.arrowheadClass){switch(_1139[_113d["strand"]]){case 1:_113e+=(this.plusArrowWidth/scale);break;case -1:_113f-=(this.minusArrowWidth/scale);break;}}if(scale>this.labelScale){_113e=Math.max(_113e,_1139[_113d["start"]]+(((_113d["name"]&&_1139[_113d["name"]])?_1139[_113d["name"]].length:0)*(this.nameWidth/scale)));}_113e+=Math.max(1,this.padding/scale);var _1140=this.glyphHeight+2+((_113d["name"]&&(scale>this.labelScale))?this.nameHeight:0);var top=block.featureLayout.addRect(_113a,_113f,_113e,_1140);var _1141;var _1142=this.featureUrl(_1139);if(_1142){_1141=document.createElement("a");_1141.href=_1142;_1141.target="_new";}else{_1141=document.createElement("div");_1141.onclick=this.onFeatureClick;}_1141.feature=_1139;_1141.layoutEnd=_113e;block.featureNodes[_113a]=_1141;switch(_1139[_113d["strand"]]){case 1:_1141.className="plus-"+this.className;break;case 0:case null:case undefined:_1141.className=this.className;break;case -1:_1141.className="minus-"+this.className;break;}if((_113d["phase"]!==undefined)&&(_1139[_113d["phase"]]!==null)){_1141.className=_1141.className+_1139[_113d["phase"]];}var _1143=Math.max(_1139[_113d["start"]],_113b);var _1144=Math.min(_1139[_113d["end"]],_113c);var _1145=block.endBase-block.startBase;_1141.style.cssText="left:"+(100*(_1143-block.startBase)/_1145)+"%;"+"top:"+top+"px;"+" width:"+(100*((_1144-_1143)/_1145))+"%;"+(this.featureCss?this.featureCss:"");if(this.featureCallback){this.featureCallback(_1139,_113d,_1141);}if(this.arrowheadClass){var ah=document.createElement("div");switch(_1139[_113d["strand"]]){case 1:ah.className="plus-"+this.arrowheadClass;ah.style.cssText="left: 100%; top: 0px;";_1141.appendChild(ah);break;case -1:ah.className="minus-"+this.arrowheadClass;ah.style.cssText="left: "+(-this.minusArrowWidth)+"px; top: 0px;";_1141.appendChild(ah);break;}}if((scale>this.labelScale)&&_113d["name"]&&_1139[_113d["name"]]){var _1146;if(_1142){_1146=document.createElement("a");_1146.href=_1142;_1146.target=_1141.target;}else{_1146=document.createElement("div");_1146.onclick=this.onFeatureClick;}_1146.className="feature-label";_1146.appendChild(document.createTextNode(_1139[_113d["name"]]));_1146.style.cssText="left: "+(100*(_1139[_113d["start"]]-block.startBase)/_1145)+"%; "+"top: "+(top+this.glyphHeight)+"px;";_1141.label=_1146;_1146.feature=_1139;block.appendChild(_1146);}if(_113d["subfeatures"]&&(scale>this.subfeatureScale)&&_1139[_113d["subfeatures"]]&&_1139[_113d["subfeatures"]].length>0){for(var i=0;i<_1139[_113d["subfeatures"]].length;i++){this.renderSubfeature(_1139,_1141,_1139[_113d["subfeatures"]][i],_1143,_1144);}}if(Util.is_ie6){_1141.appendChild(document.createComment());}return _1141;};FeatureTrack.prototype.featureUrl=function(_1147){var _1148=true;var _1149=this.fields;if(this.urlTemplate){var href=this.urlTemplate.replace(/\{([^}]+)\}/g,function(match,group){if(_1147[_1149[group]]!=undefined){return _1147[_1149[group]];}else{_1148=false;}return 0;});if(_1148){return href;}}return undefined;};FeatureTrack.prototype.renderSubfeature=function(_114a,_114b,_114c,_114d,_114e){var _114f=_114c[this.subFields["start"]];var _1150=_114c[this.subFields["end"]];var _1151=_114e-_114d;var _1152=document.createElement("div");if(this.subfeatureClasses){var _1153=this.subfeatureClasses[_114c[this.subFields["type"]]];switch(_114c[this.subFields["strand"]]){case 1:_1152.className="plus-"+_1153;break;case 0:case null:case undefined:_1152.className=_1153;break;case -1:_1152.className="minus-"+_1153;break;}}if((_1150<=_114d)||(_114f>=_114e)){return;}if(Util.is_ie6){_1152.appendChild(document.createComment());}_1152.style.cssText="left: "+(100*((_114f-_114d)/_1151))+"%;"+"top: 0px;"+"width: "+(100*((_1150-_114f)/_1151))+"%;";if(this.featureCallback){this.featureCallback(_114c,this.subFields,_1152);}_114b.appendChild(_1152);};}if(!dojo._hasResource["plugins.view.jbrowse.js.UITracks"]){dojo._hasResource["plugins.view.jbrowse.js.UITracks"]=true;dojo.provide("plugins.view.jbrowse.js.UITracks");dojo.declare("plugins.view.jbrowse.js.UITracks",null,{});function StaticTrack(name,_1154,_1155){Track.call(this,name,name,true,function(){});this.labelClass=_1154;this.posHeight=_1155;this.height=_1155;};StaticTrack.prototype=new Track("");StaticTrack.prototype.fillBlock=function(_1156,block,_1157,_1158,_1159,_115a,scale,_115b,_115c){var _115d=document.createElement("div");_115d.className=this.labelClass;_115d.appendChild(document.createTextNode(Util.addCommas(_1159)));_115d.style.top="0px";block.appendChild(_115d);this.heightUpdate(this.posHeight,_1156);};function GridTrack(name){Track.call(this,name,name,true,function(){});};GridTrack.prototype=new Track("");GridTrack.prototype.fillBlock=function(_115e,block,_115f,_1160,_1161,_1162,scale,_1163,_1164){var _1165=document.createElement("div");_1165.className="gridline";_1165.style.cssText="left: 0%; width: 0px;";block.appendChild(_1165);this.heightUpdate(100,_115e);};}if(!dojo._hasResource["plugins.view.jbrowse.js.ImageTrack"]){dojo._hasResource["plugins.view.jbrowse.js.ImageTrack"]=true;dojo.provide("plugins.view.jbrowse.js.ImageTrack");dojo.declare("plugins.view.jbrowse.js.ImageTrack",null,{});function ImageTrack(_1166,url,_1167,_1168){Track.call(this,_1166.label,_1166.key,false,_1168.changeCallback);this.refSeq=_1167;this.tileToImage={};this.zoomCache={};this.baseUrl=(_1168.baseUrl?_1168.baseUrl:"");this.load(this.baseUrl+url);this.imgErrorHandler=function(ev){var img=ev.target||ev.srcElement;img.style.display="none";dojo.stopEvent(ev);};};ImageTrack.prototype=new Track("");ImageTrack.prototype.loadSuccess=function(o){this.tileWidth=o.tileWidth;this.zoomLevels=o.zoomLevels;this.setLoaded();};ImageTrack.prototype.setViewInfo=function(_1169,_116a,_116b,_116c,_116d,_116e,scale){Track.prototype.setViewInfo.apply(this,[_1169,_116a,_116b,_116c,_116d,_116e,scale]);this.setLabel(this.key);};ImageTrack.prototype.getZoom=function(scale){var _116f=this.zoomCache[scale];if(_116f){return _116f;}_116f=this.zoomLevels[0];var _1170=this.tileWidth/scale;for(i=1;i<this.zoomLevels.length;i++){if(Math.abs(this.zoomLevels[i].basesPerTile-_1170)<Math.abs(_116f.basesPerTile-_1170)){_116f=this.zoomLevels[i];}}this.zoomCache[scale]=_116f;return _116f;};ImageTrack.prototype.getImages=function(zoom,_1171,_1172){var _1173=(_1171/zoom.basesPerTile)|0;var _1174=(_1172/zoom.basesPerTile)|0;_1173=Math.max(_1173,0);var _1175=[];var im;for(var i=_1173;i<=_1174;i++){im=this.tileToImage[i];if(!im){im=document.createElement("img");dojo.connect(im,"onerror",this.imgErrorHandler);var _1176=new RegExp("^(([^/]+:)|/)");im.src=(zoom.urlPrefix.match(_1176)?"":this.baseUrl)+zoom.urlPrefix+i+".png";im.startBase=(i*zoom.basesPerTile);im.baseWidth=zoom.basesPerTile;im.tileNum=i;this.tileToImage[i]=im;}_1175.push(im);}return _1175;};ImageTrack.prototype.fillBlock=function(_1177,block,_1178,_1179,_117a,_117b,scale,_117c,_117d,_117e){var zoom=this.getZoom(scale);var _117f=_117b-_117a;var _1180=this.getImages(zoom,_117a,_117b);var im;for(var i=0;i<_1180.length;i++){im=_1180[i];if(!(im.parentNode&&im.parentNode.parentNode)){im.style.position="absolute";im.style.left=(100*((im.startBase-_117a)/_117f))+"%";im.style.width=(100*(im.baseWidth/_117f))+"%";im.style.top="0px";im.style.height=zoom.height+"px";block.appendChild(im);}}this.heightUpdate(zoom.height,_1177);};ImageTrack.prototype.startZoom=function(_1181,_1182,_1183){if(this.empty){return;}this.tileToImage={};this.getImages(this.getZoom(_1181),_1182,_1183);};ImageTrack.prototype.endZoom=function(_1184,_1185){Track.prototype.clear.apply(this);};ImageTrack.prototype.clear=function(){Track.prototype.clear.apply(this);this.tileToImage={};};ImageTrack.prototype.transfer=function(_1186,_1187,scale,_1188,_1189){if(!(_1186&&_1187)){return;}var _118a=_1186.childNodes;var _118b=_1187.startBase;var _118c=_1187.endBase;var im;for(var i=0;i<_118a.length;i++){im=_118a[i];if("startBase" in im){if((im.startBase<_118c)&&((im.startBase+im.baseWidth)>_118b)){im.style.left=(100*((im.startBase-_118b)/(_118c-_118b)))+"%";_1187.appendChild(im);}else{delete this.tileToImage[im.tileNum];}}}};}if(!dojo._hasResource["plugins.view.jbrowse.js.GenomeView"]){dojo._hasResource["plugins.view.jbrowse.js.GenomeView"]=true;dojo.provide("plugins.view.jbrowse.js.GenomeView");dojo.declare("plugins.view.jbrowse.js.GenomeView",null,{});function Animation(_118d,_118e,time){if(_118d===undefined){return;}if("animation" in _118d){_118d.animation.stop();}this.index=0;this.time=time;this.subject=_118d;this.callback=_118e;var _118f=this;this.animFunction=function(){_118f.animate();};this.animID=setTimeout(this.animFunction,33);this.frames=0;_118d.animation=this;};Animation.prototype.animate=function(){if(this.finished){this.stop();return;}var _1190=33;var _1191=0;if(!("startTime" in this)){this.startTime=(new Date()).getTime();}else{_1191=(new Date()).getTime()-this.startTime;_1190=Math.max(33,_1191/this.frames);}if(_1191<this.time){this.step(_1191/this.time);this.frames++;}else{this.step(1);this.finished=true;}this.animID=setTimeout(this.animFunction,_1190);};Animation.prototype.stop=function(){clearTimeout(this.animID);delete this.subject.animation;this.callback(this);};function Slider(view,_1192,time,_1193){Animation.call(this,view,_1192,time);this.slideStart=view.getX();this.slideDistance=_1193;};Slider.prototype=new Animation();Slider.prototype.step=function(pos){var newX=(this.slideStart-(this.slideDistance*((-0.5*Math.cos(pos*Math.PI))+0.5)))|0;newX=Math.max(Math.min(this.subject.maxLeft-this.subject.offset,newX),this.subject.minLeft-this.subject.offset);this.subject.setX(newX);};function Zoomer(scale,_1194,_1195,time,_1196){Animation.call(this,_1194,_1195,time);this.toZoom=_1194.zoomContainer;var _1197=this.toZoom.clientWidth;this.initialWidth=_1197;this.width0=_1197*Math.min(1,scale);var _1198=_1197*Math.max(1,scale);this.distance=_1198-this.width0;this.zoomingIn=scale>1;this.center=(_1194.getX()+(_1194.elem.clientWidth*_1196))/_1194.scrollContainer.clientWidth;this.initialX=this.subject.getX();this.initialLeft=parseInt(this.toZoom.style.left);};Zoomer.prototype=new Animation();Zoomer.prototype.step=function(pos){var _1199=this.zoomingIn?pos:1-pos;var _119a=((_1199*_1199)*this.distance)+this.width0;var _119b=(this.center*this.initialWidth)-(this.center*_119a);this.toZoom.style.width=_119a+"px";this.toZoom.style.left=(this.initialLeft+_119b)+"px";var _119c=this.toZoom.offsetTop;this.subject.updateTrackLabels(this.initialX-_119b);};function GenomeView(elem,_119d,_119e,_119f,_11a0){var _11a1=document.createElement("div");_11a1.className="sequence";_11a1.style.visibility="hidden";var _11a2="12345678901234567890123456789012345678901234567890";_11a1.appendChild(document.createTextNode(_11a2));elem.appendChild(_11a1);this.charWidth=_11a1.clientWidth/_11a2.length;this.seqHeight=_11a1.clientHeight;elem.removeChild(_11a1);var _11a3=document.createElement("div");_11a3.className="pos-label";_11a3.style.visibility="hidden";_11a3.appendChild(document.createTextNode("42"));elem.appendChild(_11a3);this.posHeight=_11a3.clientHeight;this.topSpace=1.5*this.posHeight;elem.removeChild(_11a3);this.ref=_119e;this.pxPerBp=_119f;this.stripeWidth=_119d;this.elem=elem;this.scrollContainer=document.createElement("div");this.scrollContainer.id="container";this.scrollContainer.style.cssText="position: absolute; left: 0px; top: 0px;";elem.appendChild(this.scrollContainer);this.zoomContainer=document.createElement("div");this.zoomContainer.id="zoomContainer";this.zoomContainer.style.cssText="position: absolute; left: 0px; top: 0px; height: 100%;";this.scrollContainer.appendChild(this.zoomContainer);this.regularStripe=_119d;this.fullZoomStripe=this.charWidth*(_119d/10);this.overview=_11a0.overview;this.overviewBox=dojo.marginBox(this.overview);this.tracks=[];this.uiTracks=[];this.trackIndices={};this.sizeInit();this.offset=0;this.maxLeft=this.bpToPx(this.ref.end)-this.dim.width;this.minLeft=this.bpToPx(this.ref.start);this.trackPadding=20;this.drawMargin=0.2;this.slideTimeMultiple=0.8;this.trackHeights=[];this.trackTops=[];this.trackLabels=[];this.waitElems=[dojo.byId("moveLeft"),dojo.byId("moveRight"),dojo.byId("zoomIn"),dojo.byId("zoomOut"),dojo.byId("bigZoomIn"),dojo.byId("bigZoomOut"),document.body,elem];this.prevCursors=[];this.locationThumb=_11a0.locationThumb;this.locationThumb.className="locationThumb";this.overview.appendChild(this.locationThumb);this.locationThumbMover=new dojo.dnd.move.parentConstrainedMoveable(this.locationThumb,{area:"margin",within:true});dojo.connect(this.locationThumbMover,"onMoveStop",this,"thumbMoved");var view=this;var _11a4=dojo.isIE;if(_11a4){view.x=-parseInt(view.scrollContainer.style.left);view.y=-parseInt(view.scrollContainer.style.top);view.getX=function(){return view.x;};view.getY=function(){return view.y;};view.getPosition=function(){return {x:view.x,y:view.y};};view.rawSetX=function(x){view.scrollContainer.style.left=-x+"px";view.x=x;};view.setX=function(x){view.x=Math.max(Math.min(view.maxLeft-view.offset,x),view.minLeft-view.offset);view.x=Math.round(view.x);view.updateTrackLabels(view.x);view.showFine();view.scrollContainer.style.left=-view.x+"px";};view.rawSetY=function(y){view.scrollContainer.style.top=-y+"px";view.y=y;};view.setY=function(y){view.y=Math.min((y<0?0:y),view.containerHeight-view.dim.height);view.y=Math.round(view.y);view.updatePosLabels(view.y);view.scrollContainer.style.top=-view.y+"px";};view.rawSetPosition=function(pos){view.scrollContainer.style.left=-pos.x+"px";view.scrollContainer.style.top=-pos.y+"px";};view.setPosition=function(pos){view.x=Math.max(Math.min(view.maxLeft-view.offset,pos.x),view.minLeft-view.offset);view.y=Math.min((pos.y<0?0:pos.y),view.containerHeight-view.dim.height);view.x=Math.round(view.x);view.y=Math.round(view.y);view.updateTrackLabels(view.x);view.updatePosLabels(view.y);view.showFine();view.scrollContainer.style.left=-view.x+"px";view.scrollContainer.style.top=-view.y+"px";};}else{view.x=view.elem.scrollLeft;view.y=view.elem.scrollTop;view.getX=function(){return view.x;};view.getY=function(){return view.y;};view.getPosition=function(){return {x:view.x,y:view.y};};view.rawSetX=function(x){view.elem.scrollLeft=x;view.x=x;};view.setX=function(x){view.x=Math.max(Math.min(view.maxLeft-view.offset,x),view.minLeft-view.offset);view.x=Math.round(view.x);view.updateTrackLabels(view.x);view.showFine();view.elem.scrollLeft=view.x;};view.rawSetY=function(y){view.elem.scrollTop=y;view.y=y;};view.rawSetPosition=function(pos){view.elem.scrollLeft=pos.x;view.x=pos.x;view.elem.scrollTop=pos.y;view.y=pos.y;};view.setY=function(y){view.y=Math.min((y<0?0:y),view.containerHeight-view.dim.height);view.y=Math.round(view.y);view.updatePosLabels(view.y);view.elem.scrollTop=view.y;};view.setPosition=function(pos){view.x=Math.max(Math.min(view.maxLeft-view.offset,pos.x),view.minLeft-view.offset);view.y=Math.min((pos.y<0?0:pos.y),view.containerHeight-view.dim.height);view.x=Math.round(view.x);view.y=Math.round(view.y);view.updateTrackLabels(view.x);view.updatePosLabels(view.y);view.showFine();view.elem.scrollLeft=view.x;view.elem.scrollTop=view.y;};}view.dragEnd=function(event){dojo.forEach(view.dragEventHandles,dojo.disconnect);view.dragging=false;view.elem.style.cursor="url(\"plugins/view/jbrowse/openhand.cur\"), move";document.body.style.cursor="default";dojo.stopEvent(event);view.showCoarse();view.scrollUpdate();view.showVisibleBlocks(true);};var _11a5=document.body.parentNode;var _11a6=document.body;view.checkDragOut=function(event){if(!(event.relatedTarget||event.toElement)||(_11a5===(event.relatedTarget||event.toElement))||(_11a6===(event.relatedTarget||event.toElement))){view.dragEnd(event);}};view.dragMove=function(event){view.setPosition({x:view.winStartPos.x-(event.clientX-view.dragStartPos.x),y:view.winStartPos.y-(event.clientY-view.dragStartPos.y)});dojo.stopEvent(event);};view.mouseDown=function(event){if("animation" in view){if(view.animation instanceof Zoomer){dojo.stopEvent(event);return;}else{view.animation.stop();}}if(Util.isRightButton(event)){return;}dojo.stopEvent(event);if(event.shiftKey||event.ctrlKey){return;}view.dragEventHandles=[dojo.connect(document.body,"mouseup",view.dragEnd),dojo.connect(document.body,"mousemove",view.dragMove),dojo.connect(document.body,"mouseout",view.checkDragOut)];view.dragging=true;view.dragStartPos={x:event.clientX,y:event.clientY};view.winStartPos=view.getPosition();document.body.style.cursor="url(\"plugins/view/jbrowse/closedhand.cur\"), move";view.elem.style.cursor="url(\"plugins/view/jbrowse/closedhand.cur\"), move";};dojo.connect(view.elem,"mousedown",view.mouseDown);dojo.connect(view.elem,"dblclick",function(event){if(view.dragging){return;}if("animation" in view){return;}var _11a7=(event.pageX-dojo.coords(view.elem,true).x)/view.dim.width;if(event.shiftKey){view.zoomOut(event,_11a7,2);}else{view.zoomIn(event,_11a7,2);}dojo.stopEvent(event);});view.afterSlide=function(){view.showCoarse();view.scrollUpdate();view.showVisibleBlocks(true);};view.zoomCallback=function(){view.zoomUpdate();};var _11a8=null;var _11a9=function(){view.showVisibleBlocks(true);_11a8=null;};view.wheelScroll=function(e){var oldY=view.getY();var newY=Math.min(Math.max(0,oldY-60*Util.wheel(e)),view.containerHeight-view.dim.height);view.setY(newY);if(_11a8){clearTimeout(_11a8);}_11a8=setTimeout(_11a9,100);dojo.stopEvent(e);};dojo.connect(view.scrollContainer,"mousewheel",view.wheelScroll,false);dojo.connect(view.scrollContainer,"DOMMouseScroll",view.wheelScroll,false);var _11aa=document.createElement("div");_11aa.className="track";_11aa.style.height=this.posHeight+"px";_11aa.id="static_track";this.staticTrack=new StaticTrack("static_track","pos-label",this.posHeight);this.staticTrack.setViewInfo(function(_11ab){},this.stripeCount,_11aa,undefined,this.stripePercent,this.stripeWidth,this.pxPerBp);this.zoomContainer.appendChild(_11aa);this.waitElems.push(_11aa);var _11ac=document.createElement("div");_11ac.className="track";_11ac.style.cssText="top: 0px; height: 100%;";_11ac.id="gridtrack";var _11ad=new GridTrack("gridtrack");_11ad.setViewInfo(function(_11ae){},this.stripeCount,_11ac,undefined,this.stripePercent,this.stripeWidth,this.pxPerBp);this.zoomContainer.appendChild(_11ac);this.uiTracks=[this.staticTrack,_11ad];dojo.forEach(this.uiTracks,function(track){track.showRange(0,this.stripeCount-1,Math.round(this.pxToBp(this.offset)),Math.round(this.stripeWidth/this.pxPerBp),this.pxPerBp);},this);this.zoomContainer.style.paddingTop=this.topSpace+"px";this.addOverviewTrack(new StaticTrack("overview_loc_track","overview-pos",this.overviewPosHeight));document.body.style.cursor="url(\"plugins/view/jbrowse/closedhand.cur\")";document.body.style.cursor="default";this.showFine();this.showCoarse();};GenomeView.prototype.slide=function(_11af){if(this.animation){this.animation.stop();}this.trimVertical();new Slider(this,this.afterSlide,Math.abs(_11af)*this.dim.width*this.slideTimeMultiple+200,_11af*this.dim.width);};GenomeView.prototype.highlightRegions=function(_11b0){};GenomeView.prototype.setLocation=function(_11b1,_11b2,endbp){if(_11b2===undefined){_11b2=this.minVisible();}if(endbp===undefined){endbp=this.maxVisible();}if((_11b2<_11b1.start)||(_11b2>_11b1.end)){_11b2=_11b1.start;}if((endbp<_11b1.start)||(endbp>_11b1.end)){endbp=_11b1.end;}if(this.ref!=_11b1){this.ref=_11b1;var _11b3=function(track){if(track.div&&track.div.parentNode){track.div.parentNode.removeChild(track.div);}};dojo.forEach(this.tracks,_11b3);dojo.forEach(this.uiTracks,function(track){track.clear();});this.overviewTrackIterate(_11b3);this.addOverviewTrack(new StaticTrack("overview_loc_track","overview-pos",this.overviewPosHeight));this.sizeInit();this.setY(0);this.containerHeight=this.topSpace;}this.pxPerBp=Math.min(this.dim.width/(endbp-_11b2),this.charWidth);this.curZoom=Util.findNearest(this.zoomLevels,this.pxPerBp);if(Math.abs(this.pxPerBp-this.zoomLevels[this.zoomLevels.length-1])<0.2){this.pxPerBp=this.zoomLevels[this.zoomLevels.length-1];}this.stripeWidth=(this.stripeWidthForZoom(this.curZoom)/this.zoomLevels[this.curZoom])*this.pxPerBp;this.instantZoomUpdate();this.centerAtBase((_11b2+endbp)/2,true);};GenomeView.prototype.stripeWidthForZoom=function(_11b4){if((this.zoomLevels.length-1)==_11b4){return this.fullZoomStripe;}else{if(0==_11b4){return this.minZoomStripe;}else{return this.regularStripe;}}};GenomeView.prototype.instantZoomUpdate=function(){this.scrollContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";this.zoomContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";this.maxOffset=this.bpToPx(this.ref.end)-this.stripeCount*this.stripeWidth;this.maxLeft=this.bpToPx(this.ref.end)-this.dim.width;this.minLeft=this.bpToPx(this.ref.start);};GenomeView.prototype.centerAtBase=function(base,_11b5){base=Math.min(Math.max(base,this.ref.start),this.ref.end);if(_11b5){var _11b6=this.bpToPx(base);var _11b7=this.stripeCount*this.stripeWidth;var _11b8=Math.floor((_11b6-(_11b7/2))/this.stripeWidth);this.offset=_11b8*this.stripeWidth;this.setX(_11b6-this.offset-(this.dim.width/2));this.trackIterate(function(track){track.clear();});this.showVisibleBlocks(true);this.showCoarse();}else{var _11b9=this.pxToBp(this.x+this.offset);var _11ba=(this.dim.width/this.pxPerBp)/2;var endbp=_11b9+_11ba+_11ba;var _11bb=_11b9+_11ba;if((base>=(_11b9-_11ba))&&(base<=(endbp+_11ba))){if(this.animation){this.animation.stop();}var _11bc=(_11bb-base)*this.pxPerBp;this.trimVertical();new Slider(this,this.afterSlide,Math.abs(_11bc)*this.slideTimeMultiple+200,_11bc);}else{this.centerAtBase(base,true);}}};GenomeView.prototype.minVisible=function(){return this.pxToBp(this.x+this.offset);};GenomeView.prototype.maxVisible=function(){return this.pxToBp(this.x+this.offset+this.dim.width);};GenomeView.prototype.showFine=function(){this.onFineMove(this.minVisible(),this.maxVisible());};GenomeView.prototype.showCoarse=function(){if(!this.minVisible()||!this.maxVisible()){return;}this.onCoarseMove(this.minVisible(),this.maxVisible());};GenomeView.prototype.onFineMove=function(){};GenomeView.prototype.onCoarseMove=function(){};GenomeView.prototype.thumbMoved=function(mover){var _11bd=parseInt(this.locationThumb.style.left);var _11be=parseInt(this.locationThumb.style.width);var _11bf=_11bd+(_11be/2);this.centerAtBase(((_11bf/this.overviewBox.w)*(this.ref.end-this.ref.start))+this.ref.start);};GenomeView.prototype.checkY=function(y){return Math.min((y<0?0:y),this.containerHeight-this.dim.height);};GenomeView.prototype.updatePosLabels=function(newY){if(newY===undefined){newY=this.getY();}this.staticTrack.div.style.top=newY+"px";};GenomeView.prototype.updateTrackLabels=function(newX){if(newX===undefined){newX=this.getX();}for(var i=0;i<this.trackLabels.length;i++){this.trackLabels[i].style.left=newX+"px";}};GenomeView.prototype.showWait=function(){var _11c0=[];for(var i=0;i<this.waitElems.length;i++){_11c0[i]=this.waitElems[i].style.cursor;this.waitElems[i].style.cursor="wait";}this.prevCursors.push(_11c0);};GenomeView.prototype.showDone=function(){var _11c1=this.prevCursors.pop();for(var i=0;i<this.waitElems.length;i++){this.waitElems[i].style.cursor=_11c1[i];}};GenomeView.prototype.pxToBp=function(_11c2){return _11c2/this.pxPerBp;};GenomeView.prototype.bpToPx=function(bp){return bp*this.pxPerBp;};GenomeView.prototype.sizeInit=function(){this.dim={width:this.elem.clientWidth,height:this.elem.clientHeight};this.overviewBox=dojo.marginBox(this.overview);this.zoomLevels=[1/500000,1/200000,1/100000,1/50000,1/20000,1/10000,1/5000,1/2000,1/1000,1/500,1/200,1/100,1/50,1/20,1/10,1/5,1/2,1,2,5,this.charWidth];while(((this.ref.end-this.ref.start)*this.zoomLevels[0])<this.dim.width){this.zoomLevels.shift();}this.zoomLevels.unshift(this.dim.width/(this.ref.end-this.ref.start));this.minZoomStripe=this.regularStripe*(this.zoomLevels[0]/this.zoomLevels[1]);this.curZoom=0;while(this.pxPerBp>this.zoomLevels[this.curZoom]){this.curZoom++;}this.maxLeft=this.bpToPx(this.ref.end)-this.dim.width;delete this.stripePercent;var _11c3=[20,10,5,4,2,1];for(var i=0;i<_11c3.length;i++){if(((100/_11c3[i])*(this.regularStripe*0.7))>((this.dim.width*3)+this.regularStripe)){this.stripePercent=_11c3[i];break;}}if(this.stripePercent===undefined){this.stripePercent=1;}var oldX;var _11c4=this.stripeCount;if(_11c4){oldX=this.getX();}this.stripeCount=Math.round(100/this.stripePercent);this.scrollContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";this.zoomContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";var _11c5=undefined;if(_11c4&&(_11c4!=this.stripeCount)){_11c5=Math.floor((_11c4-this.stripeCount)/2);var delta=(_11c5*this.stripeWidth);var newX=this.getX()-delta;this.offset+=delta;this.updateTrackLabels(newX);this.rawSetX(newX);}this.trackIterate(function(track,view){track.sizeInit(view.stripeCount,view.stripePercent,_11c5);});var _11c6=parseInt(this.scrollContainer.style.height);_11c6=(_11c6>this.dim.height?_11c6:this.dim.height);this.scrollContainer.style.height=_11c6+"px";this.containerHeight=_11c6;var _11c7=this.ref.end-this.ref.start;var _11c8=document.createElement("div");_11c8.className="overview-pos";_11c8.appendChild(document.createTextNode(Util.addCommas(this.ref.end)));_11c8.style.visibility="hidden";this.overview.appendChild(_11c8);var _11c9=_11c8.clientWidth*1.2;this.overviewPosHeight=_11c8.clientHeight;this.overview.removeChild(_11c8);for(var n=1;n<30;n++){this.overviewStripeBases=(Math.pow(n%3,2)+1)*Math.pow(10,Math.floor(n/3));this.overviewStripes=Math.ceil(_11c7/this.overviewStripeBases);if((this.overviewBox.w/this.overviewStripes)>_11c9){break;}if(this.overviewStripes<2){break;}}var _11ca=100/(_11c7/this.overviewStripeBases);var _11cb=0;this.overviewTrackIterate(function(track,view){track.clear();track.sizeInit(view.overviewStripes,_11ca);track.showRange(0,view.overviewStripes-1,0,view.overviewStripeBases,view.overviewBox.w/(view.ref.end-view.ref.start));});this.updateOverviewHeight();};GenomeView.prototype.overviewTrackIterate=function(_11cc){var _11cd=this.overview.firstChild;do{if(_11cd&&_11cd.track){_11cc(_11cd.track,this);}}while(_11cd&&(_11cd=_11cd.nextSibling));};GenomeView.prototype.updateOverviewHeight=function(_11ce,_11cf){var _11d0=0;this.overviewTrackIterate(function(track,view){_11d0+=track.height;});this.overview.style.height=_11d0+"px";this.overviewBox=dojo.marginBox(this.overview);};GenomeView.prototype.addOverviewTrack=function(track){var _11d1=this.ref.end-this.ref.start;var _11d2=100/(_11d1/this.overviewStripeBases);var _11d3=document.createElement("div");_11d3.className="track";_11d3.style.height=this.overviewBox.h+"px";_11d3.style.left=(((-this.ref.start)/_11d1)*this.overviewBox.w)+"px";_11d3.track=track;var view=this;var _11d4=function(_11d5){view.updateOverviewHeight();};track.setViewInfo(_11d4,this.overviewStripes,_11d3,undefined,_11d2,this.overviewStripeBases,this.pxPerBp);this.overview.appendChild(_11d3);this.updateOverviewHeight();return _11d3;};GenomeView.prototype.trimVertical=function(y){if(y===undefined){y=this.getY();}var _11d6;var _11d7=this.topSpace;var _11d8=y+this.dim.height;for(var i=0;i<this.tracks.length;i++){if(this.tracks[i].shown){_11d6=_11d7+this.trackHeights[i];if(!((_11d6>y)&&(_11d7<_11d8))){this.tracks[i].hideAll();}_11d7=_11d6+this.trackPadding;}}};GenomeView.prototype.zoomIn=function(e,_11d9,steps){if(this.animation){return;}if(_11d9===undefined){_11d9=0.5;}if(steps===undefined){steps=1;}steps=Math.min(steps,(this.zoomLevels.length-1)-this.curZoom);if(0==steps){return;}this.showWait();var pos=this.getPosition();this.trimVertical(pos.y);var scale=this.zoomLevels[this.curZoom+steps]/this.pxPerBp;var _11da=this.pxToBp(pos.x+this.offset+(_11d9*this.dim.width));this.curZoom+=steps;this.pxPerBp=this.zoomLevels[this.curZoom];this.maxLeft=(this.pxPerBp*this.ref.end)-this.dim.width;for(var track=0;track<this.tracks.length;track++){this.tracks[track].startZoom(this.pxPerBp,_11da-((_11d9*this.dim.width)/this.pxPerBp),_11da+(((1-_11d9)*this.dim.width)/this.pxPerBp));}var _11db=this;new Zoomer(scale,this,function(){_11db.zoomUpdate(_11d9,_11da);},700,_11d9);};GenomeView.prototype.zoomOut=function(e,_11dc,steps){if(this.animation){return;}if(steps===undefined){steps=1;}steps=Math.min(steps,this.curZoom);if(0==steps){return;}this.showWait();var pos=this.getPosition();this.trimVertical(pos.y);if(_11dc===undefined){_11dc=0.5;}var scale=this.zoomLevels[this.curZoom-steps]/this.pxPerBp;var _11dd=this.bpToPx(this.ref.end)-(this.offset+pos.x+this.dim.width);_11dc=Math.max(_11dc,1-(((_11dd*scale)/(1-scale))/this.dim.width));_11dd=pos.x+this.offset-this.bpToPx(this.ref.start);_11dc=Math.min(_11dc,((_11dd*scale)/(1-scale))/this.dim.width);var _11de=this.pxToBp(pos.x+this.offset+(_11dc*this.dim.width));this.curZoom-=steps;this.pxPerBp=this.zoomLevels[this.curZoom];for(var track=0;track<this.tracks.length;track++){this.tracks[track].startZoom(this.pxPerBp,_11de-((_11dc*this.dim.width)/this.pxPerBp),_11de+(((1-_11dc)*this.dim.width)/this.pxPerBp));}this.minLeft=this.pxPerBp*this.ref.start;var _11df=this;new Zoomer(scale,this,function(){_11df.zoomUpdate(_11dc,_11de);},700,_11dc);};GenomeView.prototype.zoomUpdate=function(_11e0,_11e1){var _11e2=this.elem.clientWidth;var _11e3=this.bpToPx(_11e1)-(_11e0*_11e2)+(_11e2/2);this.stripeWidth=this.stripeWidthForZoom(this.curZoom);this.scrollContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";this.zoomContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";var _11e4=Math.round(_11e3/this.stripeWidth);var _11e5=(_11e4-((this.stripeCount)/2))|0;this.offset=_11e5*this.stripeWidth;this.maxOffset=this.bpToPx(this.ref.end)-this.stripeCount*this.stripeWidth;this.maxLeft=this.bpToPx(this.ref.end)-this.dim.width;this.minLeft=this.bpToPx(this.ref.start);this.zoomContainer.style.left="0px";this.setX((_11e3-this.offset)-(_11e2/2));dojo.forEach(this.uiTracks,function(track){track.clear();});for(var track=0;track<this.tracks.length;track++){this.tracks[track].endZoom(this.pxPerBp,Math.round(this.stripeWidth/this.pxPerBp));}this.showVisibleBlocks(true);this.showDone();this.showCoarse();};GenomeView.prototype.scrollUpdate=function(){var x=this.getX();var _11e6=this.stripeCount;var _11e7=_11e6*this.stripeWidth;var _11e8=this.dim.width;var dx=(_11e7/2)-((_11e8/2)+x);var _11e9=(dx/this.stripeWidth)|0;if(0==_11e9){return;}var _11ea=Math.abs(_11e9);var _11eb=this.offset-(_11e9*this.stripeWidth);if(this.offset==_11eb){return;}this.offset=_11eb;this.trackIterate(function(track){track.moveBlocks(_11e9);});var newX=x+(_11e9*this.stripeWidth);this.updateTrackLabels(newX);this.rawSetX(newX);var _11ec=(newX/this.stripeWidth)|0;};GenomeView.prototype.trackHeightUpdate=function(_11ed,_11ee){var y=this.getY();if(!_11ed in this.trackIndices){return;}var track=this.trackIndices[_11ed];if(Math.abs(_11ee-this.trackHeights[track])<1){return;}if((((this.trackTops[track]+this.trackHeights[track])-y)<(this.dim.height/2))&&(y>0)){this.setY(y+(_11ee-this.trackHeights[track]));}this.trackHeights[track]=_11ee;this.tracks[track].div.style.height=(_11ee+this.trackPadding)+"px";var _11ef=this.trackTops[track];if(this.tracks[track].shown){_11ef+=_11ee+this.trackPadding;}for(var i=track+1;i<this.tracks.length;i++){this.trackTops[i]=_11ef;this.tracks[i].div.style.top=_11ef+"px";if(this.tracks[i].shown){_11ef+=this.trackHeights[i]+this.trackPadding;}}this.containerHeight=Math.max(_11ef,this.getY()+this.dim.height);this.scrollContainer.style.height=this.containerHeight+"px";};GenomeView.prototype.showVisibleBlocks=function(_11f0,pos,_11f1,endX){if(pos===undefined){pos=this.getPosition();}if(_11f1===undefined){_11f1=pos.x-(this.drawMargin*this.dim.width);}if(endX===undefined){endX=pos.x+((1+this.drawMargin)*this.dim.width);}var _11f2=Math.max(0,(_11f1/this.stripeWidth)|0);var _11f3=Math.min(this.stripeCount-1,(endX/this.stripeWidth)|0);var _11f4=Math.round(this.stripeWidth/this.pxPerBp);var _11f5=Math.round(this.pxToBp((_11f2*this.stripeWidth)+this.offset));var _11f6=Math.round(this.pxToBp(this.offset));var _11f7=Math.round(this.pxToBp(this.offset+(this.stripeCount*this.stripeWidth)));this.trackIterate(function(track,view){track.showRange(_11f2,_11f3,_11f5,_11f4,view.pxPerBp,_11f6,_11f7);});};GenomeView.prototype.addTrack=function(track){var _11f8=this.tracks.length;var _11f9=document.createElement("div");_11f9.className="track-label dojoDndHandle";dojo.addClass(_11f9,track.trackMeta.label+"-label");var _11fa=track.trackMeta.sourceType;if(_11fa){var _11fb=_11fa+"-label";dojo.addClass(_11f9,_11fb);}var _11fc=track.trackMeta.urlInfo;if(_11fc){_11f9.ondblclick=function(event){window.open(_11fc,"_blank");event.stopPropagation();};}else{_11f9.ondblclick=function(event){event.stopPropagation();};}_11f9.id="label_"+track.name;this.trackLabels.push(_11f9);var _11fd=document.createElement("div");_11fd.className="track";_11fd.id="track_"+track.name;_11fd.track=track;var view=this;var _11fe=function(_11ff){view.trackHeightUpdate(track.name,_11ff);};track.setViewInfo(_11fe,this.stripeCount,_11fd,_11f9,this.stripePercent,this.stripeWidth,this.pxPerBp);_11f9.style.position="absolute";_11f9.style.top="0px";_11f9.style.left=this.getX()+"px";_11fd.appendChild(_11f9);return _11fd;};GenomeView.prototype.trackIterate=function(_1200){var i;for(i=0;i<this.uiTracks.length;i++){_1200(this.uiTracks[i],this);}for(i=0;i<this.tracks.length;i++){_1200(this.tracks[i],this);}};GenomeView.prototype.updateTrackList=function(){var _1201=[];var _1202=this.zoomContainer.firstChild;do{if(_1202.track){_1201.push(_1202.track);}}while((_1202=_1202.nextSibling));this.tracks=_1201;var _1203={};var _1204=new Array(this.tracks.length);for(var i=0;i<_1201.length;i++){_1203[_1201[i].name]=i;if(_1201[i].name in this.trackIndices){_1204[i]=this.trackHeights[this.trackIndices[_1201[i].name]];}else{_1204[i]=0;}this.trackIndices[_1201[i].name]=i;}this.trackIndices=_1203;this.trackHeights=_1204;var _1205=this.topSpace;for(var i=0;i<this.tracks.length;i++){this.trackTops[i]=_1205;this.tracks[i].div.style.top=_1205+"px";if(this.tracks[i].shown){_1205+=this.trackHeights[i]+this.trackPadding;}}};}if(!dojo._hasResource["plugins.view.jbrowse.js.touchJBrowse"]){dojo._hasResource["plugins.view.jbrowse.js.touchJBrowse"]=true;dojo.provide("plugins.view.jbrowse.js.touchJBrowse");dojo.declare("plugins.view.jbrowse.js.touchJBrowse",null,{});function CompareObjPos(nodes,touch){var _1206=0,j=0,top=touch.pageY;for(var i=0;i<nodes.length;i++){_1206=j++;var _1207=findPos(nodes[i]);if(_1207.top>top){break;}}return _1206;};function checkAvatarPosition(first){var _1208=document.getElementById("tracksAvail"),_1209=document.getElementById("container");if(first.pageX<(_1208.offsetLeft+_1208.offsetWidth)){return _1208;}else{return _1209;}};var startX;function removeTouchEvents(){startX=null;};function touchSimulated(event){if(event.touches.length<=1){var _120a=event.changedTouches,first=_120a[0],type1="",type2="mouseover",_120b=document.getElementsByClassName("dojoDndAvatar"),obj={},pane=checkAvatarPosition(first),nodes=pane.getElementsByClassName("dojoDndItem"),_120c={},_120d=document.createEvent("MouseEvent"),_120e=document.createEvent("MouseEvent");switch(event.type){case "touchstart":startX=first.pageX;type1="mousedown";break;case "touchmove":event.preventDefault();type1="mousemove";break;default:return;}_120d.initMouseEvent(type1,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);_120e.initMouseEvent(type2,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);switch(event.type){case "touchstart":first.target.dispatchEvent(_120d);first.target.dispatchEvent(_120e);initialPane=pane;break;case "touchmove":if(_120b.length>0){if(nodes.length>0){_120c=CompareObjPos(nodes,first);obj=nodes[_120c];}try{if(initialPane!=pane){var _120f=document.createEvent("MouseEvent");var type3="mouseout";_120f.initMouseEvent(type3,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);initialPane.dispatchEvent(_120f);}obj.dispatchEvent(_120e);obj.dispatchEvent(_120d);}catch(err){pane.dispatchEvent(_120e);pane.dispatchEvent(_120d);}}break;default:return;}}else{removeTouchEvents();}};function touchEnd(event){var _1210=event.changedTouches,first=_1210[0],type1="mouseup",type2="mouseover",_1211=document.getElementsByClassName("dojoDndAvatar"),obj={},pane=checkAvatarPosition(first),nodes=pane.getElementsByClassName("dojoDndItem"),_1212={},_1213=document.createEvent("MouseEvent"),_1214=document.createEvent("MouseEvent");if(startX!==first.pageX){event.preventDefault();}var test=findPos(first.target);_1213.initMouseEvent(type1,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);_1214.initMouseEvent(type2,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);if(_1211.length>0){if(nodes.length>0){_1212=CompareObjPos(nodes,first);obj=nodes[_1212];}try{obj.dispatchEvent(_1214);obj.dispatchEvent(_1213);}catch(error){first.target.dispatchEvent(_1214);pane.dispatchEvent(_1214);}}else{first.target.dispatchEvent(_1213);first.target.dispatchEvent(_1214);}removeTouchEvents();};function touchHandle(event){dojo.query(".dojoDndItemAnchor").connect("touchstart",touchSimulated);dojo.query(".dojoDndItemAnchor").connect("touchmove",touchSimulated);dojo.query(".dojoDndItemAnchor").connect("touchend",touchEnd);dojo.query(".dojoDndItemAnchor").connect("click",function(){void (0);});if(event.touches.length<=1){var _1215=event.changedTouches,first=_1215[0],type="";switch(event.type){case "touchstart":startX=first.pageX;type="mousedown";break;case "touchmove":event.preventDefault();type="mousemove";break;case "touchend":if(startX!==first.pageX){event.preventDefault();}type="mouseup";break;default:return;}var _1216=document.createEvent("MouseEvent");_1216.initMouseEvent(type,true,true,window,1,first.screenX,first.screenY,first.clientX,first.clientY,false,false,false,false,0,null);first.target.dispatchEvent(_1216);}else{removeTouchEvents();}};function touchinit(){dojo.query(".dojoDndItem").connect("touchstart",touchSimulated);dojo.query(".dojoDndItem").connect("touchmove",touchSimulated);dojo.query(".dojoDndItem").connect("touchend",touchEnd);dojo.query(".locationThumb").connect("touchstart",touchHandle);dojo.query(".locationThumb").connect("touchmove",touchHandle);dojo.query(".locationThumb").connect("touchend",touchHandle);dojo.query(".dojoDndItem").connect("click",function(){void (0);});dojo.query(".dojoDndTarget").connect("touchstart",touchHandle);dojo.query(".dojoDndTarget").connect("touchmove",touchHandle);dojo.query(".dojoDndTarget").connect("touchend",touchHandle);dojo.query(".dijitSplitter").connect("touchstart",touchHandle);dojo.query(".dijitSplitter").connect("touchmove",touchHandle);dojo.query(".dijitSplitter").connect("touchend",touchHandle);};function load(){touchinit();document.documentElement.style.webkitTouchCallout="none";};function findPos(obj){var _1217=0,objP={};if(obj.offsetParent){do{_1217+=obj.offsetTop;}while((obj=obj.offsetParent));}objP.top=_1217;return objP;};}if(!dojo._hasResource["plugins.view.View"]){dojo._hasResource["plugins.view.View"]=true;dojo.provide("plugins.view.View");if(1){var refSeqs;var trackInfo;}dojo.declare("plugins.view.View",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"view\"\n\t\ttitle=\"View\"\n\t\tdojoType=\"dijit.layout.BorderContainer\"\n\t\ticonClass=\"viewIcon\"\n\t\tstyle=\"width: 1100px !important; min-width: 100% !important;  height: 100% !important; min-height: 1200px !important; padding: 0px !important; bottom: 0px !important;\"\n\t\tclosable=\"true\"\n\t>\n\t\t\n\t\t<!-- LEFT PANE -->\n\t\t<div\n\t\t\tdojoAttachPoint=\"leftPane\" \n\t\t\tclass=\"leftPane\" \n\t\t\tdojoType=\"dojox.layout.ExpandoPane\" \n\t\t\tmaxWidth=\"200px\"\n\t\t\tsplitter=\"true\" \n\t\t\tduration=\"125\"\n\t\t\tregion=\"left\"\n\t\t\tstartExpanded=\"false\"\n\t\t\tstyle=\"width: 210px; min-width: 25px; background: #FFF; padding: 0; overflow: visible;\"\n\t\t\teaseIn=\"dojo.fx.easing.expoOut\" \n\t\t\teaseOut=\"dojo.fx.easing.expoInOut\"\n\t\t\tduration=\"100\"\n\t\t>\n\t\t\t\n\t\t\t<table width=\"210px\">\n\n\t\t\t\t<tr class=\"spacerTitle\">\n\n\t\t\t\t\t<td class=\"statusReady\"\n\t\t\t\t\t\tdojoAttachPoint=\"statusDisplay\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:stopPoll\"\n\t\t\t\t\t>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td colspan=\"1\" class=\"spacerTitle\">Views</td>\n\t\t\t\t\t<td class=\"spacerTitle\"> &nbsp; </td>\n\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Project</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"projectIcon\">\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\tclass=\"viewProjectCombo\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"viewProjectCombo\"\n\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireViewProjectCombo\"\n\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\ttitle=\"Select a project containing your views\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t</tr>\t\t\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"viewTitle\" colspan=\"4\">View</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\n\t\t\t\t\t<td class=\"viewIcon\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:refreshView\"\n\t\t\t\t\t\ttitle=\"Click to reload View\"\n\t\t\t\t\t>\n\t\t\t\t\t</td>\n\t\t\n\t\t\t\t\t<td>\n\t\t\n\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\tclass=\"viewCombo\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"viewCombo\"\n\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireViewCombo\"\n\t\t\t\t\t\t\tautocomplete=\"false\"'\n\t\t\t\t\t\t\ttitle=\"Select a view or type a name to create one\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td dojoAttachPoint=\"deleteViewButton\"\n\t\t\t\t\t\tclass=\"deleteViewButton\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:confirmRemoveView\"\n\t\t\t\t\t\twidth=\"20%\"\n\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\tclass=\"fileUpload\"\n\t\t\t\t\t\ttitle=\"Click to delete the selected View\"\n\t\t\t\t\t></td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Species</td>\n\t\t\t\t</tr>\n\n\t\t\t\t\t<td class=\"speciesIcon\">\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\tclass=\"speciesLabel\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"speciesLabel\"\n\t\t\t\t\t\t\t\t>&nbsp;</td>\n\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\tclass=\"buildLabel\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"buildLabel\"\n\t\t\t\t\t\t\t\t>&nbsp;</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\t\t\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Feature List</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"featureIcon\">\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\tclass=\"featureList\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"featureList\"\n\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\ttitle=\"Select a feature to add to the selected View\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div dojoAttachPoint=\"deleteFeatureButton\"\n\t\t\t\t\t\tclass=\"deleteFeatureButton\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:removeViewFeature\"\n\t\t\t\t\t\twidth=\"20%\"\n\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\tclass=\"fileUpload\" ></div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"4\">\n\n\t\t\t\t\t\t<div class=\"addFeatures\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<table class=\"addFeaturesTable\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"spacerTitle\" colspan=\"3\">Add Features</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Project</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"projectIcon\">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"featureProjectCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"featureProjectCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireFeatureProjectCombo\"\n\t\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Select a project containing features\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Workflow</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td class=\"workflowIcon\">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"workflowCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"workflowCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireWorkflowCombo\"\n\t\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Select a workflow containing features\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Species</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td class=\"speciesIcon\">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<select dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"speciesCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"speciesCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireSpeciesCombo\"\n\t\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Select a species and build to display features below\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Feature Tracks</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"featureIcon\">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"featureCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"featureCombo\"\n\t\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Select a feature to add to the selected view\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addFeatureButton\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addViewFeature\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"addFeatureButton\"\n\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n\t\t\t\t\t\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"fileUpload\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Click to add the selected Feature to the selected View\"\n\t\t\t\t\t\t\t\t\t\t\t>Add</div>\n\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t</table>\n\n\n\t\t</div>\n\t\t<!-- END OF LEFT PANE -->\n\n\n\t\t<!-- RIGHT PANE -->\n\t\t<div\n\t\t\tdojoType=\"dijit.layout.TabContainer\" \n\t\t\tdojoAttachPoint=\"rightPane\"\n\t\t\tclass=\"rightPane\" \n\t\t\tregion=\"center\"\n\t\t>\n\n\n\t\t</div>\n\t\t<!-- END OF RIGHT PANE -->\n\n\t</div>\n\t<!-- END OF VIEW TAB dijit.layout.BorderContainer -->\n\n</div> \n",parentWidget:null,project:null,workflow:null,onChangeListeners:new Object,setListeners:false,widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","view/css/view.css"),dojo.moduleUrl("plugins","view/css/genome.css"),dojo.moduleUrl("dojox","layout/resources/ExpandoPane.css"),dojo.moduleUrl("dojox","layout/tests/_expando.css"),dojo.moduleUrl("plugins","dnd/css/dnd.css")],browsers:[],url:null,baseUrl:"plugins/view/jbrowse/",browserRoot:"plugins/view/jbrowse/",polling:false,delay:10000,constructor:function(args){this.parentWidget=args.parentWidget;this.project=args.project;this.workflow=args.workflow;if(Agua.cgiUrl){this.url=Agua.cgiUrl+"/view.cgi";}if(args["cssFiles"]!=null){this.cssFiles=args.cssFiles;}this.loadCSS(this.cssFiles);},postCreate:function(){this.startup();},startup:function(){console.log("View.startup    plugins.view.Template.View.startup()");Agua.addWidget("view",this);this.inherited(arguments);this.attachWidget.addChild(this.mainTab);this.attachWidget.selectChild(this.mainTab);this.leftPane.toggle();this.setUrl();this.setSequence();this.setConfirmDialog();this.setSelectiveDialog();this.setStandby();this.setViewProjectCombo();setTimeout(function(_1218){_1218.setFeatureProjectCombo();},10,this);setTimeout(function(_1219){_1219.setOnkeyListener();},1000,this);setTimeout(function(_121a){_121a.loadBrowser(_121a.getProject(),_121a.getView());},2000,this);},loadEval:function(url){console.log("View.loadEval    url: "+url);dojo.xhrGet({url:url,sync:true,handleAs:"text",load:function(_121b){eval(_121b);},error:function(_121c,_121d){console.log("  View.loadEval    Response error. Response: "+_121c);return _121c;}});},getRefseqfile:function(_121e,_121f,_1220){return this.baseUrl+"/users"+"/"+_121e+"/"+_121f+"/"+_1220+"/data/refSeqs.js";},getTrackinfofile:function(_1221,_1222,_1223){return this.baseUrl+"/users"+"/"+_1221+"/"+_1222+"/"+_1223+"/data/trackInfo.js";},getProject:function(){return this.viewProjectCombo.get("value");},getWorkflow:function(){return this.workflowCombo.get("value");},getView:function(){return this.viewCombo.get("value");},getViewFeature:function(){return this.featureList.get("value")?this.featureList.get("value"):"";},getBuild:function(){return this.buildLabel.innerHTML;},getSpecies:function(){return this.speciesLabel.innerHTML;},getFeatureBuild:function(){var _1224=this.speciesCombo.get("value");if(_1224.match(/^(\S+)\(([^\)]+)\)$/)){return _1224.match(/^(\S+)\(([^\)]+)\)$/)[2];}},getFeatureSpecies:function(){var _1225=this.speciesCombo.get("value");if(_1225.match(/^(\S+)\(([^\)]+)\)$/)){return _1225.match(/^(\S+)\(([^\)]+)\)$/)[1];}},getFeature:function(){return this.featureCombo.get("value");},getFeatureProject:function(){return this.featureProjectCombo.get("value");},getFeatureWorkflow:function(){return this.workflowCombo.get("value");},setUrl:function(){this.url=Agua.cgiUrl+"view.cgi?";return this.url;},setSequence:function(){this.sequence=new plugins.dojox.timing.Sequence({});},setOnkeyListener:function(){var _1226=this;this.viewCombo._onKey=function(event){var key=event.charOrCode;if(key==13){var _1227=_1226.viewProjectCombo.get("value");var _1228=_1226.viewCombo.get("value");var _1229=Agua.isView(_1227,_1228);console.log("View.setOnKeyListener._onKey\t   isView: "+_1229);if(_1229==false){_1226.confirmAddView(_1227,_1228);}if(_1226.viewCombo._popupWidget!=null){_1226.viewCombo._showResultList();}}};},setConfirmDialog:function(){var _122a=function(){};var _122b=function(){};var title="Dialog title";var _122c="Dialog message";this.confirmDialog=new plugins.dijit.ConfirmDialog({title:title,message:_122c,parentWidget:this,yesCallback:_122a,noCallback:_122b});},loadConfirmDialog:function(title,_122d,_122e,_122f){this.confirmDialog.load({title:title,message:_122d,yesCallback:_122e,noCallback:_122f});},setSelectiveDialog:function(){var _1230=function(){};var _1231=function(){};var title="";var _1232="";console.log("Stages.setSelectiveDialog    plugins.files.Stages.setSelectiveDialog()");this.selectiveDialog=new plugins.dijit.SelectiveDialog({title:title,message:_1232,parentWidget:this,enterCallback:_1230,cancelCallback:_1231});console.log("Stages.setSelectiveDialog    this.selectiveDialog: "+this.selectiveDialog);},loadSelectiveDialog:function(title,_1233,_1234,_1235,_1236,_1237,_1238,_1239){console.log("Stages.loadSelectiveDialog    plugins.files.Stages.loadSelectiveDialog()");console.log("Stages.loadSelectiveDialog    enterCallback.toString(): "+_1238.toString());console.log("Stages.loadSelectiveDialog    title: "+title);console.log("Stages.loadSelectiveDialog    message: "+_1233);console.log("Stages.loadSelectiveDialog    enterCallback: "+_1238);console.log("Stages.loadSelectiveDialog    cancelCallback: "+_1239);this.selectiveDialog.load({title:title,message:_1233,comboValues:_1234,inputMessage:_1235,comboMessage:_1236,checkboxMessage:_1237,parentWidget:this,enterCallback:_1238,cancelCallback:_1239});},setViewProjectCombo:function(_123a,_123b){console.log("View.setViewProjectCombo    projectName: "+_123a);console.log("View.setViewProjectCombo    viewName: "+_123b);var _123c=Agua.getProjects();var _123d=Agua.getProjectNames(_123c);console.log("View.setViewProjectCombo    BEFORE SORT projectNames: ");console.dir({projectNames:_123d});console.log("View.setViewProjectCombo    DOING projectNames.sort(this.sortNaturally)");_123d.sort(this.sortNaturally);console.log("View.setViewProjectCombo    AFTER SORT projectNames: ");console.dir({projectName:_123a});if(!_123d){return;}var data={identifier:"name",items:[]};for(var i in _123d){data.items[i]={name:_123d[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.viewProjectCombo.store=store;if(_123a==null||!_123a){_123a=_123d[0];}this.viewProjectCombo.setValue(_123a);if(_123a==null){_123a=this.viewProjectCombo.get("value");}this.setViewCombo(_123a,_123b);},setViewCombo:function(_123e,_123f){console.log("View.setViewCombo    projectName: "+_123e);console.log("View.setViewCombo    viewName: "+_123f);this.inherited(arguments);if(_123f==null){var views=Agua.getViewsByProject(_123e);if(views==null||views.length==0){return;}if(views.length>0){_123f=views[0].view;}}this.setSpeciesLabel(_123e,_123f);},setSpeciesLabel:function(_1240,_1241){console.log("View.setSpeciesLabel    projectName: "+_1240);console.log("View.setSpeciesLabel    viewName: "+_1241);var _1242=Agua.getSpecies(_1240,_1241);this.speciesLabel.innerHTML=_1242||"";var build=Agua.getBuild(_1240,_1241);this.buildLabel.innerHTML=build||"";var _1243=_1242+"("+build+")";this.speciesCombo.set("value",_1243);var _1244=Agua.getViewFeatures(_1240,_1241);var _1245=this.hashArrayKeyToArray(_1244,"feature");this.setFeatureList(_1245);},setFeatureProjectCombo:function(_1246,_1247){console.log("Common.setFeatureProjectCombo    projectName: "+_1246);var _1248=Agua.getFeatureProjects();console.log("  View.setFeatureProjectCombo    projects: ");console.dir({projectNames:_1248});var data={identifier:"name",items:[]};for(var i in _1248){data.items[i]={name:_1248[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.featureProjectCombo.store=store;if(_1246==null||!_1246){_1246=_1248[0];}this.featureProjectCombo.setValue(_1246);if(_1246==null){_1246=this.featureProjectCombo.get("value");}this.setWorkflowCombo(_1246);},setWorkflowCombo:function(_1249,_124a){console.log("View.setWorkflowCombo    projectName: "+_1249);console.log("View.setWorkflowCombo    workflowName: "+_124a);if(_1249==null||!_1249){return;}if(this.workflowCombo==null){return;}var _124b=Agua.getViewProjectWorkflows(_1249);console.log("View.setWorkflowCombo    projectName '"+_1249+"' workflowNames: ");console.dir({workflowNames:_124b});if(!_124b){return;}var data={identifier:"name",items:[]};for(var i in _124b){data.items[i]={name:_124b[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.workflowCombo.store=store;if(_124a==null||!_124a){_124a=_124b[0];}this.workflowCombo.startup();this.workflowCombo.set("value",_124a);if(_1249==null){_1249=this.viewProjectCombo.get("value");}if(_124a==null){_124a=this.workflowCombo.get("value");}this.setSpeciesCombo(_1249,_124a);},setSpeciesCombo:function(_124c,_124d,_124e,_124f){if(_124c==null){_124c=this.featureProjectCombo.get("value");}if(_124d==null){_124d=this.workflowCombo.get("value");}var _1250=Agua.getViewWorkflowFeatures(_124c,_124d);if(_1250==null||_1250.length==0){return;}var _1251=new Array;for(var i=0;i<_1250.length;i++){_1251.push(_1250[i].species+"("+_1250[i].build+")");}_1251=this.uniqueValues(_1251);var _1252;if(_124e==null||!_124e||_124f==null||!_124f){_1252=_1251[0];_124e=_1250[0].species;_124f=_1250[0].build;}else{_1252=_124e+"("+_124f+")";}var data={identifier:"name",items:[]};for(var i in _1251){data.items[i]={name:_1251[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.speciesCombo.store=store;this.speciesCombo.startup();this.speciesCombo.set("value",_1252);this.setFeatureCombo(_124c,_124d,_124e,_124f);},setFeatureCombo:function(_1253,_1254,_1255,_1256){console.log("View.setFeatureCombo    plugins.view.View.setFeatureCombo(projectName, workflowName)");console.log("View.setFeatureCombo    projectName: "+_1253);console.log("View.setFeatureCombo    workflowName: "+_1254);if(_1253==null||!_1253||_1254==null||!_1254||_1255==null||!_1255||_1256==null||!_1256){console.log("View.setFeatureCombo    Project, workflow, species or build not defined. Returning.");return;}var _1257=Agua.getViewSpeciesFeatureNames(_1253,_1254,_1255,_1256);if(!_1257){console.log("View.setFeatureCombo    featureNames not defined. Returning.");return;}console.log("View.setFeatureCombo    projectName '"+_1253+"' workflowName '"+_1254+"' speciesName '"+_1255+"' buildName '"+_1256+"' featureNames: "+dojo.toJson(_1257));var data={identifier:"name",items:[]};for(var i in _1257){data.items[i]={name:_1257[i]};}console.log("View.setFeatureCombo    data: "+dojo.toJson(data));var store=new dojo.data.ItemFileReadStore({data:data});this.featureCombo.store=store;var _1258=_1257[0];this.featureCombo.startup();this.featureCombo.set("value",_1258);},setFeatureList:function(_1259){console.log("View.setFeatureList    featureNames: "+dojo.toJson(_1259));var data={identifier:"name",items:[]};for(var i in _1259){data.items[i]={name:_1259[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.featureList.store=store;this.featureList.startup();this.featureList.set("value",_1259[0]);},_delayedPoll:function(_125a,_125b,_125c){console.log("View._delayedPoll    viewObject:");console.dir({viewObject:_125a});var _125d=_125a;_125d.mode="viewStatus";_125d.username=Agua.cookie("username");_125d.sessionId=Agua.cookie("sessionId");console.log("View._delayedPoll    putData:");console.dir({putData:_125d});if(!_125c){_125c="";}var delay=this.delay;var _125e=[{func:[this.showMessage,this,_125c,_125d],pauseAfter:delay},{func:[this.pollStatus,this,_125d,_125b]}];this.sequence.clear();this.sequence.go(_125e,function(){});},pollStatus:function(_125f,_1260){console.log("View.pollStatus    putData:");console.dir({putData:_125f});console.log("View.pollStatus    this.polling: "+this.polling);if(!this.polling){return;}var url=this.url;var _1261=this;this.pollStatusDeferred=dojo.xhrPut({url:url,handleAs:"json-comment-optional",sync:false,putData:dojo.toJson(_125f),handle:function(_1262){_1260(_1262,_125f);}});},stopPoll:function(){this.polling=false;console.log("View.stopPoll    this.polling: "+this.polling);this.pollStatusDeferred.handle=function(){};},refreshView:function(){console.log("View.refreshView    plugins.view.View.refreshView()");this.standby.hide();this.displayLoading();this.reloadBrowser(this.getProject(),this.getView());var _1263=new Object;_1263.feature=this.getFeature();_1263.sourceproject=this.getFeatureProject();_1263.sourceworkflow=this.getFeatureWorkflow();_1263.species=this.getFeatureSpecies();_1263.build=this.getFeatureBuild();_1263.project=this.getProject();_1263.view=this.getView();_1263.username=Agua.cookie("username");_1263.sessionId=Agua.cookie("sessionId");_1263.mode="refreshView";var url=Agua.cgiUrl+"view.cgi";var _1264=dojo.hitch(this,"_refreshView");this.doPut({url:this.url,query:_1263,callback:_1264});},_refreshView:function(_1265){this.displayReady();if(!_1265){Agua.toastError("Problem reloading 'views'/'viewfeatures'");}else{Agua.setData("views",_1265.views);Agua.setData("viewfeatures",_1265.viewfeatures);this.setViewCombo(this.getProject());}},updateViewLocation:function(_1266,_1267,chrom){if(this.loading==true){return 1;}console.log("View.updateViewLocation    location: "+_1267);if(_1267==null){return 1;}var _1268=String(_1267).match(/^(((\S*)\s*:)?\s*(-?[0-9,.]*[0-9])\s*(\.\.|-|\s+))?\s*(-?[0-9,.]+)$/i);if(_1268==null){return 1;}var _1269=_1268[3];if(_1269==null){_1269=chrom;}var start=parseInt(_1268[4].replace(/[,.]/g,""));var stop=parseInt(_1268[6].replace(/[,.]/g,""));if(!start&&!stop){return 1;}var _126a=Agua.getViewObject(_1266.project,_1266.view);if(!_126a){console.log("View.updateViewLocation    object NOT DEFINED");return;}if(_126a.chromosome==_1269&&_126a.start==start&&_126a.stop==stop){return;}_126a.chromosome=_1269;_126a.start=start;_126a.stop=stop;var _126b=Agua.removeView(_126a);if(_126b!=true){console.log("View.updateViewLocation    Could not do Agua.removeView() for add track to view "+_1266.view);return;}_126b=Agua.addView(_126a);if(_126b!=true){return;}_126a.username=Agua.cookie("username");_126a.sessionId=Agua.cookie("sessionId");_126a.mode="updateViewLocation";this.doPut({url:this.url,query:_126a,doToast:false});},handleTrackChange:function(_126c,track,_126d){console.log("View.handleTrackChange    view.View.handleTrackChange(viewObject, track, action)");if(this.loading==true){return 1;}var _126e=Agua.getViewObject(_126c.project,_126c.view);var _126f=[];if(_126e.tracklist){_126f=_126e.tracklist.split(",");}var index;for(var i=0;i<_126f.length;i++){if(_126f[i]==track){index=i;continue;}}if(_126d=="add"){if(index!=null){return 0;}else{_126f.push(track);}}if(_126d=="remove"){if(index==null){return 1;}else{_126f.splice(index,1);}}_126e.tracklist=_126f.join(",");this.updateViewTracklist(_126e);},updateViewTracklist:function(_1270){console.log("View.updateViewTracklist    object: ");console.dir({object:_1270});var _1271=Agua.removeView(_1270);console.log("View.updateViewTracklist    success: "+_1271);console.dir({views:Agua.cloneData("views")});if(!_1271){console.log("View.updateViewTracklist    Could not do Agua.removeView() for view: "+viewObject.view);return;}_1271=Agua.addView(_1270);console.log("View.updateViewTracklist    Agua.addView(object) success: "+_1271);console.dir({views:Agua.cloneData("views")});if(!_1271){console.log("View.updateViewTracklist    Could not do Agua.addView() for view: "+viewObject.view);return;}_1270.username=Agua.cookie("username");_1270.sessionId=Agua.cookie("sessionId");_1270.mode="updateViewTracklist";this.doPut({url:this.url,query:_1270,doToast:false});},confirmAddView:function(_1272,_1273){console.log("View.confirmAddView    plugins.files.View.confirmAddView()");console.log("View.confirmAddView    this.selectiveDialog: "+this.selectiveDialog);this.polling=false;var _1274=this;var _1275=Agua.getSpeciesBuilds();console.log("View.confirmAddView    speciesBuilds: "+dojo.toJson(_1275));var _1276=function(){};var _1277=dojo.hitch(this,function(input,_1278,_1279,_127a){console.log("View.confirmAddView    Doing enterCallback(input, speciesBuild, checked, dialogWidget)");console.log("View.confirmAddView    viewName: "+_1273);console.log("View.confirmAddView    projectName: "+_1272);console.log("View.confirmAddView    input: "+input);console.log("View.confirmAddView    speciesBuild: "+_1278);console.log("View.confirmAddView    checked: "+_1279);console.log("View.confirmAddView    dialogWidget: "+_127a);_127a.messageNode.innerHTML="Adding view: "+_1273;_127a.close();console.log("View.confirmAddView    Doing this.addView()");_1274.addView(_1272,_1273,_1278);});this.selectiveDialog.load({title:"Add view: "+_1273,message:"Select species/build combination",comboValues:_1275,inputMessage:null,comboMessage:null,checkboxMessage:null,parentWidget:this,enterCallback:_1277,cancelCallback:_1276,enterLabel:"Add",cancelLabel:"Cancel"});},addView:function(_127b,_127c,_127d){console.log("View.addView    projectName: "+_127b);console.log("View.addView    viewName: "+_127c);console.log("View.addView    speciesBuild: "+_127d);if(this.polling){console.log("View.addView    this.polling is TRUE. Returning");return;}this.polling=true;this.standby.show();var _127e=_127d.match(/^(\S+)\(([^\)]+)\)$/)[1];var build=_127d.match(/^(\S+)\(([^\)]+)\)$/)[2];this.speciesLabel.innerHTML="";this.buildLabel.innerHTML="";var _127f=new Object;_127f.project=_127b;_127f.view=_127c;_127f.species=_127e;_127f.build=build;console.log("View.addView    viewObject: "+_127f);console.dir({viewObject:_127f});this._addView(dojo.clone(_127f));this._remoteAddView(dojo.clone(_127f));console.log("View.addView    Doing this._delayedPoll(dojo.clone(viewObject), this._handleAddView, message)");var _1280="View._delayedPoll    addView";this._delayedPoll(dojo.clone(_127f),dojo.hitch(this,"_handleAddView"),_1280);},_addView:function(_1281){console.log("View._addView    viewObject:");console.dir({viewObject:_1281});if(!Agua.addView(_1281)){console.log("View.addView    Could not add view to this.views["+_1281.view+"]");}},_remoteAddView:function(_1282){console.log("View._remoteAddView    viewObject:");console.dir({viewObject:_1282});var _1283=dojo.clone(_1282);_1283.mode="addView";_1283.username=Agua.cookie("username");_1283.sessionId=Agua.cookie("sessionId");var url=this.url;var _1284=function(_1285){console.log("View._remoteAddView    response: ");console.dir({response:_1285});if(_1285.error){thisObject.standby.hide();console.log("View._remoteAddView    Error adding view");Agua.toast(_1285);}};this.doPut({url:url,query:_1283,callback:_1284,doToast:false});},_handleAddView:function(_1286,_1287){console.log("View._handleAddView    response: ");console.dir({response:_1286});console.log("View._handleAddView    viewObject: ");console.dir({viewObject:_1287});if(_1286.status=="ready"){this.polling=false;this.standby._setTextAttr("");this.standby.hide();this.displayReady();console.log("View._handleAddView    Doing this.setViewCombo()");this.setViewCombo(_1287.project,_1287.view);console.log("View._handleAddView    Doing this.reloadBrowser()");this.reloadBrowser(_1287.project,_1287.view);Agua.toastInfo("Added view: "+_1287.view);}else{if(_1286.error){this.polling=false;this.standby.hide();this.displayReady();console.log("View.addView    Error on remote. Response: ");console.dir({response:_1286});}else{console.log("View._delayedPoll    Doing this._delayedPoll(dojo.clone(viewObject), this._handleAddView, message)");var _1288="View._delayedPoll    addView";this._delayedPoll(dojo.clone(_1287),dojo.hitch(this,"_handleAddView"),_1288);}}},confirmRemoveView:function(){var _1289=function(){};var _128a=dojo.hitch(this,function(){this.removeView();});var _128b=this.getProject();var _128c=this.getView();var title="Delete view '"+_128b+"."+_128c+"' ?";var _128d="All its data will be destroyed";this.loadConfirmDialog(title,_128d,_128a,_1289);},removeView:function(){console.log("View.removeView    plugins.view.View.removeView()");var _128e=this.getProject();var _128f=this.getView();var _1290=this.getSpecies();var build=this.getBuild();console.log("View.removeView    projectName: "+_128e);console.log("View.removeView    viewName: "+_128f);console.log("View.removeView    species: "+_1290);console.log("View.removeView    build: "+build);this.speciesLabel.innerHTML="";this.buildLabel.innerHTML="";var _1291=new Object;_1291.project=_128e;_1291.view=_128f;_1291.species=_1290;_1291.build=build;console.log("View.removeView    viewObject: "+_1291);console.dir({viewObject:_1291});this._removeView(dojo.clone(_1291));console.log("View._removeView    Doing this.removeBrowser()");var _1292=this.getBrowser(_1291.project,_1291.view);console.log("View._removeView    browserObject: ");console.dir({browserObject:_1292});if(_1292){this.removeBrowser(_1292.browser,_1291.project,_1291.view);}var _1293=Agua.getPreviousView(_1291);console.log("View.removeBrowser    previousView: ");console.dir({previousView:_1293});console.log("View.removeBrowser    DOING this.setViewProjectCombo(previousView.project, previousView.view)");this.setViewProjectCombo(_1293.project,_1293.view);Agua.toastInfo("Removed view: "+_1291.view);this._remoteRemoveView(dojo.clone(_1291));},_removeView:function(_1294){console.log("View._removeView    viewObject: "+dojo.toJson(_1294));console.dir({viewObject:_1294});if(!Agua.removeView(_1294)){console.log("View._removeView    Could not remove view: "+_1294.view);return;}},_remoteRemoveView:function(_1295){console.log("View._remoteRemoveView    viewObject:");console.dir({viewObject:_1295});var _1296=dojo.clone(_1295);_1296.mode="removeView";_1296.username=Agua.cookie("username");_1296.sessionId=Agua.cookie("sessionId");var _1297=this;var url=this.url;var _1298=function(_1299){console.log("View._remoteRemoveView    response: ");console.dir({response:_1299});if(_1299.error){_1297.standby.hide();console.log("View._remoteRemoveView    Error removing view");Agua.toast(_1299);}};this.doPut({url:url,query:_1296,callback:_1298,doToast:false});},_handleRemoveView:function(_129a,_129b){console.log("View._handleRemoveView    response: ");console.dir({response:_129a});console.log("View._handleRemoveView    viewObject: ");console.dir({viewObject:_129b});if(_129a){console.log("View._handleRemoveView    HERE 1 XXX");this.polling=false;if(this.standby._textNode){this.standby._setTextAttr("");}console.log("View._handleRemoveView    HERE 2");this.standby.hide();console.log("View._handleRemoveView    HERE 3");this.displayReady();console.log("View._handleRemoveView    HERE 4");var _129c=Agua.getPreviousView(_129b);console.log("View._handleRemoveView    previousView: ");console.dir({previousView:_129c});console.log("View._handleRemoveView    Doing this.removeBrowser()");var _129d=this.getBrowser(_129b.project,_129b.view);console.log("View._handleRemoveView    browserObject: ");console.dir({browserObject:_129d});this.removeBrowser(_129d.browser,_129b.project,_129b.view);console.log("View._handleRemoveView    DOING this.setViewProjectCombo(previousView.project, previousView.view)");this.setViewProjectCombo(_129c.project,_129c.view);Agua.toastInfo("Removed view: "+_129b.view);}else{if(_129a.error){this.polling=false;this.standby.hide();this.displayReady();console.log("View.addView    Error on remote. Response: ");console.dir({response:_129a});}else{console.log("View._delayedPoll    Doing this._delayedPoll(dojo.clone(viewObject), this._handleRemoveView, message)");var _129e="View._delayedPoll    addView";this._delayedPoll(dojo.clone(_129b),dojo.hitch(this,"_handleRemoveView"),_129e);}}},addViewFeature:function(){console.log("View.addViewFeature    plugins.view.View.addViewFeature()");if(!this.getFeature()){return;}if(this.polling==true){console.log("View.addViewFeature    this.polling IS TRUE. Returning");return;}this.polling=true;var _129f=this.getProject();var view=this.getView();var _12a0=this.getFeature();if(Agua.hasViewFeature(_129f,view,_12a0)){console.log("View.addViewFeature    Feature already present. Returning");this.polling=false;return;}this.displayLoading();this.showStandby("Adding feature '"+_12a0+"' <br>to view '"+_129f+"."+view+"'");var _12a1=new Object;_12a1.project=_129f;_12a1.view=view;_12a1.feature=_12a0;_12a1.sourceproject=this.getFeatureProject();_12a1.sourceworkflow=this.getFeatureWorkflow();_12a1.species=this.getFeatureSpecies();_12a1.build=this.getFeatureBuild();if(Agua.hasViewFeature==true){console.log("View.addViewFeature    hasViewFeature is TRUE");return;}this._addViewFeature(dojo.clone(_12a1));this._remoteAddViewFeature(dojo.clone(_12a1));console.log("View.addViewFeature    Doing this._delayedPoll()");var _12a2="View._delayedPoll    addViewFeature";this._delayedPoll(dojo.clone(_12a1),dojo.hitch(this,"_handleAddViewFeature"),_12a2);},_addViewFeature:function(_12a3){console.log("View._addViewFeature    featureObject: ");console.dir({featureObject:_12a3});if(!Agua._addViewFeature(_12a3)){console.log("View._addViewFeature    Agua._addViewFeature FAILED");Agua.toastError("Failed to add feature to local data: "+_12a3.feature);}},_remoteAddViewFeature:function(_12a4){console.log("View._remoteAddViewFeature    featureObject:");console.dir({featureObject:_12a4});var _12a5=dojo.clone(_12a4);_12a5.username=Agua.cookie("username");_12a5.sessionId=Agua.cookie("sessionId");_12a5.mode="addViewFeature";var url=this.url;var _12a6=function(_12a7){console.log("View._remoteAddViewFeature    response: ");console.dir({response:_12a7});if(_12a7.error){thisObject.standby.hide();console.log("View._remoteAddViewFeature    Error adding viewFeature");Agua.toast(_12a7);}};this.doPut({url:url,query:_12a5,callback:_12a6,doToast:false});},_handleAddViewFeature:function(_12a8,_12a9){console.log("View._handleAddViewFeature    response: ");console.dir({response:_12a8});console.log("View._handleAddViewFeature    featureObject: ");console.dir({featureObject:_12a9});if(_12a8.status=="ready"){this.polling=false;this.standby._setTextAttr("");this.standby.hide();this.displayReady();console.log("View._handleAddViewFeature    Doing this.setViewCombo(featureObject.project, featureObject.view)");this.setViewCombo(_12a9.project,_12a9.view);console.log("View._handleAddViewFeature    Doing this.reloadBrowser(featureObject.project, featureObject.view)");this.reloadBrowser(_12a9.project,_12a9.view);Agua.toastInfo("Added feature: "+_12a9.feature);}else{if(_12a8.error){this.polling=false;this.standby.hide();this.displayReady();console.log("View.handleAddViewFeature    Error on remote. Response: ");console.dir({response:_12a8});}else{console.log("View._handleAddViewFeature    Doing this._delayedPollAddViewFeature()");var _12aa="View._delayedPoll    handleAddViewFeature";this._delayedPoll(dojo.clone(_12a9),dojo.hitch(this,"_handleAddViewFeature"),_12aa);}}},removeViewFeature:function(){console.log("View.removeViewFeature    plugins.view.View.removeViewFeature()");if(!this.getViewFeature()){return;}if(this.polling==true){console.log("View.addViewFeature    this.polling IS TRUE. Returning");return;}this.polling=true;var _12ab=this.getProject();var view=this.getView();var _12ac=this.getViewFeature();if(!Agua.hasViewFeature(_12ab,view,_12ac)){console.log("View.removeViewFeature    Feature NOT present. Returning");this.polling=false;return;}this.showStandby("Removing feature '"+_12ac+"' <br>from view '"+_12ab+"."+view+"'");this.displayLoading();var _12ad=new Object;_12ad.project=this.getProject();_12ad.view=this.getView();_12ad.feature=this.getViewFeature();_12ad.species=this.getFeatureSpecies();_12ad.build=this.getFeatureBuild();_12ad.username=Agua.cookie("username");_12ad.sessionId=Agua.cookie("sessionId");_12ad.mode="removeViewFeature";console.log("View.removeViewFeature    featureObject: "+dojo.toJson(_12ad,true));this._removeViewFeature(dojo.clone(_12ad));this._remoteRemoveViewFeature(dojo.clone(_12ad));console.log("View.addViewFeature    Doing this._delayedPoll()");var _12ae="View._delayedPoll    addViewFeature";this._delayedPoll(dojo.clone(_12ad),dojo.hitch(this,"_handleRemoveViewFeature"),_12ae);},_removeViewFeature:function(_12af){console.log("View._removeViewFeature    featureObject: "+dojo.toJson(_12af));console.log("View._removeViewFeature    Doing Agua._removeViewFeature()");if(!Agua._removeViewFeature(_12af)){console.log("View._removeViewFeature    Agua._removeViewFeature FAILED");Agua.toastError("Failed to remove feature from local data: "+_12af.feature);}},_remoteRemoveViewFeature:function(_12b0){console.log("View._remoteRemoveViewFeature    featureObject:");console.dir({featureObject:_12b0});var _12b1=dojo.clone(_12b0);_12b1.username=Agua.cookie("username");_12b1.sessionId=Agua.cookie("sessionId");_12b1.mode="removeViewFeature";var url=this.url;var _12b2=function(_12b3){console.log("View._remoteRemoveViewFeature    response: ");console.dir({response:_12b3});if(_12b3.error){thisObject.standby.hide();console.log("View._remoteRemoveViewFeature    Error removing viewFeature");Agua.toast(_12b3);}};this.doPut({url:url,query:_12b1,callback:_12b2,doToast:false});},_handleRemoveViewFeature:function(_12b4,_12b5){console.log("View._handleRemoveViewFeature    response: ");console.dir({response:_12b4});console.log("View._handleRemoveViewFeature    featureObject: ");console.dir({featureObject:_12b5});if(_12b4.status=="ready"){this.polling=false;this.standby._setTextAttr("");this.standby.hide();this.displayReady();console.log("View._handleRemoveViewFeature    DOING this.setViewCombo("+_12b5.project+", "+_12b5.view+")");this.setViewCombo(_12b5.project,_12b5.view);console.log("View._handleRemoveViewFeature    DOING this.reloadBrowser("+_12b5.project+", "+_12b5.view+")");this.reloadBrowser(_12b5.project,_12b5.view);Agua.toastInfo("Removed feature: "+_12b5.feature);}else{if(_12b4.error){this.polling=false;this.standby.hide();this.displayReady();console.log("View.handleRemoveViewFeature    Error on remote. Response: ");console.dir({response:_12b4});}else{console.log("View._handleRemoveViewFeature    Doing this._handleRemoveViewFeature()");var _12b6="View._delayedPoll    handleRemoveViewFeature";this._delayedPoll(dojo.clone(_12b5),dojo.hitch(this,"_handleRemoveViewFeature"),_12b6);}}},displayLoading:function(){dojo.removeClass(this.statusDisplay,"statusReady");dojo.addClass(this.statusDisplay,"statusLoading");},displayReady:function(){dojo.removeClass(this.statusDisplay,"statusLoading");dojo.addClass(this.statusDisplay,"statusReady");},onStartRemote:function(){console.log("View.onStartRemote    caller: "+this.onStartRemote.caller.nom);console.dir({caller:this.onStartRemote.caller});console.log("View.onStartRemote    this.standby: "+this.standby);this.standby.show();this.displayLoading();},pollRemote:function(timer){console.log("View.pollRemote    timer: "+timer);console.dir({timer:timer});if(timer.url==null){return;}if(timer.query==null){return;}var _12b7=this;var _12b8=false;dojo.xhrPut({url:timer.url,contentType:"text",putData:dojo.toJson(timer.query),handleAs:"json-comment-optional",sync:true,handle:function(_12b9){console.log("View.pollRemote    response: "+dojo.toJson(_12b9,true));if(_12b9.status=="ready"||_12b9.status=="error"||_12b9.error!=null){console.log("View.pollRemote    setting completed to TRUE");_12b8=true;timer.response=_12b9;}}});console.log("View.pollRemote    Returning completed: "+_12b8);return _12b8;},onEndRemote:function(){console.log("View.onEndRemote    plugins.view.View.onEndRemote()");this.standby.hide();this.displayReady();console.log("View.onEndRemote    Doing this.callback()");console.dir({callback:this.callback});if(this.callback){this.callback();}},setStandby:function(){console.log("View.setStandby    _GroupDragPane.setStandby()");if(this.standby!=null){return this.standby;}var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.rightPane.domNode,centerIndicator:"text",text:"Loading",id:id});document.body.appendChild(this.standby.domNode);dojo.addClass(this.standby._textNode,"viewStandby");console.log("View.setStandby    this.standby: ");console.dir({this_standby:this.standby});return this.standby;},showStandby:function(_12ba){console.log("View.showStandby    message: "+_12ba);this.standby._setTextAttr(_12ba);this.standby.show();},hideStandby:function(){this.standby._setTextAttr("");this.standby.hide();},loadBrowser:function(_12bb,_12bc){console.log("View.loadBrowser      PASSED projectName: "+_12bb);console.log("View.loadBrowser      PASSED viewName: "+_12bc);if(_12bb==null){_12bb=this.getProject();}if(_12bc==null){_12bc=this.getView();}console.log("View.loadBrowser      projectName: "+_12bb);console.log("View.loadBrowser      viewName: "+_12bc);if(this.selectBrowser(_12bb,_12bc)){return;}var _12bd=Agua.cookie("username");var _12be=this.getRefseqfile(_12bd,_12bb,_12bc);var _12bf=this.getTrackinfofile(_12bd,_12bb,_12bc);console.log("View.loadBrowser      refseqfile: "+_12be);console.log("View.loadBrowser      trackinfofile: "+_12bf);this.loadEval(_12bf);this.loadEval(_12be);if(refSeqs==null){console.log("View.loadBrowser      refSeqs is null. Returning");return;}if(trackInfo==null){console.log("View.loadBrowser      trackInfo is null. Returning");return;}console.log("View.loadBrowser      refSeqs: ");console.dir({refSeqs:refSeqs});if(_12bb==null||_12bc==null){console.log("View.loadBrowser    One of the required inputs (projectName, viewName) is null. Returning");return;}var _12c0=Agua.getViewObject(_12bb,_12bc);console.log("View.loadBrowser      viewObject: ");console.dir({viewObject:_12c0});if(!_12c0){console.log("View.loadBrowser      viewObject is not defined. Returning");return;}var _12c1=_12c0.tracklist;var _12c2=_12c0.species;var _12c3=_12c0.build;var _12bd=Agua.cookie("username");var _12c4=this.getLocationObject(_12c0);var _12c5=_12c4.start+"..."+_12c4.stop;var _12c6=_12c4.name+":"+_12c5;console.log("View.loadBrowser      location: "+_12c6);var _12c7="plugins.view.View.jbrowse.Browser";var _12c8=dijit.getUniqueId(_12c7.replace(/\./g,"_"));this.loading=true;var b=new plugins.view.jbrowse.js.Browser({parentWidget:this,viewObject:_12c0,speciesName:_12c2,buildName:_12c3,species:_12c2,build:_12c3,refSeqs:refSeqs,trackData:trackInfo,baseUrl:this.baseUrl,dataRoot:this.baseUrl+"/users/"+_12bd+"/"+_12bb+"/"+_12bc+"/",locationObject:_12c4,location:_12c6,browserRoot:this.browserRoot,trackList:_12c1,tracks:_12c1,attachWidget:this.rightPane});this.addBrowser(b,_12bb,_12bc);console.dir({browser:b});console.log("View.loadBrowser    XXXXXXX END OF LOADING XXXXXX");console.log("View.loadBrowser    this.loading: "+this.loading);dojo.connect(b.mainTab,"destroy",dojo.hitch(this,"removeBrowserObject",b,_12bb,_12bc));console.log("View.loadBrowser      XXXXXXX END OF NAVIGATION XXXXXX");this.loading=false;console.log("View.loadBrowser    SET this.loading TO : "+this.loading);},getLocationObject:function(_12c9){console.log("View.getLocationObject    viewObject:");console.dir({viewObject:_12c9});var _12ca=new Object;if(!_12c9.chromosome){_12c9.chromosome=refSeqs[0].name;_12c9.start=0;_12c9.stop=(refSeqs[0].end/10);}_12ca.name=_12c9.chromosome;_12ca.start=parseInt(_12c9.start);_12ca.stop=parseInt(_12c9.stop);console.log("View.getLocationObject    Returning locationObject:");console.dir({locationObject:_12ca});return _12ca;},reloadBrowser:function(_12cb,_12cc){console.log("View.reloadBrowser      projectName: "+_12cb);console.log("View.reloadBrowser      viewName: "+_12cc);var _12cd=this.getBrowser(_12cb,_12cc);if(_12cd!=null){console.log("View.reloadBrowser    BEFORE this.removeBrowser(projectName, workflow, viewName)");this.removeBrowser(_12cd.browser,_12cb,_12cc);console.log("View.reloadBrowser    AFTER this.removeBrowser(projectName, workflow, viewName)");}this.loadBrowser(_12cb,_12cc);console.log("View.reloadBrowser    AFTER loadBrowser");},selectBrowser:function(_12ce,_12cf){var _12d0=this.getBrowser(_12ce,_12cf);if(_12d0==null){return;}var _12d1=_12d0.browser;this.rightPane.selectChild(_12d1.mainTab);return 1;},getBrowser:function(_12d2,_12d3){var index=this.getBrowserIndex(_12d2,_12d3);console.log("View.selectBrowser    index: "+index);if(index==null){return;}return this.browsers[index];},addBrowser:function(_12d4,_12d5,_12d6){console.log("View.addBrowser    browser: "+_12d4);console.log("View.addBrowser    projectName: "+_12d5);console.log("View.addBrowser    viewName: "+_12d6);var _12d7={browser:_12d4,project:_12d5,view:_12d6};var _12d8=this._addObjectToArray(this.browsers,_12d7,["browser","project","view"]);console.log("View.addBrowser    success: "+_12d8);return _12d8;},isBrowser:function(_12d9,_12da){console.log("View.isBrowser    projectName: "+_12d9);console.log("View.isBrowser    viewName: "+_12da);if(this.getBrowserIndex(_12d9,_12da)!=null){console.log("View.isBrowser    Returning 1");return 1;}else{console.log("View.isBrowser    Returning 0");return 0;}},getBrowserIndex:function(_12db,_12dc){console.log("View.getBrowserIndex    projectName: "+_12db);console.log("View.getBrowserIndex    viewName: "+_12dc);console.log("View.getBrowserIndex    this.browsers: ");console.dir({this_browsers:this.browsers});var _12dd={project:_12db,view:_12dc};var index=this._getIndexInArray(this.browsers,{project:_12db,view:_12dc},["project","view"]);console.log("View.getBrowserIndex    index: "+index);return index;},removeBrowser:function(_12de,_12df,_12e0){console.log("View.removeBrowser    plugins.viewName.View.removeBrowser(browser, projectName, viewName)");console.log("View.removeBrowser    browser: "+_12de);console.log("View.removeBrowser    projectName: "+_12df);console.log("View.removeBrowser    viewName: "+_12e0);this.removeBrowserTab(_12de);var _12e1=this.removeBrowserObject(_12de,_12df,_12e0);console.log("View.removeBrowser    success: "+_12e1);},removeBrowserObject:function(_12e2,_12e3,_12e4){console.log("View.removeBrowserObject    caller: "+this.removeBrowserObject.caller.nom);console.log("View.removeBrowserObject    browser: "+_12e2);console.dir({browser:_12e2});console.log("View.removeBrowserObject    projectName: "+_12e3);console.log("View.removeBrowserObject    viewName: "+_12e4);console.log("View.removeBrowserObject    BEFORE this.browsers: ");console.dir({this_browsers:this.browsers});var _12e5={browser:_12e2,project:_12e3,view:_12e4};console.log("View.removeBrowserObject    browserObject: ");console.dir({browserObject:_12e5});console.log("View.removeBrowserObject    BEFORE this.browsers.length: "+this.browsers.length);var _12e6=this._removeObjectFromArray(this.browsers,_12e5,["browser","project","view"]);console.log("View.removeBrowserObject    success: "+_12e6);console.log("View.removeBrowserObject    AFTER this.browsers: ");console.dir({this_browsers:this.browsers});console.log("View.removeBrowserObject    AFTER this.browsers.length: "+this.browsers.length);return _12e6;},removeBrowserTab:function(_12e7,_12e8,_12e9){console.log("View.removeBrowserTab    browser:");console.dir({browser:_12e7});this.rightPane.removeChild(_12e7.mainTab);console.log("View.removeBrowserTab    AFTER removeChild(browser.mainTab)");return true;},fireViewProjectCombo:function(){console.log("View.fireViewProjectCombo    viewProjectCombo._onchange");var _12ea=this.viewProjectCombo.get("value");this.setViewCombo(_12ea);},fireViewCombo:function(){if(!this.viewComboFired==true){this.viewComboFired=true;}else{console.log("View.fireViewCombo    plugins.view.View.fireViewCombo()");var _12eb=this.getProject();var _12ec=this.getView();console.log("View.fireViewCombo    projectName: "+_12eb);console.log("View.fireViewCombo    viewName: "+_12ec);this.setSpeciesLabel(_12eb,_12ec);this.loadBrowser(_12eb,_12ec);}},fireFeatureProjectCombo:function(){if(!this.featureProjectComboFired==true){this.featureProjectComboFired=true;}else{console.log("View.fireFeatureProjectCombo    plugins.view.View.fireFeatureProjectCombo()");var _12ed=this.featureProjectCombo.get("value");this.setWorkflowCombo(_12ed);}},fireWorkflowCombo:function(){if(!this.workflowComboFired==true){this.workflowComboFired=true;}else{console.log("View.fireWorkflowCombo    plugins.view.View.fireWorkflowCombo()");var _12ee=this.featureProjectCombo.get("value");var _12ef=this.workflowCombo.get("value");this.setSpeciesCombo(_12ee,_12ef);}},fireSpeciesCombo:function(){if(!this.speciesComboFired==true){console.log("View.fireSpeciesCombo    FIRST FIRE");this.speciesComboFired=true;}else{console.log("View.fireSpeciesCombo    plugins.view.View.fireSpeciesCombo()");var _12f0=this.viewProjectCombo.get("value");var _12f1=this.workflowCombo.get("value");var _12f2=this.getSpecies();var _12f3=this.getBuild();console.log("View.fireSpeciesCombo    projectName: "+_12f0);console.log("View.fireSpeciesCombo    workflowName: "+_12f1);console.log("View.fireSpeciesCombo    speciesName: "+_12f2);console.log("View.fireSpeciesCombo    buildName: "+_12f3);console.log("View.fireSpeciesCombo    this.setFeatureCombo("+_12f0+", "+_12f1+", "+_12f2+", "+_12f3+")");if(_12f2==null||_12f3==null){console.log("View.fireSpeciesCombo    speciesName and/or buildName is null. Returning.");return;}this.setFeatureCombo(_12f0,_12f1,_12f2,_12f3);}},destroyRecursive:function(){console.log("View.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.view.Controller"]){dojo._hasResource["plugins.view.Controller"]=true;dojo.provide("plugins.view.Controller");dojo.declare("plugins.view.Controller",[dijit._Widget,dijit._Templated,plugins.core.Common],{templatePath:dojo.moduleUrl("","../plugins/view/templates/controller.html"),widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"view/css/controller.css"],tabPanes:[],constructor:function(args){console.log("Controller.constructor     plugins.view.Controller.constructor");this.loadCSS();},postCreate:function(){console.log("Controller.postCreate    plugins.view.Controller.postCreate()");this.startup();},startup:function(){console.log("Controller.startup    plugins.view.Controller.startup()");this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _12f4=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(args){console.log("Controller.createTab    args: ");console.dir({args:args});window.getSelection().removeAllRanges();if(args==null){args=new Object;}args.attachWidget=Agua.tabs;var _12f5=new plugins.view.View(args);this.tabPanes.push(_12f5);this._supportingWidgets.push(_12f5);}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.workflow.AppRow"]){dojo._hasResource["plugins.workflow.AppRow"]=true;dojo.provide("plugins.workflow.AppRow");dojo.declare("plugins.workflow.AppRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table\n        class=\"approw\"\n        cellspacing=\"0px\"\n        height=\"16px\" width=\"100%\" style=\"padding: 0; margin: 0; height: 16px !important;\">\n        <tr width=\"100%\">\n            <td\n                colspan=\"3\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >${name}</td>\n        </tr>\n        <tr width=\"100%\">\n            <td colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                class='description'\n                title=\"Description\"\n                style=\"display: none;\" >${description}</td>\n        </tr>\n        <tr width=\"100%\">\n            <td colspan=\"3\"\n                dojoAttachPoint=\"location\"\n                class='location'\n                title=\"Location\"\n                style=\"display: none;\" >${location}</td>\n        </tr>\n        <tr width=\"100%\">\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"version\"\n                class=\"version\"\n                title=\"Version\"\n                style=\"display: none;\" >${version}</td>\n\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"executor\"\n                class=\"executor\"\n                title=\"Executor\"\n                style=\"display: none;\" >${executor}</td>\n\n            <td \n                colspan=\"1\"\n                dojoAttachPoint=\"localonly\"\n                class=\"localonly\"\n                title=\"LocalOnly\"\n                style=\"display: none;\" >${localonly}</td>\n            <td></td>\n            \n        </tr>\n        <tr width=\"100%\">\n            <td colspan=\"3\"\n                dojoAttachPoint=\"notes\"\n                class='notes'\n                title=\"Notes\"\n                style=\"display: none;\" >${notes}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,core:null,application:null,constructor:function(args){this.core=args.core;this.parentWidget=args.parentWidget;this.application=new Object;for(var key in args){if(key!="parentWidget"){this.application[key]=args[key];}}},getApplication:function(){return dojo.clone(this.application);},setApplication:function(_12f6){this.application=_12f6;return this.application;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.name.parentWidget=this;var _12f7=this;dojo.connect(this.name,"onclick",function(event){event.stopPropagation();_12f7.toggle();});},toggle:function(){var array=["description","location","notes","version","executor","localonly"];for(var i in array){if(this[array[i]].style){if(this[array[i]].style.display=="table-cell"){this[array[i]].style.display="none";}else{this[array[i]].style.display="table-cell";}}}}});}if(!dojo._hasResource["plugins.workflow.AppSource"]){dojo._hasResource["plugins.workflow.AppSource"]=true;dojo.provide("plugins.workflow.AppSource");dojo.declare("plugins.workflow.AppSource",[dijit._Widget,dijit._Templated,plugins.form.DndSource],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div>\n    \n    <div dojoType=\"dijit.TitlePane\"\n        dojoAttachPoint=\"titlePane\"\n        title=\"${title}\"\n        style=\"width: 200px !important; min-width: 25px; background: #FFF;\"\n        >\n    \n        <div\n            dojoAttachPoint=\"dragSourceNode\"\n            class=\"dragSource\"\n            style=\"height: auto; width: 96%; margin-left: auto; margin-right: auto;\"\n        >\n    \n    </div>\n    </div>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,contextMenu:null,rowClass:"plugins.workflow.AppRow",avatarItems:["name","description"],formInputs:{name:1,owner:1,type:1,version:1,executor:1,localonly:1,location:1,description:1,notes:1,url:1},constructor:function(args){this.parentWidget=args.parentWidget;this.itemArray=args.itemArray;this.contextMenu=args.contextMenu;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDragSource();},getItemArray:function(){return this.itemArray;}});}if(!dojo._hasResource["plugins.workflow.AppType"]){dojo._hasResource["plugins.workflow.AppType"]=true;dojo.provide("plugins.workflow.AppType");dojo.declare("plugins.workflow.AppType",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div>\n    \n    <div dojoType=\"dijit.TitlePane\"\n        dojoAttachPoint=\"titlePane\"\n        title=\"${title}\"\n        class=\"pipelineTitlePane\"\n        style=\"width: 200px !important; min-width: 25px; background: #FFF;\"\n        >\n    \n        <div\n            dojoAttachPoint=\"dragSourceNode\"\n            class=\"dragSource\"\n            style=\"height: auto; width: 96%; margin-left: auto; margin-right: auto;\"\n        >\n    \n    </div>\n    </div>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);}});}if(!dojo._hasResource["plugins.workflow.AppsMenu"]){dojo._hasResource["plugins.workflow.AppsMenu"]=true;dojo.provide("plugins.workflow.AppsMenu");dojo.declare("plugins.workflow.AppsMenu",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"appsmenu\"\n    dojoType=\"plugins.menu.Menu\">\n\n<!--    <div dojoType=\"dijit.MenuItem\"\n        label=\"Info\"\n        dojoAttachPoint=\"title\"\n        class=\"title\"\n        disabled=\"false\">\n    </div>\n-->\n<!--    <div\n        dojoAttachPoint=\"aboutNode\"\n        dojoType=\"dijit.MenuItem\"\n        iconClass=\"dijitEditorIcon dijitEditorIconWikiword\"\n        >\n        About\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"websiteNode\"\n        dojoAttachEvent=\"onClick:website\"\n        dojoType=\"dijit.MenuItem\"\n        iconClass=\"dijitEditorIcon dijitEditorIconInsertImage\"\n        >\n        Website\n    </div>\n\n</div>\n",widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/appsmenu.css"],parentWidget:null,core:null,constructor:function(args){this.parentWidget=args.parentWidget;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setMenu();},bind:function(node){if(node==null){}return this.menu.bindDomNode(node);},about:function(event){event.stopPropagation();},website:function(event){console.log("AppsMenu.website     plugins.workflow.Workflow.website(event)");event.stopPropagation();var _12f8=this.menu.currentTarget.parentWidget;console.log("FileMenu.onUploadComplete    appRow: "+_12f8);if(_12f8==null){return;}var _12f9=_12f8.application;console.log("FileMenu.onUploadComplete    application: "+dojo.toJson(_12f9));if(_12f9==null){return;}var url=_12f9.url;console.log("FileMenu.onUploadComplete    url: "+url);window.open(url);},setMenu:function(){}});}if(!dojo._hasResource["plugins.workflow.Apps"]){dojo._hasResource["plugins.workflow.Apps"]=true;dojo.provide("plugins.workflow.Apps");dojo.declare("plugins.workflow.Apps",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        class=\"apps\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n        title=\"My Apps\"\n\t\tstyle=\"position: relative; height: 100%; max-height: auto !important; width: 400px !important; padding: 0 !important;\"\n    >\n\n        <table width=\"200px\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t\n\t\t\t\t<td colspan=\"3\" class=\"tabTitle\" align=\"center\">\n\t\t\t\t\t<div class=\"header\">\n\t\t\t\t\t    Applications\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n            <tr>\n                <td>\n                    <div\n                        dojoAttachPoint=\"appSourcesContainer\"\n\t\t\t\t\t\tclass=\"appSource\">\n                    </div>\n                    \n                </td>\n            </tr>\n        </table>\n    \n    </div>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","workflow/css/apps.css")],parentWidget:null,core:null,tabContainer:null,contextMenu:null,constructor:function(args){this.core=args.core;this.parentWidget=args.parentWidget;this.attachNode=args.attachNode;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.attachNode.addChild(this.mainTab);this.attachNode.selectChild(this.mainTab);this.setContextMenu();this.loadAppSources();Agua.updater.subscribe(this,"updateApps");},setContextMenu:function(){this.contextMenu=new plugins.workflow.AppsMenu({parentWidget:this});},updateApps:function(args){this.loadAppSources();},closePanes:function(){if(this.appSources==null||this.appSources.length==0){return;}for(var i=0;i<this.appSources.length;i++){var _12fa=this.appSources[i].titlePane;if(_12fa.open==true){_12fa.toggle();}}},clearAppSources:function(){if(this.appSources==null||this.appSources.length==0){return;}for(var i=0;i<this.appSources.length;i++){this.appSources[i].clearDragSource();this.appSourcesContainer.removeChild(this.appSources[i].domNode);this.appSources[i].destroy();}},getApps:function(){return Agua.getApps();},getAppsByType:function(type,apps){var _12fb=["type"];var _12fc=[type];var _12fd=dojo.clone(apps);return this.filterByKeyValues(_12fd,_12fb,_12fc);},loadAppSources:function(){this.clearAppSources();var apps=this.getApps();var types=Agua.getAppTypes(apps);this.appSources=new Array;for(var i=0;i<types.length;i++){var type=types[i];var _12fe=this.getAppsByType(type,apps);if(_12fe==null||_12fe.length==0){continue;}var _12ff=new plugins.workflow.AppSource({title:type,itemArray:_12fe,contextMenu:this.contextMenu});this.appSources.push(_12ff);this.appSourcesContainer.appendChild(_12ff.domNode);}}});}if(!dojo._hasResource["plugins.workflow.ClusterStatus"]){dojo._hasResource["plugins.workflow.ClusterStatus"]=true;dojo.provide("plugins.workflow.ClusterStatus");dojo.declare("plugins.workflow.ClusterStatus",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\toverflow=\"auto\"\n\t\ttitle=\"Cluster\"\n\t\tclass=\"clusterstatus\"\n\t\tstyle=\"position: relative; top: 0px !important; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important; background: #FFF;\"\n        >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td align=\"left\">\n\t\t\t\t\t<table align=\"left\" width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t<!--<div>-->\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"stop\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:stopCluster\"\n\t\t\t\t\t\t\t\t\t\tclass=\"stop\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<!--<div-->\n\t\t\t\t\t\t\t\t\t<!--\tdojoAttachPoint=\"pause\"-->\n\t\t\t\t\t\t\t\t\t<!--\tdojoAttachEvent=\"onclick:pauseCluster\"-->\n\t\t\t\t\t\t\t\t\t<!--\tclass=\"pause\">-->\n\t\t\t\t\t\t\t\t\t<!--</div>-->\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"start\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:startCluster\"\n\t\t\t\t\t\t\t\t\t\tclass=\"play\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"clusterHeading\">Cluster</div>\n\t\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"clusterName\"\n\t\t\t\t\t\t\t\t\t\tclass=\"clusterText\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"clusterHeading\">Status</div>\n\t\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"clusterStatus\"\n\t\t\t\t\t\t\t\t\t\tclass=\"clusterText\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<!--</div>-->\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Cluster List\"\n\t\t\t\t\t\tclass=\"clusterStatus\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important; font-size: 10px !important\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"clusterList\"\n\t\t\t\t\t\t\tclass=\"clusterStatusContainer\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Cluster Log\"\n\t\t\t\t\t\tclass=\"clusterStatus\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important; font-size: 10px !important\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"clusterLog\"\n\t\t\t\t\t\t\tclass=\"clusterStatusContainer\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\n\t\t</table>\n\n\t</div>\n\n\n\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/clusterstatus.css"],core:null,status:"",runner:null,constructor:function(args){console.log("ClusterStatus.constructor    args:");console.dir({args:args});this.core=args.core;this.attachNode=args.attachNode;if(args.cgiUrl!=null){this.cgiUrl=args.cgiUrl;}else{this.cgiUrl=Agua.cgiUrl+"workflow.cgi";}this.loadCSS();},postCreate:function(){console.log("ClusterStatus.postCreate    plugins.workflow.ClusterStatus.postCreate()");this.startup();},startup:function(){console.log("ClusterStatus.startup    plugins.workflow.ClusterStatus.startup()");this.inherited(arguments);console.log("ClusterStatus.startup    this.attachNode: "+this.attachNode);console.log("ClusterStatus.startup    this.stagesTab: "+this.stagesTab);console.log("ClusterStatus.startup    this.queueTab: "+this.queueTab);if(this.attachNode.addChild!=null){this.attachNode.addChild(this.mainTab);}else{var div=dojo.create("div");document.body.appendChild(div);div.appendChild(this.mainTab.domNode);}this.attachNode.selectChild(this.mainTab);this.setConfirmDialog();},clearStatus:function(){console.log("ClusterStatus.clearStatus      plugins.workflow.ClusterStatus.clearStatus()");this.clusterList.innerHTML="";this.clusterLog.innerHTML="";while(this.clusterList.firstChild){this.clusterList.removeChild(this.clusterList.firstChild);}while(this.clusterLog.firstChild){this.clusterLog.removeChild(this.clusterLog.firstChild);}},displayStatus:function(_1300){console.log("ClusterStatus.displayStatus      reponse:");console.dir({reponse:_1300});if(!_1300){_1300={clusterList:"No nodes running",clusterLog:"No log output available"};}this.clearStatus();this.clusterList.innerHTML="<PRE>"+_1300.clusterList+"</PRE>";this.clusterLog.innerHTML="<PRE>"+_1300.clusterLog+"</PRE>";this.clusterName.innerHTML=_1300.cluster;this.status=_1300.status;this.clusterStatus.innerHTML=_1300.status;},pauseCluster:function(){console.log("ClusterStatus.pauseCluster    ");var _1301=this.core.userWorkflows.getProject();var _1302=this.core.userWorkflows.getCluster();this.checkRunning(_1301,_1302,"confirmPauseCluster");},stopCluster:function(){console.log("ClusterStatus.stopCluster    this.status: "+this.status);var _1303=this.runner.cluster;console.log("ClusterStatus.stopCluster    cluster: "+_1303);if(!_1303){Agua.toastInfo("Cluster not defined");}else{if(!this.status||this.status=="stopping"||this.status=="stopped"){Agua.toastInfo("Cluster is already stopped");}else{this.confirmStopCluster(_1303);}}},startCluster:function(){var _1304=this.runner.cluster;console.log("ClusterStatus.startCluster    cluster: "+_1304);console.log("ClusterStatus.startCluster    this.status: "+this.status);if(!_1304){Agua.toastInfo("Cluster not defined");}else{if(this.status=="running"){Agua.toastInfo("Cluster is already running");}else{if(this.status=="starting"){Agua.toastInfo("Cluster is already starting");}else{this.confirmStartCluster(_1304);}}}},confirmPauseCluster:function(_1305,_1306,_1307){console.log("ClusterStatus.confirmPauseCluster    project: "+_1305);console.log("ClusterStatus.confirmPauseCluster    workflow: "+_1306);console.log("ClusterStatus.confirmPauseCluster    isRunning: "+_1307);if(!_1307){return;}var _1308=function(){console.log("ClusterMenu.confirmPauseCluster    noCallback()");};var _1309=dojo.hitch(this,function(){console.log("ClusterMenu.confirmPauseCluster    yesCallback()");this.doPauseCluster();});var _130a=this.core.userWorkflows.indexOfRunningStage();console.log("ClusterStatus.confirmPauseCluster   indexOfRunningStage: "+_130a);this.runner=this.core.runStatus.createRunner(_130a);var title=_1305+"."+_1306+" is running";var _130b="Are you sure you want to stop it?";this.loadConfirmDialog(title,_130b,_1309,_1308);},confirmStartCluster:function(_130c){console.log("ClusterStatus.confirmStartCluster    cluster: "+_130c);var _130d=function(){};var _130e=dojo.hitch(this,function(){console.log("ClusterStatus.startCluster    yesCallback()");this.doStartCluster();});var title="Are you sure you want to start cluster '"+_130c+"'?";var _130f="Cloud fees apply as soon as the cluster is started";this.loadConfirmDialog(title,_130f,_130e,_130d);},confirmStopCluster:function(_1310){console.log("ClusterStatus.confirmStopCluster    cluster "+_1310);var _1311=function(){};var _1312=dojo.hitch(this,function(){this.doStopCluster();});var title="Are you sure you want to stop cluster '"+_1310+"'?";var _1313="Any workflows currently running on it will be stopped";this.loadConfirmDialog(title,_1313,_1312,_1311);},doPauseCluster:function(){console.log("ClusterStatus.doPauseCluster    plugins.workflow.ClusterStatus.doPauseCluster");this.pauseRun();},doStartCluster:function(){console.log("ClusterStatus.doStartCluster    this.runner:");console.dir({this_runner:this.runner});var _1314=this.runner.project||"";var _1315=this.runner.workflow||"";var _1316=this.runner.cluster||"";var start=this.runner.start||"";var _1317=this.runner.username||"";var _1318=this.runner.sessionId||"";this.clusterStatus.innerHTML="starting";this.status="starting";var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=_1317;query.sessionId=_1318;query.project=_1314;query.workflow=_1315;query.cluster=_1317+"-"+_1316;query.mode="startCluster";query.start=start;console.log("ClusterStatus.startCluster     query: "+dojo.toJson(query));var _1319=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,load:function(_131a){Agua.toast(_131a);}});},doStopCluster:function(){console.log("ClusterStatus.doStopCluster    this.runner:");console.dir({this_runner:this.runner});var _131b=this.runner.project||"";var _131c=this.runner.workflow||"";var _131d=this.runner.cluster||"";var start=this.runner.start||"";var _131e=this.runner.username||"";var _131f=this.runner.sessionId||"";this.clusterStatus.innerHTML="stopping";this.status="stopping";var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=_131e;query.sessionId=_131f;query.project=_131b;query.workflow=_131c;query.cluster=_131e+"-"+_131d;query.mode="stopCluster";query.start=start;console.log("ClusterStatus.stopCluster     query: "+dojo.toJson(query));var _1320=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,load:function(_1321){Agua.toast(_1321);}});},setConfirmDialog:function(){var _1322=function(){};var _1323=function(){};var title="Dialog title";var _1324="Dialog message";this.confirmDialog=new plugins.dijit.ConfirmDialog({title:title,message:_1324,parentWidget:this,yesCallback:_1322,noCallback:_1323});},loadConfirmDialog:function(title,_1325,_1326,_1327){console.log("FileMenu.loadConfirmDialog    yesCallback.toString(): "+_1326.toString());console.log("FileMenu.loadConfirmDialog    title: "+title);console.log("FileMenu.loadConfirmDialog    message: "+_1325);console.log("FileMenu.loadConfirmDialog    yesCallback: "+_1326);console.log("FileMenu.loadConfirmDialog    noCallback: "+_1327);this.confirmDialog.load({title:title,message:_1325,yesCallback:_1326,noCallback:_1327});}});}if(!dojo._hasResource["dojo.cldr.monetary"]){dojo._hasResource["dojo.cldr.monetary"]=true;dojo.provide("dojo.cldr.monetary");dojo.getObject("cldr.monetary",true,dojo);dojo.cldr.monetary.getData=function(code){var _1328={ADP:0,AFN:0,ALL:0,AMD:0,BHD:3,BIF:0,BYR:0,CLF:0,CLP:0,COP:0,CRC:0,DJF:0,ESP:0,GNF:0,GYD:0,HUF:0,IDR:0,IQD:0,IRR:3,ISK:0,ITL:0,JOD:3,JPY:0,KMF:0,KPW:0,KRW:0,KWD:3,LAK:0,LBP:0,LUF:0,LYD:3,MGA:0,MGF:0,MMK:0,MNT:0,MRO:0,MUR:0,OMR:3,PKR:0,PYG:0,RSD:0,RWF:0,SLL:0,SOS:0,STD:0,SYP:0,TMM:0,TND:3,TRL:0,TZS:0,UGX:0,UZS:0,VND:0,VUV:0,XAF:0,XOF:0,XPF:0,YER:0,ZMK:0,ZWD:0};var _1329={CHF:5};var _132a=_1328[code],round=_1329[code];if(typeof _132a=="undefined"){_132a=2;}if(typeof round=="undefined"){round=0;}return {places:_132a,round:round};};}if(!dojo._hasResource["dojo.currency"]){dojo._hasResource["dojo.currency"]=true;dojo.provide("dojo.currency");dojo.getObject("currency",true,dojo);dojo.currency._mixInDefaults=function(_132b){_132b=_132b||{};_132b.type="currency";var _132c=dojo.i18n.getLocalization("dojo.cldr","currency",_132b.locale)||{};var iso=_132b.currency;var data=dojo.cldr.monetary.getData(iso);dojo.forEach(["displayName","symbol","group","decimal"],function(prop){data[prop]=_132c[iso+"_"+prop];});data.fractional=[true,false];return dojo.mixin(data,_132b);};dojo.currency.format=function(value,_132d){return dojo.number.format(value,dojo.currency._mixInDefaults(_132d));};dojo.currency.regexp=function(_132e){return dojo.number.regexp(dojo.currency._mixInDefaults(_132e));};dojo.currency.parse=function(_132f,_1330){return dojo.number.parse(_132f,dojo.currency._mixInDefaults(_1330));};}if(!dojo._hasResource["dijit.form.CurrencyTextBox"]){dojo._hasResource["dijit.form.CurrencyTextBox"]=true;dojo.provide("dijit.form.CurrencyTextBox");dojo.declare("dijit.form.CurrencyTextBox",dijit.form.NumberTextBox,{currency:"",baseClass:"dijitTextBox dijitCurrencyTextBox",regExpGen:function(_1331){return "("+(this._focused?this.inherited(arguments,[dojo.mixin({},_1331,this.editOptions)])+"|":"")+dojo.currency.regexp(_1331)+")";},_formatter:dojo.currency.format,_parser:dojo.currency.parse,parse:function(value,_1332){var v=this.inherited(arguments);if(isNaN(v)&&/\d+/.test(value)){v=dojo.hitch(dojo.mixin({},this,{_parser:dijit.form.NumberTextBox.prototype._parser}),"inherited")(arguments);}return v;},_setConstraintsAttr:function(_1333){if(!_1333.currency&&this.currency){_1333.currency=this.currency;}this.inherited(arguments,[dojo.currency._mixInDefaults(dojo.mixin(_1333,{exponent:false}))]);}});}if(!dojo._hasResource["dojo.DeferredList"]){dojo._hasResource["dojo.DeferredList"]=true;dojo.provide("dojo.DeferredList");dojo.DeferredList=function(list,_1334,_1335,_1336,_1337){var _1338=[];dojo.Deferred.call(this);var self=this;if(list.length===0&&!_1334){this.resolve([0,[]]);}var _1339=0;dojo.forEach(list,function(item,i){item.then(function(_133a){if(_1334){self.resolve([i,_133a]);}else{_133b(true,_133a);}},function(error){if(_1335){self.reject(error);}else{_133b(false,error);}if(_1336){return null;}throw error;});function _133b(_133c,_133d){_1338[i]=[_133c,_133d];_1339++;if(_1339===list.length){self.resolve(_1338);}};});};dojo.DeferredList.prototype=new dojo.Deferred();dojo.DeferredList.prototype.gatherResults=function(_133e){var d=new dojo.DeferredList(_133e,false,true,false);d.addCallback(function(_133f){var ret=[];dojo.forEach(_133f,function(_1340){ret.push(_1340[1]);});return ret;});return d;};}if(!dojo._hasResource["dijit.tree.TreeStoreModel"]){dojo._hasResource["dijit.tree.TreeStoreModel"]=true;dojo.provide("dijit.tree.TreeStoreModel");dojo.declare("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:false,constructor:function(args){dojo.mixin(this,args);this.connects=[];var store=this.store;if(!store.getFeatures()["dojo.data.api.Identity"]){throw new Error("dijit.Tree: store must support dojo.data.Identity");}if(store.getFeatures()["dojo.data.api.Notification"]){this.connects=this.connects.concat([dojo.connect(store,"onNew",this,"onNewItem"),dojo.connect(store,"onDelete",this,"onDeleteItem"),dojo.connect(store,"onSet",this,"onSetItem")]);}},destroy:function(){dojo.forEach(this.connects,dojo.disconnect);},getRoot:function(_1341,_1342){if(this.root){_1341(this.root);}else{this.store.fetch({query:this.query,onComplete:dojo.hitch(this,function(items){if(items.length!=1){throw new Error(this.declaredClass+": query "+dojo.toJson(this.query)+" returned "+items.length+" items, but must return exactly one item");}this.root=items[0];_1341(this.root);}),onError:_1342});}},mayHaveChildren:function(item){return dojo.some(this.childrenAttrs,function(attr){return this.store.hasAttribute(item,attr);},this);},getChildren:function(_1343,_1344,_1345){var store=this.store;if(!store.isItemLoaded(_1343)){var _1346=dojo.hitch(this,arguments.callee);store.loadItem({item:_1343,onItem:function(_1347){_1346(_1347,_1344,_1345);},onError:_1345});return;}var _1348=[];for(var i=0;i<this.childrenAttrs.length;i++){var vals=store.getValues(_1343,this.childrenAttrs[i]);_1348=_1348.concat(vals);}var _1349=0;if(!this.deferItemLoadingUntilExpand){dojo.forEach(_1348,function(item){if(!store.isItemLoaded(item)){_1349++;}});}if(_1349==0){_1344(_1348);}else{dojo.forEach(_1348,function(item,idx){if(!store.isItemLoaded(item)){store.loadItem({item:item,onItem:function(item){_1348[idx]=item;if(--_1349==0){_1344(_1348);}},onError:_1345});}});}},isItem:function(_134a){return this.store.isItem(_134a);},fetchItemByIdentity:function(_134b){this.store.fetchItemByIdentity(_134b);},getIdentity:function(item){return this.store.getIdentity(item);},getLabel:function(item){if(this.labelAttr){return this.store.getValue(item,this.labelAttr);}else{return this.store.getLabel(item);}},newItem:function(args,_134c,_134d){var pInfo={parent:_134c,attribute:this.childrenAttrs[0]},_134e;if(this.newItemIdAttr&&args[this.newItemIdAttr]){this.fetchItemByIdentity({identity:args[this.newItemIdAttr],scope:this,onItem:function(item){if(item){this.pasteItem(item,null,_134c,true,_134d);}else{_134e=this.store.newItem(args,pInfo);if(_134e&&(_134d!=undefined)){this.pasteItem(_134e,_134c,_134c,false,_134d);}}}});}else{_134e=this.store.newItem(args,pInfo);if(_134e&&(_134d!=undefined)){this.pasteItem(_134e,_134c,_134c,false,_134d);}}},pasteItem:function(_134f,_1350,_1351,bCopy,_1352){var store=this.store,_1353=this.childrenAttrs[0];if(_1350){dojo.forEach(this.childrenAttrs,function(attr){if(store.containsValue(_1350,attr,_134f)){if(!bCopy){var _1354=dojo.filter(store.getValues(_1350,attr),function(x){return x!=_134f;});store.setValues(_1350,attr,_1354);}_1353=attr;}});}if(_1351){if(typeof _1352=="number"){var _1355=store.getValues(_1351,_1353).slice();_1355.splice(_1352,0,_134f);store.setValues(_1351,_1353,_1355);}else{store.setValues(_1351,_1353,store.getValues(_1351,_1353).concat(_134f));}}},onChange:function(item){},onChildrenChange:function(_1356,_1357){},onDelete:function(_1358,_1359){},onNewItem:function(item,_135a){if(!_135a){return;}this.getChildren(_135a.item,dojo.hitch(this,function(_135b){this.onChildrenChange(_135a.item,_135b);}));},onDeleteItem:function(item){this.onDelete(item);},onSetItem:function(item,_135c,_135d,_135e){if(dojo.indexOf(this.childrenAttrs,_135c)!=-1){this.getChildren(item,dojo.hitch(this,function(_135f){this.onChildrenChange(item,_135f);}));}else{this.onChange(item);}}});}if(!dojo._hasResource["dijit.tree.ForestStoreModel"]){dojo._hasResource["dijit.tree.ForestStoreModel"]=true;dojo.provide("dijit.tree.ForestStoreModel");dojo.declare("dijit.tree.ForestStoreModel",dijit.tree.TreeStoreModel,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(_1360){this.root={store:this,root:true,id:_1360.rootId,label:_1360.rootLabel,children:_1360.rootChildren};},mayHaveChildren:function(item){return item===this.root||this.inherited(arguments);},getChildren:function(_1361,_1362,_1363){if(_1361===this.root){if(this.root.children){_1362(this.root.children);}else{this.store.fetch({query:this.query,onComplete:dojo.hitch(this,function(items){this.root.children=items;_1362(items);}),onError:_1363});}}else{this.inherited(arguments);}},isItem:function(_1364){return (_1364===this.root)?true:this.inherited(arguments);},fetchItemByIdentity:function(_1365){if(_1365.identity==this.root.id){var scope=_1365.scope?_1365.scope:dojo.global;if(_1365.onItem){_1365.onItem.call(scope,this.root);}}else{this.inherited(arguments);}},getIdentity:function(item){return (item===this.root)?this.root.id:this.inherited(arguments);},getLabel:function(item){return (item===this.root)?this.root.label:this.inherited(arguments);},newItem:function(args,_1366,_1367){if(_1366===this.root){this.onNewRootItem(args);return this.store.newItem(args);}else{return this.inherited(arguments);}},onNewRootItem:function(args){},pasteItem:function(_1368,_1369,_136a,bCopy,_136b){if(_1369===this.root){if(!bCopy){this.onLeaveRoot(_1368);}}dijit.tree.TreeStoreModel.prototype.pasteItem.call(this,_1368,_1369===this.root?null:_1369,_136a===this.root?null:_136a,bCopy,_136b);if(_136a===this.root){this.onAddToRoot(_1368);}},onAddToRoot:function(item){console.log(this,": item ",item," added to root");},onLeaveRoot:function(item){console.log(this,": item ",item," removed from root");},_requeryTop:function(){var _136c=this.root.children||[];this.store.fetch({query:this.query,onComplete:dojo.hitch(this,function(_136d){this.root.children=_136d;if(_136c.length!=_136d.length||dojo.some(_136c,function(item,idx){return _136d[idx]!=item;})){this.onChildrenChange(this.root,_136d);}})});},onNewItem:function(item,_136e){this._requeryTop();this.inherited(arguments);},onDeleteItem:function(item){if(dojo.indexOf(this.root.children,item)!=-1){this._requeryTop();}this.inherited(arguments);},onSetItem:function(item,_136f,_1370,_1371){this._requeryTop();this.inherited(arguments);}});}if(!dojo._hasResource["dijit.tree._dndContainer"]){dojo._hasResource["dijit.tree._dndContainer"]=true;dojo.provide("dijit.tree._dndContainer");dojo.getObject("tree",true,dojo);dijit.tree._compareNodes=function(n1,n2){if(n1===n2){return 0;}if("sourceIndex" in document.documentElement){return n1.sourceIndex-n2.sourceIndex;}else{if("compareDocumentPosition" in document.documentElement){return n1.compareDocumentPosition(n2)&2?1:-1;}else{if(document.createRange){var r1=doc.createRange();r1.setStartBefore(n1);var r2=doc.createRange();r2.setStartBefore(n2);return r1.compareBoundaryPoints(r1.END_TO_END,r2);}else{throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");}}}};dojo.declare("dijit.tree._dndContainer",null,{constructor:function(tree,_1372){this.tree=tree;this.node=tree.domNode;dojo.mixin(this,_1372);this.map={};this.current=null;this.containerState="";dojo.addClass(this.node,"dojoDndContainer");this.events=[dojo.connect(this.node,"onmouseenter",this,"onOverEvent"),dojo.connect(this.node,"onmouseleave",this,"onOutEvent"),dojo.connect(this.tree,"_onNodeMouseEnter",this,"onMouseOver"),dojo.connect(this.tree,"_onNodeMouseLeave",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",dojo,"stopEvent"),dojo.connect(this.node,"onselectstart",dojo,"stopEvent")];},getItem:function(key){var _1373=this.selection[key],ret={data:_1373,type:["treeNode"]};return ret;},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.node=this.parent=null;},onMouseOver:function(_1374,evt){this.current=_1374;},onMouseOut:function(_1375,evt){this.current=null;},_changeState:function(type,_1376){var _1377="dojoDnd"+type;var state=type.toLowerCase()+"State";dojo.replaceClass(this.node,_1377+_1376,_1377+this[state]);this[state]=_1376;},_addItemClass:function(node,type){dojo.addClass(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){dojo.removeClass(node,"dojoDndItem"+type);},onOverEvent:function(){this._changeState("Container","Over");},onOutEvent:function(){this._changeState("Container","");}});}if(!dojo._hasResource["dijit.tree._dndSelector"]){dojo._hasResource["dijit.tree._dndSelector"]=true;dojo.provide("dijit.tree._dndSelector");dojo.declare("dijit.tree._dndSelector",dijit.tree._dndContainer,{constructor:function(tree,_1378){this.selection={};this.anchor=null;dijit.setWaiState(this.tree.domNode,"multiselect",!this.singular);this.events.push(dojo.connect(this.tree.domNode,"onmousedown",this,"onMouseDown"),dojo.connect(this.tree.domNode,"onmouseup",this,"onMouseUp"),dojo.connect(this.tree.domNode,"onmousemove",this,"onMouseMove"));},singular:false,getSelectedTreeNodes:function(){var nodes=[],sel=this.selection;for(var i in sel){nodes.push(sel[i]);}return nodes;},selectNone:function(){this.setSelection([]);return this;},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null;},addTreeNode:function(node,_1379){this.setSelection(this.getSelectedTreeNodes().concat([node]));if(_1379){this.anchor=node;}return node;},removeTreeNode:function(node){this.setSelection(this._setDifference(this.getSelectedTreeNodes(),[node]));return node;},isTreeNodeSelected:function(node){return node.id&&!!this.selection[node.id];},setSelection:function(_137a){var _137b=this.getSelectedTreeNodes();dojo.forEach(this._setDifference(_137b,_137a),dojo.hitch(this,function(node){node.setSelected(false);if(this.anchor==node){delete this.anchor;}delete this.selection[node.id];}));dojo.forEach(this._setDifference(_137a,_137b),dojo.hitch(this,function(node){node.setSelected(true);this.selection[node.id]=node;}));this._updateSelectionProperties();},_setDifference:function(xs,ys){dojo.forEach(ys,function(y){y.__exclude__=true;});var ret=dojo.filter(xs,function(x){return !x.__exclude__;});dojo.forEach(ys,function(y){delete y["__exclude__"];});return ret;},_updateSelectionProperties:function(){var _137c=this.getSelectedTreeNodes();var paths=[],nodes=[];dojo.forEach(_137c,function(node){nodes.push(node);paths.push(node.getTreePath());});var items=dojo.map(nodes,function(node){return node.item;});this.tree._set("paths",paths);this.tree._set("path",paths[0]||[]);this.tree._set("selectedNodes",nodes);this.tree._set("selectedNode",nodes[0]||null);this.tree._set("selectedItems",items);this.tree._set("selectedItem",items[0]||null);},onMouseDown:function(e){if(!this.current||this.tree.isExpandoNode(e.target,this.current)){return;}if(e.button==dojo.mouseButtons.RIGHT){return;}dojo.stopEvent(e);var _137d=this.current,copy=dojo.isCopyKey(e),id=_137d.id;if(!this.singular&&!e.shiftKey&&this.selection[id]){this._doDeselect=true;return;}else{this._doDeselect=false;}this.userSelect(_137d,copy,e.shiftKey);},onMouseUp:function(e){if(!this._doDeselect){return;}this._doDeselect=false;this.userSelect(this.current,dojo.isCopyKey(e),e.shiftKey);},onMouseMove:function(e){this._doDeselect=false;},userSelect:function(node,multi,range){if(this.singular){if(this.anchor==node&&multi){this.selectNone();}else{this.setSelection([node]);this.anchor=node;}}else{if(range&&this.anchor){var cr=dijit.tree._compareNodes(this.anchor.rowNode,node.rowNode),begin,end,_137e=this.anchor;if(cr<0){begin=_137e;end=node;}else{begin=node;end=_137e;}nodes=[];while(begin!=end){nodes.push(begin);begin=this.tree._getNextNode(begin);}nodes.push(end);this.setSelection(nodes);}else{if(this.selection[node.id]&&multi){this.removeTreeNode(node);}else{if(multi){this.addTreeNode(node,true);}else{this.setSelection([node]);this.anchor=node;}}}}},forInSelectedItems:function(f,o){o=o||dojo.global;for(var id in this.selection){f.call(o,this.getItem(id),id,this);}}});}if(!dojo._hasResource["dijit.Tree"]){dojo._hasResource["dijit.Tree"]=true;dojo.provide("dijit.Tree");dojo.declare("dijit._TreeNode",[dijit._Widget,dijit._Templated,dijit._Container,dijit._Contained,dijit._CssStateMixin],{item:null,isTreeNode:true,label:"",isExpandable:null,isExpanded:false,state:"UNCHECKED",templateString:dojo.cache("dijit","templates/TreeNode.html","<div class=\"dijitTreeNode\" role=\"presentation\"\n\t><div dojoAttachPoint=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" dojoAttachEvent=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\"\n\t\t><img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"\n\t\t/><span dojoAttachPoint=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"\n\t\t></span\n\t\t><span dojoAttachPoint=\"contentNode\"\n\t\t\tclass=\"dijitTreeContent\" role=\"presentation\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"\n\t\t\t/><span dojoAttachPoint=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\" tabindex=\"-1\" aria-selected=\"false\" dojoAttachEvent=\"onfocus:_onLabelFocus\"></span>\n\t\t</span\n\t></div>\n\t<div dojoAttachPoint=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\n</div>\n"),baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow",labelNode:"dijitTreeLabel"},attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{label:{node:"labelNode",type:"innerText"},tooltip:{node:"rowNode",type:"attribute",attribute:"title"}}),buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);if(this.isExpandable){dijit.setWaiState(this.labelNode,"expanded",this.isExpanded);}this.setSelected(false);},_setIndentAttr:function(_137f){var _1380=(Math.max(_137f,0)*this.tree._nodePixelIndent)+"px";dojo.style(this.domNode,"backgroundPosition",_1380+" 0px");dojo.style(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",_1380);dojo.forEach(this.getChildren(),function(child){child.set("indent",_137f+1);});this._set("indent",_137f);},markProcessing:function(){this.state="LOADING";this._setExpando(true);},unmarkProcessing:function(){this._setExpando(false);},_updateItemClasses:function(item){var tree=this.tree,model=tree.model;if(tree._v10Compat&&item===model.root){item=null;}this._applyClassAndStyle(item,"icon","Icon");this._applyClassAndStyle(item,"label","Label");this._applyClassAndStyle(item,"row","Row");},_applyClassAndStyle:function(item,lower,upper){var _1381="_"+lower+"Class";var _1382=lower+"Node";var _1383=this[_1381];this[_1381]=this.tree["get"+upper+"Class"](item,this.isExpanded);dojo.replaceClass(this[_1382],this[_1381]||"",_1383||"");dojo.style(this[_1382],this.tree["get"+upper+"Style"](item,this.isExpanded)||{});},_updateLayout:function(){var _1384=this.getParent();if(!_1384||_1384.rowNode.style.display=="none"){dojo.addClass(this.domNode,"dijitTreeIsRoot");}else{dojo.toggleClass(this.domNode,"dijitTreeIsLast",!this.getNextSibling());}},_setExpando:function(_1385){var _1386=["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"],_1387=["*","-","+","*"],idx=_1385?0:(this.isExpandable?(this.isExpanded?1:2):3);dojo.replaceClass(this.expandoNode,_1386[idx],_1386);this.expandoNodeText.innerHTML=_1387[idx];},expand:function(){if(this._expandDeferred){return this._expandDeferred;}this._wipeOut&&this._wipeOut.stop();this.isExpanded=true;dijit.setWaiState(this.labelNode,"expanded","true");if(this.tree.showRoot||this!==this.tree.rootNode){dijit.setWaiRole(this.containerNode,"group");}dojo.addClass(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);if(this==this.tree.rootNode){dijit.setWaiState(this.tree.domNode,"expanded","true");}var def,_1388=dojo.fx.wipeIn({node:this.containerNode,duration:dijit.defaultDuration,onEnd:function(){def.callback(true);}});def=(this._expandDeferred=new dojo.Deferred(function(){_1388.stop();}));_1388.play();return def;},collapse:function(){if(!this.isExpanded){return;}if(this._expandDeferred){this._expandDeferred.cancel();delete this._expandDeferred;}this.isExpanded=false;dijit.setWaiState(this.labelNode,"expanded","false");if(this==this.tree.rootNode){dijit.setWaiState(this.tree.domNode,"expanded","false");}dojo.removeClass(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);if(!this._wipeOut){this._wipeOut=dojo.fx.wipeOut({node:this.containerNode,duration:dijit.defaultDuration});}this._wipeOut.play();},indent:0,setChildItems:function(items){var tree=this.tree,model=tree.model,defs=[];dojo.forEach(this.getChildren(),function(child){dijit._Container.prototype.removeChild.call(this,child);},this);this.state="LOADED";if(items&&items.length>0){this.isExpandable=true;dojo.forEach(items,function(item){var id=model.getIdentity(item),_1389=tree._itemNodesMap[id],node;if(_1389){for(var i=0;i<_1389.length;i++){if(_1389[i]&&!_1389[i].getParent()){node=_1389[i];node.set("indent",this.indent+1);break;}}}if(!node){node=this.tree._createTreeNode({item:item,tree:tree,isExpandable:model.mayHaveChildren(item),label:tree.getLabel(item),tooltip:tree.getTooltip(item),dir:tree.dir,lang:tree.lang,indent:this.indent+1});if(_1389){_1389.push(node);}else{tree._itemNodesMap[id]=[node];}}this.addChild(node);if(this.tree.autoExpand||this.tree._state(item)){defs.push(tree._expandNode(node));}},this);dojo.forEach(this.getChildren(),function(child,idx){child._updateLayout();});}else{this.isExpandable=false;}if(this._setExpando){this._setExpando(false);}this._updateItemClasses(this.item);if(this==tree.rootNode){var fc=this.tree.showRoot?this:this.getChildren()[0];if(fc){fc.setFocusable(true);tree.lastFocused=fc;}else{tree.domNode.setAttribute("tabIndex","0");}}return new dojo.DeferredList(defs);},getTreePath:function(){var node=this;var path=[];while(node&&node!==this.tree.rootNode){path.unshift(node.item);node=node.getParent();}path.unshift(this.tree.rootNode.item);return path;},getIdentity:function(){return this.tree.model.getIdentity(this.item);},removeChild:function(node){this.inherited(arguments);var _138a=this.getChildren();if(_138a.length==0){this.isExpandable=false;this.collapse();}dojo.forEach(_138a,function(child){child._updateLayout();});},makeExpandable:function(){this.isExpandable=true;this._setExpando(false);},_onLabelFocus:function(evt){this.tree._onNodeFocus(this);},setSelected:function(_138b){dijit.setWaiState(this.labelNode,"selected",_138b);dojo.toggleClass(this.rowNode,"dijitTreeRowSelected",_138b);},setFocusable:function(_138c){this.labelNode.setAttribute("tabIndex",_138c?"0":"-1");},_onClick:function(evt){this.tree._onClick(this,evt);},_onDblClick:function(evt){this.tree._onDblClick(this,evt);},_onMouseEnter:function(evt){this.tree._onNodeMouseEnter(this,evt);},_onMouseLeave:function(evt){this.tree._onNodeMouseLeave(this,evt);}});dojo.declare("dijit.Tree",[dijit._Widget,dijit._Templated],{store:null,model:null,query:null,label:"",showRoot:true,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:false,openOnDblClick:false,templateString:dojo.cache("dijit","templates/Tree.html","<div class=\"dijitTree dijitTreeContainer\" role=\"tree\"\n\tdojoAttachEvent=\"onkeypress:_onKeyPress\">\n\t<div class=\"dijitInline dijitTreeIndent\" style=\"position: absolute; top: -9999px\" dojoAttachPoint=\"indentDetector\"></div>\n</div>\n"),persist:true,autoExpand:false,dndController:"dijit.tree._dndSelector",dndParams:["onDndDrop","itemCreator","onDndCancel","checkAcceptance","checkItemAcceptance","dragThreshold","betweenThreshold"],onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(_138d,_138e){dojo.publish(this.id,[dojo.mixin({tree:this,event:_138d},_138e||{})]);},postMixInProperties:function(){this.tree=this;if(this.autoExpand){this.persist=false;}this._itemNodesMap={};if(!this.cookieName){this.cookieName=this.id+"SaveStateCookie";}this._loadDeferred=new dojo.Deferred();this.inherited(arguments);},postCreate:function(){this._initState();if(!this.model){this._store2model();}this.connect(this.model,"onChange","_onItemChange");this.connect(this.model,"onChildrenChange","_onItemChildrenChange");this.connect(this.model,"onDelete","_onItemDelete");this._load();this.inherited(arguments);if(this.dndController){if(dojo.isString(this.dndController)){this.dndController=dojo.getObject(this.dndController);}var _138f={};for(var i=0;i<this.dndParams.length;i++){if(this[this.dndParams[i]]){_138f[this.dndParams[i]]=this[this.dndParams[i]];}}this.dndController=new this.dndController(this,_138f);}},_store2model:function(){this._v10Compat=true;dojo.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var _1390={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};if(this.params.mayHaveChildren){_1390.mayHaveChildren=dojo.hitch(this,"mayHaveChildren");}if(this.params.getItemChildren){_1390.getChildren=dojo.hitch(this,function(item,_1391,_1392){this.getItemChildren((this._v10Compat&&item===this.model.root)?null:item,_1391,_1392);});}this.model=new dijit.tree.ForestStoreModel(_1390);this.showRoot=Boolean(this.label);},onLoad:function(){},_load:function(){this.model.getRoot(dojo.hitch(this,function(item){var rn=(this.rootNode=this.tree._createTreeNode({item:item,tree:this,isExpandable:true,label:this.label||this.getLabel(item),indent:this.showRoot?0:-1}));if(!this.showRoot){rn.rowNode.style.display="none";dijit.setWaiRole(this.domNode,"presentation");dijit.setWaiRole(rn.labelNode,"presentation");dijit.setWaiRole(rn.containerNode,"tree");}this.domNode.appendChild(rn.domNode);var _1393=this.model.getIdentity(item);if(this._itemNodesMap[_1393]){this._itemNodesMap[_1393].push(rn);}else{this._itemNodesMap[_1393]=[rn];}rn._updateLayout();this._expandNode(rn).addCallback(dojo.hitch(this,function(){this._loadDeferred.callback(true);this.onLoad();}));}),function(err){console.error(this,": error loading root: ",err);});},getNodesByItem:function(item){if(!item){return [];}var _1394=dojo.isString(item)?item:this.model.getIdentity(item);return [].concat(this._itemNodesMap[_1394]);},_setSelectedItemAttr:function(item){this.set("selectedItems",[item]);},_setSelectedItemsAttr:function(items){var tree=this;this._loadDeferred.addCallback(dojo.hitch(this,function(){var _1395=dojo.map(items,function(item){return (!item||dojo.isString(item))?item:tree.model.getIdentity(item);});var nodes=[];dojo.forEach(_1395,function(id){nodes=nodes.concat(tree._itemNodesMap[id]||[]);});this.set("selectedNodes",nodes);}));},_setPathAttr:function(path){if(path.length){return this.set("paths",[path]);}else{return this.set("paths",[]);}},_setPathsAttr:function(paths){var tree=this;return new dojo.DeferredList(dojo.map(paths,function(path){var d=new dojo.Deferred();path=dojo.map(path,function(item){return dojo.isString(item)?item:tree.model.getIdentity(item);});if(path.length){tree._loadDeferred.addCallback(function(){_1396(path,[tree.rootNode],d);});}else{d.errback("Empty path");}return d;})).addCallback(_1397);function _1396(path,nodes,def){var _1398=path.shift();var _1399=dojo.filter(nodes,function(node){return node.getIdentity()==_1398;})[0];if(!!_1399){if(path.length){tree._expandNode(_1399).addCallback(function(){_1396(path,_1399.getChildren(),def);});}else{def.callback(_1399);}}else{def.errback("Could not expand path at "+_1398);}};function _1397(_139a){tree.set("selectedNodes",dojo.map(dojo.filter(_139a,function(x){return x[0];}),function(x){return x[1];}));};},_setSelectedNodeAttr:function(node){this.set("selectedNodes",[node]);},_setSelectedNodesAttr:function(nodes){this._loadDeferred.addCallback(dojo.hitch(this,function(){this.dndController.setSelection(nodes);}));},mayHaveChildren:function(item){},getItemChildren:function(_139b,_139c){},getLabel:function(item){return this.model.getLabel(item);},getIconClass:function(item,_139d){return (!item||this.model.mayHaveChildren(item))?(_139d?"dijitFolderOpened":"dijitFolderClosed"):"dijitLeaf";},getLabelClass:function(item,_139e){},getRowClass:function(item,_139f){},getIconStyle:function(item,_13a0){},getLabelStyle:function(item,_13a1){},getRowStyle:function(item,_13a2){},getTooltip:function(item){return "";},_onKeyPress:function(e){if(e.altKey){return;}var dk=dojo.keys;var _13a3=dijit.getEnclosingWidget(e.target);if(!_13a3){return;}var key=e.charOrCode;if(typeof key=="string"&&key!=" "){if(!e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey){this._onLetterKeyNav({node:_13a3,key:key.toLowerCase()});dojo.stopEvent(e);}}else{if(this._curSearch){clearTimeout(this._curSearch.timer);delete this._curSearch;}var map=this._keyHandlerMap;if(!map){map={};map[dk.ENTER]="_onEnterKey";map[dk.SPACE]=map[" "]="_onEnterKey";map[this.isLeftToRight()?dk.LEFT_ARROW:dk.RIGHT_ARROW]="_onLeftArrow";map[this.isLeftToRight()?dk.RIGHT_ARROW:dk.LEFT_ARROW]="_onRightArrow";map[dk.UP_ARROW]="_onUpArrow";map[dk.DOWN_ARROW]="_onDownArrow";map[dk.HOME]="_onHomeKey";map[dk.END]="_onEndKey";this._keyHandlerMap=map;}if(this._keyHandlerMap[key]){this[this._keyHandlerMap[key]]({node:_13a3,item:_13a3.item,evt:e});dojo.stopEvent(e);}}},_onEnterKey:function(_13a4){this._publish("execute",{item:_13a4.item,node:_13a4.node});this.dndController.userSelect(_13a4.node,dojo.isCopyKey(_13a4.evt),_13a4.evt.shiftKey);this.onClick(_13a4.item,_13a4.node,_13a4.evt);},_onDownArrow:function(_13a5){var node=this._getNextNode(_13a5.node);if(node&&node.isTreeNode){this.focusNode(node);}},_onUpArrow:function(_13a6){var node=_13a6.node;var _13a7=node.getPreviousSibling();if(_13a7){node=_13a7;while(node.isExpandable&&node.isExpanded&&node.hasChildren()){var _13a8=node.getChildren();node=_13a8[_13a8.length-1];}}else{var _13a9=node.getParent();if(!(!this.showRoot&&_13a9===this.rootNode)){node=_13a9;}}if(node&&node.isTreeNode){this.focusNode(node);}},_onRightArrow:function(_13aa){var node=_13aa.node;if(node.isExpandable&&!node.isExpanded){this._expandNode(node);}else{if(node.hasChildren()){node=node.getChildren()[0];if(node&&node.isTreeNode){this.focusNode(node);}}}},_onLeftArrow:function(_13ab){var node=_13ab.node;if(node.isExpandable&&node.isExpanded){this._collapseNode(node);}else{var _13ac=node.getParent();if(_13ac&&_13ac.isTreeNode&&!(!this.showRoot&&_13ac===this.rootNode)){this.focusNode(_13ac);}}},_onHomeKey:function(){var node=this._getRootOrFirstNode();if(node){this.focusNode(node);}},_onEndKey:function(_13ad){var node=this.rootNode;while(node.isExpanded){var c=node.getChildren();node=c[c.length-1];}if(node&&node.isTreeNode){this.focusNode(node);}},multiCharSearchDuration:250,_onLetterKeyNav:function(_13ae){var cs=this._curSearch;if(cs){cs.pattern=cs.pattern+_13ae.key;clearTimeout(cs.timer);}else{cs=this._curSearch={pattern:_13ae.key,startNode:_13ae.node};}var self=this;cs.timer=setTimeout(function(){delete self._curSearch;},this.multiCharSearchDuration);var node=cs.startNode;do{node=this._getNextNode(node);if(!node){node=this._getRootOrFirstNode();}}while(node!==cs.startNode&&(node.label.toLowerCase().substr(0,cs.pattern.length)!=cs.pattern));if(node&&node.isTreeNode){if(node!==cs.startNode){this.focusNode(node);}}},isExpandoNode:function(node,_13af){return dojo.isDescendant(node,_13af.expandoNode);},_onClick:function(_13b0,e){var _13b1=e.target,_13b2=this.isExpandoNode(_13b1,_13b0);if((this.openOnClick&&_13b0.isExpandable)||_13b2){if(_13b0.isExpandable){this._onExpandoClick({node:_13b0});}}else{this._publish("execute",{item:_13b0.item,node:_13b0,evt:e});this.onClick(_13b0.item,_13b0,e);this.focusNode(_13b0);}dojo.stopEvent(e);},_onDblClick:function(_13b3,e){var _13b4=e.target,_13b5=(_13b4==_13b3.expandoNode||_13b4==_13b3.expandoNodeText);if((this.openOnDblClick&&_13b3.isExpandable)||_13b5){if(_13b3.isExpandable){this._onExpandoClick({node:_13b3});}}else{this._publish("execute",{item:_13b3.item,node:_13b3,evt:e});this.onDblClick(_13b3.item,_13b3,e);this.focusNode(_13b3);}dojo.stopEvent(e);},_onExpandoClick:function(_13b6){var node=_13b6.node;this.focusNode(node);if(node.isExpanded){this._collapseNode(node);}else{this._expandNode(node);}},onClick:function(item,node,evt){},onDblClick:function(item,node,evt){},onOpen:function(item,node){},onClose:function(item,node){},_getNextNode:function(node){if(node.isExpandable&&node.isExpanded&&node.hasChildren()){return node.getChildren()[0];}else{while(node&&node.isTreeNode){var _13b7=node.getNextSibling();if(_13b7){return _13b7;}node=node.getParent();}return null;}},_getRootOrFirstNode:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0];},_collapseNode:function(node){if(node._expandNodeDeferred){delete node._expandNodeDeferred;}if(node.isExpandable){if(node.state=="LOADING"){return;}node.collapse();this.onClose(node.item,node);if(node.item){this._state(node.item,false);this._saveState();}}},_expandNode:function(node,_13b8){if(node._expandNodeDeferred&&!_13b8){return node._expandNodeDeferred;}var model=this.model,item=node.item,_13b9=this;switch(node.state){case "UNCHECKED":node.markProcessing();var def=(node._expandNodeDeferred=new dojo.Deferred());model.getChildren(item,function(items){node.unmarkProcessing();var scid=node.setChildItems(items);var ed=_13b9._expandNode(node,true);scid.addCallback(function(){ed.addCallback(function(){def.callback();});});},function(err){console.error(_13b9,": error loading root children: ",err);});break;default:def=(node._expandNodeDeferred=node.expand());this.onOpen(node.item,node);if(item){this._state(item,true);this._saveState();}}return def;},focusNode:function(node){dijit.focus(node.labelNode);},_onNodeFocus:function(node){if(node&&node!=this.lastFocused){if(this.lastFocused&&!this.lastFocused._destroyed){this.lastFocused.setFocusable(false);}node.setFocusable(true);this.lastFocused=node;}},_onNodeMouseEnter:function(node){},_onNodeMouseLeave:function(node){},_onItemChange:function(item){var model=this.model,_13ba=model.getIdentity(item),nodes=this._itemNodesMap[_13ba];if(nodes){var label=this.getLabel(item),_13bb=this.getTooltip(item);dojo.forEach(nodes,function(node){node.set({item:item,label:label,tooltip:_13bb});node._updateItemClasses(item);});}},_onItemChildrenChange:function(_13bc,_13bd){var model=this.model,_13be=model.getIdentity(_13bc),_13bf=this._itemNodesMap[_13be];if(_13bf){dojo.forEach(_13bf,function(_13c0){_13c0.setChildItems(_13bd);});}},_onItemDelete:function(item){var model=this.model,_13c1=model.getIdentity(item),nodes=this._itemNodesMap[_13c1];if(nodes){dojo.forEach(nodes,function(node){this.dndController.removeTreeNode(node);var _13c2=node.getParent();if(_13c2){_13c2.removeChild(node);}node.destroyRecursive();},this);delete this._itemNodesMap[_13c1];}},_initState:function(){if(this.persist){var _13c3=dojo.cookie(this.cookieName);this._openedItemIds={};if(_13c3){dojo.forEach(_13c3.split(","),function(item){this._openedItemIds[item]=true;},this);}}},_state:function(item,_13c4){if(!this.persist){return false;}var id=this.model.getIdentity(item);if(arguments.length===1){return this._openedItemIds[id];}if(_13c4){this._openedItemIds[id]=true;}else{delete this._openedItemIds[id];}},_saveState:function(){if(!this.persist){return;}var ary=[];for(var id in this._openedItemIds){ary.push(id);}dojo.cookie(this.cookieName,ary.join(","),{expires:365});},destroy:function(){if(this._curSearch){clearTimeout(this._curSearch.timer);delete this._curSearch;}if(this.rootNode){this.rootNode.destroyRecursive();}if(this.dndController&&!dojo.isString(this.dndController)){this.dndController.destroy();}this.rootNode=null;this.inherited(arguments);},destroyRecursive:function(){this.destroy();},resize:function(_13c5){if(_13c5){dojo.marginBox(this.domNode,_13c5);}this._nodePixelIndent=dojo._getMarginSize(this.tree.indentDetector).w;if(this.tree.rootNode){this.tree.rootNode.set("indent",this.showRoot?0:-1);}},_createTreeNode:function(args){return new dijit._TreeNode(args);}});}if(!dojo._hasResource["dijit.layout.AccordionPane"]){dojo._hasResource["dijit.layout.AccordionPane"]=true;dojo.provide("dijit.layout.AccordionPane");dojo.declare("dijit.layout.AccordionPane",dijit.layout.ContentPane,{constructor:function(){dojo.deprecated("dijit.layout.AccordionPane deprecated, use ContentPane instead","","2.0");},onSelected:function(){}});}if(!dojo._hasResource["dijit.layout.AccordionContainer"]){dojo._hasResource["dijit.layout.AccordionContainer"]=true;dojo.provide("dijit.layout.AccordionContainer");dojo.declare("dijit.layout.AccordionContainer",dijit.layout.StackContainer,{duration:dijit.defaultDuration,buttonWidget:"dijit.layout._AccordionButton",baseClass:"dijitAccordionContainer",buildRendering:function(){this.inherited(arguments);this.domNode.style.overflow="hidden";dijit.setWaiRole(this.domNode,"tablist");},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.selectedChildWidget){var style=this.selectedChildWidget.containerNode.style;style.display="";style.overflow="auto";this.selectedChildWidget._wrapperWidget.set("selected",true);}},layout:function(){var _13c6=this.selectedChildWidget;if(!_13c6){return;}var _13c7=_13c6._wrapperWidget.domNode,_13c8=dojo._getMarginExtents(_13c7),_13c9=dojo._getPadBorderExtents(_13c7),_13ca=_13c6._wrapperWidget.containerNode,_13cb=dojo._getMarginExtents(_13ca),_13cc=dojo._getPadBorderExtents(_13ca),_13cd=this._contentBox;var _13ce=0;dojo.forEach(this.getChildren(),function(child){if(child!=_13c6){_13ce+=dojo._getMarginSize(child._wrapperWidget.domNode).h;}});this._verticalSpace=_13cd.h-_13ce-_13c8.h-_13c9.h-_13cb.h-_13cc.h-_13c6._buttonWidget.getTitleHeight();this._containerContentBox={h:this._verticalSpace,w:this._contentBox.w-_13c8.w-_13c9.w-_13cb.w-_13cc.w};if(_13c6){_13c6.resize(this._containerContentBox);}},_setupChild:function(child){child._wrapperWidget=new dijit.layout._AccordionInnerContainer({contentWidget:child,buttonWidget:this.buttonWidget,id:child.id+"_wrapper",dir:child.dir,lang:child.lang,parent:this});this.inherited(arguments);},addChild:function(child,_13cf){if(this._started){dojo.place(child.domNode,this.containerNode,_13cf);if(!child._started){child.startup();}this._setupChild(child);dojo.publish(this.id+"-addChild",[child,_13cf]);this.layout();if(!this.selectedChildWidget){this.selectChild(child);}}else{this.inherited(arguments);}},removeChild:function(child){if(child._wrapperWidget){dojo.place(child.domNode,child._wrapperWidget.domNode,"after");child._wrapperWidget.destroy();delete child._wrapperWidget;}dojo.removeClass(child.domNode,"dijitHidden");this.inherited(arguments);},getChildren:function(){return dojo.map(this.inherited(arguments),function(child){return child.declaredClass=="dijit.layout._AccordionInnerContainer"?child.contentWidget:child;},this);},destroy:function(){if(this._animation){this._animation.stop();}dojo.forEach(this.getChildren(),function(child){if(child._wrapperWidget){child._wrapperWidget.destroy();}else{child.destroyRecursive();}});this.inherited(arguments);},_showChild:function(child){child._wrapperWidget.containerNode.style.display="block";return this.inherited(arguments);},_hideChild:function(child){child._wrapperWidget.containerNode.style.display="none";this.inherited(arguments);},_transition:function(_13d0,_13d1,_13d2){if(dojo.isIE<8){_13d2=false;}if(this._animation){this._animation.stop(true);delete this._animation;}var self=this;if(_13d0){_13d0._wrapperWidget.set("selected",true);var d=this._showChild(_13d0);if(this.doLayout&&_13d0.resize){_13d0.resize(this._containerContentBox);}}if(_13d1){_13d1._wrapperWidget.set("selected",false);if(!_13d2){this._hideChild(_13d1);}}if(_13d2){var _13d3=_13d0._wrapperWidget.containerNode,_13d4=_13d1._wrapperWidget.containerNode;var _13d5=_13d0._wrapperWidget.containerNode,_13d6=dojo._getMarginExtents(_13d5),_13d7=dojo._getPadBorderExtents(_13d5),_13d8=_13d6.h+_13d7.h;_13d4.style.height=(self._verticalSpace-_13d8)+"px";this._animation=new dojo.Animation({node:_13d3,duration:this.duration,curve:[1,this._verticalSpace-_13d8-1],onAnimate:function(value){value=Math.floor(value);_13d3.style.height=value+"px";_13d4.style.height=(self._verticalSpace-_13d8-value)+"px";},onEnd:function(){delete self._animation;_13d3.style.height="auto";_13d1._wrapperWidget.containerNode.style.display="none";_13d4.style.height="auto";self._hideChild(_13d1);}});this._animation.onStop=this._animation.onEnd;this._animation.play();}return d;},_onKeyPress:function(e,_13d9){if(this.disabled||e.altKey||!(_13d9||e.ctrlKey)){return;}var k=dojo.keys,c=e.charOrCode;if((_13d9&&(c==k.LEFT_ARROW||c==k.UP_ARROW))||(e.ctrlKey&&c==k.PAGE_UP)){this._adjacent(false)._buttonWidget._onTitleClick();dojo.stopEvent(e);}else{if((_13d9&&(c==k.RIGHT_ARROW||c==k.DOWN_ARROW))||(e.ctrlKey&&(c==k.PAGE_DOWN||c==k.TAB))){this._adjacent(true)._buttonWidget._onTitleClick();dojo.stopEvent(e);}}}});dojo.declare("dijit.layout._AccordionInnerContainer",[dijit._Widget,dijit._CssStateMixin],{baseClass:"dijitAccordionInnerContainer",isContainer:true,isLayoutContainer:true,buildRendering:function(){this.domNode=dojo.place("<div class='"+this.baseClass+"'>",this.contentWidget.domNode,"after");var child=this.contentWidget,cls=dojo.getObject(this.buttonWidget);this.button=child._buttonWidget=(new cls({contentWidget:child,label:child.title,title:child.tooltip,dir:child.dir,lang:child.lang,iconClass:child.iconClass,id:child.id+"_button",parent:this.parent})).placeAt(this.domNode);this.containerNode=dojo.place("<div class='dijitAccordionChildWrapper' style='display:none'>",this.domNode);dojo.place(this.contentWidget.domNode,this.containerNode);},postCreate:function(){this.inherited(arguments);var _13da=this.button;this._contentWidgetWatches=[this.contentWidget.watch("title",dojo.hitch(this,function(name,_13db,_13dc){_13da.set("label",_13dc);})),this.contentWidget.watch("tooltip",dojo.hitch(this,function(name,_13dd,_13de){_13da.set("title",_13de);})),this.contentWidget.watch("iconClass",dojo.hitch(this,function(name,_13df,_13e0){_13da.set("iconClass",_13e0);}))];},_setSelectedAttr:function(_13e1){this._set("selected",_13e1);this.button.set("selected",_13e1);if(_13e1){var cw=this.contentWidget;if(cw.onSelected){cw.onSelected();}}},startup:function(){this.contentWidget.startup();},destroy:function(){this.button.destroyRecursive();dojo.forEach(this._contentWidgetWatches||[],function(w){w.unwatch();});delete this.contentWidget._buttonWidget;delete this.contentWidget._wrapperWidget;this.inherited(arguments);},destroyDescendants:function(){this.contentWidget.destroyRecursive();}});dojo.declare("dijit.layout._AccordionButton",[dijit._Widget,dijit._Templated,dijit._CssStateMixin],{templateString:dojo.cache("dijit.layout","templates/AccordionButton.html","<div dojoAttachEvent='onclick:_onTitleClick' class='dijitAccordionTitle'>\n\t<div dojoAttachPoint='titleNode,focusNode' dojoAttachEvent='onkeypress:_onTitleKeyPress'\n\t\t\tclass='dijitAccordionTitleFocus' role=\"tab\" aria-expanded=\"false\"\n\t\t><span class='dijitInline dijitAccordionArrow' role=\"presentation\"></span\n\t\t><span class='arrowTextUp' role=\"presentation\">+</span\n\t\t><span class='arrowTextDown' role=\"presentation\">-</span\n\t\t><img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon\" dojoAttachPoint='iconNode' style=\"vertical-align: middle\" role=\"presentation\"/>\n\t\t<span role=\"presentation\" dojoAttachPoint='titleTextNode' class='dijitAccordionText'></span>\n\t</div>\n</div>\n"),attributeMap:dojo.mixin(dojo.clone(dijit.layout.ContentPane.prototype.attributeMap),{label:{node:"titleTextNode",type:"innerHTML"},title:{node:"titleTextNode",type:"attribute",attribute:"title"},iconClass:{node:"iconNode",type:"class"}}),baseClass:"dijitAccordionTitle",getParent:function(){return this.parent;},buildRendering:function(){this.inherited(arguments);var _13e2=this.id.replace(" ","_");dojo.attr(this.titleTextNode,"id",_13e2+"_title");dijit.setWaiState(this.focusNode,"labelledby",dojo.attr(this.titleTextNode,"id"));dojo.setSelectable(this.domNode,false);},getTitleHeight:function(){return dojo._getMarginSize(this.domNode).h;},_onTitleClick:function(){var _13e3=this.getParent();_13e3.selectChild(this.contentWidget,true);dijit.focus(this.focusNode);},_onTitleKeyPress:function(evt){return this.getParent()._onKeyPress(evt,this.contentWidget);},_setSelectedAttr:function(_13e4){this._set("selected",_13e4);dijit.setWaiState(this.focusNode,"expanded",_13e4);dijit.setWaiState(this.focusNode,"selected",_13e4);this.focusNode.setAttribute("tabIndex",_13e4?"0":"-1");}});}if(!dojo._hasResource["dojox.rpc.Service"]){dojo._hasResource["dojox.rpc.Service"]=true;dojo.provide("dojox.rpc.Service");dojo.declare("dojox.rpc.Service",null,{constructor:function(smd,_13e5){var url;var self=this;function _13e6(smd){smd._baseUrl=new dojo._Url((dojo.isBrowser?location.href:dojo.config.baseUrl),url||".")+"";self._smd=smd;for(var _13e7 in self._smd.services){var _13e8=_13e7.split(".");var _13e9=self;for(var i=0;i<_13e8.length-1;i++){_13e9=_13e9[_13e8[i]]||(_13e9[_13e8[i]]={});}_13e9[_13e8[_13e8.length-1]]=self._generateService(_13e7,self._smd.services[_13e7]);}};if(smd){if((dojo.isString(smd))||(smd instanceof dojo._Url)){if(smd instanceof dojo._Url){url=smd+"";}else{url=smd;}var text=dojo._getText(url);if(!text){throw new Error("Unable to load SMD from "+smd);}else{_13e6(dojo.fromJson(text));}}else{_13e6(smd);}}this._options=(_13e5?_13e5:{});this._requestId=0;},_generateService:function(_13ea,_13eb){if(this[_13eb]){throw new Error("WARNING: "+_13ea+" already exists for service. Unable to generate function");}_13eb.name=_13ea;var func=dojo.hitch(this,"_executeMethod",_13eb);var _13ec=dojox.rpc.transportRegistry.match(_13eb.transport||this._smd.transport);if(_13ec.getExecutor){func=_13ec.getExecutor(func,_13eb,this);}var _13ed=_13eb.returns||(_13eb._schema={});var _13ee="/"+_13ea+"/";_13ed._service=func;func.servicePath=_13ee;func._schema=_13ed;func.id=dojox.rpc.Service._nextId++;return func;},_getRequest:function(_13ef,args){var smd=this._smd;var _13f0=dojox.rpc.envelopeRegistry.match(_13ef.envelope||smd.envelope||"NONE");var _13f1=(_13ef.parameters||[]).concat(smd.parameters||[]);if(_13f0.namedParams){if((args.length==1)&&dojo.isObject(args[0])){args=args[0];}else{var data={};for(var i=0;i<_13ef.parameters.length;i++){if(typeof args[i]!="undefined"||!_13ef.parameters[i].optional){data[_13ef.parameters[i].name]=args[i];}}args=data;}if(_13ef.strictParameters||smd.strictParameters){for(i in args){var found=false;for(var j=0;j<_13f1.length;j++){if(_13f1[i].name==i){found=true;}}if(!found){delete args[i];}}}for(i=0;i<_13f1.length;i++){var param=_13f1[i];if(!param.optional&&param.name&&!args[param.name]){if(param["default"]){args[param.name]=param["default"];}else{if(!(param.name in args)){throw new Error("Required parameter "+param.name+" was omitted");}}}}}else{if(_13f1&&_13f1[0]&&_13f1[0].name&&(args.length==1)&&dojo.isObject(args[0])){if(_13f0.namedParams===false){args=dojox.rpc.toOrdered(_13f1,args);}else{args=args[0];}}}if(dojo.isObject(this._options)){args=dojo.mixin(args,this._options);}var _13f2=_13ef._schema||_13ef.returns;var _13f3=_13f0.serialize.apply(this,[smd,_13ef,args]);_13f3._envDef=_13f0;var _13f4=(_13ef.contentType||smd.contentType||_13f3.contentType);return dojo.mixin(_13f3,{sync:dojox.rpc._sync,contentType:_13f4,headers:_13ef.headers||smd.headers||_13f3.headers||{},target:_13f3.target||dojox.rpc.getTarget(smd,_13ef),transport:_13ef.transport||smd.transport||_13f3.transport,envelope:_13ef.envelope||smd.envelope||_13f3.envelope,timeout:_13ef.timeout||smd.timeout,callbackParamName:_13ef.callbackParamName||smd.callbackParamName,rpcObjectParamName:_13ef.rpcObjectParamName||smd.rpcObjectParamName,schema:_13f2,handleAs:_13f3.handleAs||"auto",preventCache:_13ef.preventCache||smd.preventCache,frameDoc:this._options.frameDoc||undefined});},_executeMethod:function(_13f5){var args=[];var i;for(i=1;i<arguments.length;i++){args.push(arguments[i]);}var _13f6=this._getRequest(_13f5,args);var _13f7=dojox.rpc.transportRegistry.match(_13f6.transport).fire(_13f6);_13f7.addBoth(function(_13f8){return _13f6._envDef.deserialize.call(this,_13f8);});return _13f7;}});dojox.rpc.getTarget=function(smd,_13f9){var dest=smd._baseUrl;if(smd.target){dest=new dojo._Url(dest,smd.target)+"";}if(_13f9.target){dest=new dojo._Url(dest,_13f9.target)+"";}return dest;};dojox.rpc.toOrdered=function(_13fa,args){if(dojo.isArray(args)){return args;}var data=[];for(var i=0;i<_13fa.length;i++){data.push(args[_13fa[i].name]);}return data;};dojox.rpc.transportRegistry=new dojo.AdapterRegistry(true);dojox.rpc.envelopeRegistry=new dojo.AdapterRegistry(true);dojox.rpc.envelopeRegistry.register("URL",function(str){return str=="URL";},{serialize:function(smd,_13fb,data){var d=dojo.objectToQuery(data);return {data:d,transport:"POST"};},deserialize:function(_13fc){return _13fc;},namedParams:true});dojox.rpc.envelopeRegistry.register("JSON",function(str){return str=="JSON";},{serialize:function(smd,_13fd,data){var d=dojo.toJson(data);return {data:d,handleAs:"json",contentType:"application/json"};},deserialize:function(_13fe){return _13fe;}});dojox.rpc.envelopeRegistry.register("PATH",function(str){return str=="PATH";},{serialize:function(smd,_13ff,data){var i;var _1400=dojox.rpc.getTarget(smd,_13ff);if(dojo.isArray(data)){for(i=0;i<data.length;i++){_1400+="/"+data[i];}}else{for(i in data){_1400+="/"+i+"/"+data[i];}}return {data:"",target:_1400};},deserialize:function(_1401){return _1401;}});dojox.rpc.transportRegistry.register("POST",function(str){return str=="POST";},{fire:function(r){r.url=r.target;r.postData=r.data;return dojo.rawXhrPost(r);}});dojox.rpc.transportRegistry.register("GET",function(str){return str=="GET";},{fire:function(r){r.url=r.target+(r.data?"?"+((r.rpcObjectParamName)?r.rpcObjectParamName+"=":"")+r.data:"");return dojo.xhrGet(r);}});dojox.rpc.transportRegistry.register("JSONP",function(str){return str=="JSONP";},{fire:function(r){r.url=r.target+((r.target.indexOf("?")==-1)?"?":"&")+((r.rpcObjectParamName)?r.rpcObjectParamName+"=":"")+r.data;r.callbackParamName=r.callbackParamName||"callback";return dojo.io.script.get(r);}});dojox.rpc.Service._nextId=1;dojo._contentHandlers.auto=function(xhr){var _1402=dojo._contentHandlers;var _1403=xhr.getResponseHeader("Content-Type");var _1404=!_1403?_1402.text(xhr):_1403.match(/\/.*json/)?_1402.json(xhr):_1403.match(/\/javascript/)?_1402.javascript(xhr):_1403.match(/\/xml/)?_1402.xml(xhr):_1402.text(xhr);return _1404;};}if(!dojo._hasResource["dojo.io.script"]){dojo._hasResource["dojo.io.script"]=true;dojo.provide("dojo.io.script");dojo.getObject("io",true,dojo);(function(){var _1405=dojo.isIE?"onreadystatechange":"load",_1406=/complete|loaded/;dojo.io.script={get:function(args){var dfd=this._makeScriptDeferred(args);var _1407=dfd.ioArgs;dojo._ioAddQueryToUrl(_1407);dojo._ioNotifyStart(dfd);if(this._canAttach(_1407)){var node=this.attach(_1407.id,_1407.url,args.frameDoc);if(!_1407.jsonp&&!_1407.args.checkString){var _1408=dojo.connect(node,_1405,function(evt){if(evt.type=="load"||_1406.test(node.readyState)){dojo.disconnect(_1408);_1407.scriptLoaded=evt;}});}}dojo._ioWatch(dfd,this._validCheck,this._ioCheck,this._resHandle);return dfd;},attach:function(id,url,_1409){var doc=(_1409||dojo.doc);var _140a=doc.createElement("script");_140a.type="text/javascript";_140a.src=url;_140a.id=id;_140a.charset="utf-8";return doc.getElementsByTagName("head")[0].appendChild(_140a);},remove:function(id,_140b){console.log("dojo.io.script.remove    DESTROYING ALL");return;dojo.destroy(dojo.byId(id,_140b));if(this["jsonp_"+id]){delete this["jsonp_"+id];}},_makeScriptDeferred:function(args){var dfd=dojo._ioSetArgs(args,this._deferredCancel,this._deferredOk,this._deferredError);var _140c=dfd.ioArgs;_140c.id=dojo._scopeName+"IoScript"+(this._counter++);_140c.canDelete=false;_140c.jsonp=args.callbackParamName||args.jsonp;if(_140c.jsonp){_140c.query=_140c.query||"";if(_140c.query.length>0){_140c.query+="&";}_140c.query+=_140c.jsonp+"="+(args.frameDoc?"parent.":"")+dojo._scopeName+".io.script.jsonp_"+_140c.id+"._jsonpCallback";_140c.frameDoc=args.frameDoc;_140c.canDelete=true;dfd._jsonpCallback=this._jsonpCallback;this["jsonp_"+_140c.id]=dfd;}return dfd;},_deferredCancel:function(dfd){dfd.canceled=true;if(dfd.ioArgs.canDelete){dojo.io.script._addDeadScript(dfd.ioArgs);}},_deferredOk:function(dfd){var _140d=dfd.ioArgs;if(_140d.canDelete){dojo.io.script._addDeadScript(_140d);}return _140d.json||_140d.scriptLoaded||_140d;},_deferredError:function(error,dfd){if(dfd.ioArgs.canDelete){if(error.dojoType=="timeout"){dojo.io.script.remove(dfd.ioArgs.id,dfd.ioArgs.frameDoc);}else{dojo.io.script._addDeadScript(dfd.ioArgs);}}console.log("dojo.io.script error",error);return error;},_deadScripts:[],_counter:1,_addDeadScript:function(_140e){dojo.io.script._deadScripts.push({id:_140e.id,frameDoc:_140e.frameDoc});_140e.frameDoc=null;},_validCheck:function(dfd){var _140f=dojo.io.script;var _1410=_140f._deadScripts;if(_1410&&_1410.length>0){for(var i=0;i<_1410.length;i++){_140f.remove(_1410[i].id,_1410[i].frameDoc);_1410[i].frameDoc=null;}dojo.io.script._deadScripts=[];}return true;},_ioCheck:function(dfd){var _1411=dfd.ioArgs;if(_1411.json||(_1411.scriptLoaded&&!_1411.args.checkString)){return true;}var _1412=_1411.args.checkString;if(_1412&&eval("typeof("+_1412+") != 'undefined'")){return true;}return false;},_resHandle:function(dfd){if(dojo.io.script._ioCheck(dfd)){dfd.callback(dfd);}else{dfd.errback(new Error("inconceivable dojo.io.script._resHandle error"));}},_canAttach:function(_1413){return true;},_jsonpCallback:function(json){this.ioArgs.json=json;}};})();}if(!dojo._hasResource["plugins.workflow.ParameterRow"]){dojo._hasResource["plugins.workflow.ParameterRow"]=true;dojo.provide("plugins.workflow.ParameterRow");dojo.declare("plugins.workflow.ParameterRow",[plugins.form.EditRow,plugins.form.Inputs,plugins.core.Common,dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div class=\"${paramtype}\">\n    \n    <table width=\"100%\">\n        <tr>\n            <td\n                colspan=\"1\"\n                width=\"120px\"\n                dojoAttachPoint=\"nameNode\"\n                class=\"name\"\n                >${name}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"valueNode\"\n                class=\"value\"\n                title=\"Click to edit value then press 'Return' to save (ESC to quit)\"\n                >${value}</td>\n        </tr>\n    </table>\n    <table\n        dojoAttachPoint=\"hidden\"\n        class=\"hidden\"\n        style=\"display: none;\"\n        width=\"100%\">\n        \n        <tr width=\"100%\">\n            <td colspan=\"2\">\n                <table width=\"100%\">\n                    <tr width=\"100%\">\n                        <td\n                            colspan=\"1\"\n                            width=\"60px\"\n                            dojoAttachPoint=\"typeTitle\"\n                            class=\"discretion\"\n                            style=\"display: none;\">${discretion}</td>\n                        <td \n                            colspan=\"1\"\n                            width=\"60px\"\n                            dojoAttachPoint=\"typeNode\"\n                            class=\"valuetype\"\n                            title=\"Parameter type, e.g., file, directory, integer or text string\"\n                            style=\"display: none;\">${valuetype}</td>\n                        <td \n                            colspan=\"1\"\n                            width=\"50px\"\n                            dojoAttachPoint=\"browseButton\"\n                            class=\"browseButton\"\n                            title=\"Click to browse the filesystem in your home directory on the server\"\n                            style=\"display: none;\">&nbsp;</td>\n                        <td\n                            dojoAttachPoint=\"downloadButton\"\n                            class=\"downloadButton\"\n                            title=\"Click to download this file to your computer\"\n                            style=\"display: none;\">&nbsp;</td>\n                        <td\n                            dojoAttachPoint=\"uploadButton\"\n                            dojoAttachEvent=\"onclick:upload\"\n                            class=\"uploadButton\"\n                            title=\"Click to upload a file from your computer\"\n                            style=\"display: none;\">&nbsp;</td>\n                        <td dojoAttachPoint=\"fileInputMask\"\n                            class=\"fileInputMask\"\n                            style=\"display: none;\" ></td>\n                        <td class=\"filler\">&nbsp;</td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n        <tr>\n            <td \n                colspan=\"2\"\n                dojoAttachPoint=\"descriptionNode\"\n                class=\"description\"\n                title=\"Click to edit description then press 'Return' to save (ESC to quit)\"\n                style=\"display: none;\" >${description}</td>\n        <tr>\n    </table>\n\n</div>\n\n</div>\n",widgetsInTemplate:true,validInput:true,core:null,formInputs:{valueNode:"word",descriptionNode:"phrase"},defaultInputs:{valueNode:"",descriptionNode:["Description"]},requiredInputs:{valueNode:1},invalidInputs:{valueNode:["essential","required","optional"]},constructor:function(args){this.passedArgs=args;this.core=args.core;this.uploader=args.uploader;this.parameterObject=new Object;for(var key in args){if(key=="core"||key=="uploader"){continue;}this.parameterObject[key]=args[key];}},postCreate:function(){this.inherited(arguments);this.startup();},startup:function(){this.inherited(arguments);this.setToggle();this.setEditOnclicks();this.nameNode.parentWidget=this;this.setBrowseButton();if(this.valuetype=="file"){this.setFileDownload();}if(this.valuetype=="flag"){this.setCheckbox();}var node=this.valueNode;},getInputValue:function(){console.log("ParameterRow.getInputValue    plugins.workflow.ParameterRow.getInputValue()");console.log("ParameterRow.getInputValue    '"+this.name+"' this.valueNode.innerHTML: "+this.valueNode.innerHTML);if(inputValue&&inputValue.match(/^<input type="checkbox">/)){return this.valueNode.firstChild.checked;}var value;if(this.valueNode.innerHTML){value=this.valueNode.innerHTML;}var name="valueNode";if(this.formInputs[name]=="word"){value=this.cleanWord(value);}else{if(this.formInputs[name]=="phrase"){value=this.cleanEnds(value);}}value=this.convertString(value,"htmlToText");this.valueNode.value=value;return value;},destroy:function(_1414){this.inherited(arguments);},setCheckbox:function(){console.log("ParameterRow.setCheckbox    plugins.workflow.ParameterRow.setCheckbox()");console.log("ParameterRow.setCheckbox    this.valuetype: "+this.valuetype);this.checkbox=document.createElement("input");this.checkbox.type="checkbox";if(this.parameterObject.valuetype=="flag"){if(this.value==1){this.checkbox.checked=true;}else{this.checkbox.checked=false;}}this.valueNode.innerHTML="";this.valueNode.appendChild(this.checkbox);dojo.connect(this.checkbox,"onchange",dojo.hitch(this,"handleCheckboxOnChange"));},handleCheckboxOnChange:function(event){console.log("ParameterRow.handleCheckboxOnChange    plugins.workflow.ParameterRow.handleCheckboxOnChange(event)");console.log("ParameterRow.handleCheckboxOnChange    event: "+event);event.stopPropagation();var _1415=this.getFormInputs(this);console.log("ParameterRow.handleCheckboxOnChange    inputs: "+dojo.toJson(_1415));if(_1415==null){return;}console.log("ParameterRow.setCheckbox    Doing thisObject.saveInputs(inputs)");this.saveInputs(_1415,{originator:this,reload:false});},setBrowseButton:function(){if(!this.valuetype.match(/^file/)&&!this.valuetype.match(/^director/)){return;}dojo.connect(this.browseButton,"onclick",this,dojo.hitch(this,function(event){this.openFileManager();}));},openFileManager:function(){console.log("ParameterRow.openFileManager     workflow.ParameterRow.openFileManager()");if(!Agua.fileManager){console.log("ParameterRow.openFileManager     Agua.fileManager is null. Returning");return;}if(this.paramtype!="input"){console.log("ParameterRow.openFileManager     Doing Agua.fileManager.disableMenus()");Agua.fileManager.disableMenuSelect();Agua.fileManager.disableMenuAdd();}else{console.log("ParameterRow.openFileManager     Doing Agua.fileManager.enableMenus()");Agua.fileManager.enableMenuSelect();Agua.fileManager.enableMenuAdd();}Agua.fileManager.show(this);},saveInputs:function(_1416,_1417){console.log("ParameterRow.saveInputs    plugins.workflow.ParameterRow.saveInputs(inputs, updateArgs)");console.log("ParameterRow.saveInputs    inputs: "+_1416);console.dir(_1416);console.log("ParameterRow.saveInputs    updateArgs: ");console.dir(_1417);console.log("ParameterRow.saveInputs    this.savingParameter: "+this.savingParameter);if(this.savingParameter==true){return;}this.savingParameter=true;var node=_1417.originator.valueNode;var _1418=_1416.valueNode;var force=true;console.log("ParameterRow.saveInputs    node: "+node);console.log("ParameterRow.saveInputs    inputValue: "+_1418);console.log("ParameterRow.saveInputs    force: "+force);console.log("ParameterRow.saveInputs    this.valuetype: "+this.valuetype);if(this.valuetype=="flag"){console.log("ParameterRow.saveInputs    DOING inputValue = this.getCheckboxValue()");_1418=this.getCheckboxValue();console.log("ParameterRow.saveInputs    inputValue: "+_1418);_1416.valueNode=_1418;}console.log("ParameterRow.saveInputs    Doing this.checkInput(node, inputValue, force)");this.checkInput(node,_1418,force);for(var i=0;i<_1416.length;i++){_1416[i]=this.convertBackslash(_1416[i],"expand");}console.log("ParameterRow.saveInputs    AFTER this.convertBackslash() inputs: "+dojo.toJson(_1416));this.parameterObject.username=Agua.cookie("username");this.parameterObject.sessionId=Agua.cookie("sessionId");for(key in _1416){this.parameterObject[key]=_1416[key];}delete this.parameterObject.uploader;this.parameterObject.value=this.parameterObject.valueNode;delete this.parameterObject.valueNode;this.savingParameter=false;console.log("ParameterRow.saveInputs    Doing Agua.addStageParameter(stageParameterObject)");Agua.addStageParameter(this.parameterObject);console.log("ParameterRow.saveInputs    Doing this.core.io.chainOutputs()");var _1419=this.core.parameters.application;console.log("ParameterRow.saveInputs    application: "+dojo.toJson(_1419));var _141a=this.core.io.chainOutputs(_1419,true);console.log("ParameterRow.saveInputs    chainedOutputs: "+dojo.toJson(_141a));this.core.parameters.resetChainedOutputs(_141a);this.core.parameters.checkValidInputs();},getCheckboxValue:function(){if(this.valueNode.firstChild.checked==true){return "1";}return "0";},checkInput:function(node,_141b,force){console.group("ParameterRow-"+this.id+"    checkInput");console.log("ParameterRow.checkInput    node, inputValue, force");console.log("ParameterRow.checkInput    node: "+node);console.log("ParameterRow.checkInput    inputValue: "+_141b);console.log("ParameterRow.checkInput    force: "+force);if(this.valuetype=="flag"){this.validInput==true;this.setValid(node);}else{if(_141b==null||_141b==""){this.checkEmpty(node);}else{if(!this.valuetype.match(/^file$/)&&!this.valuetype.match(/^directory$/)){if(this.parameterObject.valuetype=="integer"){this.checkIntegerInput(node,_141b);}else{if(this.parameterObject.valuetype=="string"){this.checkTextInput(node,_141b);}}}else{if(force==null){force=false;}this.checkFile(node,_141b,force);}}}console.groupEnd("ParameterRow-"+this.id+"    checkInput");},checkEmpty:function(node){if(this.discretion=="essential"||this.discretion=="required"){this.setInvalid(node);this.validInput=false;Agua.setParameterValidity(this,false);}else{Agua.setParameterValidity(this,true);this.setValid(node);this.validInput=true;}this.core.parameters.checkValidInputs();},checkIntegerInput:function(node,_141c){console.log("ParameterRow.checkIntegerInput    plugins.workflow.ParameterRow.checkIntegerInput()");console.log("ParameterRow.checkIntegerInput    node: "+node);console.log("ParameterRow.checkIntegerInput    inputValue: "+_141c);if(!_141c.match(/^\s*[\d\.]+\s*$/)){console.log("ParameterRow.isValidInput    Non-integer inputValue. Returning false");this.validInput=false;this.setInvalid(node);Agua.setParameterValidity(this,false);}else{this.setValid(node);Agua.setParameterValidity(this,true);}},checkTextInput:function(node,_141d){console.log("ParameterRow.checkTextInput    plugins.workflow.ParameterRow.checkTextInput()");console.log("ParameterRow.checkTextInput    node: "+node);console.log("ParameterRow.checkTextInput    inputValue: "+_141d);var _141e=true;this.validInput=this.isValidInput(this.invalidInputs,"valueNode",_141d);console.log("ParameterRow.checkIntegerInput    this.validInput: "+this.validInput);if(this.validInput==false&&this.paramtype=="input"){console.log("ParameterRow.checkInput    text input not valid. Setting stageParameter. to FALSE");this.setInvalid(node);Agua.setParameterValidity(this,false);}else{console.log("ParameterRow.checkInput    text input is valid. Setting stageParameter. to TRUE");this.setValid(node);Agua.setParameterValidity(this,true);}this.core.parameters.checkValidInputs();},checkFile:function(node,_141f,force){console.log("ParameterRow.checkFile    plugins.workflow.ParameterRow.checkFile()");console.log("ParameterRow.checkFile    node: "+node);if(_141f==null||_141f==""){return null;}console.log("ParameterRow.checkFile    force: "+force);if(this.parameterObject.fileinfo!=null){this.handleCheckfile(node,this.parameterObject.fileinfo);}var _1420=Agua.getFileInfo(this.parameterObject);if(_1420!=null){this.handleCheckfile(node,_1420);}var query=new Object;if(this.core.parameters.shared==true){query.username=this.username;query.requestor=Agua.cookie("username");}else{query.username=Agua.cookie("username");}query.sessionId=Agua.cookie("sessionId");query.project=this.project;query.workflow=this.workflow;query.mode="checkFile";query.filepath=_141f;var url=this.randomiseUrl(Agua.cgiUrl+"workflow.cgi");var _1421=Math.floor(Math.random()*1000000000000);var _1422=this;dojo.xhrPut({url:url,contentType:"text",preventCache:true,sync:false,handleAs:"json",content:_1421,putData:dojo.toJson(query),handle:function(_1423,_1424){console.log("ParameterRow.checkFile    JSON fileinfo for inputValue '"+_141f+"': "+dojo.toJson(_1423));Agua.setFileInfo(_1422.parameterObject,_1423);_1422.handleCheckfile(node,_1423);_1422.core.parameters.checkValidInputs();},error:function(_1425,_1426){console.log("ParameterRow.checkFile    Error with JSON Post, response: "+_1425);}});},handleCheckfile:function(node,_1427){console.log("ParameterRow.handleCheckfile    plugins.workflow.ParameterRow.handleCheckfile(node, fileinfo)");console.log("ParameterRow.handleCheckfile    BEFORE node: node");console.log("ParameterRow.handleCheckfile    node: "+node);console.log("ParameterRow.handleCheckfile    fileinfo: "+dojo.toJson(_1427));console.log("ParameterRow.handleCheckfile    DOING Agua.setFileInfo(this.parameterObject, fileinfo)");Agua.setFileInfo(this.parameterObject,_1427);if(_1427==null||_1427.exists==null){console.log("ParameterRow.handleCheckfile    Either fileinfo or fileinfo.exists is null. Returning");return;}if(_1427.exists=="true"){console.log("ParameterRow.handleCheckfile    File exists. Changing CSS");console.log("ParameterRow.handleCheckfile    this.valuetype: "+this.valuetype);console.log("ParameterRow.handleCheckfile    fileinfo.type: "+_1427.type);this.filePresent(node);if((this.valuetype=="directory"&&_1427.type=="directory")||(this.valuetype=="file"&&_1427.type=="file")){console.log("ParameterRow.handleCheckfile    The file or directory is of the correct type. Doing this.setValid(node)");this.setValid(node);this.validInput=true;console.log("ParameterRow.handleCheckfile    essential/required file/dir is  present. DOING Agua.setParameterValidity(this, true)");Agua.setParameterValidity(this,true);}else{console.log("ParameterRow.handleCheckfile    File found when directory required (or vice-versa). Doing this.setInvalid(node)");this.setInvalid(node);this.validInput=false;console.log("ParameterRow.handleCheckfile    null/empty for essential/required input. DOING Agua.setParameterValidity(this, false)");Agua.setParameterValidity(this,false);}}else{console.log("ParameterRow.handleCheckfile    File does not exist. Changing class of node to 'fileMissing'");console.log("ParameterRow.handleCheckfile    node: "+node);this.fileMissing(node);if(this.discretion=="essential"){this.validInput=false;this.setInvalid(node);console.log("ParameterRow.handleCheckfile    null/empty for essential input. DOING Agua.setParameterValidity(this, false)");Agua.setParameterValidity(this,false);}else{this.validInput=true;this.setValid(node);console.log("ParameterRow.handleCheckfile    null/empty for required input. DOING Agua.setParameterValidity(this, true)");Agua.setParameterValidity(this,true);}}console.log("ParameterRow.handleCheckfile    "+this.appname+" parameter "+this.name+" FINAL this.validInput: "+this.validInput);console.log("ParameterRow.handleCheckfile    "+this.appname+" parameter "+this.name+" FINAL this.validInput: "+this.validInput);},isValidInput:function(name,value){return true;},setEditOnclicks:function(){if(this.paramtype!="input"){return;}var _1428=this;var array=["valueNode","descriptionNode"];for(var i in array){if(this.valuetype!="flag"){dojo.connect(this[array[i]],"onclick",dojo.hitch(this,function(event){var node=event.target;this.editRow(this,node);event.stopPropagation();}));}}},setFileDownload:function(node,name){dojo.connect(this.downloadButton,"onclick",this,dojo.hitch(this,function(event){this.downloadFile(this.valueNode.innerHTML);}));},downloadFile:function(_1429){var query="?mode=downloadFile";if(this.core.parameters.shared==true){query+="&username="+this.username;query+="&requestor="+Agua.cookie("username");}else{query+="&username="+Agua.cookie("username");}query+="&sessionId="+Agua.cookie("sessionId");query+="&filepath="+_1429;var url=Agua.cgiUrl+"download.cgi";var args={method:"GET",url:url+query,handleAs:"json",load:this.handleDownload};var value=dojo.io.iframe.send(args);},handleDownload:function(_142a,_142b){if(_142a.message=="ifd.getElementsByTagName(\"textarea\")[0] is undefined"){Agua.toastMessage({message:"Download failed: File is not present",type:"error"});}},upload:function(event){var path=this.project+"/"+this.workflow;if(path==null||path==""){return;}this.uploader.getSetter("path",path);this.uploader.show();dojo.stopEvent(event);var _142c=this;this.uploader.onComplete=function(_142d){_142c.onComplete(_142d);};},onComplete:function(_142e){if(!_142e.match(/\/([^\/]+)$/)){return;}var _142f=_142e.match(/\/([^\/]+)$/)[1];var path=this.project+"/"+this.workflow+"/"+_142f;this.changeValue(this.valueNode,this.valueNode.value,path,"file");},changeValue:function(node,_1430,_1431,type){console.log("ParameterRow.changeValue     plugins.workflow.ParameterRow.changeValue(node, oldValue, newValue)");console.log("ParameterRow.changeValue     node: "+node);console.log("ParameterRow.changeValue     newValue: "+_1431);console.log("ParameterRow.changeValue     oldValue: "+_1430);console.log("ParameterRow.changeValue     type: "+type);console.log("ParameterRow.changeValue     this.valuetype: "+this.valuetype);if(_1431==null||_1431==""||_1431==_1430){console.log("ParameterRow.changeValue    newValue is empty or newValue == oldValue. Either upload was aborted or the files have the same name. Returning.");node.innerHTML=_1430;return;}node.innerHTML=_1431;this.parameterObject.value=_1431;console.log("ParameterRow.changeValue     this.parameterObject: ");console.dir(this.parameterObject);this.parameterObject.username=Agua.cookie("username");console.log("ParameterRow.changeValue     Doing Agua.addStageParameter(this.parameterObject)");Agua.addStageParameter(this.parameterObject);this.filePresent(node);if(this.valuetype.substring(0,4)!=type.substring(0,4)){console.log("ParameterRow.changeValue     type ("+type+") does not match this.valuetype ("+this.valuetype+") ");this.validInput=false;this.setInvalid(node);console.log("ParameterRow.handleCheckfile    File found where directory wanted (or vice-versa). Setting stageParameter.isValid to FALSE");Agua.setParameterValidity(this,false);}else{console.log("ParameterRow.changeValue     type ("+type+") matches this.valuetype ("+this.valuetype+") ");this.validInput=true;this.setValid(node);console.log("ParameterRow.handleCheckfile    File found where wanted. Setting stageParameter.isValid to TRUE");Agua.setParameterValidity(this,true);}console.log("ParameterRow.changeValue     DOING this.core.parameters.checkValidInputs()");this.core.parameters.checkValidInputs();},addValue:function(node,_1432,_1433,type){console.log("ParameterRow.addValue     plugins.workflow.ParameterRow.addValue(node, oldValue, newValue)");console.log("ParameterRow.addValue     node: "+node);console.log("ParameterRow.addValue     newValue: "+_1433);console.log("ParameterRow.addValue     oldValue: "+_1432);console.log("ParameterRow.addValue     type: "+type);console.log("ParameterRow.addValue     this.valuetype: "+this.valuetype);if(_1433==null||_1433==""||_1433==_1432){console.log("ParameterRow.addValue    newValue is empty or newValue == oldValue. Either upload was aborted or the files have the same name. Returning.");node.innerHTML=_1432;return;}if(_1432){_1433=_1432+","+_1433;}node.innerHTML=_1433;console.log("ParameterRow.addValue     Doing Agua.addStageParameter(stageParameterObject)");var _1434=new Object;for(var key in this.passedArgs){if(key!="core"){_1434[key]=this.passedArgs[key];}}_1434.value=_1433;console.log("ParameterRow.addValue     stageParameterObject: ");console.dir({stageParameterObject:_1434});delete _1434.uploader;_1434.username=Agua.cookie("username");Agua.addStageParameter(_1434);this.filePresent(node);if(this.valuetype!=type){console.log("ParameterRow.addValue     Input types do not match. Doing this.setInvalid(node)");this.validInput=false;this.setInvalid(node);console.log("ParameterRow.handleCheckfile    File found where directory wanted (or vice-versa). Setting stageParameter.isValid to FALSE");Agua.setParameterValidity(this,false);}else{console.log("ParameterRow.addValue     Input types match. Doing this.setValid(node)");this.validInput=true;this.setValid(node);if(this.discretion=="essential"||this.discretion=="required"){this.inputSatisfied(node);}console.log("ParameterRow.handleCheckfile    File found where wanted. Setting stageParameter.isValid to TRUE");Agua.setParameterValidity(this,true);}console.log("ParameterRow.handleCheckfile    File found where wanted. Setting stageParameter.isValid to TRUE");var _1435=this;setTimeout(function(){console.log("ParameterRow.handleCheckfile    Doing setTimeout thisObj.checkFile("+node+", "+_1433+")");_1435.checkFile(node,_1433);},100,this);console.log("ParameterRow.addValue     DOING this.core.parameters.checkValidInputs()");this.core.parameters.checkValidInputs();},filePresent:function(node){dojo.removeClass(node,"fileMissing");dojo.addClass(node,"filePresent");},fileMissing:function(node){dojo.removeClass(node,"filePresent");dojo.addClass(node,"fileMissing");},setInvalid:function(node){console.group("ParameterRow-"+this.id+"    setInvalid");console.dir({node:node});var _1436=this.setInvalid.caller.nom;console.log("ParameterRow.setInvalid    caller: "+_1436);console.log("ParameterRow.setInvalid    this.discretion: "+this.discretion);dojo.addClass(node,"invalid");dojo.addClass(this.domNode,"invalid");if(this.discretion=="required"||this.discretion=="essential"){console.log("ParameterRow.setValid    Setting required");dojo.removeClass(node,"satisfied");dojo.addClass(node,"required");dojo.removeClass(this.domNode,"satisfied");dojo.addClass(this.domNode,"required");}console.groupEnd("ParameterRow-"+this.id+"    setInvalid");},setValid:function(node){console.group("ParameterRow-"+this.id+"    setValid");console.dir({node:node});var _1437=this.setValid.caller.nom;console.log("ParameterRow.setValid    caller: "+_1437);console.log("ParameterRow.setValid    this.discretion: "+this.discretion);dojo.removeClass(node,"invalid");dojo.removeClass(this.domNode,"invalid");if(this.discretion=="essential"||this.discretion=="required"){console.log("ParameterRow.setValid    Setting satisfied");dojo.removeClass(node,"required");dojo.addClass(node,"satisfied");dojo.removeClass(this.domNode,"required");dojo.addClass(this.domNode,"satisfied");}console.groupEnd("ParameterRow-"+this.id+"    setValid");},setToggle:function(){var _1438=this;dojo.connect(this.nameNode,"onclick",function(event){event.stopPropagation();_1438.toggle();});},toggle:function(){if(this["hidden"].style.display=="table"){this["hidden"].style.display="none";}else{this["hidden"].style.display="table";}var array=["descriptionNode","typeNode","typeTitle"];for(var i in array){if(this[array[i]].style.display=="table-cell"){this[array[i]].style.display="none";}else{this[array[i]].style.display="table-cell";}}var _1439;var end=0;if(this.paramtype=="input"){_1439=["browseButton","downloadButton","uploadButton","fileInputMask"];if(this.valuetype=="file"||this.valuetype=="files"){end=4;}if(this.valuetype=="directory"||this.valuetype=="directories"){end=1;}if(this.core.parameters.shared==true&&end==4){end=2;}}else{if(this.paramtype=="output"){_1439=["browseButton","downloadButton"];if(this.valuetype=="file"){end=2;}}}for(var i=0;i<end;i++){if(this[_1439[i]].style.display=="table-cell"){this[_1439[i]].style.display="none";}else{this[_1439[i]].style.display="table-cell";}}}});}if(!dojo._hasResource["plugins.workflow.Parameters"]){dojo._hasResource["plugins.workflow.Parameters"]=true;dojo.provide("plugins.workflow.Parameters");dojo.declare("plugins.workflow.Parameters",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\ttitle=\"Inputs\"\n\t\tclass=\"parameters\"\n\t\tstyle=\"position: relative; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important;\"\n    >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"3\"class=\"tabTitle\" align=\"center\">\n                    Inputs\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td\n\t\t\t\t\tdojoAttachPoint=\"appNameNode\"\n\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\tclass=\"appName\"\n\t\t\t\t\talign=\"center\"\n\t\t\t\t\t>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div \n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Inputs\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important;\"\n\t\t\t\t\t\t>\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"inputRows\"\n\t\t\t\t\t\t\tclass=\"inputRows\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Outputs\"\n\t\t\t\t\t\tclass=\"outputsTitlePane\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important;\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"outputRows\"\n\t\t\t\t\t\t\tclass=\"outputRows\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\t\t\n\t</div>\n\n\t\n</div> \n\n\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","workflow/css/parameters.css")],parentWidget:null,childWidgets:null,isValid:null,core:null,constructor:function(args){this.core=args.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setUploader();this.attachNode.addChild(this.mainTab);this.attachNode.selectChild(this.mainTab);},setUploader:function(){var _143a=dijit.getUniqueId("plugins_form_Uploader");var _143b=Agua.cookie("username");var _143c=Agua.cookie("sessionId");this.uploader=new plugins.form.Uploader({uploaderId:_143a,username:_143b,sessionId:_143c});},clear:function(){this.mainTab.style.visibility="hidden";this.appNameNode.innerHTML="";while(this["inputRows"].firstChild){this["inputRows"].removeChild(this["inputRows"].firstChild);}while(this["outputRows"].firstChild){this["outputRows"].removeChild(this["outputRows"].firstChild);}},resetChainedOutputs:function(_143d){var _143e=this;dojo.forEach(_143d,function(_143f,i){if(_143f==null){return;}var _1440=_143f.value;_143e.setOutputValue(_1440);});},setOutputValue:function(_1441){var _1442=this;dojo.forEach(_1442.childWidgets,function(_1443,j){if(_1443.paramtype=="input"){return;}if(_1441==null||_1441==""){return;}if(_1441!=_1443.value){_1443.value=_1441;_1443.valueNode.innerHTML=_1441;return;}});},load:function(node,_1444,force){console.log("Parameters.load    PASSED node.application:");console.dir({node_application:node.application});if(force==null){force=false;}this.shared=_1444;this.parentNode=node;this.parentWidget=node.parentWidget;if(node.stageRow){this.stageRow=node.stageRow;}else{this.stageRow=node.parentWidget;}if(this.stageRow==null&&node.childNodes){this.stageRow=dijit.byNode(node.childNodes[0]);}this.application=node.application;if(node.application==null){console.log("Parameters.load     node.application is null. Using node.parentWidget.application");this.application=node.parentWidget.application;}console.log("Parameters.load    AFTER node.application:");console.dir({node_application:node.application});if(this.childWidgets==null){this.childWidgets=new Array;}while(this.childWidgets.length>0){var _1445=this.childWidgets.splice(0,1)[0];if(_1445.destroy){_1445.destroy();}}this.appNameNode.innerHTML=this.application.number+". "+this.application.name;this.loadTitlePane("input",_1444);this.loadTitlePane("output",_1444);this.attachNode.selectChild(this.mainTab);var _1446=node.parentWidget;console.log("Parameters.load     BEFORE stageRow.checkValidParameters()");if(!_1444){_1446.checkValidParameters(force);}console.log("Parameters.load     AFTER stageRow.checkValidParameters()");console.log("Parameters.load     END");},setParameterRowStyles:function(){console.group("Parameters-"+this.id+"    setParameterRowStyles");console.log("Parameters.setParameterRowStyles    caller: "+this.setParameterRowStyles.caller.nom);var _1447=this.childWidgets;var _1448=new Object;for(var i=0;i<_1447.length;i++){if(_1447[i].paramtype=="input"){_1448[_1447[i].name]=_1447[i];}}console.log("Parameters.setParameterRowStyles     parameterRows:");console.dir({parameterRows:_1447});var _1449=Agua.getStageParameters(this.application);for(var i=0;i<_1449.length;i++){if(_1449[i].paramtype!="input"){continue;}var _144a=_1448[_1449[i].name];var _144b=Agua.getParameterValidity(_1449[i]);if(_144b==true||_144b==null){_144a.setValid(_144a.domNode);}else{_144a.setInvalid(_144a.domNode);}}console.groupEnd("Parameters-"+this.id+"    setParameterRowStyles");},loadTitlePane:function(_144c){var _144d=_144c+"Rows";while(this[_144d].firstChild){this[_144d].removeChild(this[_144d].firstChild);}var _144e={username:this.application.username,project:this.application.project,workflow:this.application.workflow,workflownumber:this.application.workflownumber,submit:this.application.submit,name:this.application.name,number:this.application.number};if(_144c=="input"){this.addSubmit(dojo.clone(_144e),_144d);}var _144f;if(this.shared==true){_144f=Agua.getSharedStageParameters(_144e);}else{_144f=Agua.getStageParameters(_144e);}_144f=this.filterByKeyValues(_144f,["paramtype"],[_144c]);_144f=this.sortHasharrayByKeys(_144f,["ordinal","name"]);if(_144f==null){return;}for(var i=0;i<_144f.length;i++){var _1450=new Object;for(var key in _144f[i]){if(_144f[i][key].replace){_1450[key]=_144f[i][key].replace(/\\\\/g,"\\");}else{_1450[key]=_144f[i][key];}}var _1451=Agua.cookie("username");if(_1450.value==null){_1450.value="";}else{_1450.value=String(_1450.value);_1450.value=_1450.value.replace(/%username%/,_1451);_1450.value=_1450.value.replace(/%project%/,_1450.project);_1450.value=_1450.value.replace(/%workflow%/,_1450.workflow);_1450.value=_1450.value.replace(/%username%/,Agua.cookie("username"));}_1450.core=this.core;_1450.uploader=this.uploader;var _1452=new plugins.workflow.ParameterRow(_1450);this[_144d].appendChild(_1452.domNode);this.childWidgets.push(_1452);}},addSubmit:function(_1453,_1454){var _1455=this.stageRow;var _1456=_1453;_1456.description="Submit this stage to the cluster (if cluster is defined)";_1456.discretion="optional";_1456.name="SUBMIT";_1456.value=this.application.submit;_1456.paramtype="input";_1456.valuetype="flag";if(!_1456.value){_1456.value="";}var _1457=new plugins.workflow.ParameterRow(_1456);var _1458=this;_1457.handleCheckboxOnChange=dojo.hitch(_1458,function(event){event.stopPropagation();_1453.submit=0;if(event.target.checked==true){_1453.submit=1;}this.application.submit=_1453.submit;this.setStageSubmitStyle(_1455,_1453.submit);Agua.updateStageSubmit(_1453);});this[_1454].appendChild(_1457.domNode);},setStageSubmitStyle:function(_1459,_145a){console.group("Parameters-"+this.id+"    setStageSubmitStyle");console.group("Parameters.setStageSubmitStyle     stageRow: "+_1459);console.dir({stageRow:_1459});console.group("Parameters.setStageSubmitStyle     submit: "+_145a);_1459.setSubmitStyle(_145a);console.groupEnd("Parameters-"+this.id+"    setStageSubmitStyle");},checkValidInputs:function(){this.isValid=true;for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].paramtype!="input"){continue;}if(this.childWidgets[i].validInput==false){this.isValid=false;break;}}var _145b=this.stageRow;if(this.stageRow==null){return;}if(this.isValid==true){this.stageRow.setValid();}else{this.stageRow.setInvalid();}},isCurrentApplication:function(_145c){var keys=["project","workflow","workflownumber","name","number"];return (this._objectsMatchByKey(_145c,this.core.parameters.application,keys));}});}if(!dojo._hasResource["plugins.workflow.Workflow"]){dojo._hasResource["plugins.workflow.Workflow"]=true;dojo.provide("plugins.workflow.Workflow");if(1){}dojo.declare("plugins.workflow.Workflow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- WORKFLOW TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"workflow\"\n\t\ticonClass=\"workflowIcon\"\n\t\tminWidth=\"833\"\n\t\tstyle=\"min-width: 965px !important; width: 100% !important; padding: 0px; background: #FFF; min-height: inherit !important;\"\n\t\tclosable=\"true\"\n\t\tdojoType=\"dijit.layout.BorderContainer\"\n\t\ttitle=\"Workflow\"\n\t\tparentWidget=this>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"leftPaneExpando\"\n\t\t\tdojoType=\"dojox.layout.ExpandoPane\"\n\t\t\tclass=\"leftExpando\"\n\t\t\tstartExpanded=\"true\"\n\t\t\ttitle=\"Tools\"\n\t\t\tregion=\"left\"\n\t\t\tmaxWidth=\"200\"\n\t\t\tstyle=\"width: 200px;\">\n\t\t\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"leftPane\"\n\t\t\t\tdojoType=\"dijit.layout.TabContainer\"\n\t\t\t\tregion=\"center\"\n\t\t\t\ttabStrip=\"true\">\n\t\t\t</div>\n\t\t\t\n\t\t</div>\n\t\t<div region=\"center\" startExpanded=\"false\" dojoType=\"dijit.layout.ContentPane\">\n\t\t\t\n\t\t\t<div dojoType=\"dijit.layout.BorderContainer\" style=\"height:275px; border: solid #ccc 1px;\">\n\t\t\t\t<div dojoType=\"dojox.layout.ExpandoPane\"\n\t\t\t\t\tdojoAttachPoint=\"middlePaneExpando\"\n\t\t\t\t\t title=\"Controls\"\n\t\t\t\t\t region=\"left\"\n\t\t\t\t\t class=\"middleExpando\"\n\t\t\t\t\t maxWidth=\"265\"\n\t\t\t\t\t style=\"width: 320px;\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"middlePane\"\n\t\t\t\t\t\tdojoType=\"dijit.layout.TabContainer\" region=\"center\" tabStrip=\"true\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"rightPane\"\n\t\t\t\t\tclass=\"rightExpando\"\n\t\t\t\t\t dojoType=\"dijit.layout.TabContainer\" region=\"center\" tabStrip=\"true\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t\n\t\t</div>\n\n\t</div>\n\t<!-- END OF WORKFLOW TAB -->\n\n\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"workflow/css/workflow.css",dojo.moduleUrl("plugins")+"workflow/css/history.css",dojo.moduleUrl("plugins")+"workflow/css/shared.css",dojo.moduleUrl("dojox")+"layout/resources/ExpandoPane.css",dojo.moduleUrl("dijit")+"themes/tundra/tundra.css"],attachWidget:null,project:null,workflow:null,polling:false,textBreakWidth:22,fileManager:null,core:new Object,constructor:function(args){this.loadCSS();this.attachWidget=Agua.tabs;if(args!=null){this.project=args.project;this.workflow=args.workflow;}this.core.workflow=this;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.addWidget("workflow",this);this.attachWidget.addChild(this.mainTab);this.attachWidget.selectChild(this.mainTab);var _145d=[["plugins.workflow.Apps","apps",this.leftPane],["plugins.workflow.SharedApps","sharedApps",this.leftPane]];for(var i=0;i<_145d.length;i++){var _145e=_145d[i];this.setCoreWidget(_145e[0],_145e[1],_145e[2]);}this.setParameters();var _145f=[["plugins.workflow.Grid","grid",this.middlePane],["plugins.workflow.UserWorkflows","userWorkflows",this.middlePane],["plugins.workflow.SharedWorkflows","sharedWorkflows",this.middlePane],["plugins.workflow.History","historyPane",this.middlePane],["plugins.workflow.RunStatus","runStatus",this.rightPane]];for(var i=0;i<_145f.length;i++){var _145e=_145f[i];this.setCoreWidget(_145e[0],_145e[1],_145e[2]);}console.log("Workflow.startup    BEFORE this.core.userWorkflows.setProjectCombo()");console.log("Workflow.startup    this.project: "+this.project);console.log("Workflow.startup    this.workflow: "+this.workflow);if(this.project!=null&&this.core.userWorkflows!=null){this.core.userWorkflows.setProjectCombo(this.project,this.workflow);}},setCoreWidget:function(_1460,name,pane){console.log("Workflow.setCoreWidget    moduleName: "+_1460);console.log("Workflow.setCoreWidget    BEFORE dojo.require moduleName: "+_1460);dojo["require"](_1460);console.log("Workflow.setCoreWidget    AFTER dojo.require moduleName: "+_1460);if(this[name]!=null){return;}var _1461=dojo.getObject(_1460);this[name]=new _1461({attachNode:pane,parentWidget:this,core:this.core});console.log("Workflow.setCoreWidget    this["+name+"]: "+this[name]);this.core[name]=this[name];},setParameters:function(){this.core.parameters=new plugins.workflow.Parameters({attachNode:this.rightPane,parentWidget:this,core:this.core});},destroyRecursive:function(){console.log("Workflow.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.workflow.Controller"]){dojo._hasResource["plugins.workflow.Controller"]=true;dojo.provide("plugins.workflow.Controller");dojo.declare("plugins.workflow.Controller",[dijit._Widget,dijit._Templated,plugins.core.Common],{name:"plugins.workflow.Controller",version:"0.01",url:"",description:"",dependencies:[{name:"plugins.core.Agua",version:0.01}],templateString:"<div dojoAttachPoint=\"containerNode\" class=\"workflow\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"workflowIcon\"\n        type=\"button\"\n        label=\"Workflow\"\n        ></button>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"workflow/css/controller.css",dojo.moduleUrl("plugins")+"workflow/css/workflow.css"],tabPanes:[],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _1462=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(args){console.log("Controller.createTab    args: ");console.dir({args:args});window.getSelection().removeAllRanges();if(args==null){args=new Object;}args.attachWidget=Agua.tabs;var _1463=new plugins.workflow.Workflow(args);this.tabPanes.push(_1463);this._supportingWidgets.push(_1463);},refreshTabs:function(){console.log("workflow.Controller.refreshTabs    Populating this.tabPanes");console.log("workflow.Controller.refreshTabs    BEFORE this.tabPanes: ");console.dir({this_tabPanes:this.tabPanes});var _1464=this;dijit.registry.byClass("plugins.workflow.Workflow").forEach(function(_1465){console.log("workflow: "+_1465);console.dir({workflow:_1465});_1464.tabPanes.push(_1465);});console.log("workflow.Controller.refreshTabs    AFTER this.tabPanes: ");console.dir({this_tabPanes:this.tabPanes});}});}if(!dojo._hasResource["dojox.mdnd.Moveable"]){dojo._hasResource["dojox.mdnd.Moveable"]=true;dojo.provide("dojox.mdnd.Moveable");dojo.declare("dojox.mdnd.Moveable",null,{handle:null,skip:true,dragDistance:3,constructor:function(_1466,node){this.node=dojo.byId(node);this.d=this.node.ownerDocument;if(!_1466){_1466={};}this.handle=_1466.handle?dojo.byId(_1466.handle):null;if(!this.handle){this.handle=this.node;}this.skip=_1466.skip;this.events=[dojo.connect(this.handle,"onmousedown",this,"onMouseDown")];if(dojox.mdnd.autoScroll){this.autoScroll=dojox.mdnd.autoScroll;}},isFormElement:function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " a button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;},onMouseDown:function(e){if(this._isDragging){return;}var _1467=dojo.isIE?(e.button==1):(e.which==1);if(!_1467){return;}if(this.skip&&this.isFormElement(e)){return;}if(this.autoScroll){this.autoScroll.setAutoScrollNode(this.node);this.autoScroll.setAutoScrollMaxPage();}this.events.push(dojo.connect(this.d,"onmouseup",this,"onMouseUp"));this.events.push(dojo.connect(this.d,"onmousemove",this,"onFirstMove"));this._selectStart=dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent);this._firstX=e.clientX;this._firstY=e.clientY;dojo.stopEvent(e);},onFirstMove:function(e){dojo.stopEvent(e);var d=(this._firstX-e.clientX)*(this._firstX-e.clientX)+(this._firstY-e.clientY)*(this._firstY-e.clientY);if(d>this.dragDistance*this.dragDistance){this._isDragging=true;dojo.disconnect(this.events.pop());dojo.style(this.node,"width",dojo.contentBox(this.node).w+"px");this.initOffsetDrag(e);this.events.push(dojo.connect(this.d,"onmousemove",this,"onMove"));}},initOffsetDrag:function(e){this.offsetDrag={"l":e.pageX,"t":e.pageY};var s=this.node.style;var _1468=dojo.position(this.node,true);this.offsetDrag.l=_1468.x-this.offsetDrag.l;this.offsetDrag.t=_1468.y-this.offsetDrag.t;var _1469={"x":_1468.x,"y":_1468.y};this.size={"w":_1468.w,"h":_1468.h};this.onDragStart(this.node,_1469,this.size);},onMove:function(e){dojo.stopEvent(e);if(dojo.isIE==8&&new Date()-this.date<20){return;}if(this.autoScroll){this.autoScroll.checkAutoScroll(e);}var _146a={"x":this.offsetDrag.l+e.pageX,"y":this.offsetDrag.t+e.pageY};var s=this.node.style;s.left=_146a.x+"px";s.top=_146a.y+"px";this.onDrag(this.node,_146a,this.size,{"x":e.pageX,"y":e.pageY});if(dojo.isIE==8){this.date=new Date();}},onMouseUp:function(e){if(this._isDragging){dojo.stopEvent(e);this._isDragging=false;if(this.autoScroll){this.autoScroll.stopAutoScroll();}delete this.onMove;this.onDragEnd(this.node);this.node.focus();}dojo.disconnect(this.events.pop());dojo.disconnect(this.events.pop());},onDragStart:function(node,_146b,size){},onDragEnd:function(node){},onDrag:function(node,_146c,size,_146d){},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.events=this.node=null;}});}if(!dojo._hasResource["dojox.mdnd.AreaManager"]){dojo._hasResource["dojox.mdnd.AreaManager"]=true;dojo.provide("dojox.mdnd.AreaManager");dojo.declare("dojox.mdnd.AreaManager",null,{autoRefresh:true,areaClass:"dojoxDndArea",dragHandleClass:"dojoxDragHandle",constructor:function(){this._areaList=[];this.resizeHandler=dojo.connect(dojo.global,"onresize",this,function(){this._dropMode.updateAreas(this._areaList);});this._oldIndexArea=this._currentIndexArea=this._oldDropIndex=this._currentDropIndex=this._sourceIndexArea=this._sourceDropIndex=-1;},init:function(){this.registerByClass();},registerByNode:function(area,_146e){var index=this._getIndexArea(area);if(area&&index==-1){var _146f=area.getAttribute("accept");var _1470=(_146f)?_146f.split(/\s*,\s*/):["text"];var obj={"node":area,"items":[],"coords":{},"margin":null,"accept":_1470,"initItems":false};dojo.forEach(this._getChildren(area),function(item){this._setMarginArea(obj,item);obj.items.push(this._addMoveableItem(item));},this);this._areaList=this._dropMode.addArea(this._areaList,obj);if(!_146e){this._dropMode.updateAreas(this._areaList);}dojo.publish("/dojox/mdnd/manager/register",[area]);}},registerByClass:function(){dojo.query("."+this.areaClass).forEach(function(area){this.registerByNode(area,true);},this);this._dropMode.updateAreas(this._areaList);},unregister:function(area){var index=this._getIndexArea(area);if(index!=-1){dojo.forEach(this._areaList[index].items,function(item){this._deleteMoveableItem(item);},this);this._areaList.splice(index,1);this._dropMode.updateAreas(this._areaList);return true;}return false;},_addMoveableItem:function(node){node.setAttribute("tabIndex","0");var _1471=this._searchDragHandle(node);var _1472=new dojox.mdnd.Moveable({"handle":_1471,"skip":true},node);dojo.addClass(_1471||node,"dragHandle");var type=node.getAttribute("dndType");var item={"item":_1472,"type":type?type.split(/\s*,\s*/):["text"],"handlers":[dojo.connect(_1472,"onDragStart",this,"onDragStart")]};if(dijit&&dijit.byNode){var _1473=dijit.byNode(node);if(_1473){item.type=_1473.dndType?_1473.dndType.split(/\s*,\s*/):["text"];item.handlers.push(dojo.connect(_1473,"uninitialize",this,function(){this.removeDragItem(node.parentNode,_1472.node);}));}}return item;},_deleteMoveableItem:function(_1474){dojo.forEach(_1474.handlers,function(_1475){dojo.disconnect(_1475);});var node=_1474.item.node,_1476=this._searchDragHandle(node);dojo.removeClass(_1476||node,"dragHandle");_1474.item.destroy();},_getIndexArea:function(area){if(area){for(var i=0;i<this._areaList.length;i++){if(this._areaList[i].node===area){return i;}}}return -1;},_searchDragHandle:function(node){if(node){var _1477=this.dragHandleClass.split(" "),_1478=_1477.length,_1479="";dojo.forEach(_1477,function(css,i){_1479+="."+css;if(i!=_1478-1){_1479+=", ";}});return dojo.query(_1479,node)[0];}},addDragItem:function(area,node,index,_147a){var add=true;if(!_147a){add=area&&node&&(node.parentNode===null||(node.parentNode&&node.parentNode.nodeType!==1));}if(add){var _147b=this._getIndexArea(area);if(_147b!==-1){var item=this._addMoveableItem(node),items=this._areaList[_147b].items;if(0<=index&&index<items.length){var _147c=items.slice(0,index),_147d=items.slice(index,items.length);_147c[_147c.length]=item;this._areaList[_147b].items=_147c.concat(_147d);area.insertBefore(node,items[index].item.node);}else{this._areaList[_147b].items.push(item);area.appendChild(node);}this._setMarginArea(this._areaList[_147b],node);this._areaList[_147b].initItems=false;return true;}}return false;},removeDragItem:function(area,node){var index=this._getIndexArea(area);if(area&&index!==-1){var items=this._areaList[index].items;for(var j=0;j<items.length;j++){if(items[j].item.node===node){this._deleteMoveableItem(items[j]);items.splice(j,1);return area.removeChild(node);}}}return null;},_getChildren:function(area){var _147e=[];dojo.forEach(area.childNodes,function(child){if(child.nodeType==1){if(dijit&&dijit.byNode){var _147f=dijit.byNode(child);if(_147f){if(!_147f.dragRestriction){_147e.push(child);}}else{_147e.push(child);}}else{_147e.push(child);}}});return _147e;},_setMarginArea:function(area,node){if(area&&area.margin===null&&node){area.margin=dojo._getMarginExtents(node);}},findCurrentIndexArea:function(_1480,size){this._oldIndexArea=this._currentIndexArea;this._currentIndexArea=this._dropMode.getTargetArea(this._areaList,_1480,this._currentIndexArea);if(this._currentIndexArea!=this._oldIndexArea){if(this._oldIndexArea!=-1){this.onDragExit(_1480,size);}if(this._currentIndexArea!=-1){this.onDragEnter(_1480,size);}}return this._currentIndexArea;},_isAccepted:function(type,_1481){this._accept=false;for(var i=0;i<_1481.length;++i){for(var j=0;j<type.length;++j){if(type[j]==_1481[i]){this._accept=true;break;}}}},onDragStart:function(node,_1482,size){if(this.autoRefresh){this._dropMode.updateAreas(this._areaList);}var _1483=(dojo.isWebKit)?dojo.body():dojo.body().parentNode;if(!this._cover){this._cover=dojo.create("div",{"class":"dndCover"});this._cover2=dojo.clone(this._cover);dojo.addClass(this._cover2,"dndCover2");}var h=_1483.scrollHeight+"px";this._cover.style.height=this._cover2.style.height=h;dojo.body().appendChild(this._cover);dojo.body().appendChild(this._cover2);this._dragStartHandler=dojo.connect(node.ownerDocument,"ondragstart",dojo,"stopEvent");this._sourceIndexArea=this._lastValidIndexArea=this._currentIndexArea=this._getIndexArea(node.parentNode);var _1484=this._areaList[this._sourceIndexArea];var _1485=_1484.items;for(var i=0;i<_1485.length;i++){if(_1485[i].item.node==node){this._dragItem=_1485[i];this._dragItem.handlers.push(dojo.connect(this._dragItem.item,"onDrag",this,"onDrag"));this._dragItem.handlers.push(dojo.connect(this._dragItem.item,"onDragEnd",this,"onDrop"));_1485.splice(i,1);this._currentDropIndex=this._sourceDropIndex=i;break;}}var _1486=null;if(this._sourceDropIndex!==_1484.items.length){_1486=_1484.items[this._sourceDropIndex].item.node;}if(dojo.isIE>7){this._eventsIE7=[dojo.connect(this._cover,"onmouseover",dojo,"stopEvent"),dojo.connect(this._cover,"onmouseout",dojo,"stopEvent"),dojo.connect(this._cover,"onmouseenter",dojo,"stopEvent"),dojo.connect(this._cover,"onmouseleave",dojo,"stopEvent")];}var s=node.style;s.left=_1482.x+"px";s.top=_1482.y+"px";if(s.position=="relative"||s.position==""){s.position="absolute";}this._cover.appendChild(node);this._dropIndicator.place(_1484.node,_1486,size);dojo.addClass(node,"dragNode");this._accept=true;dojo.publish("/dojox/mdnd/drag/start",[node,_1484,this._sourceDropIndex]);},onDragEnter:function(_1487,size){if(this._currentIndexArea===this._sourceIndexArea){this._accept=true;}else{this._isAccepted(this._dragItem.type,this._areaList[this._currentIndexArea].accept);}},onDragExit:function(_1488,size){this._accept=false;},onDrag:function(node,_1489,size,_148a){var _148b=this._dropMode.getDragPoint(_1489,size,_148a);this.findCurrentIndexArea(_148b,size);if(this._currentIndexArea!==-1&&this._accept){this.placeDropIndicator(_148b,size);}},placeDropIndicator:function(_148c,size){this._oldDropIndex=this._currentDropIndex;var area=this._areaList[this._currentIndexArea];if(!area.initItems){this._dropMode.initItems(area);}this._currentDropIndex=this._dropMode.getDropIndex(area,_148c);if(!(this._currentIndexArea===this._oldIndexArea&&this._oldDropIndex===this._currentDropIndex)){this._placeDropIndicator(size);}return this._currentDropIndex;},_placeDropIndicator:function(size){var _148d=this._areaList[this._lastValidIndexArea];var _148e=this._areaList[this._currentIndexArea];this._dropMode.refreshItems(_148d,this._oldDropIndex,size,false);var node=null;if(this._currentDropIndex!=-1){node=_148e.items[this._currentDropIndex].item.node;}this._dropIndicator.place(_148e.node,node);this._lastValidIndexArea=this._currentIndexArea;this._dropMode.refreshItems(_148e,this._currentDropIndex,size,true);},onDropCancel:function(){if(!this._accept){var index=this._getIndexArea(this._dropIndicator.node.parentNode);if(index!=-1){this._currentIndexArea=index;}else{this._currentIndexArea=0;}}},onDrop:function(node){this.onDropCancel();var _148f=this._areaList[this._currentIndexArea];dojo.removeClass(node,"dragNode");var style=node.style;style.position="relative";style.left="0";style.top="0";style.width="auto";if(_148f.node==this._dropIndicator.node.parentNode){_148f.node.insertBefore(node,this._dropIndicator.node);}else{_148f.node.appendChild(node);this._currentDropIndex=_148f.items.length;}var _1490=this._currentDropIndex;if(_1490==-1){_1490=_148f.items.length;}var _1491=_148f.items;var _1492=_1491.slice(0,_1490);var _1493=_1491.slice(_1490,_1491.length);_1492[_1492.length]=this._dragItem;_148f.items=_1492.concat(_1493);this._setMarginArea(_148f,node);dojo.forEach(this._areaList,function(obj){obj.initItems=false;});dojo.disconnect(this._dragItem.handlers.pop());dojo.disconnect(this._dragItem.handlers.pop());this._resetAfterDrop();if(this._cover){dojo.body().removeChild(this._cover);dojo.body().removeChild(this._cover2);}dojo.publish("/dojox/mdnd/drop",[node,_148f,_1490]);},_resetAfterDrop:function(){this._accept=false;this._dragItem=null;this._currentDropIndex=-1;this._currentIndexArea=-1;this._oldDropIndex=-1;this._sourceIndexArea=-1;this._sourceDropIndex=-1;this._dropIndicator.remove();if(this._dragStartHandler){dojo.disconnect(this._dragStartHandler);}if(dojo.isIE>7){dojo.forEach(this._eventsIE7,dojo.disconnect);}},destroy:function(){while(this._areaList.length>0){if(!this.unregister(this._areaList[0].node)){throw new Error("Error while destroying AreaManager");}}dojo.disconnect(this.resizeHandler);this._dropIndicator.destroy();this._dropMode.destroy();if(dojox.mdnd.autoScroll){dojox.mdnd.autoScroll.destroy();}if(this.refreshListener){dojo.unsubscribe(this.refreshListener);}if(this._cover){dojo._destroyElement(this._cover);dojo._destroyElement(this._cover2);delete this._cover;delete this._cover2;}}});if(dijit&&dijit._Widget){dojo.extend(dijit._Widget,{dndType:"text"});}dojox.mdnd._areaManager=null;dojox.mdnd.areaManager=function(){if(!dojox.mdnd._areaManager){dojox.mdnd._areaManager=new dojox.mdnd.AreaManager();}return dojox.mdnd._areaManager;};}if(!dojo._hasResource["dojox.mdnd.DropIndicator"]){dojo._hasResource["dojox.mdnd.DropIndicator"]=true;dojo.provide("dojox.mdnd.DropIndicator");dojo.declare("dojox.mdnd.DropIndicator",null,{node:null,constructor:function(){var _1494=document.createElement("div");var _1495=document.createElement("div");_1494.appendChild(_1495);dojo.addClass(_1494,"dropIndicator");this.node=_1494;},place:function(area,_1496,size){if(size){this.node.style.height=size.h+"px";}try{if(_1496){area.insertBefore(this.node,_1496);}else{area.appendChild(this.node);}return this.node;}catch(e){return null;}},remove:function(){if(this.node){this.node.style.height="";if(this.node.parentNode){this.node.parentNode.removeChild(this.node);}}},destroy:function(){if(this.node){if(this.node.parentNode){this.node.parentNode.removeChild(this.node);}dojo._destroyElement(this.node);delete this.node;}}});(function(){dojox.mdnd.areaManager()._dropIndicator=new dojox.mdnd.DropIndicator();}());}if(!dojo._hasResource["dojox.mdnd.dropMode.OverDropMode"]){dojo._hasResource["dojox.mdnd.dropMode.OverDropMode"]=true;dojo.provide("dojox.mdnd.dropMode.OverDropMode");dojo.declare("dojox.mdnd.dropMode.OverDropMode",null,{_oldXPoint:null,_oldYPoint:null,_oldBehaviour:"up",constructor:function(){this._dragHandler=[dojo.connect(dojox.mdnd.areaManager(),"onDragEnter",function(_1497,size){var m=dojox.mdnd.areaManager();if(m._oldIndexArea==-1){m._oldIndexArea=m._lastValidIndexArea;}})];},addArea:function(areas,_1498){var _1499=areas.length,_149a=dojo.position(_1498.node,true);_1498.coords={"x":_149a.x,"y":_149a.y};if(_1499==0){areas.push(_1498);}else{var x=_1498.coords.x;for(var i=0;i<_1499;i++){if(x<areas[i].coords.x){for(var j=_1499-1;j>=i;j--){areas[j+1]=areas[j];}areas[i]=_1498;break;}}if(i==_1499){areas.push(_1498);}}return areas;},updateAreas:function(_149b){var _149c=_149b.length;for(var i=0;i<_149c;i++){this._updateArea(_149b[i]);}},_updateArea:function(area){var _149d=dojo.position(area.node,true);area.coords.x=_149d.x;area.coords.x2=_149d.x+_149d.w;area.coords.y=_149d.y;},initItems:function(area){dojo.forEach(area.items,function(obj){var node=obj.item.node;var _149e=dojo.position(node,true);var y=_149e.y+_149e.h/2;obj.y=y;});area.initItems=true;},refreshItems:function(area,_149f,size,added){if(_149f==-1){return;}else{if(area&&size&&size.h){var _14a0=size.h;if(area.margin){_14a0+=area.margin.t;}var _14a1=area.items.length;for(var i=_149f;i<_14a1;i++){var item=area.items[i];if(added){item.y+=_14a0;}else{item.y-=_14a0;}}}}},getDragPoint:function(_14a2,size,_14a3){return {"x":_14a3.x,"y":_14a3.y};},getTargetArea:function(_14a4,_14a5,_14a6){var index=0;var x=_14a5.x;var y=_14a5.y;var end=_14a4.length;var start=0,_14a7="right",_14a8=false;if(_14a6==-1||arguments.length<3){_14a8=true;}else{if(this._checkInterval(_14a4,_14a6,x,y)){index=_14a6;}else{if(this._oldXPoint<x){start=_14a6+1;}else{start=_14a6-1;end=0;_14a7="left";}_14a8=true;}}if(_14a8){if(_14a7==="right"){for(var i=start;i<end;i++){if(this._checkInterval(_14a4,i,x,y)){index=i;break;}}if(i==end){index=-1;}}else{for(var i=start;i>=end;i--){if(this._checkInterval(_14a4,i,x,y)){index=i;break;}}if(i==end-1){index=-1;}}}this._oldXPoint=x;return index;},_checkInterval:function(_14a9,index,x,y){var area=_14a9[index];var node=area.node;var _14aa=area.coords;var _14ab=_14aa.x;var endX=_14aa.x2;var _14ac=_14aa.y;var endY=_14ac+node.offsetHeight;if(_14ab<=x&&x<=endX&&_14ac<=y&&y<=endY){return true;}return false;},getDropIndex:function(_14ad,_14ae){var _14af=_14ad.items.length;var _14b0=_14ad.coords;var y=_14ae.y;if(_14af>0){for(var i=0;i<_14af;i++){if(y<_14ad.items[i].y){return i;}else{if(i==_14af-1){return -1;}}}}return -1;},destroy:function(){dojo.forEach(this._dragHandler,dojo.disconnect);}});(function(){dojox.mdnd.areaManager()._dropMode=new dojox.mdnd.dropMode.OverDropMode();}());}if(!dojo._hasResource["dojox.mdnd.AutoScroll"]){dojo._hasResource["dojox.mdnd.AutoScroll"]=true;dojo.provide("dojox.mdnd.AutoScroll");dojo.declare("dojox.mdnd.AutoScroll",null,{interval:3,recursiveTimer:10,marginMouse:50,constructor:function(){this.resizeHandler=dojo.connect(dojo.global,"onresize",this,function(){this.getViewport();});dojo.ready(dojo.hitch(this,"init"));},init:function(){this._html=(dojo.isWebKit)?dojo.body():dojo.body().parentNode;this.getViewport();},getViewport:function(){var d=dojo.doc,dd=d.documentElement,w=window,b=dojo.body();if(dojo.isMozilla){this._v={"w":dd.clientWidth,"h":w.innerHeight};}else{if(!dojo.isOpera&&w.innerWidth){this._v={"w":w.innerWidth,"h":w.innerHeight};}else{if(!dojo.isOpera&&dd&&dd.clientWidth){this._v={"w":dd.clientWidth,"h":dd.clientHeight};}else{if(b.clientWidth){this._v={"w":b.clientWidth,"h":b.clientHeight};}}}}},setAutoScrollNode:function(node){this._node=node;},setAutoScrollMaxPage:function(){this._yMax=this._html.scrollHeight;this._xMax=this._html.scrollWidth;},checkAutoScroll:function(e){if(this._autoScrollActive){this.stopAutoScroll();}this._y=e.pageY;this._x=e.pageX;if(e.clientX<this.marginMouse){this._autoScrollActive=true;this._autoScrollLeft(e);}else{if(e.clientX>this._v.w-this.marginMouse){this._autoScrollActive=true;this._autoScrollRight(e);}}if(e.clientY<this.marginMouse){this._autoScrollActive=true;this._autoScrollUp(e);}else{if(e.clientY>this._v.h-this.marginMouse){this._autoScrollActive=true;this._autoScrollDown();}}},_autoScrollDown:function(){if(this._timer){clearTimeout(this._timer);}if(this._autoScrollActive&&this._y+this.marginMouse<this._yMax){this._html.scrollTop+=this.interval;this._node.style.top=(parseInt(this._node.style.top)+this.interval)+"px";this._y+=this.interval;this._timer=setTimeout(dojo.hitch(this,"_autoScrollDown"),this.recursiveTimer);}},_autoScrollUp:function(){if(this._timer){clearTimeout(this._timer);}if(this._autoScrollActive&&this._y-this.marginMouse>0){this._html.scrollTop-=this.interval;this._node.style.top=(parseInt(this._node.style.top)-this.interval)+"px";this._y-=this.interval;this._timer=setTimeout(dojo.hitch(this,"_autoScrollUp"),this.recursiveTimer);}},_autoScrollRight:function(){if(this._timer){clearTimeout(this._timer);}if(this._autoScrollActive&&this._x+this.marginMouse<this._xMax){this._html.scrollLeft+=this.interval;this._node.style.left=(parseInt(this._node.style.left)+this.interval)+"px";this._x+=this.interval;this._timer=setTimeout(dojo.hitch(this,"_autoScrollRight"),this.recursiveTimer);}},_autoScrollLeft:function(e){if(this._timer){clearTimeout(this._timer);}if(this._autoScrollActive&&this._x-this.marginMouse>0){this._html.scrollLeft-=this.interval;this._node.style.left=(parseInt(this._node.style.left)-this.interval)+"px";this._x-=this.interval;this._timer=setTimeout(dojo.hitch(this,"_autoScrollLeft"),this.recursiveTimer);}},stopAutoScroll:function(){if(this._timer){clearTimeout(this._timer);}this._autoScrollActive=false;},destroy:function(){dojo.disconnect(this.resizeHandler);}});dojox.mdnd.autoScroll=null;(function(){dojox.mdnd.autoScroll=new dojox.mdnd.AutoScroll();}());}if(!dojo._hasResource["dojox.layout.GridContainerLite"]){dojo._hasResource["dojox.layout.GridContainerLite"]=true;dojo.provide("dojox.layout.GridContainerLite");dojo.declare("dojox.layout.GridContainerLite",[dijit.layout._LayoutWidget,dijit._Templated],{autoRefresh:true,templateString:dojo.cache("dojox.layout","resources/GridContainer.html","<div id=\"${id}\" class=\"gridContainer\" dojoAttachPoint=\"containerNode\" tabIndex=\"0\" dojoAttachEvent=\"onkeypress:_selectFocus\">\n\t<div dojoAttachPoint=\"gridContainerDiv\">\n\t\t<table class=\"gridContainerTable\" dojoAttachPoint=\"gridContainerTable\" cellspacing=\"0\" cellpadding=\"0\">\n\t\t\t<tbody>\n\t\t\t\t<tr dojoAttachPoint=\"gridNode\" >\n\t\t\t\t\t\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</div>\n"),dragHandleClass:"dojoxDragHandle",nbZones:1,doLayout:true,isAutoOrganized:true,acceptTypes:[],colWidths:"",constructor:function(props,node){this.acceptTypes=(props||{}).acceptTypes||["text"];this._disabled=true;},postCreate:function(){this.inherited(arguments);this._grid=[];this._createCells();this.subscribe("/dojox/mdnd/drop","resizeChildAfterDrop");this.subscribe("/dojox/mdnd/drag/start","resizeChildAfterDragStart");this._dragManager=dojox.mdnd.areaManager();this._dragManager.autoRefresh=this.autoRefresh;this._dragManager.dragHandleClass=this.dragHandleClass;if(this.doLayout){this._border={"h":(dojo.isIE)?dojo._getBorderExtents(this.gridContainerTable).h:0,"w":(dojo.isIE==6)?1:0};}else{dojo.style(this.domNode,"overflowY","hidden");dojo.style(this.gridContainerTable,"height","auto");}this.inherited(arguments);},startup:function(){if(this._started){return;}if(this.isAutoOrganized){this._organizeChildren();}else{this._organizeChildrenManually();}dojo.forEach(this.getChildren(),function(child){child.startup();});if(this._isShown()){this.enableDnd();}this.inherited(arguments);},resizeChildAfterDrop:function(node,_14b1,_14b2){if(this._disabled){return false;}if(dijit.getEnclosingWidget(_14b1.node)==this){var _14b3=dijit.byNode(node);if(_14b3.resize&&dojo.isFunction(_14b3.resize)){_14b3.resize();}_14b3.set("column",node.parentNode.cellIndex);if(this.doLayout){var _14b4=this._contentBox.h,_14b5=dojo.contentBox(this.gridContainerDiv).h;if(_14b5>=_14b4){dojo.style(this.gridContainerTable,"height",(_14b4-this._border.h)+"px");}}return true;}return false;},resizeChildAfterDragStart:function(node,_14b6,_14b7){if(this._disabled){return false;}if(dijit.getEnclosingWidget(_14b6.node)==this){this._draggedNode=node;if(this.doLayout){dojo.marginBox(this.gridContainerTable,{"h":dojo.contentBox(this.gridContainerDiv).h-this._border.h});}return true;}return false;},getChildren:function(){var _14b8=[];dojo.forEach(this._grid,function(_14b9){_14b8=_14b8.concat(dojo.query("> [widgetId]",_14b9.node).map(dijit.byNode));});return _14b8;},_isShown:function(){if("open" in this){return this.open;}else{var node=this.domNode;return (node.style.display!="none")&&(node.style.visibility!="hidden")&&!dojo.hasClass(node,"dijitHidden");}},layout:function(){if(this.doLayout){var _14ba=this._contentBox;dojo.marginBox(this.gridContainerTable,{"h":_14ba.h-this._border.h});dojo.contentBox(this.domNode,{"w":_14ba.w-this._border.w});}dojo.forEach(this.getChildren(),function(_14bb){if(_14bb.resize&&dojo.isFunction(_14bb.resize)){_14bb.resize();}});},onShow:function(){if(this._disabled){this.enableDnd();}},onHide:function(){if(!this._disabled){this.disableDnd();}},_createCells:function(){if(this.nbZones===0){this.nbZones=1;}var _14bc=this.acceptTypes.join(","),i=0;var _14bd=this.colWidths||[];var _14be=[];var _14bf;var _14c0=0;for(i=0;i<this.nbZones;i++){if(_14be.length<_14bd.length){_14c0+=_14bd[i];_14be.push(_14bd[i]);}else{if(!_14bf){_14bf=(100-_14c0)/(this.nbZones-i);}_14be.push(_14bf);}}i=0;while(i<this.nbZones){this._grid.push({"node":dojo.create("td",{"class":"gridContainerZone","accept":_14bc,"id":this.id+"_dz"+i,"style":{"width":_14be[i]+"%"}},this.gridNode)});i++;}},_getZonesAttr:function(){return dojo.query(".gridContainerZone",this.containerNode);},enableDnd:function(){var m=this._dragManager;dojo.forEach(this._grid,function(_14c1){m.registerByNode(_14c1.node);});m._dropMode.updateAreas(m._areaList);this._disabled=false;},disableDnd:function(){var m=this._dragManager;dojo.forEach(this._grid,function(_14c2){m.unregister(_14c2.node);});m._dropMode.updateAreas(m._areaList);this._disabled=true;},_organizeChildren:function(){var _14c3=dojox.layout.GridContainerLite.superclass.getChildren.call(this);var _14c4=this.nbZones,_14c5=Math.floor(_14c3.length/_14c4),mod=_14c3.length%_14c4,i=0;for(var z=0;z<_14c4;z++){for(var r=0;r<_14c5;r++){this._insertChild(_14c3[i],z);i++;}if(mod>0){try{this._insertChild(_14c3[i],z);i++;}catch(e){console.error("Unable to insert child in GridContainer",e);}mod--;}else{if(_14c5===0){break;}}}},_organizeChildrenManually:function(){var _14c6=dojox.layout.GridContainerLite.superclass.getChildren.call(this),_14c7=_14c6.length,child;for(var i=0;i<_14c7;i++){child=_14c6[i];try{this._insertChild(child,child.column-1);}catch(e){console.error("Unable to insert child in GridContainer",e);}}},_insertChild:function(child,_14c8,p){var zone=this._grid[_14c8].node,_14c9=zone.childNodes.length;if(typeof (p)==undefined||p>_14c9){p=_14c9;}if(this._disabled){dojo.place(child.domNode,zone,p);dojo.attr(child.domNode,"tabIndex","0");}else{if(!child.dragRestriction){this._dragManager.addDragItem(zone,child.domNode,p,true);}else{dojo.place(child.domNode,zone,p);dojo.attr(child.domNode,"tabIndex","0");}}child.set("column",_14c8);return child;},removeChild:function(_14ca){if(this._disabled){this.inherited(arguments);}else{this._dragManager.removeDragItem(_14ca.domNode.parentNode,_14ca.domNode);}},addService:function(child,_14cb,p){dojo.deprecated("addService is deprecated.","Please use  instead.","Future");this.addChild(child,_14cb,p);},addChild:function(child,_14cc,p){child.domNode.id=child.id;dojox.layout.GridContainerLite.superclass.addChild.call(this,child,0);if(_14cc<0||_14cc==undefined){_14cc=0;}if(p<=0){p=0;}try{return this._insertChild(child,_14cc,p);}catch(e){console.error("Unable to insert child in GridContainer",e);}return null;},_setColWidthsAttr:function(value){this.colWidths=dojo.isString(value)?value.split(","):(dojo.isArray(value)?value:[value]);if(this._started){this._updateColumnsWidth();}},_updateColumnsWidth:function(_14cd){var _14ce=this._grid.length;var _14cf=this.colWidths||[];var _14d0=[];var _14d1;var _14d2=0;var i;for(i=0;i<_14ce;i++){if(_14d0.length<_14cf.length){_14d2+=_14cf[i]*1;_14d0.push(_14cf[i]);}else{if(!_14d1){_14d1=(100-_14d2)/(this.nbZones-i);if(_14d1<0){_14d1=100/this.nbZones;}}_14d0.push(_14d1);_14d2+=_14d1*1;}}if(_14d2>100){var _14d3=100/_14d2;for(i=0;i<_14d0.length;i++){_14d0[i]*=_14d3;}}for(i=0;i<_14ce;i++){this._grid[i].node.style.width=_14d0[i]+"%";}},_selectFocus:function(event){if(this._disabled){return;}var key=event.keyCode,k=dojo.keys,zone=null,focus=dijit.getFocus(),_14d4=focus.node,m=this._dragManager,found,i,j,r,_14d5,area,_14d6;if(_14d4==this.containerNode){area=this.gridNode.childNodes;switch(key){case k.DOWN_ARROW:case k.RIGHT_ARROW:found=false;for(i=0;i<area.length;i++){_14d5=area[i].childNodes;for(j=0;j<_14d5.length;j++){zone=_14d5[j];if(zone!=null&&zone.style.display!="none"){dijit.focus(zone);dojo.stopEvent(event);found=true;break;}}if(found){break;}}break;case k.UP_ARROW:case k.LEFT_ARROW:area=this.gridNode.childNodes;found=false;for(i=area.length-1;i>=0;i--){_14d5=area[i].childNodes;for(j=_14d5.length;j>=0;j--){zone=_14d5[j];if(zone!=null&&zone.style.display!="none"){dijit.focus(zone);dojo.stopEvent(event);found=true;break;}}if(found){break;}}break;}}else{if(_14d4.parentNode.parentNode==this.gridNode){var child=(key==k.UP_ARROW||key==k.LEFT_ARROW)?"lastChild":"firstChild";var pos=(key==k.UP_ARROW||key==k.LEFT_ARROW)?"previousSibling":"nextSibling";switch(key){case k.UP_ARROW:case k.DOWN_ARROW:dojo.stopEvent(event);found=false;var _14d7=_14d4;while(!found){_14d5=_14d7.parentNode.childNodes;var num=0;for(i=0;i<_14d5.length;i++){if(_14d5[i].style.display!="none"){num++;}if(num>1){break;}}if(num==1){return;}if(_14d7[pos]==null){zone=_14d7.parentNode[child];}else{zone=_14d7[pos];}if(zone.style.display==="none"){_14d7=zone;}else{found=true;}}if(event.shiftKey){var _14d8=_14d4.parentNode;for(i=0;i<this.gridNode.childNodes.length;i++){if(_14d8==this.gridNode.childNodes[i]){break;}}_14d5=this.gridNode.childNodes[i].childNodes;for(j=0;j<_14d5.length;j++){if(zone==_14d5[j]){break;}}if(dojo.isMoz||dojo.isWebKit){i--;}_14d6=dijit.byNode(_14d4);if(!_14d6.dragRestriction){r=m.removeDragItem(_14d8,_14d4);this.addChild(_14d6,i,j);dojo.attr(_14d4,"tabIndex","0");dijit.focus(_14d4);}else{dojo.publish("/dojox/layout/gridContainer/moveRestriction",[this]);}}else{dijit.focus(zone);}break;case k.RIGHT_ARROW:case k.LEFT_ARROW:dojo.stopEvent(event);if(event.shiftKey){var z=0;if(_14d4.parentNode[pos]==null){if(dojo.isIE&&key==k.LEFT_ARROW){z=this.gridNode.childNodes.length-1;}}else{if(_14d4.parentNode[pos].nodeType==3){z=this.gridNode.childNodes.length-2;}else{for(i=0;i<this.gridNode.childNodes.length;i++){if(_14d4.parentNode[pos]==this.gridNode.childNodes[i]){break;}z++;}if(dojo.isMoz||dojo.isWebKit){z--;}}}_14d6=dijit.byNode(_14d4);var _14d9=_14d4.getAttribute("dndtype");if(_14d9==null){if(_14d6&&_14d6.dndType){_14d9=_14d6.dndType.split(/\s*,\s*/);}else{_14d9=["text"];}}else{_14d9=_14d9.split(/\s*,\s*/);}var _14da=false;for(i=0;i<this.acceptTypes.length;i++){for(j=0;j<_14d9.length;j++){if(_14d9[j]==this.acceptTypes[i]){_14da=true;break;}}}if(_14da&&!_14d6.dragRestriction){var _14db=_14d4.parentNode,place=0;if(k.LEFT_ARROW==key){var t=z;if(dojo.isMoz||dojo.isWebKit){t=z+1;}place=this.gridNode.childNodes[t].childNodes.length;}r=m.removeDragItem(_14db,_14d4);this.addChild(_14d6,z,place);dojo.attr(r,"tabIndex","0");dijit.focus(r);}else{dojo.publish("/dojox/layout/gridContainer/moveRestriction",[this]);}}else{var node=_14d4.parentNode;while(zone===null){if(node[pos]!==null&&node[pos].nodeType!==3){node=node[pos];}else{if(pos==="previousSibling"){node=node.parentNode.childNodes[node.parentNode.childNodes.length-1];}else{node=(dojo.isIE)?node.parentNode.childNodes[0]:node.parentNode.childNodes[1];}}zone=node[child];if(zone&&zone.style.display=="none"){_14d5=zone.parentNode.childNodes;var _14dc=null;if(pos=="previousSibling"){for(i=_14d5.length-1;i>=0;i--){if(_14d5[i].style.display!="none"){_14dc=_14d5[i];break;}}}else{for(i=0;i<_14d5.length;i++){if(_14d5[i].style.display!="none"){_14dc=_14d5[i];break;}}}if(!_14dc){_14d4=zone;node=_14d4.parentNode;zone=null;}else{zone=_14dc;}}}dijit.focus(zone);}break;}}}},destroy:function(){var m=this._dragManager;dojo.forEach(this._grid,function(_14dd){m.unregister(_14dd.node);});this.inherited(arguments);}});dojo.extend(dijit._Widget,{column:"1",dragRestriction:false});}if(!dojo._hasResource["dojox.layout.GridContainer"]){dojo._hasResource["dojox.layout.GridContainer"]=true;dojo.provide("dojox.layout.GridContainer");dojo.declare("dojox.layout.GridContainer",dojox.layout.GridContainerLite,{hasResizableColumns:true,liveResizeColumns:false,minColWidth:20,minChildWidth:150,mode:"right",isRightFixed:false,isLeftFixed:false,startup:function(){this.inherited(arguments);if(this.hasResizableColumns){for(var i=0;i<this._grid.length-1;i++){this._createGrip(i);}if(!this.getParent()){dojo.ready(dojo.hitch(this,"_placeGrips"));}}},resizeChildAfterDrop:function(node,_14de,_14df){if(this.inherited(arguments)){this._placeGrips();}},onShow:function(){this.inherited(arguments);this._placeGrips();},resize:function(){this.inherited(arguments);if(this._isShown()&&this.hasResizableColumns){this._placeGrips();}},_createGrip:function(index){var _14e0=this._grid[index],grip=dojo.create("div",{"class":"gridContainerGrip"},this.domNode);_14e0.grip=grip;_14e0.gripHandler=[this.connect(grip,"onmouseover",function(e){var _14e1=false;for(var i=0;i<this._grid.length-1;i++){if(dojo.hasClass(this._grid[i].grip,"gridContainerGripShow")){_14e1=true;break;}}if(!_14e1){dojo.removeClass(e.target,"gridContainerGrip");dojo.addClass(e.target,"gridContainerGripShow");}})[0],this.connect(grip,"onmouseout",function(e){if(!this._isResized){dojo.removeClass(e.target,"gridContainerGripShow");dojo.addClass(e.target,"gridContainerGrip");}})[0],this.connect(grip,"onmousedown","_resizeColumnOn")[0],this.connect(grip,"ondblclick","_onGripDbClick")[0]];},_placeGrips:function(){var _14e2,_14e3,left=0,grip;var _14e4=this.domNode.style.overflowY;dojo.forEach(this._grid,function(_14e5){if(_14e5.grip){grip=_14e5.grip;if(!_14e2){_14e2=grip.offsetWidth/2;}left+=dojo.marginBox(_14e5.node).w;dojo.style(grip,"left",(left-_14e2)+"px");if(!_14e3){_14e3=dojo.contentBox(this.gridNode).h;}if(_14e3>0){dojo.style(grip,"height",_14e3+"px");}}},this);},_onGripDbClick:function(){this._updateColumnsWidth(this._dragManager);this.resize();},_resizeColumnOn:function(e){this._activeGrip=e.target;this._initX=e.pageX;e.preventDefault();dojo.body().style.cursor="ew-resize";this._isResized=true;var _14e6=[];var grid;var i;for(i=0;i<this._grid.length;i++){_14e6[i]=dojo.contentBox(this._grid[i].node).w;}this._oldTabSize=_14e6;for(i=0;i<this._grid.length;i++){grid=this._grid[i];if(this._activeGrip==grid.grip){this._currentColumn=grid.node;this._currentColumnWidth=_14e6[i];this._nextColumn=this._grid[i+1].node;this._nextColumnWidth=_14e6[i+1];}grid.node.style.width=_14e6[i]+"px";}var _14e7=function(_14e8,_14e9){var width=0;var _14ea=0;dojo.forEach(_14e8,function(child){if(child.nodeType==1){var _14eb=dojo.getComputedStyle(child);var _14ec=(dojo.isIE)?_14e9:parseInt(_14eb.minWidth);_14ea=_14ec+parseInt(_14eb.marginLeft)+parseInt(_14eb.marginRight);if(width<_14ea){width=_14ea;}}});return width;};var _14ed=_14e7(this._currentColumn.childNodes,this.minChildWidth);var _14ee=_14e7(this._nextColumn.childNodes,this.minChildWidth);var _14ef=Math.round((dojo.marginBox(this.gridContainerTable).w*this.minColWidth)/100);this._currentMinCol=_14ed;this._nextMinCol=_14ee;if(_14ef>this._currentMinCol){this._currentMinCol=_14ef;}if(_14ef>this._nextMinCol){this._nextMinCol=_14ef;}this._connectResizeColumnMove=dojo.connect(dojo.doc,"onmousemove",this,"_resizeColumnMove");this._connectOnGripMouseUp=dojo.connect(dojo.doc,"onmouseup",this,"_onGripMouseUp");},_onGripMouseUp:function(){dojo.body().style.cursor="default";dojo.disconnect(this._connectResizeColumnMove);dojo.disconnect(this._connectOnGripMouseUp);this._connectOnGripMouseUp=this._connectResizeColumnMove=null;if(this._activeGrip){dojo.removeClass(this._activeGrip,"gridContainerGripShow");dojo.addClass(this._activeGrip,"gridContainerGrip");}this._isResized=false;},_resizeColumnMove:function(e){e.preventDefault();if(!this._connectResizeColumnOff){dojo.disconnect(this._connectOnGripMouseUp);this._connectOnGripMouseUp=null;this._connectResizeColumnOff=dojo.connect(dojo.doc,"onmouseup",this,"_resizeColumnOff");}var d=e.pageX-this._initX;if(d==0){return;}if(!(this._currentColumnWidth+d<this._currentMinCol||this._nextColumnWidth-d<this._nextMinCol)){this._currentColumnWidth+=d;this._nextColumnWidth-=d;this._initX=e.pageX;this._activeGrip.style.left=parseInt(this._activeGrip.style.left)+d+"px";if(this.liveResizeColumns){this._currentColumn.style["width"]=this._currentColumnWidth+"px";this._nextColumn.style["width"]=this._nextColumnWidth+"px";this.resize();}}},_resizeColumnOff:function(e){dojo.body().style.cursor="default";dojo.disconnect(this._connectResizeColumnMove);dojo.disconnect(this._connectResizeColumnOff);this._connectResizeColumnOff=this._connectResizeColumnMove=null;if(!this.liveResizeColumns){this._currentColumn.style["width"]=this._currentColumnWidth+"px";this._nextColumn.style["width"]=this._nextColumnWidth+"px";}var _14f0=[],_14f1=[],_14f2=this.gridContainerTable.clientWidth,node,_14f3=false,i;for(i=0;i<this._grid.length;i++){node=this._grid[i].node;if(dojo.isIE){_14f0[i]=dojo.marginBox(node).w;_14f1[i]=dojo.contentBox(node).w;}else{_14f0[i]=dojo.contentBox(node).w;_14f1=_14f0;}}for(i=0;i<_14f1.length;i++){if(_14f1[i]!=this._oldTabSize[i]){_14f3=true;break;}}if(_14f3){var mul=dojo.isIE?100:10000;for(i=0;i<this._grid.length;i++){this._grid[i].node.style.width=Math.round((100*mul*_14f0[i])/_14f2)/mul+"%";}this.resize();}if(this._activeGrip){dojo.removeClass(this._activeGrip,"gridContainerGripShow");dojo.addClass(this._activeGrip,"gridContainerGrip");}this._isResized=false;},setColumns:function(_14f4){var z,j;if(_14f4>0){var _14f5=this._grid.length,delta=_14f5-_14f4;if(delta>0){var count=[],zone,start,end,_14f6;if(this.mode=="right"){end=(this.isLeftFixed&&_14f5>0)?1:0;start=(this.isRightFixed)?_14f5-2:_14f5-1;for(z=start;z>=end;z--){_14f6=0;zone=this._grid[z].node;for(j=0;j<zone.childNodes.length;j++){if(zone.childNodes[j].nodeType==1&&!(zone.childNodes[j].id=="")){_14f6++;break;}}if(_14f6==0){count[count.length]=z;}if(count.length>=delta){this._deleteColumn(count);break;}}if(count.length<delta){dojo.publish("/dojox/layout/gridContainer/noEmptyColumn",[this]);}}else{start=(this.isLeftFixed&&_14f5>0)?1:0;end=(this.isRightFixed)?_14f5-1:_14f5;for(z=start;z<end;z++){_14f6=0;zone=this._grid[z].node;for(j=0;j<zone.childNodes.length;j++){if(zone.childNodes[j].nodeType==1&&!(zone.childNodes[j].id=="")){_14f6++;break;}}if(_14f6==0){count[count.length]=z;}if(count.length>=delta){this._deleteColumn(count);break;}}if(count.length<delta){dojo.publish("/dojox/layout/gridContainer/noEmptyColumn",[this]);}}}else{if(delta<0){this._addColumn(Math.abs(delta));}}if(this.hasResizableColumns){this._placeGrips();}}},_addColumn:function(_14f7){var grid=this._grid,_14f8,node,index,_14f9,_14fa=(this.mode=="right"),_14fb=this.acceptTypes.join(","),m=this._dragManager;if(this.hasResizableColumns&&((!this.isRightFixed&&_14fa)||(this.isLeftFixed&&!_14fa&&this.nbZones==1))){this._createGrip(grid.length-1);}for(var i=0;i<_14f7;i++){node=dojo.create("td",{"class":"gridContainerZone dojoxDndArea","accept":_14fb,"id":this.id+"_dz"+this.nbZones});_14f9=grid.length;if(_14fa){if(this.isRightFixed){index=_14f9-1;grid.splice(index,0,{"node":grid[index].node.parentNode.insertBefore(node,grid[index].node)});}else{index=_14f9;grid.push({"node":this.gridNode.appendChild(node)});}}else{if(this.isLeftFixed){index=(_14f9==1)?0:1;this._grid.splice(1,0,{"node":this._grid[index].node.parentNode.appendChild(node,this._grid[index].node)});index=1;}else{index=_14f9-this.nbZones;this._grid.splice(index,0,{"node":grid[index].node.parentNode.insertBefore(node,grid[index].node)});}}if(this.hasResizableColumns){if((!_14fa&&this.nbZones!=1)||(!_14fa&&this.nbZones==1&&!this.isLeftFixed)||(_14fa&&i<_14f7-1)||(_14fa&&i==_14f7-1&&this.isRightFixed)){this._createGrip(index);}}m.registerByNode(grid[index].node);this.nbZones++;}this._updateColumnsWidth(m);},_deleteColumn:function(_14fc){var child,grid,index,_14fd=0,_14fe=_14fc.length,m=this._dragManager;for(var i=0;i<_14fe;i++){index=(this.mode=="right")?_14fc[i]:_14fc[i]-_14fd;grid=this._grid[index];if(this.hasResizableColumns&&grid.grip){dojo.forEach(grid.gripHandler,function(_14ff){dojo.disconnect(_14ff);});dojo.destroy(this.domNode.removeChild(grid.grip));grid.grip=null;}m.unregister(grid.node);dojo.destroy(this.gridNode.removeChild(grid.node));this._grid.splice(index,1);this.nbZones--;_14fd++;}var _1500=this._grid[this.nbZones-1];if(_1500.grip){dojo.forEach(_1500.gripHandler,dojo.disconnect);dojo.destroy(this.domNode.removeChild(_1500.grip));_1500.grip=null;}this._updateColumnsWidth(m);},_updateColumnsWidth:function(_1501){this.inherited(arguments);_1501._dropMode.updateAreas(_1501._areaList);},destroy:function(){dojo.unsubscribe(this._dropHandler);this.inherited(arguments);}});}if(!dojo._hasResource["plugins.dijit.TitlePane"]){dojo._hasResource["plugins.dijit.TitlePane"]=true;dojo.provide("plugins.dijit.TitlePane");dojo.declare("plugins.dijit.TitlePane",[dijit.TitlePane],{templateString:dojo.cache("plugins","dijit/templates/TitlePane.html","<div>\n\t<div dojoAttachEvent=\"onclick:_onTitleClick, onkeypress:_onTitleKey\"\n\t\t\tclass=\"dijitTitlePaneTitle\" dojoAttachPoint=\"titleBarNode\">\n\t\t<div class=\"dijitTitlePaneTitleFocus\" dojoAttachPoint=\"focusNode\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"arrowNode\" class=\"dijitArrowNode\" role=\"presentation\"\n\t\t\t/><span dojoAttachPoint=\"arrowNodeInner\" class=\"dijitArrowNodeInner\"></span\n\t\t\t><span dojoAttachPoint=\"titleNode\" class=\"dijitTitlePaneTextNode\"></span\n\t\t\t><span dojoAttachPoint=\"numberNode\" class=\"dijitTitlePaneNumberNode\"></span>\n\t\t</div>\n\t</div>\n\t<div class=\"dijitTitlePaneContentOuter\" dojoAttachPoint=\"hideNode\" role=\"presentation\">\n\t\t<div class=\"dijitReset\" dojoAttachPoint=\"wipeNode\" role=\"presentation\">\n\t\t\t<div class=\"dijitTitlePaneContentInner\" dojoAttachPoint=\"containerNode\" role=\"region\" id=\"${id}_pane\">\n\t\t\t\t<!-- nested divs because wipeIn()/wipeOut() doesn't work right on node w/padding etc.  Put padding on inner div. -->\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n"),number:null,attributeMap:dojo.delegate(dijit.layout.ContentPane.prototype.attributeMap,{title:{node:"titleNode",type:"innerHTML"},number:{node:"numberNode",type:"innerHTML"},tooltip:{node:"focusNode",type:"attribute",attribute:"title"},id:""}),setNumber:function(_1502){dojo.deprecated("dijit.TitlePane.setNumber() is deprecated.  Use set('number', ...) instead.","","2.0");this.set("number",_1502);}});}if(!dojo._hasResource["plugins.workflow.GridStage"]){dojo._hasResource["plugins.workflow.GridStage"]=true;dojo.provide("plugins.workflow.GridStage");dojo.declare("plugins.workflow.GridStage",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table\n        class=\"stagerow\"\n        cellspacing=\"0px\"\n        height=\"16px\" width=\"100%\" style=\"padding: 0; margin: 0; height: 16px !important;\">\n        <tr>\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"nameNode\"\n                class=\"name\"\n                >${name}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"numberNode\"\n                class=\"number\">\n            </td>\n        </tr>\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"executorNode\"\n                class=\"executor\"\n                style=\"display: none;\" >${executor}\n            </td>\n\n            <td \n                colspan=\"2\"\n                dojoAttachPoint=\"submitNode\"\n                class=\"\"\n                style=\"display: none;\" >\n            </td>\n            \n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"locationNode\"\n                class='location'\n                style=\"display: none;\" >${location}\n            </td>\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"descriptionNode\"\n                class='description'\n                style=\"display: none;\" >${description}\n            </td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/stagerow.css"],parentWidget:null,application:null,core:null,postCreate:function(){this.startup();},constructor:function(args){this.loadCSS();this.core=args.core;this.parentWidget=args.parentWidget;this.application=new Object;for(var key in args){if(key!="parentWidget"){this.application[key]=args[key];}}},startup:function(){this.inherited(arguments);this.name.parentWidget=this;var _1503=this;dojo.connect(this.nameNode,"onclick",function(event){event.stopPropagation();_1503.toggle();});},toggle:function(){var array=["executor","submit","location","description"];for(var i in array){var _1504=array[i]+"Node";if(this[_1504].style.display=="table-cell"){this[_1504].style.display="none";}else{this[_1504].style.display="table-cell";}}},checkAllParameters:function(force){this.isValid=true;var _1505=new Array;var _1506=new Array;if(this.core.parameters!=null&&this.core.parameters.isCurrentApplication(this.application)){_1505=this.core.parameters.childWidgets;for(var i=0;i<this.core.parameters.childWidgets.length;i++){_1506.push(this.core.parameters.childWidgets[i].parameterObject);}}else{_1506=Agua.getStageParameters(this.application);}if(_1506==null){return false;}this.fileStageParameters=new Array;this.fileParameterRows=new Array;for(var i=0;i<_1506.length;i++){_1506[i].value=this.systemVariables(_1506[i].value,_1506[i]);var _1507=Agua.getParameterValidity(_1506[i]);if(force!=true&&_1507!=null){if(_1505[i]!=null){if(_1507==true){_1505[i].setValid(_1505[i].containerNode);}else{_1505[i].setInvalid(_1505[i].containerNode);this.isValid=false;}}continue;}else{if(_1506[i].valuetype=="flag"){continue;}}if(_1506[i].valuetype=="file"||_1506[i].valuetype=="directory"){this.checkValidFile(_1506[i],_1505[i]);}else{if(_1506[i].valuetype=="integer"){this.checkValidInteger(_1506[i],_1505[i]);}else{this.checkValidText(_1506[i],_1505[i]);}}}if(this.fileStageParameters.length==0){if(this.isValid==false||this.isValid==null){this.setInvalid();}else{this.setValid();}return this.isValid;}},checkValidParameters:function(force){this.checkAllParameters(force);if(this.fileStageParameters.length!=0){this.checkFiles();}},currentParametersApplication:function(_1508){var keys=["project","workflow","workflownumber","name","number"];return this._objectsMatchByKey(_1508,this.core.parameters.application,keys);},checkFiles:function(files){if(files==null){files=this.fileStageParameters;}var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");query.project=this.application.project;query.workflow=this.application.workflow;query.mode="checkFiles";query.files=files;var _1509=this;var _150a=dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:dojo.toJson(query),handle:function(_150b,_150c){_1509.validateFiles(files,_150b);}});if(this.isValid==false||this.isValid==null){this.setInvalid();}else{this.setValid();}return this.isValid;},validateFiles:function(_150d){if(_150d==null||_150d.length==null||!_150d.length){return;}for(var i=0;i<_150d.length;i++){var _150e=this.fileParameterRows[i];Agua.setFileInfo(this.fileStageParameters[i],_150d[i]);if(_150d[i].exists=="true"){if(_150d[i].type!=this.fileStageParameters[i].valuetype){Agua.setParameterValidity(this.fileStageParameters[i],false);this.isValid=false;if(_150e!=null){_150e.setInvalid(_150e.containerNode);}}else{Agua.setParameterValidity(this.fileStageParameters[i],true);if(_150e!=null){_150e.setValid(_150e.containerNode);}}}else{if(this.fileStageParameters[i].discretion=="essential"){this.isValid=false;Agua.setParameterValidity(this.fileStageParameters[i],false);if(_150e!=null){_150e.setInvalid(_150e.containerNode);}}else{Agua.setParameterValidity(this.fileStageParameters[i],true);if(_150e!=null){_150e.setValid(_150e.containerNode);}}}}if(this.isValid==false){this.setInvalid();}else{this.setValid();}},checkValidFile:function(_150f,_1510){var _1511=_150f.value;if(_150f.discretion=="required"||_150f.discretion=="essential"){if(_1511==null||_1511==""){this.setInvalidParameter(_150f,_1510);}else{if(_150f.fileinfo==null){this.fileStageParameters.push(_150f);this.fileParameterRows.push(_1510);}else{if((_150f.fileinfo.exists==false)){if(_150f.chained==null||_150f.chained==0){this.fileStageParameters.push(_150f);this.fileParameterRows.push(_1510);}else{this.setValidParameter(_150f,_1510);}}else{if(_150f.fileinfo.type!=_150f.valuetype){this.setInvalidParameter(_150f,_1510);}else{this.setValidParameter(_150f,_1510);}}}}}else{if(_150f.value==null||_150f.value==""){this.setValidParameter(_150f,_1510);}else{this.fileStageParameters.push(_150f);this.fileParameterRows.push(_1510);}}},checkValidInteger:function(_1512,_1513){if(_1512.discretion!="optional"){if(_1512.value==null||_1512.value==""){this.setInvalidParameter(_1512,_1513);}else{if(!_1512.value.match(/^\s*[\d\.]+\s*$/)){this.isValid=false;Agua.setParameterValidity(_1512,false);}else{this.setValidParameter(_1512,_1513);}}}else{if(_1512.value!=null&&_1512.value!=""&&!_1512.value.match(/^\s*[\d\.]+\s*$/)){this.setInvalidParameter(_1512,_1513);}else{this.setValidParameter(_1512,_1513);}}},checkValidText:function(_1514,_1515){if(_1514.discretion!="optional"){if(_1514.value==null||_1514.value==""){this.setInvalidParameter(_1514,_1515);}else{this.setValidParameter(_1514,_1515);}}else{this.setValidParameter(_1514,_1515);}},setInvalidParameter:function(_1516,_1517){this.isValid=false;Agua.setParameterValidity(_1516,false);if(_1517!=null){_1517.setInvalid(_1517.containerNode);}},setValidParameter:function(_1518,_1519){Agua.setParameterValidity(_1518,true);if(_1519!=null){_1519.setValid(_1519.containerNode);}},setValid:function(){dojo.removeClass(this.domNode,"unsatisfied");dojo.addClass(this.domNode,"satisfied");this.isValid=true;var _151a=this.core.userWorkflows;_151a.updateRunButton();},setInvalid:function(){for(var key in this.core){}dojo.removeClass(this.domNode,"satisfied");dojo.addClass(this.domNode,"unsatisfied");this.isValid=false;var _151b=this.core.userWorkflows;_151b.updateRunButton();}});}if(!dojo._hasResource["plugins.workflow.GridWorkflow"]){dojo._hasResource["plugins.workflow.GridWorkflow"]=true;dojo.provide("plugins.workflow.GridWorkflow");if(1){}dojo.declare("plugins.workflow.GridWorkflow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"titlePane\"\n        dojoType=\"plugins.dijit.TitlePane\"\n        class=\"stageContainer\"\n        title=\"${title}\"\n        number=\"${number}\"\n        style=\"background: #FFF; height: auto; width: 100% !important; min-width: 306px\"\n    >\n        <div\n            dojoAttachPoint=\"dropTargetContainer\"\n        >\n        </div>\n    </div>\n\n</div>\n",widgetsInTemplate:true,cssFiles:[],parentWidget:null,childWidgets:null,attachNode:null,contextMenu:null,core:null,workflowLoaded:null,dropTargetLoaded:null,project:null,workflow:null,number:null,constructor:function(args){this.stages=args.stages;this.core=args.core;this.project=args.project;this.workflow=args.workflow;this.number=args.number;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setStages(this.stages);},setStages:function(_151c){this.clearStages();this.childWidgets=new Array;_151c=this.sortNumericHasharray(_151c,"number");var _151d=new Array;for(var i=0;i<_151c.length;i++){var hash=new Object;hash.data=_151c[i].name;hash.type=["draggableItem"];_151d.push(hash);}console.log("GridWorkflow.setStages     dataArray: ");console.dir({dataArray:_151d});if(this.dropTarget==null){this.dropTarget=new plugins.dnd.Target(this.dropTargetContainer,{accept:[],parentWidget:this});}console.log("GridWorkflow.setStages     this.dropTarget: "+this.dropTarget);this.dropTarget.insertNodes(false,_151d);allNodes=this.dropTarget.getAllNodes();var _151e=this;dojo.forEach(allNodes,function(node,i){_151c[i].description=_151c[i].stagedescription||"";_151c[i].submit=_151c[i].submit||"";var _151f=new plugins.workflow.GridStage(_151c[i]);_151f.parentWidget=_151e;node.innerHTML="";node.appendChild(_151f.domNode);_151e.childWidgets.push(_151f);});},setNumber:function(_1520){this.number=_1520;this.titlePane.set("number",_1520);},clearStages:function(){while(this.dropTargetContainer.firstChild){this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}},getStagesStandby:function(){console.log("GridWorkflow.getStagesStandby    Stages.getStagesStandby()");if(this.standby==null){var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.dropTargetContainer,onClick:"reload",text:"Checking stage inputs",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);}console.log("GridWorkflow.getStagesStandby    this.standby: "+this.standby);return this.standby;}});}if(!dojo._hasResource["plugins.workflow.Grid"]){dojo._hasResource["plugins.workflow.Grid"]=true;dojo.provide("plugins.workflow.Grid");dojo.declare("plugins.workflow.Grid",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\ttitle=\"Projects\"\n\t\tclass=\"grid\"\n\t\tstyle=\"position: relative; min-height: 100px; height: 100%; max-height: auto !important; width: 320px !important; padding: 0 !important;\"\n    >\n\n        <table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td class=\"tabTitle\" align=\"center\">\n                    Projects\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr width=\"100%\" align=\"center\">\n\t\t\t\t<td>\n\t\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t<td class=\"projectIcon\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"projectCombo\"\n\t\t\t\t\t\t\t\t\tclass=\"projectCombo\"\n\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\n\t\t\t<tr width=\"100%\" align=\"center\">\n\t\t\t\t<td>\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"stop\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:confirmStopProject\"\n\t\t\t\t\t\t\t\tclass=\"stop\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"pause\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:confirmPauseProject\"\n\t\t\t\t\t\t\t\tclass=\"pause\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"play\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:startProject\"\n\t\t\t\t\t\t\t\tclass=\"play\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\n\t\t\t<tr width=\"100%\">\n\t\t\t\t<td width=\"100%\">\n\t\t\t\t\t\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tdojoAttachPoint=\"mainPanel\"\n\t\t\t\t\t\t\tdojoType=\"dojox.layout.GridContainer\" \n\t\t\t\t\t\t\tclass=\"workflowContainer\"\n\t\t\t\t\t\t\tnbZones=\"1\"\n\t\t\t\t\t\t\topacity=\"0.7\" \n\t\t\t\t\t\t\tallowAutoScroll=\"true\" \n\t\t\t\t\t\t\thasResizableColumns=\"false\"\n\t\t\t\t\t\t\twithHandles=\"true\"\n\t\t\t\t\t\t\tacceptTypes=\"TitlePane\"\n\t\t\t\t\t\t>\n\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","workflow/css/grid.css"),dojo.moduleUrl("dojo","resources/dojo.css"),dojo.moduleUrl("dijit","themes/tundra/tundra.css"),dojo.moduleUrl("dojox","layout/resources/GridContainer.css"),],parentWidget:null,childWidgets:null,core:null,constructor:function(args){console.log("Grid.constructor     plugins.workflow.Grid.constructor");this.core=args.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("Grid.startup    plugins.workflow.Grid.startup()");this.inherited(arguments);console.log("Grid.startup    Doing this.attachNode.addChild(this.mainTab)");this.attachNode.addChild(this.mainTab);console.log("Grid.startup    Doing this.attachNode.selectChild(this.mainTab)");this.attachNode.selectChild(this.mainTab);this.childWidgets=new Array;this.setProjectCombo();var _1521=this;setTimeout(function(){_1521.setProjectListeners();},100,this);Agua.updater.subscribe(this,"updateProjects");this.setSubscriptions();},updateProjects:function(args){console.log("workflow.Stages.updateProjects    workflow.Stages.updateProjects(args)");console.log("workflow.Stages.updateProjects    args:");console.dir({args:args});this.setProjectCombo();},getProject:function(){return this.projectCombo.get("value");},setProjectCombo:function(_1522){console.log("Grid.setProjectCombo    workflow.Stages.setProjectCombo(projectName)");this.settingProject=true;this.inherited(arguments);if(_1522==null){_1522=this.projectCombo.getValue();}this.setWorkflows(_1522);},setProjectListeners:function(){var _1523=this;dojo.connect(this.projectCombo,"onChange",dojo.hitch(this,function(event){var _1524=event;console.log("Grid.setProjectListeners    onchange event. Doing this.setWorkflowCombo("+_1524+")");console.log("Grid.setProjectListeners    thisObject.settingProject: "+_1523.settingProject);_1523.setWorkflows(_1524);}));},setWorkflows:function(_1525){console.log("Grid.setWorkflows    plugins.workflow.Parameters.setWorkflows(projectName)");console.log("Grid.setWorkflows    projectName: "+_1525);this.clearPanel(this.mainPanel);var _1526=Agua.getWorkflowsByProject(_1525);_1526=this.sortNumericHasharray(_1526,"number");if(_1526==null||_1526==[]){return;}var _1527=this;dojo.forEach(_1526,function(_1528,i){var _1529=_1528.project;var _152a=_1528.name;var _152b=_1528.number;var _152c=Agua.getStagesByWorkflow(_1525,_152a);var _152d=new plugins.workflow.GridWorkflow({title:_152a,project:_1525,workflow:_152a,number:_152b,stages:_152c,core:_1527.core});_1527.addChild(_152d);});},addChild:function(_152e){this.mainPanel.addChild(_152e);this.childWidgets.push(_152e);},setWorkflowStyles:function(){console.log("Grid.setWorkflowStyles     workflow.Parameters.setWorkflowStyles()");var _152f=this.childWidgets;var _1530=new Object;for(var i=0;i<_152f.length;i++){console.log("Grid.setWorkflowStyles     parameterRows["+i+"]: "+_152f[i]);console.log("Grid.setWorkflowStyles     "+_152f[i].name+", parameterRows["+i+"].paramtype: "+_152f[i].paramtype);if(_152f[i].paramtype=="input"){_1530[_152f[i].name]=_152f[i];}}console.dir(_1530);console.log("Grid.setWorkflowStyles     parameterHash:");console.log("Grid.setWorkflowStyles     this.application: "+dojo.toJson(this.application,true));var _1531=Agua.getStageParameters(this.application);console.log("Grid.setWorkflowStyles     stageParameters: "+dojo.toJson(_1531,true));console.log("Grid.setWorkflowStyles     stageParameters.length: "+_1531.length);for(var i=0;i<_1531.length;i++){if(_1531[i].paramtype!="input"){continue;}var _1532=_1530[_1531[i].name];console.log("Grid.setWorkflowStyles    stageParameters[i] "+_1531[i].name+" (paramtype: "+_1531[i].paramtype+") parameterRow: "+_1532);var _1533=Agua.getParameterValidity(_1531[i]);console.log("Grid.setWorkflowStyles     stageParameters["+i+"] '"+_1531[i].name+"' isValid: "+_1533);if(_1533==true||_1533==null){console.log("Grid.setWorkflowStyles     Doing parameterRows["+i+"].setValid()");_1532.setValid(_1532.domNode);}else{_1532.setInvalid(_1532.domNode);}}},clearPanel:function(panel){children=panel.getChildren();while(children!=null&&children.length!=0){panel.removeChild(children[0]);children=panel.getChildren();}},getWorkflowNumber:function(_1534,_1535){if(_1534==null||_1535==null){console.log("Grid.getWorkflow    project or workflow is null. Returning null");return;}return Agua.getWorkflowNumber(_1534,_1535);},updateWorkflowNumber:function(_1536,_1537){console.log("Workflows.updateWorkflowNumber     Workflow.updateWorkflowNumber(workflowObject)");console.log("Workflows.updateWorkflowNumber    workflowObject.project: "+_1536.project);console.log("Workflows.updateWorkflowNumber    workflowObject.workflow: "+_1536.workflow);console.log("Workflows.updateWorkflowNumber    workflowObject.name: "+_1536.name);console.log("Workflows.updateWorkflowNumber    workflowObject.number: "+_1536.number);var addOk=Agua.updateWorkflowNumber(_1536,_1537);if(!addOk){return;}},resetNumbers:function(node,_1538,_1539){console.log("Grid.resetNumbers    plugins.workflow.GridWorkflow.resetNumbers(node, targetArea, indexChild)");console.log("Grid.resetNumbers    indexChild: "+_1539);var _153a=dijit.byNode(node);var _153b={project:_153a.project,name:_153a.title,number:_153a.number};Agua.moveWorkflow(_153b,_1539+1);console.log("Grid.updateWorkflowNumber    DOING renumberWorkflows()");this.renumberWorkflows();console.log("Grid.updateWorkflowNumber    DOING Agua.updater.update('updateClusters')");Agua.updater.update("updateProjects",{originator:this,reload:false});},renumberWorkflows:function(){console.log("Grid.renumberWorkflows     renumberWorkflows()");var _153c=this.mainPanel.getChildren();for(var i=0;i<_153c.length;i++){var _153d=_153c[i];_153d.setNumber(i+1);var _153e=_153d.childWidgets;if(_153e==null){continue;}for(var j=0;j<_153e.length;j++){_153e[j].workflownumber=i+1;}}},confirmStopProject:function(){},confirmPauseProject:function(){},startProject:function(){},setSubscriptions:function(){var _153f=this;dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/over",null,function(arg){console.log("dndToDojo/over");});dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/out",null,function(arg){console.log("dndToDojo/out");});dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/drop",null,function(arg){console.log("dndToDojo/drop");});dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/cancel",null,function(arg){console.log("dndToDojo/cancel");});dojo.subscribe("/dojo/dnd/manager/overSource",function(_1540){console.debug("/dojo/dnd/manager/overSource",_1540);});dojo.subscribe("/dojox/mdnd/drag/start",function(node,_1541,_1542){console.dir({node:node});console.log("Doing /dojox/mdnd/drag/start    targetArea: ");console.dir({targetArea:_1541});console.log("Doing /dojox/mdnd/drag/start    indexChild: "+_1542);});dojo.subscribe("/dojox/mdnd/drop",null,function(node,_1543,_1544){console.log("Doing /dojox/mdnd/drop    node: "+node);console.log("Doing /dojox/mdnd/drop    targetArea: "+_1543);console.dir({targetArea:_1543});console.log("Doing /dojox/mdnd/drop    indexChild: "+_1544);_153f.resetNumbers(node,_1543,_1544);});dojo.subscribe("/dojox/mdnd/dropMode.OverDropMode/getDragPoint",function(node,_1545,_1546){console.log("Doing /dojox/mdnd/dropMode.OverDropMode/getDragPoint    node: "+node);console.log("Doing /dojox/mdnd/drop    targetArea: "+_1545);console.dir({targetArea:_1545});console.log("Doing /dojox/mdnd/drop    indexChild: "+_1546);});}});}if(!dojo._hasResource["plugins.workflow.HistoryPane"]){dojo._hasResource["plugins.workflow.HistoryPane"]=true;dojo.provide("plugins.workflow.HistoryPane");dojo.declare("plugins.workflow.HistoryPane",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<table class=\"historyPaneTable\">\n\t\t<tr>\n\t\t\t<td colspan=\"2\"\n\t\t\t\tclass='displayStatusHeader'\n\t\t\t\tdojoAttachEvent=\"onclick:openWorkflow\"\n\t\t\t\talign=left>${project} ${workflow}</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<div dojoAttachPoint=\"rowsNode\"></div>\n\t\t\t</td>\n\t\t</tr>\n\t\n\t</table>\n\n</div>\n",widgetsInTemplate:true,rows:null,core:null,constructor:function(args){this.rows=args.rows;this.core=args.core;},postMixInProperties:function(){},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);for(var i=0;i<this.rows.length;i++){var _1547=new plugins.workflow.HistoryPaneRow(this.rows[i]);this.rowsNode.innerHTML+=_1547.domNode.innerHTML;}},openWorkflow:function(){var _1548=this.project;var _1549=this.workflow;console.log("HistoryPane.openWorkflow    projectName: "+_1548);console.log("HistoryPane.openWorkflow    workflowName: "+_1549);if(Agua.controllers["workflow"]){Agua.controllers["workflow"].createTab({project:_1548,workflow:_1549});}}});dojo.declare("plugins.workflow.HistoryPaneRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table>\n    <tr>\n        <td colspan=\"2\" class='displayStatusRow value' width='200px'>${number}. ${name} ${status}</td>\n    </tr>\n    <tr>\n        <td class='displayStatusRow key' width='100px' align='right'>Started</td>\n        <td class='displayStatusRow value' width='200px'>${started}</td>\n    </tr>\n    <tr>\n        <td class='displayStatusRow key' width='100px' align='right'>Completed</td>\n        <td class='displayStatusRow value' width='200px'>${completed}</td>\n    </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,core:null,constructor:function(args){this.core=args.core;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);}});}if(!dojo._hasResource["plugins.workflow.History"]){dojo._hasResource["plugins.workflow.History"]=true;dojo.provide("plugins.workflow.History");dojo.declare("plugins.workflow.History",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <!-- HISTORY TAB -->\n    <div\n        dojoAttachPoint=\"mainTab\" \n        dojoType=\"dijit.layout.ContentPane\"\n        title=\"History\"\n        parseOnLoad=\"false\"\n        class=\"history\"\n        style=\" height: 100%; width: 100%; padding: 0 !important;\"\n    >\n\n        <table width=\"100%\">\n            <tr>\n                <td colspan=\"5\" class=\"tabTitle\" align=\"center\">History</td>\n            </tr>\n            <tr>\n                <td width=\"20%\"></td>\n                <td\n                    dojoAttachPoint=\"downloadHistoryButton\"\n                    dojoAttachEvent=\"onclick:downloadHistory\"\n                    class=\"downloadHistoryButton\"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\" >\n                </td>\n                <td width=\"20%\"></td>\n                <td\n                    dojoAttachPoint=\"refreshHistoryButton\"\n                    dojoAttachEvent=\"onclick:showHistory\"\n                    class=\"refreshHistoryButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\" >\n                </td>\n                <td width=\"20%\"></td>\n            </tr>\n            <tr class=\"titles\">\n                <td width=\"20%\"></td>\n                <td width=\"20%\" height=\"12px\" align=\"center\">Download</td>\n                <td width=\"20%\"></td>\n                <td width=\"20%\" height=\"12px\" align=\"center\">Refresh</td>\n                <td width=\"20%\"></td>\n            </tr>\n\n        </table>\n\n        <div\n            dojoAttachPoint=\"historyTable\" \n            style=\"height:100%;width:100%;\"\n            parseOnLoad=\"false\"\n            >\n        </div>\n\n    </div>\n    <!-- END OF HISTORY TAB -->\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","workflow/css/history.css")],parentWidget:null,childWidgets:null,isValid:null,core:null,constructor:function(args){this.core=args.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.attachNode.addChild(this.mainTab);this.showHistory();},showHistory:function(){while(this.historyTable.firstChild){this.historyTable.removeChild(this.historyTable.firstChild);}var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");query.mode="getHistory";var _154a=this;dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,handle:function(_154b){var table=document.createElement("table");_154a.historyTable.appendChild(table);dojo.addClass(table,"historyTable");for(var i=0;i<_154b.length;i++){var tr=document.createElement("tr");table.appendChild(tr);var td=document.createElement("td");tr.appendChild(td);var _154c=_154b[i][0].project;var _154d=_154b[i][0].workflow;var _154e=new plugins.workflow.HistoryPane({project:_154c,workflow:_154d,rows:_154b[i]});td.appendChild(_154e.domNode);}}});},downloadHistory:function(event){event.stopPropagation();var query="?username="+Agua.cookie("username");query+="&sessionId="+Agua.cookie("sessionId");query+="&mode=downloadHistory";var url=Agua.cgiUrl+"download.cgi";console.log("History.setHistoryButtons     downloadHistoryButton.onclick    query: "+query);console.log("History.setHistoryButtons     downloadHistoryButton.onclick    url: "+url);var args={method:"POST",url:url+query,handleAs:"html",};dojo.io.iframe.send(args);}});}if(!dojo._hasResource["plugins.workflow.IO"]){dojo._hasResource["plugins.workflow.IO"]=true;dojo.provide("plugins.workflow.IO");dojo.declare("plugins.workflow.IO",[plugins.core.Common],{parentWidget:null,core:null,constructor:function(args){this.core=args.core;this.parentWidget=args.parentWidget;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);},chainStage:function(_154f,force){var _1550=new Object;if(_154f.number!=1){_1550.inputs=this.chainInputs(_154f,force);}_1550.outputs=this.chainOutputs(_154f,force);if(this.core.parameters!=null&&this.core.parameters.isCurrentApplication(_154f)){this.core.parameters.setParameterRowStyles();}return _1550;},chainInputs:function(_1551,force){var _1552=Agua.getStageParameters(_1551);var _1553=this.filterByKeyValues(_1552,["paramtype"],["input"]);var _1554=_1551.appnumber;if(_1554==null){return;}var _1555=Agua.getStagesByWorkflow(_1551.project,_1551.workflow);if(_1555==null){return;}var _1556=_1555[_1554-2];if(_1556==null){return;}var _1557=Agua.getStageParameters(_1556);if(_1557==null){return;}for(var i=0;i<_1553.length;i++){this.chainStageParameter(_1553[i],_1557,force);}return _1553;},chainResources:function(_1558,force){},chainOutputs:function(_1559,force){var _155a=Agua.getStageParameters(_1559);var _155b=dojo.clone(_155a);_155b=this.filterByKeyValues(_155b,["paramtype"],["output"]);for(var i=0;i<_155b.length;i++){this.chainStageParameter(_155b[i],_155a,force);}return _155b;},chainStageParameter:function(_155c,_155d,force){if(_155c.args==null||_155c.args==""){return;}var _155e=this.getValuesArray(_155c,dojo.clone(_155d));var value=this.getValue(_155e,_155c.inputParams,_155c.paramFunction);if((force==true&&value!=null&&value!="")||(value!=null&&value!=""&&_155c.value=="")){_155c.value=value;_155c.chained=1;Agua._removeStageParameter(_155c);Agua.addStageParameter(_155c);Agua.setParameterValidity(_155c,true);}},getValuesArray:function(_155f,_1560){if(_155f.args==null||_1560==null){return;}var _1561=_155f.args.split(/,/);var _1562=new Array;var _1563=this;for(var i=0;i<_1561.length;i++){var args=_1561[i];var array=args.split(".");var _1564=array[0];var _1565=array[1];var _1566=array[2];var _1567=dojo.clone(_1560);_1567=_1563.filterByKeyValues(_1567,["paramtype"],[_1564]);if(_1567==null||_1567.length==0){_1562.push(null);continue;}if(_1565==null||_1565==""){_1562.push(_1567);continue;}var _1568=_1563.filterByKeyValues(dojo.clone(_1567),["name"],[_1565])[0];if(_1568==null||_1568==""){_1562.push(null);continue;}if(_1566==null){_1562.push(_1568);continue;}var value=_1568.value;_1562.push(value);}return _1562;},getValue:function(_1569,_156a,_156b){var value;if(_156a==null||_156a==""||_156b==null||_156b==""){for(var i=0;i<_1569.length;i++){if(_1569[i]==null||_1569[i]==""){continue;}return _1569[i];}}var _156c=_156a.slice(",");var _156d=new Function(_156c,_156b);value=_156d(_1569[0],_1569[1],_1569[2],_1569[3],_1569[4]);return value;}});}if(!dojo._hasResource["plugins.workflow.StageStatusRow"]){dojo._hasResource["plugins.workflow.StageStatusRow"]=true;dojo.provide("plugins.workflow.StageStatusRow");dojo.declare("plugins.workflow.StageStatusRow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\" class=\"stageTable\">\n\n\t<!-- NB: EXTRA dojoAttachPointS ADDED FOR TESTING -->\n\n\t<table class=\"stageTable ${status}\" width=\"100%\">\n\n\t\t<tr width=\"100%\" class='stageRow'>\n\t\t\t<td class='${status}Icon header'\n\t\t\t\talign=\"left\" width=\"100px\">${number} </td>\n\t\t\t<td dojoAttachPoint=\"nameNode\" class='name'>${name}</td>\n\t\t\t<td class='key'>Queued</td>\n\t\t\t<td dojoAttachPoint=\"queuedNode\" class='value'>${queued}</td>\n\t\t\t<td class='key'>Lapsed</td>\n\t\t\t<td dojoAttachPoint=\"lapsedNode\" dojoAttachPoint=\"lapsed\"\n\t\t\t\tclass='value'>${lapsed}</td>\n\t\t</tr>\n\n\t\t<tr width=\"100%\" class='stageRow'>\n\t\t\t<td class='key'>Status</td>\n\t\t\t<td dojoAttachPoint=\"statusNode\" class='value ${status}'>${status}</td>\n\t\t\t<td class='key'>Started</td>\n\t\t\t<td dojoAttachPoint=\"startedNode\" class='value'>${started}</td>\n\t\t\t<td class='key'>Output</td>\n\t\t\t<td dojoAttachPoint=\"stdoutNode\"\n\t\t\t\tclass='stdout'\n\t\t\t\twidth=\"50%\"\n\t\t\t\ttitle=\"Click to view run output\">STDOUT file</td>\n\t\t</tr>\n\n\t\t<tr width=\"100%\" class='stageRow'>\n\t\t\t<td class='key'>Duration</td>\n\t\t\t<td dojoAttachPoint=\"durationNode\" class='value'>${duration}</td>\n\t\t\t<td class='key'>Ended</td>\n\t\t\t<td dojoAttachPoint=\"completedNode\" class='value'>${completed}</td>\n\t\t\t<td class='key'>Errors</td>\n\t\t\t<td dojoAttachPoint=\"stderrNode\"\n\t\t\t\tclass='stderr'\n\t\t\t\twidth=\"50%\"\n\t\t\t\ttitle=\"Click to view error messages\">STDERR file</td>\n\t\t</tr>\n\n\t</table>\n\t\n</div>\n\n",widgetsInTemplate:true,constructor:function(args){this.core=args.core;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);if(this.stderrfile!=null&&this.stderrfile!=""){this.setFileDownload("stderr");}if(this.stdoutfile!=null&&this.stdoutfile!=""){this.setFileDownload("stdout");}},setFileDownload:function(_156e){var _156f=_156e+"Node";var _1570=_156e+"file";this[_156f].innerHTML=this[_1570];dojo.connect(this[_156f],"onclick",this,dojo.hitch(this,function(event){this.downloadFile(this[_156f].innerHTML);}));},handleDownload:function(_1571,_1572){if(_1571.message=="ifd.getElementsByTagName(\"textarea\")[0] is undefined"){Agua.toastMessage({message:"Download failed: File is not present",type:"error"});}}});}if(!dojo._hasResource["plugins.workflow.StageStatus"]){dojo._hasResource["plugins.workflow.StageStatus"]=true;dojo.provide("plugins.workflow.StageStatus");dojo.declare("plugins.workflow.StageStatus",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<table class=\"stageTable\"\n\t\tdojoAttachPoint=\"stageTable\"\n\t\twidth=\"100%\">\n\t\t\n\t</table>\t\n</div>\n",widgetsInTemplate:true,stages:null,rows:new Array(),constructor:function(args){},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);console.group("StageStatus-"+this.id+"    startup");console.log("StageStatus.startup    this.stages: ");console.dir({stages:this.stages});this.rows=[];if(this.stages==null){return;}for(var i=0;i<this.stages.length;i++){var tr=document.createElement("tr");this.stageTable.appendChild(tr);this.stages[i].duration=this.calculateDuration(this.stages[i]);console.log("RunStatus.displaythis.stagesStatus     this.stages[i].duration: "+this.stages[i].duration);this.stages[i].lapsed=this.calculateLapsed(this.stages[i]);console.log("RunStatus.displaythis.stagesStatus     this.stages[i].lapsed: "+this.stages[i].lapsed);if(this.stages[i].completed=="0000-00-00 00:00:00"){this.stages[i].completed="";}if(this.stages[i].queued=="0000-00-00 00:00:00"){this.stages[i].queued="";}this.stages[i].core=this.core;var _1573=new plugins.workflow.StageStatusRow(this.stages[i]);this.rows.push(_1573);var td=document.createElement("td");tr.appendChild(td);td.appendChild(_1573.domNode);}console.groupEnd("StageStatus-"+this.id+"    startup");},clearTable:function(){console.log("RunStatus.clearTable    DOING stageStatus.clearTable()");while(this.stageTable.childNodes&&this.stageTable.childNodes.length){console.log("RunStatus.clearTable    REMOVING node "+this.stageTable.childNodes[0]);this.stageTable.removeChild(this.stageTable.childNodes[0]);}},stringToDate:function(_1574){var array=_1574.match(/^(\d{4})\D+(\d+)\D+(\d+)\D+(\d+)\D+(\d+)\D+(\d+)/);array.shift();array[1]--;return new Date(array[0],array[1],array[2],array[3],array[4],array[5]);},secondsToDuration:function(_1575){var _1576="";var _1577=0;_1577=_1575%1000;_1575-=_1577;_1575/=1000;_1577=_1575%60;if(_1577){_1576=_1577.toString();}else{_1576="0";}_1576=_1576+" sec";_1575-=_1577;_1575/=60;_1577=_1575%60;_1576=_1577.toString()+" min "+_1576;_1575-=_1577;_1575/=60;return _1575.toString()+" hours "+_1576;},calculateDuration:function(stage){var _1578="";if(stage.started&&stage.started!="0000-00-00 00:00:00"){var _1579=this.stringToDate(stage.started);var _157a;if(!stage.completed||stage.completed=="0000-00-00 00:00:00"){_157a=this.stringToDate(stage.now);}else{_157a=this.stringToDate(stage.completed);}var _157b=_157a-_1579;_1578=this.secondsToDuration(_157b);}return _1578;},calculateLapsed:function(stage){console.log("StageStatus.calculateLapsed    stage.completed: "+stage.completed);var _157c="";if(!stage||!stage.completed){return _157c;}var _157d=this.stringToDate(stage.completed);var _157e=new Date;console.log("StageStatus.calculateLapsed    currentDate: "+_157e);console.dir({currentDate:_157e});var _157f=_157e-_157d;console.log("StageStatus.calculateLapsed    seconds: "+_157f);_157c=this.secondsToDuration(_157f);console.log("StageStatus.calculateLapsed    lapsed: "+_157c);return _157c;}});}if(!dojo._hasResource["plugins.workflow.RunStatus"]){dojo._hasResource["plugins.workflow.RunStatus"]=true;dojo.provide("plugins.workflow.RunStatus");dojo.declare("plugins.workflow.RunStatus",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"stagesTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\toverflow=\"auto\"\n\t\ttitle=\"Status\"\n\t\tclass=\"runstatus\"\n\t\tstyle=\"position: relative; top: 0px !important; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important; background: #FFF;\"\n        >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td\n\t\t\t\t\tdojoAttachPoint=\"statusTitle\"\n\t\t\t\t\tclass=\"tabTitle\"\n\t\t\t\t\talign=\"center\">Status</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"toggle\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:togglePoller\"\n\t\t\t\t\t\t\t\tclass=\"pollingStopped\"\n\t\t\t\t\t\t\t\ttitle=\"Click to start or stop run status polling\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"stop\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:stopWorkflow\"\n\t\t\t\t\t\t\t\tclass=\"stop\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"pause\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:pauseWorkflow\"\n\t\t\t\t\t\t\t\tclass=\"pause\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"play\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:startWorkflow\"\n\t\t\t\t\t\t\t\tclass=\"play\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"notifier\"\n\t\t\t\t\t\t\t\tclass=\"notifier\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div \n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Stages\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important;\"\n\t\t\t\t\t\t>\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"stagesStatusContainer\"\n\t\t\t\t\t\t\tclass=\"status\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n\t\n<!--    <div\n        dojoAttachPoint=\"clusterTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\toverflow=\"auto\"\n\t\ttitle=\"Cluster\"\n\t\tclass=\"runstatus\"\n\t\tstyle=\"position: relative; top: 0px !important; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important; background: #FFF;\"\n        >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Cluster\"\n\t\t\t\t\t\tclass=\"clusterStatus\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important; font-size: 10px !important\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"clusterStatusContainer\"\n\t\t\t\t\t\t\tclass=\"clusterStatusContainer\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n-->\t\n\t\n    <div\n        dojoAttachPoint=\"queueTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\toverflow=\"auto\"\n\t\ttitle=\"Queues\"\n\t\tclass=\"runstatus\"\n\t\tstyle=\"position: relative; top: 0px !important; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important; background: #FFF;\"\n        >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Queue\"\n\t\t\t\t\t\tclass=\"queueStatus\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important; font-size: 10px !important\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"queueStatusContainer\"\n\t\t\t\t\t\t\tclass=\"queueStatusContainer\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\t\t\n\t</div>\n\n\t\n</div> \n\n\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/runstatus.css"],timer:null,timerInterval:20000,polling:false,core:null,delay:21000,deferreds:[],constructor:function(args){console.log("RunStatus.constructor    plugins.workflow.RunStatus.constructor(args)");this.core=args.core||{};this.core.runstatus=this;console.log("RunStatus.constructor    args.parentWidget: "+args.parentWidget);console.log("RunStatus.constructor    args.attachNode: "+args.attachNode);if(args.parentWidget){this.parentWidget=args.parentWidget;}if(args.attachNode){this.attachNode=args.attachNode;}if(args.cgiUrl!=null){this.cgiUrl=args.cgiUrl;}if(this.cgiUrl==null){this.cgiUrl=Agua.cgiUrl+"workflow.cgi";}if(args.timerInterval){this.timerInterval=args.timerInterval;}this.loadCSS();},postMixInProperties:function(){console.log("RunStatus.postMixInProperties    plugins.workflow.RunStatus.postMixInProperties()");},postCreate:function(){console.log("RunStatus.postCreate    plugins.workflow.RunStatus.postCreate()");this.startup();},startup:function(){console.log("RunStatus.startup    plugins.workflow.RunStatus.startup()");this.inherited(arguments);console.log("RunStatus.startup    this.attachNode: "+this.attachNode);console.log("RunStatus.startup    this.stagesTab: "+this.stagesTab);console.log("RunStatus.startup    this.clusterTab: "+this.clusterTab);console.log("RunStatus.startup    this.queueTab: "+this.queueTab);if(this.attachNode.addChild!=null){this.attachNode.addChild(this.stagesTab);this.attachNode.addChild(this.queueTab);}else{var div=dojo.create("div");document.body.appendChild(div);div.appendChild(this.stagesTab.domNode);div.appendChild(this.queueTab.domNode);}this.setConfirmDialog();this.setSequence();this.setClusterStatus();},runWorkflow:function(_1580){console.group("runStatus-"+this.id+"    runWorkflow");console.log("RunStatus.runWorkflow      runner: ");console.dir(_1580);this.attachNode.selectChild(this.stagesTab);if(_1580!=null){delete this.runner;this.runner=_1580;}var _1581=_1580.project;var _1582=_1580.workflow;var start=_1580.start;console.log("RunStatus.runWorkflow      project: "+_1581);console.log("RunStatus.runWorkflow      workflow: "+_1582);console.log("RunStatus.runWorkflow      start: "+start);this.notifier.innerHTML="Running workflow...";var url=Agua.cgiUrl+"workflow.cgi";console.log("RunStatus.runWorkflow      url: "+url);var _1583=Agua.getWorkflowSubmit(this.runner);var query=new Object;query.project=this.runner.project;query.workflow=this.runner.workflow;query.workflownumber=this.runner.workflownumber;query.start=this.runner.start;query.stop=this.runner.stop;query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");query.mode="executeWorkflow";query.submit=_1583;query.cluster=this.runner.cluster;if(query.cluster!=""){query.cluster=query.username+"-"+query.cluster;}else{query.cluster="";}console.log("RunStatus.runWorkflow     query: "+dojo.toJson(query));var _1584=this;var _1585=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,handle:function(_1586){console.log("RunStatus.runWorkflow     response: ");console.dir({response:_1586});if(_1586.error){_1584.clearDeferreds();_1584.polling=false;_1584.displayNotPolling();if(_1586.error=="running"){console.log("RunStatus.runWorkflow    Doing this.confirmStopWorkfkow()");_1584.confirmStopWorkflow(_1581,_1582);}console.groupEnd("runStatus-"+_1584.id+"    runWorkflow");return;}Agua.toast(_1586);}});this.deferreds.push(_1585);this.polling=true;var _1587=false;this.delayedQueryStatus(this.runner,_1587);},checkRunning:function(_1588,_1589,_158a){console.group("runStatus-"+this.id+"    checkRunning");console.log("RunStatus.checkRunning     project: "+_1588);console.log("RunStatus.checkRunning     workflow: "+_1589);console.log("RunStatus.checkRunning     callback: "+_158a);var url=Agua.cgiUrl+"workflow.cgi";console.log("RunStatus.checkRunning     url: "+url);var query=new Object;query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");query.project=_1588;query.workflow=_1589;query.mode="getStatus";console.log("RunStatus.checkRunning    query: "+dojo.toJson(query));this.clearDeferreds();var _158b=this;var _158c=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,handle:function(_158d){console.log("RunStatus.checkRunning    response: ");console.dir({response:_158d});var _158e=false;if(_158d.stages==null){return false;}for(var i=0;i<_158d.stages.length;i++){if(_158d.stages[i].status=="running"){_158e=true;console.log("RunStatus.checkRunning    stage "+i+" ("+_158d.stages[i].name+") is running.");break;}}console.log("RunStatus.checkRunning    Doing  callback "+_158a+"("+_158e+")");_158b[_158a](_1588,_1589,_158e);console.groupEnd("runStatus-"+_158b.id+"    checkRunning");}});this.deferreds.push(_158c);},createRunner:function(_158f,_1590){console.group("RunStatus-"+this.id+"    createRunner");if(!this.core.userWorkflows.dropTarget){console.log("workflow.RunStatus.createRunner    Returning without childNodes because this.core.userWorkflows.dropTarget is null");console.groupEnd("RunStatus-"+this.id+"    createRunner");return _1591;}var _1592=this.core.userWorkflows.dropTarget.getAllNodes();if(_158f==null){_158f=1;}if(_1590==null){_1590=_1592.length;}console.log("workflow.RunStatus.createRunner    startNumber: "+_158f);console.log("workflow.RunStatus.createRunner    stopNumber: "+_1590);var _1593=this.core.userWorkflows.getProject();var _1594=this.core.userWorkflows.getWorkflow();var _1595=Agua.getWorkflowNumber(_1593,_1594);console.log("workflow.RunStatus.createRunner    workflowNumber: "+_1595);var _1596=this.core.userWorkflows.getCluster();console.log("workflow.RunStatus.createRunner    clusterName: "+_1596);var _1591=new Object;_1591.username=Agua.cookie("username");_1591.sessionId=Agua.cookie("sessionId");_1591.project=_1593;_1591.workflow=_1594;_1591.cluster=_1596;_1591.start=_158f;_1591.stop=_1590;_1591.workflownumber=_1595;_1591.childNodes=_1592;console.log("workflow.RunStatus.createRunner    runner: ");console.dir({runner:_1591});console.groupEnd("RunStatus-"+this.id+"    createRunner");return _1591;},getStatus:function(_1597,_1598){console.group("RunStatus-"+this.id+"    getStatus");console.log("RunStatus.getStatus    runner: ");console.dir({runner:_1597});console.log("RunStatus.getStatus      singleton: "+_1598);console.log("RunStatus.getStatus     this.polling: "+this.polling);if(this.polling==true){console.log("RunStatus.getStatus     Returning because this.polling is TRUE");console.groupEnd("RunStatus-"+this.id+"    getStatus");return;}this.polling=true;this.runner=_1597;if(!this.runner){console.log("RunStatus.getStatus    Doing this.runner\t= this.createRunner(stageNumber)");var _1599=1;this.runner=this.createRunner(_1599);}this.clusterStatus.runner=this.runner;if(!this.runner.childNodes&&this.core.userWorkflows.dropTarget){this.runner.childNodes=this.core.userWorkflows.dropTarget.getAllNodes();}dojo.removeClass(this.toggle,"pollingStopped");dojo.addClass(this.toggle,"pollingStarted");this.notifier.innerHTML="Getting run status...";var _159a=this.runner.project;var _159b=this.runner.workflow;var start=this.runner.start;var _159c=this.runner.childNodes;console.log("RunStatus.getStatus      project: "+_159a);console.log("RunStatus.getStatus      workflow: "+_159b);console.log("RunStatus.getStatus      start: "+start);console.log("RunStatus.getStatus      childNodes.length: "+_159c.length);if(_159a==null||_159b==null||start==null){console.groupEnd("RunStatus-"+this.id+"    getStatus");return;}if(_159c==null||!_159c||_159c.length==0){console.log("RunStatus.getStatus      No childNodes in dropTarget. Returning...");console.groupEnd("RunStatus-"+this.id+"    getStatus");return;}this.queryStatus(this.runner,_1598);},queryStatus:function(_159d,_159e){if(this.queryStatus.caller){console.log("RunStatus.queryStatus    caller: "+this.queryStatus.caller.nom);}console.log("RunStatus.queryStatus    passed runner: ");console.dir({runner:_159d});console.log("RunStatus.queryStatus    passed singleton: "+_159e);var url=this.cgiUrl;var query=new Object;query.username=_159d.username;query.sessionId=_159d.sessionId;query.project=_159d.project;query.workflow=_159d.workflow;query.mode="getStatus";console.log("RunStatus.queryStatus    query: "+dojo.toJson(query));this.clearDeferreds();var _159f=this;var _15a0=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,handle:function(_15a1){if(_159f.runCompleted(_15a1)){console.log("RunStatus.getStatus    response:");console.dir({response:_15a1});_159f.handleStatus(_159d,_15a1);console.groupEnd("RunStatus-"+_159f.id+"    getStatus");if(!_159e){_159f.delayedQueryStatus(_159d,_159e);}else{_159f.stopPolling();}}else{if(!_159e){_159f.delayedQueryStatus(_159d,_159e);}else{_159f.stopPolling();}}}});this.deferreds.push(_15a0);},clearDeferreds:function(){console.log("RunStatus.clearDeferreds    No. deferreds: "+this.deferreds.length);dojo.forEach(this.deferreds,function(_15a2,index){console.log("RunStatus.clearDeferreds    Clearing deferred "+index+": "+_15a2.callback.toString());_15a2.callback=function(){console.log("RunStatus.clearDeferreds    deleted callback");};console.log("RunStatus.clearDeferreds    BEFORE deferred.destroy deferred:");console.dir({deferred:_15a2});});this.deferreds=[];console.log("RunStatus.clearDeferreds    Doing this.sequence.stop()");this.sequence.stop();},showMessage:function(_15a3){console.log("RunStatus.showMessage    message: "+_15a3);console.log("RunStatus.showMessage    Doing queryStatus after delay: "+this.delay);},delayedQueryStatus:function(_15a4,_15a5){console.log("_GroupDragPane.delayedQueryStatus    runner:");console.dir({runner:_15a4});console.log("_GroupDragPane.delayedQueryStatus    singleton: "+_15a5);console.log("_GroupDragPane.delayedQueryStatus    this.polling: "+this.polling);if(!this.polling){console.log("_GroupDragPane.delayedQueryStatus    this.polling is FALSE. Returning");return;}var delay=this.delay;this.clearCountdown();var _15a6=parseInt(delay/1000);this.delayCountdown(_15a6);var _15a7=[{func:[this.showMessage,this,"RunStatus.delayedQueryStatus"],pauseAfter:delay},{func:[this.queryStatus,this,_15a4,_15a5]}];console.log("_GroupDragPane.delayedPollCopy    commands: ");console.dir({commands:_15a7});this.sequence.go(_15a7,function(){console.log("RunStatus.delayedQueryStatus    Doing this.sequence.go(commands)");});},runCompleted:function(_15a8){var _15a9=true;for(var i=0;i<_15a8.length;i++){console.log("RunStatus.runCompleted    response.stages["+i+"].status: "+_15a8.stages[i].status);if(_15a8.stages[i].status=="completed"){_15a9=false;}}return _15a9;},handleStatus:function(_15aa,_15ab){console.group("RunStatus-"+this.id+"    handleStatus");var _15ac=this.runner.project;var _15ad=this.runner.workflow;var start=this.runner.start;var _15ae=this.runner.childNodes;console.log("RunStatus.handleStatus     response: ");console.dir({response:_15ab});console.log("RunStatus.handleStatus      this.polling: "+this.polling);if(!this.polling){return false;}if(!_15ab){return false;}this.notifier.innerHTML="Processing run status...";this.response=_15ab;this.completed=true;console.log("RunStatus.handleStatus    Setting class of "+_15ab.stagestatus.length+" stage nodes");var _15af=_15aa.start-1;if(_15af<0){_15af=0;}console.log("RunStatus.handleStatus    startIndex: "+_15af);for(var i=_15af;i<_15ab.stagestatus.length;i++){var _15b0=_15ab.stagestatus[i].status;console.log("RunStatus.handleStatus   response.stagestatus["+i+"].status: "+_15ab.stagestatus[i].status);if(!_15aa.childNodes[i]){continue;}dojo.removeClass(_15aa.childNodes[i],"stopped");dojo.removeClass(_15aa.childNodes[i],"waiting");dojo.removeClass(_15aa.childNodes[i],"running");dojo.removeClass(_15aa.childNodes[i],"completed");dojo.addClass(_15aa.childNodes[i],_15b0);if(_15b0!="completed"){console.log("RunStatus.handleStatus    Setting this.completed = false");this.completed=false;}}if(this.completed==true){this.stopPolling();}console.log("RunStatus.handleStatus    this.completed: "+this.completed);console.log("RunStatus.handleStatus     BEFORE Agua.updateStagesStatus(startIndex, response)");Agua.updateStagesStatus(_15ab.stagestatus);console.log("RunStatus.handleStatus     AFTER Agua.updateStagesStatus(startIndex, response)");console.log("RunStatus.handleStatus     BEFORE this.showStatus(startIndex, response)");this.showStatus(_15ab);console.log("RunStatus.handleStatus     AFTER this.showStatus(startIndex, response)");console.groupEnd("RunStatus-"+this.id+"    handleStatus");return null;},clearCountdown:function(){if(this.delayCountdownTimeout){clearTimeout(this.delayCountdownTimeout);}this.toggle.innerHTML="";},delayCountdown:function(_15b1){if(_15b1==1){this.notifier.innerHTML="Getting run status ...";}_15b1-=1;this.toggle.innerHTML=_15b1;if(_15b1<1){return;}var _15b2=850;var _15b3=this;this.delayCountdownTimeout=setTimeout(function(){_15b3.delayCountdown(_15b1);},_15b2,this);},togglePoller:function(){console.log("RunStatus.togglePoller      plugins.workflow.RunStatus.togglePoller()");console.log("RunStatus.togglePoller      this.polling: "+this.polling);if(this.polling){console.log("RunStatus.togglePoller      Setting this.polling to FALSE and this.completed to FALSE");this.polling=false;this.completed=false;this.stopPolling();}else{console.log("RunStatus.togglePoller      Setting this.polling to TRUE and this.completed to TRUE");this.polling=true;this.completed=true;if(!this.runner){this.runner=this.createRunner(1,null);}this.startPolling();}},displayPolling:function(){dojo.removeClass(this.toggle,"pollingStopped");dojo.addClass(this.toggle,"pollingStarted");},displayNotPolling:function(){dojo.removeClass(this.toggle,"pollingStarted");dojo.addClass(this.toggle,"pollingStopped");},stopPolling:function(){console.log("RunStatus.stopPolling      plugins.workflow.RunStatus.stopPolling()");console.log("RunStatus.stopPolling      Setting this.polling to FALSE");this.polling=false;this.clearCountdown();this.clearDeferreds();this.displayNotPolling();},startPolling:function(){console.log("RunStatus.startPolling      plugins.workflow.RunStatus.startPolling()");console.log("RunStatus.startPolling      this.polling: "+this.polling);console.log("RunStatus.togglePoller      Setting this.polling to FALSE (ahead of check this.polling in getStatus)");this.polling=false;if(!this.runner){console.log("RunStatus.startPolling      this.runner is null. Returning");this.polling=false;return;}this.displayPolling();console.log("RunStatus.togglePoller      Doing this.getStatus(null, false)");this.getStatus(null,false);},showStatus:function(_15b4){console.log("RunStatus.showStatus      response: ");console.dir({response:_15b4});if(!_15b4){return;}this.setTime(_15b4.stagestatus[0]);console.log("RunStatus.showStatus      Doing this.displayStageStatus(response.stages)");this.displayStageStatus(_15b4.stagestatus);console.log("RunStatus.showStatus      Doing this.displayRunStatus(response.clusterstatus)");this.displayClusterStatus(_15b4.clusterstatus);console.log("RunStatus.showStatus      Doing this.displayQueueStatus(response.queuestatus)");this.displayQueueStatus(_15b4.queuestatus);},displayStageStatus:function(_15b5){console.log("RunStatus.displayStageStatus      plugins.workflow.RunStatus.displayStageStatus(stages)");console.log("RunStatus.displayStageStatus      stages: ");console.dir({stages:_15b5});while(this.stagesStatusContainer.firstChild){this.stagesStatusContainer.removeChild(this.stagesStatusContainer.firstChild);}console.log("RunStatus.displayStageStatus      AFTER clear status table");delete this.stageStatus;this.stageStatus=new plugins.workflow.StageStatus({attachNode:this.stagesStatusContainer,stages:_15b5});console.log("RunStatus.displayStageStatus      this.stageStatus: "+this.stageStatus);this.stagesStatusContainer.appendChild(this.stageStatus.stageTable);},displayClusterStatus:function(_15b6){this.clusterStatus.displayStatus(_15b6);},displayQueueStatus:function(queue){console.log("RunStatus.displayQueueStatus      queue: "+queue);if(!queue){queue="No output available";}while(this.queueStatusContainer.firstChild){this.queueStatusContainer.removeChild(this.queueStatusContainer.firstChild);}this.queueStatusContainer.innerHTML="<PRE>"+queue+"</PRE>";},clear:function(){console.log("RunStatus.clear      plugins.workflow.RunStatus.clear()");this.queueStatusContainer.innerHTML="";this.clusterStatus.clearStatus();while(this.stagesStatusContainer.firstChild){this.stagesStatusContainer.removeChild(this.stagesStatusContainer.firstChild);}},setTime:function(stage){console.log("RunStatus.setTime    stage: "+dojo.toJson(stage));this.notifier.innerHTML=stage.now;},pauseWorkflow:function(){console.log("RunStatus.pauseWorkflow    ");var _15b7=this.core.userWorkflows.getProject();var _15b8=this.core.userWorkflows.getWorkflow();this.checkRunning(_15b7,_15b8,"confirmPauseWorkflow");},stopWorkflow:function(){console.log("RunStatus.stopWorkflow    ");var _15b9=this.core.userWorkflows.getProject();var _15ba=this.core.userWorkflows.getWorkflow();this.checkRunning(_15b9,_15ba,"confirmStopWorkflow");},startWorkflow:function(){console.log("RunStatus.startWorkflow    ");var _15bb=this.core.userWorkflows.getProject();var _15bc=this.core.userWorkflows.getWorkflow();this.checkRunning(_15bb,_15bc,"confirmStartWorkflow");},confirmPauseWorkflow:function(_15bd,_15be,_15bf){console.log("RunStatus.confirmPauseWorkflow    project: "+_15bd);console.log("RunStatus.confirmPauseWorkflow    workflow: "+_15be);console.log("RunStatus.confirmPauseWorkflow    isRunning: "+_15bf);if(!_15bf){return;}var _15c0=function(){console.log("WorkflowMenu.confirmPauseWorkflow    noCallback()");};var _15c1=dojo.hitch(this,function(){console.log("WorkflowMenu.confirmPauseWorkflow    yesCallback()");this.doPauseWorkflow();});var _15c2=this.core.userWorkflows.indexOfRunningStage();console.log("RunStatus.confirmPauseWorkflow   indexOfRunningStage: "+_15c2);this.runner=this.core.runStatus.createRunner(_15c2);var title=_15bd+"."+_15be+" is running";var _15c3="Are you sure you want to stop it?";this.loadConfirmDialog(title,_15c3,_15c1,_15c0);},confirmStartWorkflow:function(_15c4,_15c5,_15c6){console.log("RunStatus.confirmStartWorkflow    project: "+_15c4);console.log("RunStatus.confirmStartWorkflow    workflow: "+_15c5);console.log("RunStatus.confirmStartWorkflow    isRunning: "+_15c6);if(_15c6){return;}var _15c7=function(){console.log("RunStatus.startWorkflow    noCallback()");};var _15c8=dojo.hitch(this,function(){console.log("RunStatus.startWorkflow    yesCallback()");this.doStartWorkflow();});var title="Run "+_15c4+"."+_15c5+" from start to finish";var _15c9="Please confirm (click Yes to run)";this.loadConfirmDialog(title,_15c9,_15c8,_15c7);},confirmStopWorkflow:function(_15ca,_15cb,_15cc){console.log("RunStatus.confirmStopWorkflow    project: "+_15ca);console.log("RunStatus.confirmStopWorkflow    workflow: "+_15cb);console.log("RunStatus.confirmStopWorkflow    isRunning: "+_15cc);if(!_15cc){return;}var _15cd=function(){console.log("RunStatus.startWorkflow    noCallback()");};var _15ce=dojo.hitch(this,function(){console.log("RunStatus.startWorkflow    yesCallback()");this.doStartWorkflow();});var title="Run "+_15ca+"."+_15cb+" from start to finish";var _15cf="Please confirm (click Yes to run)";this.loadConfirmDialog(title,_15cf,_15ce,_15cd);},doPauseWorkflow:function(){console.log("RunStatus.doPauseWorkflow    plugins.workflow.RunStatus.pauseWorkflow");this.pauseRun();},doStartWorkflow:function(){console.log("RunStatus.doStartWorkflow    plugins.workflow.RunStatus.startWorkflow");this.runner=this.core.runStatus.createRunner(1);this.runWorkflow(this.runner);},doStopWorkflow:function(){console.log("RunStatus.stopWorkflow    plugins.workflow.RunStatus.stopWorkflow()");var _15d0=this.runner.project;var _15d1=this.runner.workflow;var _15d2=this.runner.cluster;var start=this.runner.start;var _15d3=Agua.cookie("username");var _15d4=Agua.cookie("sessionId");dojo.removeClass(this.toggle,"pollingStopped");dojo.addClass(this.toggle,"pollingStarted");this.notifier.innerHTML="Running workflow...";var url=Agua.cgiUrl+"workflow.cgi";console.log("RunStatus.stopWorkflow      url: "+url);var query=new Object;query.username=_15d3;query.sessionId=_15d4;query.project=_15d0;query.workflow=_15d1;query.cluster=_15d3+"-"+_15d2;query.mode="stopWorkflow";query.start=start;console.log("RunStatus.stopWorkflow     query: "+dojo.toJson(query));this.clearDeferreds();var _15d5=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,load:function(_15d6){Agua.toast(_15d6);}});this.deferreds.push(_15d5);},stopRun:function(){console.log("RunStatus.stopRun    DOING this.stopPolling()");this.stopPolling();if(!this.core.userWorkflows.dropTarget){console.log("workflow.RunStatus.stopRun    Returning because this.core.userWorkflows.dropTarget is null");return;}console.log("RunStatus.stopRun      this.stageStatus: "+this.stageStatus);console.dir({stageStatus:this.stageStatus});if(this.stageStatus==null||this.stageStatus.rows==null||this.stageStatus.rows.length==0){return;}for(var i=0;i<this.stageStatus.rows;i++){var row=this.stageStatus.rows[i];console.log("RunStatus.stopRun    row.status "+i+": "+row.status);if(row.status=="running"){row.status="stopped";}}var _15d7=this.core.userWorkflows.dropTarget.getAllNodes();for(var i=0;i<this.stageNodes;i++){var node=this.stageNodes[i];console.log("RunStatus.stopRun    node "+i+": "+node);if(dojo.hasClass(node,"running")){dojo.removeClass(node,"running");dojo.addClass(node,"stopped");}}this.stopWorkflow();},pauseRun:function(){console.log("RunStatus.pauseRun      DOING this.stopPolling()");this.stopPolling();this.stopWorkflow();if(this.response==null){return;}console.log("RunStatus.pauseRun    Checking "+this.response.length+" stage nodes");for(var i=0;i<this.response.length;i++){if(this.response[i].status=="completed"){continue;}this.runner.start=(startIndex+1);dojo.removeClass(childNodes[i],"waiting");dojo.removeClass(childNodes[i],"running");dojo.removeClass(childNodes[i],"completed");dojo.addClass(childNodes[i],"waiting");break;}},confirmStopWorkflow:function(_15d8,_15d9){console.log("RunStatus.confirmStopWorkflow    project "+_15d8+", workflow "+_15d9+" isRunning is true. Loading confirm dialog.");var _15da=function(){};var _15db=dojo.hitch(this,function(){this.stopRun();});var title=_15d8+"."+_15d9+" is already running";var _15dc="Do you want to stop it?";this.loadConfirmDialog(title,_15dc,_15db,_15da);},setConfirmDialog:function(){var _15dd=function(){};var _15de=function(){};var title="Dialog title";var _15df="Dialog message";this.confirmDialog=new plugins.dijit.ConfirmDialog({title:title,message:_15df,parentWidget:this,yesCallback:_15dd,noCallback:_15de});},loadConfirmDialog:function(title,_15e0,_15e1,_15e2){console.log("FileMenu.loadConfirmDialog    yesCallback.toString(): "+_15e1.toString());console.log("FileMenu.loadConfirmDialog    title: "+title);console.log("FileMenu.loadConfirmDialog    message: "+_15e0);console.log("FileMenu.loadConfirmDialog    yesCallback: "+_15e1);console.log("FileMenu.loadConfirmDialog    noCallback: "+_15e2);this.confirmDialog.load({title:title,message:_15e0,yesCallback:_15e1,noCallback:_15e2});},setSequence:function(){this.sequence=new dojox.timing.Sequence({});},setClusterStatus:function(){this.clusterStatus=new plugins.workflow.ClusterStatus({core:this.core,attachNode:this.attachNode});}});}if(!dojo._hasResource["plugins.workflow.SharedApps"]){dojo._hasResource["plugins.workflow.SharedApps"]=true;dojo.provide("plugins.workflow.SharedApps");dojo.declare("plugins.workflow.SharedApps",[plugins.workflow.Apps],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        class=\"apps\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n        title=\"Bioapps\"\n\t\tstyle=\"position: relative; height: 100%; max-height: auto !important; width: 400px !important; padding: 0 !important;\"\n    >\n\n        <!-- NEED margin-bottom TO COMPENSATE FOR 29px MARGIN-TOP OFFSET FOR TABLE-->\n        <table width=\"200px\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t\n\t\t\t\t<td colspan=\"3\" class=\"tabTitle\" align=\"center\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"refreshButton\"\n\t\t\t\t\t\tdojoAttachPoint=\"refreshButton\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:refresh\">\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"header\">\n\t\t\t\t\t    Applications\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n            <tr>\n                <td>\n                    <div\n                        dojoAttachPoint=\"appSourcesContainer\"\n\t\t\t\t\t>\n                    </div>\n                    \n                </td>\n            </tr>\n        </table>\n    \n    </div>\n</div>\n",startup:function(){console.log("SharedApps.startup    workflow.SharedApps.startup()");this.inherited(arguments);},setRefreshButton:function(){dojo.connect(this.refreshButton,"onclick",this,"refresh");},refresh:function(){this.updateApps();},updateApps:function(args){console.log("SharedApps.updateApps    Doing Agua.getTable(sharedapps)");this.closePanes();setTimeout(function(_15e3){Data.getTable("sharedApps,sharedParameters");_15e3.loadAppSources();},500,this);},getApps:function(){return Agua.getSharedApps();}});}if(!dojo._hasResource["plugins.workflow.StageRow"]){dojo._hasResource["plugins.workflow.StageRow"]=true;dojo.provide("plugins.workflow.StageRow");dojo.declare("plugins.workflow.StageRow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table\n        class=\"stagerow\"\n        cellspacing=\"0px\"\n        height=\"16px\" width=\"100%\" style=\"padding: 0; margin: 0; height: 16px !important;\">\n        <tr>\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"nameNode\"\n                class=\"name\"\n                >${name}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"numberNode\"\n                class=\"number\">\n            </td>\n        </tr>\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"executorNode\"\n                class=\"executor\"\n                style=\"display: none;\" >${executor}\n            </td>\n\n            <td \n                colspan=\"2\"\n                dojoAttachPoint=\"submitNode\"\n                class=\"\"\n                style=\"display: none;\" >\n            </td>\n            \n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"locationNode\"\n                class='location'\n                style=\"display: none;\" >${location}\n            </td>\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"descriptionNode\"\n                class='description'\n                style=\"display: none;\" >${description}\n            </td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/stagerow.css"],parentWidget:null,application:null,core:null,constructor:function(args){this.loadCSS();this.core=args.core;this.parentWidget=args.parentWidget;this.application=new Object;for(var key in args){if(key!="parentWidget"){this.application[key]=args[key];}}},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.name.parentWidget=this;this.setNumber(this.application.number);this.setSubmitStyle(this.application.submit);},setSubmitStyle:function(_15e4){if(_15e4==1){dojo.addClass(this.domNode,"submit");}else{dojo.removeClass(this.domNode,"submit");}},checkValidParameters:function(force){this.checkAllParameters(force);if(this.fileStageParameters.length!=0){this.checkFiles();}else{this.checkRunStatus();}},checkRunStatus:function(){if(this.core.runStatus==null){return;}var _15e5=this.core.userWorkflows.indexOfRunningStage();var _15e6=this.core.runStatus.createRunner(_15e5);var _15e7=true;this.core.runStatus.getStatus(_15e6,_15e7);},checkAllParameters:function(force){this.isValid=true;var _15e8=new Array;var _15e9=new Array;if(this.core.parameters!=null&&this.core.parameters.isCurrentApplication(this.application)){_15e8=this.core.parameters.childWidgets;for(var i=0;i<this.core.parameters.childWidgets.length;i++){_15e9.push(this.core.parameters.childWidgets[i].parameterObject);}}else{_15e9=Agua.getStageParameters(this.application);}if(_15e9==null){return false;}this.fileStageParameters=new Array;this.fileParameterRows=new Array;for(var i=0;i<_15e9.length;i++){_15e9[i].value=this.systemVariables(_15e9[i].value,_15e9[i]);var _15ea=Agua.getParameterValidity(_15e9[i]);if(force!=true&&_15ea!=null&&_15ea!=false){if(_15e8[i]!=null){if(_15ea==true){_15e8[i].setValid(_15e8[i].containerNode);}else{_15e8[i].setInvalid(_15e8[i].containerNode);this.isValid=false;}}continue;}else{if(_15e9[i].valuetype=="flag"){continue;}}if(_15e9[i].valuetype=="file"||_15e9[i].valuetype=="directory"){this.checkValidFile(_15e9[i],_15e8[i]);}else{if(_15e9[i].valuetype=="integer"){this.checkValidInteger(_15e9[i],_15e8[i]);}else{this.checkValidText(_15e9[i],_15e8[i]);}}}if(this.fileStageParameters.length==0){if(this.isValid==false||this.isValid==null){this.setInvalid();}else{this.setValid();}return this.isValid;}},currentParametersApplication:function(_15eb){var keys=["project","workflow","workflownumber","name","number"];return this._objectsMatchByKey(_15eb,this.core.parameters.application,keys);},checkFiles:function(files){if(files==null){files=this.fileStageParameters;}var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");query.project=this.application.project;query.workflow=this.application.workflow;query.mode="checkFiles";query.files=files;var _15ec=this;var _15ed=dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:dojo.toJson(query),handle:function(_15ee,_15ef){_15ec.validateFiles(files,_15ee);if(_15ec.core.parameters!=null&&_15ec.core.parameters.isCurrentApplication(_15ec.application)){_15ec.checkRunStatus();}}});if(this.isValid==false||this.isValid==null){this.setInvalid();}else{this.setValid();}return this.isValid;},validateFiles:function(_15f0){if(_15f0==null||_15f0.length==null||!_15f0.length){return;}for(var i=0;i<_15f0.length;i++){var _15f1=this.fileParameterRows[i];if(this.fileStageParameters&&this.fileStageParameters[i]){Agua.setFileInfo(this.fileStageParameters[i],_15f0[i]);}if(_15f0[i].exists=="true"){if(_15f0[i].type!=this.fileStageParameters[i].valuetype){Agua.setParameterValidity(this.fileStageParameters[i],false);this.isValid=false;if(_15f1!=null){_15f1.setInvalid(_15f1.containerNode);}}else{Agua.setParameterValidity(this.fileStageParameters[i],true);if(_15f1!=null){_15f1.setValid(_15f1.containerNode);}}}else{if(this.fileStageParameters[i].discretion=="essential"){this.isValid=false;Agua.setParameterValidity(this.fileStageParameters[i],false);if(_15f1!=null){_15f1.setInvalid(_15f1.containerNode);}}else{Agua.setParameterValidity(this.fileStageParameters[i],true);if(_15f1!=null){_15f1.setValid(_15f1.containerNode);}}}}if(this.isValid==false){this.setInvalid();}else{this.setValid();}},checkValidFile:function(_15f2,_15f3){var _15f4=_15f2.value;if(_15f2.discretion=="required"||_15f2.discretion=="essential"){if(_15f4==null||_15f4==""){this.setInvalidParameter(_15f2,_15f3);}else{if(_15f2.fileinfo==null){this.fileStageParameters.push(_15f2);this.fileParameterRows.push(_15f3);}else{if(_15f2.fileinfo.exists=="false"){if(_15f2.chained==null||_15f2.chained==0){this.fileStageParameters.push(_15f2);this.fileParameterRows.push(_15f3);}else{this.setValidParameter(_15f2,_15f3);}}else{if(_15f2.fileinfo.type!=_15f2.valuetype){this.setInvalidParameter(_15f2,_15f3);}else{this.setValidParameter(_15f2,_15f3);}}}}}else{if(_15f2.value==null||_15f2.value==""){this.setValidParameter(_15f2,_15f3);}else{this.fileStageParameters.push(_15f2);this.fileParameterRows.push(_15f3);}}},checkValidInteger:function(_15f5,_15f6){if(_15f5.discretion!="optional"){if(_15f5.value==null||_15f5.value==""){this.setInvalidParameter(_15f5,_15f6);}else{if(!_15f5.value.match(/^\s*[\d\.]+\s*$/)){this.isValid=false;Agua.setParameterValidity(_15f5,false);}else{this.setValidParameter(_15f5,_15f6);}}}else{if(_15f5.value!=null&&_15f5.value!=""&&!_15f5.value.match(/^\s*[\d\.]+\s*$/)){this.setInvalidParameter(_15f5,_15f6);}else{this.setValidParameter(_15f5,_15f6);}}},checkValidText:function(_15f7,_15f8){if(_15f7.discretion!="optional"){if(_15f7.value==null||_15f7.value==""){this.setInvalidParameter(_15f7,_15f8);}else{this.setValidParameter(_15f7,_15f8);}}else{this.setValidParameter(_15f7,_15f8);}},toggle:function(){var array=["executor","localonly","location","description","notes"];for(var i in array){if(this[array[i]].style.display=="table-cell"){this[array[i]].style.display="none";}else{this[array[i]].style.display="table-cell";}}},setInvalidParameter:function(_15f9,_15fa){this.isValid=false;Agua.setParameterValidity(_15f9,false);if(_15fa!=null){_15fa.setInvalid(_15fa.containerNode);}},setValidParameter:function(_15fb,_15fc){Agua.setParameterValidity(_15fb,true);if(_15fc!=null){_15fc.setValid(_15fc.containerNode);}},setValid:function(){dojo.removeClass(this.domNode,"unsatisfied");dojo.addClass(this.domNode,"satisfied");this.isValid=true;var _15fd=this.core.userWorkflows;_15fd.updateRunButton();},setInvalid:function(){dojo.removeClass(this.domNode,"satisfied");dojo.addClass(this.domNode,"unsatisfied");this.isValid=false;var _15fe=this.core.userWorkflows;_15fe.updateRunButton();},getApplication:function(){return dojo.clone(this.application);},setApplication:function(_15ff){this.application=_15ff;return this.application;},setNumber:function(_1600){this.application.number=_1600;this.application.appnumber=_1600;this.numberNode.innerHTML=_1600;}});}if(!dojo._hasResource["plugins.workflow.StageMenu"]){dojo._hasResource["plugins.workflow.StageMenu"]=true;dojo.provide("plugins.workflow.StageMenu");dojo.declare("plugins.workflow.StageMenu",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"stagemenu\"\n    dojoType=\"plugins.menu.Menu\">\n\n    <div\n        dojoAttachPoint=\"runNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"runIcon\"\n        dojoAttachEvent=\"onClick:run\"    \n        >\n        Run\n    </div>\n\n    <div\n        dojoAttachPoint=\"runAllNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"runAllIcon\"\n        dojoAttachEvent=\"onClick:runAll\"    \n        >\n        Run All\n    </div>\n\n    <div\n        dojoAttachPoint=\"chainNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"chainIcon\"\n        dojoAttachEvent=\"onClick:chain\"    \n        >\n        Chain\n    </div>\n\n    <div\n        dojoAttachPoint=\"refreshNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"refreshIcon\"\n        dojoAttachEvent=\"onClick:refresh\"    \n        >\n        Refresh\n    </div>\n\n    <div\n        dojoAttachPoint=\"stopNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"stopIcon\"\n        dojoAttachEvent=\"onClick:stop\"    \n        >\n        Stop\n    </div>\n\n    <div\n        dojoAttachPoint=\"removeNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"deleteIcon\"\n        dojoAttachEvent=\"onClick:remove\"    \n        >\n        Delete\n    </div>\n\n</div>\n",widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/stagemenu.css"],parentWidget:null,core:null,constructor:function(args){console.log("StageMenu.constructor     plugins.workflow.StageMenu.constructor");this.core=args.core;console.log("StageMenu.constructor     this.core: "+this.core);this.parentWidget=args.parentWidget;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setMenu();},setMenu:function(){},bind:function(node){if(node==null){}return this.menu.bindDomNode(node);},remove:function(event){console.log("StageMenu.remove     plugins.workflow.StageMenu.remove(event)");var node=this.menu.currentTarget;var _1601=dijit.getEnclosingWidget(node);var _1602=_1601.getApplication();if(_1601==null){return;}var _1603=_1601.domNode.parentNode;this.parentWidget.dropTarget.delItem(_1603.id);dojo.destroy(_1603);var _1604=Agua.cookie(_1604);var _1605={username:_1604,project:this.parentWidget.projectCombo.getValue(),workflow:this.parentWidget.workflowCombo.getValue(),name:_1602.name,owner:_1602.owner,number:_1602.number,type:_1602.type};setTimeout(function(_1606){console.log("StageMenu.remove     Doing Agua.spliceStage(stageObject); }, 100, this)");Agua.spliceStage(_1605);},100,this);var _1607=this.parentWidget.dropTarget.getAllNodes();for(var i=_1602.number;i<_1607.length;i++){_1607[i].application.number=(i+1).toString();}for(var i=0;i<_1607.length;i++){var node=_1607[i];var _1601=dijit.byNode(node.firstChild);if(_1601==null){_1601=dijit.getEnclosingWidget(_1607[i]);}node.application.number=(i+1).toString();node.application.appnumber=(i+1).toString();_1601.setNumber(node.application.number);console.log("StageMenu.remove     Reset widget childNodes["+i+"].application.name "+node.application.name+", node.application.number: "+node.application.number);}console.log("StageMenu.remove    this.parentWidget: "+this.parentWidget);if(_1607.length){this.parentWidget.loadParametersPane(_1607[0]);}else{this.parentWidget.clearParameters();}this.parentWidget.updateRunButton();console.log("StageMenu.remove    Doing this.core.userWorkflows.checkRunStatus()");this.core.runStatus.polling=false;this.core.userWorkflows.checkRunStatus();},run:function(){console.log("StageMenu.run     plugins.workflow.StageMenu.run()");var node=this.menu.currentTarget;var _1608=dijit.getEnclosingWidget(node);var _1609=_1608.getApplication();if(_1609==null){var _1608=node.parentWidget;_1609=_1608.getApplication();}var _160a=this.core.runStatus.createRunner(_1609.number,_1609.number);this.core.runStatus.runWorkflow(_160a);},stop:function(){console.log("StageMenu.stop     plugins.workflow.StageMenu.stop()");var node=this.menu.currentTarget;var _160b=dijit.getEnclosingWidget(node);var _160c=_160b.getApplication();console.log("StageMenu.stop     application: "+dojo.toJson(_160c));if(_160c==null){var _160b=node.parentWidget;_160c=_160b.getApplication();}console.log("StageMenu.stop    application: "+dojo.toJson(_160c));var _160d=this.core.runStatus.createRunner(_160c.number,_160c.number);this.core.runStatus.confirmStopWorkflow();},runAll:function(){console.log("StageMenu.runAll     plugins.workflow.StageMenu.runAll()");var node=this.menu.currentTarget;var _160e=dijit.getEnclosingWidget(node);var _160f=_160e.getApplication();if(_160f==null){var _160e=node.parentWidget;_160f=_160e.getApplication();}var _1610=this.core.runStatus.createRunner(_160f.number);this.core.runStatus.runWorkflow(_1610);},chain:function(){var node=this.menu.currentTarget;var _1611=dijit.getEnclosingWidget(node);var _1612=_1611.getApplication();var _1613={project:this.parentWidget.projectCombo.getValue(),workflow:this.parentWidget.workflowCombo.getValue(),owner:_1612.owner,appname:_1612.name,appnumber:_1612.number,name:_1612.name,number:_1612.number};console.log("StageMenu.chain     DOING this.parentWidget.core.io.chainstage()");console.log("StageMenu.chain     this.parentWidget.core.io: "+this.parentWidget.core.io);var force=true;this.core.io.chainStage(_1613,force);var _1614=_1611.domNode.parentNode;this.core.userWorkflows.loadParametersPane(_1614);},refresh:function(){console.log("StageMenu.refresh     plugins.workflow.StageMenu.refresh()");var node=this.menu.currentTarget;console.dir({node:node});console.log("StageMenu.refresh     plugins.workflow.StageMenu.refresh()");var _1615=dijit.getEnclosingWidget(node);var _1616=_1615.getApplication();var _1617=Agua.cookie("username");var _1618=false;if(_1616.username!=_1617){_1618=true;}var force=true;this.core.parameters.load(node,_1618,force);}});}if(!dojo._hasResource["plugins.workflow.Workflows"]){dojo._hasResource["plugins.workflow.Workflows"]=true;dojo.provide("plugins.workflow.Workflows");if(1){}dojo.declare("plugins.workflow.Workflows",[dijit._Widget,dijit._Templated,plugins.core.Common],{templatePath:null,widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins","workflow/css/workflows.css")],parentWidget:null,attachNode:null,contextMenu:null,core:null,workflowLoaded:null,dropTargetLoaded:null,ready:false,stageRows:null,workflowType:null,constructor:function(args){console.log("Workflows.constructor     plugins.workflow.Workflows.constructor");this.core=args.core;this.core[this.workflowType]=this;this.parentWidget=args.parentWidget;this.attachNode=args.attachNode;console.log("Workflows.constructor     core.userWorkflows: "+this.core.userWorkflows);console.log("Workflows.constructor     core.sharedWorkflows: "+this.core.sharedWorkflows);this.loadCSS();},postCreate:function(){if(this.preStartup){this.preStartup();}this.startup();if(this.postStartup){this.postStartup();}},startup:function(){console.log("Workflows.startup    plugins.workflow.Workflows.startup()");console.group("Workflows-"+this.id+"    startup");this.ready=false;this.inherited(arguments);this.attachNode.addChild(this.mainTab);this.attachNode.selectChild(this.mainTab);this.setWorkflowIO();this.setSelectiveDialog();this.setInteractiveDialog();this.setContextMenu();this.setDropTarget();this.setProjectCombo();this.setComboButtons();this.setProjectListeners();this.setWorkflowListeners();Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateWorkflows");Agua.updater.subscribe(this,"updateClusters");console.log("Workflows.startup    END");console.groupEnd("Workflows-"+this.id+"    startup");},updateProjects:function(args){console.warn("workflow.Workflows.updateProjects    args:");console.dir({args:args});this.setProjectCombo();},updateWorkflows:function(args){console.warn("workflow.Workflows.updateWorkflows    args:");console.dir({args:args});this.setProjectCombo();},updateClusters:function(args){console.warn("admin.Clusters.updateClusters    args:");console.dir({args:args});this.setClusterCombo();},setContextMenu:function(){this.contextMenu=new plugins.workflow.StageMenu({parentWidget:this,core:this.core});},setDroppingApp:function(value){this.droppingApp=value;},setDropTarget:function(){this.dropTarget=new plugins.dnd.Target(this.dropTargetContainer,{accept:["draggableItem"],contextMenu:this.contextMenu,parentWidget:this,core:this.core});if(this.dropTarget==null){console.log("Workflows._setDropTargetNodes    this.dropTarget is null. Returning");return;}},updateDropTarget:function(_1619,_161a){if(this.dropTarget==null){this.dropTarget=new plugins.dnd.Target(this.dropTargetContainer,{accept:["draggableItem"],contextMenu:this.contextMenu,parentWidget:this,core:this.core});}if(this.dropTarget==null){console.log("Workflows._updateDropTargetNodes    this.dropTarget is null. Returning");return;}var _161b=Agua.getStagesByWorkflow(_1619,_161a);if(_161b==null){_161b=[];}this._updateDropTarget(_161b);},_updateDropTarget:function(_161c){console.group("Workflows-"+this.id+"    _updateDropTarget");console.log("Workflows._updateDropTarget    stages.length: "+_161c.length);var _161d=this._updateDropTargetNodes(_161c);this._updateDropTargetStageRows(_161c,_161d);if(_161d.length!=0&&this.shared){console.log("Workflows._updateDropTarget    Shared. Doing this.loadParametersPane(node_0)");this.loadParametersPane(_161d[0]);var _161e=this;setTimeout(function(){console.log("Workflows._updateDropTarget    setTimeout; SET this.ready TO TRUE");_161e.ready=true;},1000);}else{if(_161d.length!=0&&!this.shared){this.checkStages(_161d);}else{if(this.standby){this.standby.hide();}console.log("Workflows._updateDropTarget    Doing this.updateRunButton()");this.updateRunButton();}}console.groupEnd("Workflows-"+this.id+"    _updateDropTarget");},_clearTarget:function(){while(this.dropTargetContainer.firstChild){this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}},_updateDropTargetNodes:function(_161f){this._clearTarget();_161f=this.sortNumericHasharray(_161f,"number");var _1620=new Array;for(var i=0;i<_161f.length;i++){var hash=new Object;hash.data=_161f[i].name;hash.type=["draggableItem"];_1620.push(hash);}console.log("Workflows._updateDropTargetNodes     Inserting dataArray: ");console.dir({dataArray:_1620});console.log("Workflows._updateDropTargetNodes    this.dropTarget: "+this.dropTarget);this.dropTarget.insertNodes(false,_1620);console.log("Workflows._updateDropTargetNodes    this.dropTarget: "+this.dropTarget);allNodes=this.dropTarget.getAllNodes();if(!allNodes){allNodes=[];}dojo.forEach(allNodes,function(node,i){var _1621=_1620[i].type;});return allNodes;},_updateDropTargetStageRows:function(_1622,_1623){this.stageRows=new Array;var _1624=this;console.log("Workflows._updateDropTargetStageRows     Workflow.allNodes.length: "+_1623.length);dojo.forEach(_1623,function(node,i){console.log("Workflows._updateDropTargetStageRows     Doing node for stages["+i+"]: ");console.dir({stage:_1622[i]});var _1625=node.innerHTML;node.setAttribute("infoId",_1624.infoId);node.application=_1622[i];console.log("Workflows._updateDropTargetStageRows     stages["+i+"]: ");console.dir({stage:_1622[i]});node.application.description="";_1622[i].description="";_1622[i].notes="";if(_1622[i]["cluster"]==null){_1622[i]["cluster"]="";}console.log("Workflows._updateDropTargetStageRows    stages[i]: ");console.dir({stage:_1622[i]});var _1626=new plugins.workflow.StageRow(_1622[i]);_1626.core=_1624.core;_1626.parentWidget=_1624;_1624.stageRows.push(_1626);node.innerHTML="";node.appendChild(_1626.domNode);node.parentWidget=_1626;_1624.contextMenu.bind(node);dojo.connect(node,"onclick",dojo.hitch(_1624,function(event){console.log("Workflows._updateDropTargetStageRows    ONCLICK call to this.loadParametersPane()");console.log("Workflows._updateDropTargetStageRows    thisObject.ready: "+_1624.ready);event.stopPropagation();if(!_1624.ready){console.log("Workflows._updateDropTargetStageRows    QUTTING because thisObject.ready: "+_1624.ready);return;}this.loadParametersPane(node);}));});},checkStages:function(_1627){console.group("Workflows-"+this.id+"    checkStages");console.log("Workflows.checkStages    caller: "+this.checkStages.caller.nom);var _1628=this.getStandby();_1628.show();var _1629=this;setTimeout(function(){_1629.loadParametersPane(_1627[0]);var _162a=new Array;_162a[0]=[];if(_1627.length>=1){var _162b=0;for(var i=1;i<_1627.length;i++){var _162c=_1627[i].parentWidget;console.log("Workflows.checkStages    stageRows["+i+"]: "+_162c);var force=false;_162c.checkAllParameters(force);var files=_162c.fileStageParameters;console.log("Workflows.checkStages    files: ");console.dir({files:files});if(!files){files=[];}if(files!=[]&&files.length>0){console.log("Workflows.checkStages    Setting filesPresent to 1");_162b=1;}_162a[i]=files;}console.log("Workflows.checkStages    No. stageFiles to be checked: "+_162a.length);console.dir({stageFiles:_162a});if(_162b==1){_1629.checkStageFiles(_162a);}console.log("Workflows.checkStages    DOING this.standby.hide()");_1629.standby.hide();_1629.ready=true;console.log("Workflows.checkStages    SET this.ready TO TRUE");}console.log("Workflows.checkStages    Doing this.updateRunButton()");_1629.updateRunButton();_1629.ready=true;console.log("Workflows.checkStages    SET this.ready: "+_1629.ready);console.groupEnd("Workflows-"+_1629.id+"    checkStages (inside setTimeout)");},100);},checkStageFiles:function(_162d){console.group("Workflows-"+this.id+"    checkStageFiles");console.dir({stageFiles:_162d});var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");query.project=this.getProject();query.workflow=this.getWorkflow();query.mode="checkStageFiles";query.stagefiles=_162d;var _162e=this;dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:dojo.toJson(query),handle:function(_162f,_1630){if(_162f.error){Agua.toastError(_162f.error);}else{console.log("Workflows.checkStageFiles    Returned stageFileInfos:");console.dir({stageFileInfos:_162f});_162e.validateStageFiles(_162f,_162d);console.groupEnd("Workflows-"+this.id+"    checkStageFiles");}_162e.standby.hide();console.log("StagescheckStageFiles    BEFORE Do checkRunStatus()");if(_162e.core.parameters!=null&&_162e.core.parameters.isCurrentApplication(_162e.application)){console.log("StagescheckStageFiles    Doing checkRunStatus()");_162e.checkRunStatus();}}});},validateStageFiles:function(_1631,_1632){console.group("Workflows-"+this.id+"    validateStageFiles");console.dir({stageFileInfos:_1631});console.log("Workflows.validateStageFiles    this.dropTarget: "+this.dropTarget);var _1633=this.dropTarget.getAllNodes();for(var i=1;i<_1633.length;i++){var _1634=_1633[i].parentWidget;var files=_1632[i];var _1635=_1631[i];console.log("Workflows.validateStageFiles    files: ");console.dir({files:files});console.log("Workflows.validateStageFiles    infofiles: ");console.dir({infofiles:_1635});if(!files){return;}if(files!=null&&files.length){_1634.validateFiles(_1631[i]);}}console.groupEnd("Workflows-"+this.id+"    validateStageFiles");},checkRunStatus:function(){console.log("Workflows.checkRunStatus    plugins.workflow.Workflows.checkRunStatus");if(this.core.runStatus==null){return;}console.log("Parameters.load     BEFORE this.indexOfRunningStage()");var _1636=this.indexOfRunningStage();console.log("Parameters.load     indexOfRunningStage: "+_1636);var _1637=this.core.runStatus.createRunner(_1636);var _1638=true;console.log("Parameters.load     DOING runStatus.getStatus");this.core.runStatus.getStatus(_1637,_1638);},getStandby:function(){console.log("Workflows.getStandby    this.standby");if(this.standby){return this.standby;}console.log("Workflows.getStandby    Creating this.standby");var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.dropTargetContainer,onClick:"reload",text:"Checking stage inputs",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);return this.standby;},resetNumbers:function(){var _1639=this.dropTarget.getAllNodes();for(var i=0;i<_1639.length;i++){var node=_1639[i];var _163a=dijit.byNode(node.firstChild);if(_163a==null){_163a=dijit.getEnclosingWidget(_1639[i]);}node.application.number=(i+1).toString();node.application.appnumber=(i+1).toString();_163a.setNumber(node.application.number);}},getCluster:function(){if(this.clusterCombo==null){return "";}return this.clusterCombo.get("value");},setClusterCombo:function(){this.settingCluster=true;if(this.shared==true){return;}var _163b=this.getProject();var _163c=this.getWorkflow();var _163d=Agua.getClusters();var _163e=Agua.getClusterByWorkflow(_163b,_163c);if(_163e==null){_163e="";}var regex=Agua.cookie("username")+"-";_163e=_163e.replace(regex,"");var _163f=this.hashArrayKeyToArray(_163d,"cluster");_163f.splice(0,0,"");for(var i=0;i<_163f.length;i++){_163f[i]=_163f[i].replace(regex,"");}_163f=_163f.sort();var data={identifier:"name",items:[]};for(var i in _163f){data.items[i]={name:_163f[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.clusterCombo.store=store;this.clusterCombo.startup();this.clusterCombo.set("value",_163e);var _1640=_163e;var _1641=Agua.cookie("username");if(_163e){_1640=_1641+"-"+_163e;}this.setClusterNodes(_1640);},checkClusterNodes:function(event){if(event.keyCode==dojo.keys.ENTER){document.body.focus();this.checkNodeNumbers();this.updateClusterNodes();dojo.stopEvent(event);}},setClusterNodes:function(_1642){if(_1642==null||!_1642){this.minNodes.set("value",0);this.maxNodes.set("value",0);return;}var _1643=Agua.getClusters();_1643=this.filterByKeyValues(_1643,["cluster"],[_1642]);if(_1643==null){return;}if(_1643[0]!=null&&_1643[0].minnodes!=null&&_1643[0].maxnodes!=null){var _1644=_1643[0].minnodes;var _1645=_1643[0].maxnodes;this.minNodes.set("value",_1644);this.maxNodes.set("value",_1645);}},checkNodeNumbers:function(){if(this.minNodes.get("value")>this.maxNodes.get("value")){this.minNodes.set("value",this.maxNodes.get("value"));}},updateClusterNodes:function(){console.log("Workflows.updateClusterNodes    plugins.admin.Clusters.updateClusterNodes()");console.log("Workflows.updateClusterNodes    this.ready: "+this.ready);if(!this.ready){return;}var _1646=this.getCluster();console.log("Workflows.updateClusterNodes    cluster: "+_1646);if(!_1646){return;}var _1647=Agua.getClusterLongName(_1646);if(this.savingCluster==true){return;}this.savingCluster=true;var _1647=Agua.getClusterLongName(_1646);var _1648=Agua.getClusterObject(_1647);var _1649=this.minNodes.get("value");console.log("Workflows.updateClusterNodes    minValue: "+_1649);if(!_1649){this.minNodes.set("value",_1648.minnodes);return;}else{_1648.minnodes=_1649;}var _164a=this.maxNodes.get("value");console.log("Workflows.updateClusterNodes    maxValue: "+_164a);if(!_164a){this.maxNodes.set("value",_1648.maxnodes);return;}else{_1648.maxnodes=_164a;}console.log("Workflows.updateClusterNodes    clusterObject: ");console.dir({clusterObject:_1648});Agua._removeCluster(_1648);Agua._addCluster(_1648);this.savingCluster=false;var query=dojo.clone(_1648);query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");var url=Agua.cgiUrl+"admin.cgi?";query.mode="updateClusterNodes";console.log("Workflows.updateClusterNodes    query: "+dojo.toJson(query));dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(query),handle:function(_164b,_164c){console.log("Workflows.updateClusterNodes    response: ");console.dir({response:_164b});if(_164b.error){Agua.toast(_164b);}}});Agua.updater.update("updateClusters");},saveClusterWorkflow:function(event){console.log("Workflows.saveClusterWorkflow    event: "+event);console.log("Workflows.saveClusterWorkflow    this.ready: "+this.ready);console.log("Workflows.saveClusterWorkflow    caller: "+this.saveClusterWorkflow.caller.nom);if(!this.ready){console.log("Workflows.saveClusterWorkflow    this.ready is FALSE. Returning");return;}if(this.savingCluster==true){return;}this.savingCluster=true;var _164d=this.getCluster();var _164e=Agua.getClusterLongName(_164d);var _164f=this.getProject();var _1650=this.getWorkflow();if(_164f==null||!_164f){return;}if(_1650==null||!_1650){return;}var _1651=new Object;_1651.cluster=_164e;_1651.project=_164f;_1651.workflow=_1650;if(Agua.isClusterWorkflow(_1651)){this.savingCluster=false;return;}Agua._removeClusterWorkflow(_1651);if(!Agua._addClusterWorkflow(_1651)){this.savingCluster=false;return;}this.savingCluster=false;var query=dojo.clone(_1651);query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");query.mode="saveClusterWorkflow";var url=Agua.cgiUrl+"workflow.cgi?";console.log("Workflows.saveClusterWorkflow    query: "+dojo.toJson(query));Agua.doPut({query:query,url:url});var _1652=_164d;var _1653=Agua.cookie("username");if(_164d){_1652=_1653+"-"+_164d;}this.setClusterNodes(_1652);},clearParameters:function(){if(this.core.parameters==null){return;}this.core.parameters.clear();},loadParametersPane:function(node){console.group("Workflows-"+this.id+"    loadParametersPane");console.log("Workflows.loadParametersPane    plugins.workflow.Workflows.loadParametersPane(node)");if(node==null){console.groupEnd("Workflows-"+this.id+"    loadParametersPane");return;}console.log("Workflows.loadParametersPane    node.application: ");console.dir({application:node.application});if(this.core.parameters!=null){console.log("Workflows.loadParametersPane    Doing this.core.parameters.load(node)");this.core.parameters.load(node);}else{}console.groupEnd("Workflows-"+this.id+"    loadParametersPane");},setWorkflowIO:function(){if(this.core.io==null){this.core.io=new plugins.workflow.IO({parentWidget:this,core:this.core});}},getChainedValues:function(node){if(node.application==null){return;}if(node.application.number==null){this.quit("Workflows.getChainedValues    node.application.number is null. Returning.");return;}var force=true;this.core.io.chainStage(node.application,force);},chainStages:function(force){console.log("Workflows.chainStages     plugins.workflow.Workflow.chainStages(force)");console.log("Workflows.chainStages     force: "+force);console.log("Workflows.chainStages    this.dropTarget: "+this.dropTarget);var nodes=this.dropTarget.getAllNodes();console.log("Workflows.chainStages     nodes.length: "+nodes.length);for(var i=0;i<nodes.length;i++){this.core.io.chainInputs(nodes[i].application,force);if(this.core.parameters!=null){var keys=["project","workflow","workflownumber","name","number"];if(this._objectsMatchByKey(nodes[i].application,this.core.parameters.application,keys)){this.core.parameters.setParameterRowStyles();}}}},getProject:function(){return this.projectCombo.get("value");},setProjectCombo:function(_1654,_1655){this.settingProject=true;this.inherited(arguments);if(_1654==null){_1654=this.projectCombo.getValue();}this.setWorkflowCombo(_1654,_1655);},setProjectListeners:function(){var _1656=this;dojo.connect(this.projectCombo,"onChange",dojo.hitch(this,function(event){var _1657=event;console.log("Workflows.setProjectListeners    this.projectCombo onchange event. DOING this.setWorkflowCombo("+_1657+")");if(_1656.ready==false){console.log("Workflows.setProjectListeners    ONCHANGE fired. thisObject.ready is FALSE. Returning");return;}_1656.clearParameters();_1656.clearRunStatus();_1656.setWorkflowCombo(_1657);}));var _1656=this;this.projectCombo._onKey=function(evt){var key=evt.charOrCode;if(key==13){var _1658=_1656.projectCombo.getValue();_1658=_1658.replace(/\s+/g,"");_1656.projectCombo.set("value",_1658);var _1659=new Object;_1659.name=_1658;if(Agua.isProject(_1658)==false){_1656.clearParameters();Agua.addProject(_1659);Agua.updater.update("updateProjects");}if(_1656.projectCombo._popupWidget!=null){_1656.projectCombo._showResultList();}}};},deleteProject:function(event){if(this.doingDelete==true){return;}this.doingDelete=true;if(!Agua.getStages()){return;}var _165a=this.projectCombo.getValue();if(_165a==null||!_165a){this.doingDelete=false;return;}var args=new Object;args.project=_165a;args.workflow=null;this.confirmDelete(args);this.doingDelete=false;},getWorkflow:function(){return this.workflowCombo.get("value");},getWorkflowNumber:function(){var _165b=this.getProject();var _165c=this.getWorkflow();if(_165b==null||_165c==null){return;}return Agua.getWorkflowNumber(_165b,_165c);},setWorkflowCombo:function(_165d,_165e){this.inherited(arguments);if(_165e==null){_165e=this.workflowCombo.getValue();}this.setClusterCombo(_165d,_165e);this.updateDropTarget(_165d,_165e);},setWorkflowListeners:function(){var _165f=this;dojo.connect(_165f.workflowCombo,"onChange",dojo.hitch(this,function(event){var _1660=event;var _1661=_165f.getProject();if(_165f.ready==false){return;}_165f.clearRunStatus();_165f.setClusterCombo(_1661,_1660);_165f.updateDropTarget(_1661,_1660);}));var _165f=this;this.workflowCombo._onKey=function(evt){var key=evt.charOrCode;if(key==13){var _1662=_165f.getProject();var _1663=_165f.getWorkflow();_1663=_1663.replace(/\s+/g,"");_165f.workflowCombo.set("value",_1663);evt.stopPropagation();var _1664=Agua.isWorkflow({project:_1662,name:_1663});if(_1664==false){Agua.addWorkflow({project:_1662,name:_1663});_165f.setWorkflowCombo(_1662,_1663);}if(_165f.workflowCombo._popupWidget!=null){_165f.workflowCombo._showResultList();}}};},newWorkflow:function(_1665,_1666){if(this.doingNewWorkflow==true){return;}this.doingNewWorkflow=true;Agua.addWorkflow({project:_1665,name:_1666});this.doingNewWorkflow=false;this.setWorkflowCombo(_1665,_1666);Agua.addProjectWorkflow(_1665,_1666);},setComboButtons:function(){var _1667=this;dojo.connect(this.deleteProjectButton,"onclick",function(event){_1667.deleteProject(event);});dojo.connect(this.deleteWorkflowButton,"onclick",function(event){_1667.deleteWorkflow(event);});},deleteWorkflow:function(event){if(this.doingDelete==true){return;}this.doingDelete=true;var _1668=this.projectCombo.getValue();if(_1668==null||!_1668){this.doingDelete=false;return;}var _1669=this.workflowCombo.getValue();if(_1669==null||!_1669){this.doingDelete=false;return;}var args=new Object;args.project=_1668;args.workflow=_1669;this.confirmDelete(args);this.doingDelete=false;},indexOfRunningStage:function(){var _166a=this.getProject();var _166b=this.getWorkflow();var _166c=Agua.getStagesByWorkflow(_166a,_166b);var _166d=0;for(var i=0;i<_166c.length;i++){if(_166c[i].status=="running"){return i+1;}}return 0;},updateStageNumber:function(_166e,_166f){var addOk=Agua.updateStageNumber(_166e,_166f);if(!addOk){return;}},clearRunStatus:function(){if(this.core.runStatus==null){return;}this.core.runStatus.clear();this.core.runStatus.polling=false;},updateRunButton:function(){console.log("Workflows.updateRunButton    plugins.workflow.Workflows.updateRunButton()");console.log("Workflows.updateRunButton    this.dropTarget: "+this.dropTarget);if(!this.dropTarget){console.log("Workflows.updateRunButton    Returning because this.dropTarget not defined");return;}var _1670=this.dropTarget.getAllNodes();console.log("Workflows.updateRunButton    stageNodes.length: "+_1670.length);this.isValid=true;for(var i=0;i<_1670.length;i++){var _1671=_1670[i].parentWidget;if(_1671==null){_1671=dijit.byNode(_1670[i].firstChild);}if(_1671==null){this.isValid=false;return;}if(_1671.isValid==false||_1671.isValid==null){this.isValid=false;}}if(this.isValid==true){this.enableRunButton();}else{this.disableRunButton();}},enableRunButton:function(){var node=this.runButton;dojo.removeClass(node,"runButtonDisabled");dojo.addClass(node,"runButtonEnabled");if(node.onclickListener!=null){dojo.disconnect(node.onclickListener);}if(this.shared==true){return;}var _1672=this;node.onclickListener=dojo.connect(node,"onclick",function(event){console.log("Workflows.enableRunButton     runButton onclick triggered");if(_1672.core.runStatus==null){return;}var _1673=_1672.core.runStatus.createRunner(1);_1672.core.runStatus.runWorkflow(_1673);});},disableRunButton:function(){var node=this.runButton;dojo.removeClass(node,"runButtonEnabled");dojo.addClass(node,"runButtonDisabled");if(node.onclickListener!=null){dojo.disconnect(node.onclickListener);}},commitDelete:function(args){if(args.project==null){return;}if(args.workflow!=null){Agua.removeWorkflow({project:args.project,name:args.workflow});this.clearParameters();var _1674=this.projectCombo.getValue();this.setWorkflowCombo(_1674);Agua.toastMessage({message:"Deleted workflow: "+args.project+"."+args.workflow,type:"message"});Agua.updater.update("updateWorkflows",{originator:this,reload:false});}else{Agua.removeProject({name:args.project});Agua.updater.update("updateProjects");Agua.toastMessage({message:"Deleted project '"+args.project+"'",type:"warning"});Agua.updater.update("updateProjects",{originator:this,reload:false});}},confirmDelete:function(args){var _1675=this;var _1676=function(){_1675.commitDelete(args);};var _1677=function(){};var title="Delete project: "+args.project+"?";if(args.workflow!=null){title="Delete workflow: "+args.workflow+"?";}var _1678="All stages and data will be destroyed<br><span style='color: #222;'>Click 'Yes' to delete or 'No' to cancel</span>";if(args.workflow!=null){_1678="All data will be destroyed<br><span style='color: #222;'>Click 'Yes' to delete or 'No' to cancel</span>";}if(this.confirm!=null){this.confirm.destroy();}this.confirm=new plugins.dijit.Confirm({parentWidget:this,title:title,message:_1678,yesCallback:_1676,noCallback:_1677});this.confirm.show();},setSelectiveDialog:function(){var _1679=function(){};var _167a=function(){};var title="";var _167b="";var _167c="";this.selectiveDialog=new plugins.dijit.SelectiveDialog({title:title,message:_167b,inputMessage:_167c,parentWidget:this,enterCallback:_1679,cancelCallback:_167a});},loadSelectiveDialog:function(title,_167d,_167e,_167f,_1680,_1681,_1682,_1683){this.selectiveDialog.load({title:title,message:_167d,comboValues:_167e,inputMessage:_167f,comboMessage:_1680,checkboxMessage:_1681,parentWidget:this,enterCallback:_1682,cancelCallback:_1683});},setInteractiveDialog:function(){var _1684=function(){};var _1685=function(){};var title="";var _1686="";var _1687="";this.interactiveDialog=new plugins.dijit.InteractiveDialog({title:title,message:_1686,inputMessage:_1687,parentWidget:this,enterCallback:_1684,cancelCallback:_1685});},loadInteractiveDialog:function(title,_1688,_1689,_168a,_168b){this.interactiveDialog.load({title:title,message:_1688,checkboxMessage:_168b,enterCallback:_1689,cancelCallback:_168a});},copyWorkflow:function(){var _168c=this.projectCombo.get("value");var _168d=this.workflowCombo.get("value");var _168e=function(){};var _168f=this;var _1690=dojo.hitch(this,function(_1691,_1692,_1693,_1694){var _1695="Copy";var _1696="Cancel";if(_1691==null||_1691==""){return;}_1691=_1691.replace(/\s+/,"");if(Agua.isWorkflow({project:_1692,name:_1691})==true){_1694.messageNode.innerHTML="/"+_1691+"' already exists in '"+_1692+"'";return;}else{_1694.messageNode.innerHTML="Creating workflow";_1694.close();}_168f._copyWorkflow(_168c,_168d,_1692,_1691,_1693);});this.selectiveDialog.load({title:"Copy Workflow",message:"Source: '"+_168c+":"+_168d+"'",comboValues:Agua.getProjectNames(),inputMessage:"Workflow",comboMessage:"Project",checkboxMessage:"Copy files",parentWidget:this,enterCallback:_1690,cancelCallback:_168e,enterLabel:"Copy",cancelLabel:"Cancel"});},_copyWorkflow:function(_1697,_1698,_1699,_169a,_169b){var _169c=Agua.cookie("username");var _169d=Agua.copyWorkflow(_169c,_1697,_1698,_169c,_1699,_169a,_169b);if(_169d==true){this.setProjectCombo(_1699,_169a);}},copyProject:function(){var _169e=this.projectCombo.get("value");var _169f=function(){};var _16a0=this;var _16a1=dojo.hitch(this,function(_16a2,_16a3,_16a4){if(_16a2==null||_16a2==""){return;}_16a2=_16a2.replace(/\s+/,"");if(Agua.isProject(_16a2)==true){_16a4.messageNode.innerHTML="Project name already exists";return;}else{_16a4.messageNode.innerHTML="Creating project";_16a4.close();}_16a0._copyProject(_169e,_16a2,_16a3);});this.interactiveDialog.load({title:"Copy Project",message:"Please enter project name",checkboxMessage:"Copy files",enterCallback:_16a1,cancelCallback:_169f});},_copyProject:function(_16a5,_16a6,_16a7){var _16a8=Agua.cookie("username");Agua.copyProject(_16a8,_16a5,_16a8,_16a6,_16a7);this.setProjectCombo(_16a6);}});}if(!dojo._hasResource["plugins.workflow.SharedWorkflows"]){dojo._hasResource["plugins.workflow.SharedWorkflows"]=true;dojo.provide("plugins.workflow.SharedWorkflows");dojo.declare("plugins.workflow.SharedWorkflows",[plugins.workflow.Workflows],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <!-- SHARED TAB -->\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoAttachEvent=\"onclick:assumeFocus\"\n        dojoType=\"dijit.layout.ContentPane\"\n        title=\"Shared\"\n        class=\"workflows\"\n        parseOnLoad=\"false\"\n        style=\" height: 100%; width: 100%; padding: 0 !important;\"\n        >\n            \n        <table width=\"100%\">\n            <tr>\n                <td colspan=\"4\" class=\"tabTitle\" align=\"center\">Shared Workflows</td>\n            </tr>\n            <tr>\n                <td class=\"projectTitle\" colspan=\"3\">User</td>\n            </tr>\n            <tr>\n                <td class=\"usernameIcon\">\n                </td>\n                \n                <td class=\"comboColumn\">\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"usernameCombo\"\n                        class=\"usernameCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n\n            </tr>\n            <tr>\n                <td class=\"projectTitle\" colspan=\"3\">Project</td>\n            </tr>\n            <tr>\n\n                <td class=\"projectIcon\">\n                </td>\n                \n                <td class=\"comboColumn\">\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"projectCombo\"\n                        class=\"projectCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n                \n                <td class=\"buttonColumn\">\n                    <div\n                    dojoAttachPoint=\"copyProjectButton\"\n                    dojoAttachEvent=\"onclick:copyProject\"\n                    class=\"copyProjectButton\" \t\t\t\t\t\t\t\t\t\t\t                        width=\"20%\"\n                    title=\"Copy Project\"\n                    align=\"center\"\n                    >\n                    </div>\n                </td>\n\n            </tr>\n            <tr>\n                <td class=\"workflowTitle\" colspan=\"3\">Workflow</td>\n            </tr>\n            <tr>\n\n                <td class=\"workflowIcon\">\n                </td>\n                \n                <td class=\"comboColumn\">\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"workflowCombo\"\n                        class=\"workflowCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n\n                <td class=\"buttonColumn\">\n                    <div\n                    dojoAttachPoint=\"copyWorkflowButton\"\n                    dojoAttachEvent=\"onclick:copyWorkflow\"\n                    class=\"copyWorkflowButton\"\n                    title=\"Copy Workflow\"\n                    width=\"20%\"\n                    align=\"center\"\n                    >\n                    </div>\n                </td>\n            </tr>\n            \n            <tr>\n                <td \n                    dojoAttachPoint=\"sharedDisplayStatus\"\n                    class=\"displayStatus\"\n                    colspan=\"3\"\n                    >\n                </td>\n            </tr>\n            \n            <tr>\n                <td align=\"center\" width=\"260px\" colspan=\"3\">\n                    <div\n                        dojoAttachPoint=\"dropTargetContainer\"\n                        class=\"dropTarget\"\n                        style=\"position:relative; top: 20px;\">\n                    </div>\n                </td>\n            </tr>\n\n        </table>\n    \n    </div>\n    <!-- END OF SHARED TAB -->\n\n</div>\n",widgetsInTemplate:true,shared:true,parentWidget:null,childWidgets:null,isValid:null,core:null,workflowType:"sharedWorkflows",startup:function(){this.ready=false;this.attachNode.addChild(this.mainTab);this.setSelectiveDialog();this.setInteractiveDialog();this.setContextMenu();this.setDropTarget();this.setUsernameCombo();this.setListeners();Agua.updater.subscribe(this,"updateProjects");this.ready=true;},updateProjects:function(args){},setListeners:function(){var _16a9=this;dojo.connect(this.usernameCombo,"onChange",dojo.hitch(function(event){_16a9.setProjectCombo(event);}));dojo.connect(this.projectCombo,"onChange",dojo.hitch(function(event){var _16aa=_16a9.usernameCombo.get("value");var _16ab=_16a9.projectCombo.get("value");_16a9.setWorkflowCombo(_16aa,_16ab);}));var _16a9=this;dojo.connect(this.workflowCombo,"onChange",dojo.hitch(function(event){var _16ac=_16a9.usernameCombo.get("value");var _16ad=_16a9.projectCombo.get("value");var _16ae=_16a9.workflowCombo.get("value");_16a9.updateDropTarget(_16ac,_16ad,_16ae);}));},enableRunButton:function(){},disableRunButton:function(){},setUsernameCombo:function(){this.inherited(arguments);var _16af=this.usernameCombo.get("value");this.setProjectCombo(_16af);},setProjectCombo:function(_16b0,_16b1,_16b2){this.setSharedProjectCombo(_16b0,_16b1,_16b2);if(_16b1==null||!_16b1){_16b1=this.projectCombo.get("value");}this.setWorkflowCombo(_16b0,_16b1);},setWorkflowCombo:function(_16b3,_16b4,_16b5){this.setSharedWorkflowCombo(_16b3,_16b4,_16b5);if(_16b4==null||!_16b4){_16b4=this.projectCombo.get("value");}if(_16b5==null||!_16b5){_16b5=this.workflowCombo.get("value");}this.updateDropTarget(_16b3,_16b4,_16b5);},setDropTarget:function(){this.dropTarget=new plugins.dnd.Target(this.dropTargetContainer,{accept:[],contextMenu:this.contextMenu,parentWidget:this,core:this.core});if(this.dropTarget==null){return;}},updateDropTarget:function(_16b6,_16b7,_16b8){if(!this.ready){return;}if(!_16b6){return;}if(!_16b7){return;}if(!_16b8){return;}var _16b9=Agua.getSharedStagesByWorkflow(_16b6,_16b7,_16b8);if(_16b9==null){return;}this._updateDropTarget(_16b9);},assumeFocus:function(){var _16ba=thisObject.usernameCombo.get("value");var _16bb=thisObject.projectCombo.get("value");var _16bc=thisObject.workflowCombo.get("value");this.updateDropTarget(_16ba,_16bb,_16bc);},loadParametersPane:function(node){if(node==null){return;}if(this.core.parameters!=null){this.core.parameters.load(node,this.shared);}this.ready=true;},_copyWorkflow:function(_16bd,_16be,_16bf,_16c0,_16c1){var _16c2=this.usernameCombo.get("value");var _16c3=Agua.cookie("username");Agua.copyWorkflow(_16c2,_16bd,_16be,_16c3,_16bf,_16c0,_16c1);Agua.updater.update("updateProjects");},_copyProject:function(_16c4,_16c5,_16c6){var _16c7=Agua.cookie("username");var _16c8=this.usernameCombo.get("value");Agua.copyProject(_16c8,_16c4,_16c7,_16c5,_16c6);Agua.updater.update("updateProjects");}});}if(!dojo._hasResource["plugins.workflow.UserWorkflows"]){dojo._hasResource["plugins.workflow.UserWorkflows"]=true;dojo.provide("plugins.workflow.UserWorkflows");if(1){}dojo.declare("plugins.workflow.UserWorkflows",[plugins.workflow.Workflows],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n        class=\"workflows\"\n\t\ttitle=\"Workflows\"\n\t\tstyle=\"height: 100%; width: 100%; padding: 0 !important;\"\n    >\n    \n        <table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"4\"class=\"tabTitle\" align=\"center\">\n                    Workflows\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\n        <table align=\"center\" width=\"100%\">\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td\n\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\tdojoAttachPoint=\"syncWorkflowsButton\"\n\t\t\t\t\tclass=\"syncWorkflowsButton\"\n\t\t\t\t\ttitle=\"Click to sync workflows to biorepository\"\n\t\t\t\t\tdojoAttachEvent=\"onclick:showSyncDialog\"\n\t\t\t\t>\n\t\t\t\t\tSync\n\t\t\t\t</td>\n\t\t\t</tr>\n            <tr>\n                <td class=\"workflowTitle\" colspan=\"5\">Cluster</td>\n            </tr>\n\n            <tr align=\"center\">\n\n                <td class=\"clusterIcon\"></td>\n\t\t\t\t<td>\n                    <div\n\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"clusterCombo\"\n\t\t\t\t\t\tdojoAttachEvent=\"onChange:saveClusterWorkflow\"\n                        class=\"clusterCombo\"\n                        autocomplete=\"false\"\n\t\t\t\t\t\tdisabled=\"false\"\n                    >\n                    </div>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t\t\t<td colspan=\"2\"><b>Nodes</b></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t\t\t<td>Min</td>\n\t\t\t\t\t\t\t<td>Max</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"minNodes\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onKeyPress:checkClusterNodes\"\n\t\t\t\t\t\t\t\t\tclass=\"minNodes\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"5\" \n\t\t\t\t\t\t\t\t\tpromptMessage=\"Minimum nodes: from 0 to 99999\" \n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Minimum nodes: from 0 to 99999\"\n\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"maxNodes\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onKeyPress:checkClusterNodes\"\n\t\t\t\t\t\t\t\t\tclass=\"maxNodes\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"5\" \n\t\t\t\t\t\t\t\t\tpromptMessage=\"Maximum nodes: from 0 to 99999\" \n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Maximum nodes: from 0 to 99999\"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\n\t\t\n\t\t<table width=\"100%\">\n            <tr>\n                <td class=\"projectTitle\" colspan=\"4\">Project</td>\n            </tr>\n            <tr>\n\n                <td class=\"projectIcon\">\n                </td>\n                \n                <td>\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"projectCombo\"\n                        class=\"projectCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n                \n                <td\n                    dojoAttachPoint=\"copyProjectButton\"\n\t\t\t\t\tdojoAttachEvent=\"onclick:copyProject\"\n                    class=\"copyProjectButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\"\n                    class=\"fileUpload\" >\n                </td>\n\n                <td\n                    dojoAttachPoint=\"deleteProjectButton\"\n                    class=\"deleteProjectButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\"\n                    class=\"fileUpload\" >\n                </td>\n\n            </tr>\n            <tr>\n                <td class=\"workflowTitle\" colspan=\"4\">Workflow</td>\n            </tr>\n            <tr>\n\n                <td class=\"workflowIcon\">\n                </td>\n\n                <td>\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"workflowCombo\"\n                        class=\"workflowCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n\n                <td \n                    dojoAttachPoint=\"copyWorkflowButton\"\n\t\t\t\t\tdojoAttachEvent=\"onclick:copyWorkflow\"\n                    class=\"copyWorkflowButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\"\n                    class=\"fileUpload\" >\n                </td>\n\n                <td \n                    dojoAttachPoint=\"deleteWorkflowButton\"\n                    class=\"deleteWorkflowButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\"\n                    class=\"fileUpload\" >\n                </td>\n\n            </tr>\n        </table>\n\t\t\n        <table align=\"center\" width=\"260px\">\n            <tr align=\"center\" >\n\n                <td width=80px\n                    colspan=\"3\"\n                    dojoAttachPoint=\"runButton\"\n                    class=\"runButton runButtonDisabled\"\n                    width=\"100%\"\n                    style=\"-moz-user-select: none !important; padding-left: 0px;\">\n                    Run Workflow\n                </td>\n\n            </tr>\n\n            <tr>\n                <td \n                    dojoAttachPoint=\"displayStatus\"\n                    class=\"displayStatus\"\n                    colspan=\"3\"\n                    >\n                </td>\n            </tr>\n            \n            <tr>\n                <td colspan=\"3\">\n                    <div\n                        dojoAttachPoint=\"dropTargetContainer\"\n                        class=\"dropTarget\" >\n                    </div>\n                </td>\n            </tr>\n\n        </table>\n\n    \n    </div>\n    <!-- END OF WORKFLOWS TAB -->\n    \n\n</div>\n",widgetsInTemplate:true,contextMenu:null,workflowType:"userWorkflows",syncDialog:null,constructor:function(args){console.log("Stages.constructor     plugins.workflow.UserWorkflows.constructor");this.core=args.core;this.core[this.workflowType]=this;this.parentWidget=args.parentWidget;this.attachNode=args.attachNode;this.loadCSS();},preStartup:function(){console.group("UserWorkflows-"+this.id+"    preStartup");console.log("HERE");console.log("UserWorkflows.preStartup    END");console.groupEnd("UserWorkflows-"+this.id+"    preStartup");},postStartup:function(){console.group("UserWorkflows-"+this.id+"    postStartup");this.setSyncWorkflows();Agua.updater.subscribe(this,"updateSyncWorkflows");this.setSyncDialog();console.groupEnd("UserWorkflows-"+this.id+"    postStartup");},updateSyncWorkflows:function(args){console.warn("UserWorkflows.updateSyncWorkflows    args:");console.dir({args:args});this.setSyncWorkflows();},setSyncWorkflows:function(){var hub=Agua.getHub();console.log("UserWorkflows.setSyncWorkflows    hub:");console.dir({hub:hub});if(!hub.login||!hub.token){this.disableSyncWorkflows();}else{this.enableSyncWorkflows();}},setSyncDialog:function(){console.log("UserWorkflows.loadSyncDialog    plugins.workflows.UserWorkflows.setSyncDialog()");var _16c9=function(){};var _16ca=function(){};var title="Sync";var _16cb="Sync Workflows";this.syncDialog=new plugins.dijit.SyncDialog({title:title,header:_16cb,parentWidget:this,enterCallback:_16c9});console.log("UserWorkflows.loadSyncDialog    this.syncDialog:");console.dir({this_syncDialog:this.syncDialog});},showSyncDialog:function(){var _16cc=dojo.hasClass(this.syncWorkflowsButton,"disabled");console.log("UserWorkflows.loadSyncDialog    disabled: "+_16cc);if(_16cc){console.log("UserWorkflows.loadSyncDialog    SyncWorkflows is disabled. Returning");return;}var title="Sync Workflows";var _16cd="";var _16ce="";var _16cf="";var _16d0=dojo.hitch(this,"syncWorkflows");this.loadSyncDialog(title,_16cd,_16ce,_16cf,_16d0);},loadSyncDialog:function(title,_16d1,_16d2,_16d3,_16d4){console.log("UserWorkflows.loadSyncDialog    title: "+title);console.log("UserWorkflows.loadSyncDialog    header: "+_16d1);console.log("UserWorkflows.loadSyncDialog    message: "+_16d2);console.log("UserWorkflows.loadSyncDialog    details: "+_16d3);console.log("UserWorkflows.loadSyncDialog    enterCallback: "+_16d4);this.syncDialog.load({title:title,header:_16d1,message:_16d2,details:_16d3,enterCallback:_16d4});},disableSyncWorkflows:function(){dojo.addClass(this.syncWorkflowsButton,"disabled");dojo.attr(this.syncWorkflowsButton,"title","Input AWS private key and public certificate to enable Sync");},enableSyncWorkflows:function(){dojo.removeClass(this.syncWorkflowsButton,"disabled");dojo.attr(this.syncWorkflowsButton,"title","Click to sync workflows to biorepository");},syncWorkflows:function(_16d5){console.log("Hub.syncWorkflows    inputs: ");console.dir({inputs:_16d5});if(this.syncingWorkflows==true){console.log("Hub.syncWorkflows    this.syncingWorkflows: "+this.syncingWorkflows+". Returning.");return;}this.syncingWorkflows=true;var query=new Object;query.username=Agua.cookie("username");query.sessionId=Agua.cookie("sessionId");query.message=_16d5.message;query.details=_16d5.details;query.hubtype="github";query.mode="syncWorkflows";console.log("Hub.syncWorkflows    query: ");console.dir({query:query});var url=Agua.cgiUrl+"workflow.cgi?";var _16d6=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(query),load:function(_16d7,_16d8){_16d6.syncingWorkflows=false;console.log("Workflows.syncWorkflows    OK. response:");console.dir({response:_16d7});Agua.toast(_16d7);},error:function(_16d9,_16da){_16d6.syncingWorkflows=false;console.log("Workflows.syncWorkflows    ERROR. response:");console.dir({response:_16d9});Agua.toast(_16d9);}});}});}dojo.i18n._preloadLocalizations("dojo.nls.",["ROOT","ar","ca","cs","da","de","de-de","el","en","en-gb","en-us","es","es-es","fi","fi-fi","fr","fr-fr","he","he-il","hu","it","it-it","ja","ja-jp","ko","ko-kr","nb","nl","nl-nl","pl","pt","pt-br","pt-pt","ru","sk","sl","sv","th","tr","xx","zh","zh-cn","zh-tw"]);